[0m21:04:45.276166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f17e0>]}


============================== 21:04:45.279117 | c58a28b6-f745-4b4f-a862-de7a88b70a5d ==============================
[0m21:04:45.279117 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:04:45.279434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m21:04:45.287760 [info ] [MainThread]: dbt version: 1.10.7
[0m21:04:45.288040 [info ] [MainThread]: python version: 3.10.8
[0m21:04:45.288199 [info ] [MainThread]: python path: /Users/rishin/bin/python
[0m21:04:45.288348 [info ] [MainThread]: os info: macOS-12.5-arm64-arm-64bit
[0m21:04:45.294581 [info ] [MainThread]: Using profiles dir at /Users/rishin/.dbt
[0m21:04:45.294955 [info ] [MainThread]: Using profiles.yml file at /Users/rishin/.dbt/profiles.yml
[0m21:04:45.295157 [info ] [MainThread]: Using dbt_project.yml file at /Users/rishin/Downloads/automate-dv-demo-5.4/dbt_project.yml
[0m21:04:45.357697 [info ] [MainThread]: Configuration:
[0m21:04:45.358100 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m21:04:45.358273 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:04:45.358423 [info ] [MainThread]: Required dependencies:
[0m21:04:45.358627 [debug] [MainThread]: Executing "git --help"
[0m21:04:45.924148 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:04:45.925040 [debug] [MainThread]: STDERR: "b''"
[0m21:04:45.925276 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:04:45.925470 [info ] [MainThread]: Connection test skipped since no profile was found
[0m21:04:45.925639 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:04:45.925791 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'dbtvault_snowflake_demo'


[0m21:04:45.927596 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6971695, "process_in_blocks": "0", "process_kernel_time": 0.071794, "process_mem_max_rss": "106692608", "process_out_blocks": "0", "process_user_time": 0.730742}
[0m21:04:45.928074 [debug] [MainThread]: Command `dbt debug` failed at 21:04:45.927997 after 0.70 seconds
[0m21:04:45.928521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108146da0>]}
[0m21:04:45.928848 [debug] [MainThread]: Flushing usage events
[0m21:04:47.067132 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:06:34.496648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11829b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e304c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e33dc0>]}


============================== 21:06:34.499827 | 0e5bcd50-2e33-446d-9f8e-a7d0023fed15 ==============================
[0m21:06:34.499827 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:06:34.500179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:06:34.507320 [info ] [MainThread]: dbt version: 1.10.7
[0m21:06:34.507515 [info ] [MainThread]: python version: 3.10.8
[0m21:06:34.507661 [info ] [MainThread]: python path: /Users/rishin/bin/python
[0m21:06:34.507806 [info ] [MainThread]: os info: macOS-12.5-arm64-arm-64bit
[0m21:06:36.318297 [info ] [MainThread]: Using profiles dir at /Users/rishin/.dbt
[0m21:06:36.318634 [info ] [MainThread]: Using profiles.yml file at /Users/rishin/.dbt/profiles.yml
[0m21:06:36.318798 [info ] [MainThread]: Using dbt_project.yml file at /Users/rishin/Downloads/automate-dv-demo-5.4/dbt_project.yml
[0m21:06:36.318961 [info ] [MainThread]: adapter type: bigquery
[0m21:06:36.319123 [info ] [MainThread]: adapter version: 1.10.1
[0m21:06:36.377186 [info ] [MainThread]: Configuration:
[0m21:06:36.377486 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:06:36.377646 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:06:36.377797 [info ] [MainThread]: Required dependencies:
[0m21:06:36.378111 [debug] [MainThread]: Executing "git --help"
[0m21:06:36.400468 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:06:36.401431 [debug] [MainThread]: STDERR: "b''"
[0m21:06:36.401661 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:06:36.401951 [info ] [MainThread]: Connection:
[0m21:06:36.402348 [info ] [MainThread]:   method: service-account
[0m21:06:36.402501 [info ] [MainThread]:   database: trim-field-467501-p5
[0m21:06:36.402638 [info ] [MainThread]:   execution_project: trim-field-467501-p5
[0m21:06:36.402773 [info ] [MainThread]:   schema: dbt_dataset
[0m21:06:36.402906 [info ] [MainThread]:   location: US
[0m21:06:36.403040 [info ] [MainThread]:   priority: interactive
[0m21:06:36.403171 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:06:36.403300 [info ] [MainThread]:   impersonate_service_account: None
[0m21:06:36.403433 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:06:36.403562 [info ] [MainThread]:   job_retries: 1
[0m21:06:36.403691 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:06:36.403819 [info ] [MainThread]:   job_execution_timeout_seconds: 200
[0m21:06:36.403948 [info ] [MainThread]:   timeout_seconds: 200
[0m21:06:36.404076 [info ] [MainThread]:   client_id: None
[0m21:06:36.404218 [info ] [MainThread]:   token_uri: None
[0m21:06:36.404348 [info ] [MainThread]:   compute_region: None
[0m21:06:36.404478 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:06:36.404610 [info ] [MainThread]:   gcs_bucket: None
[0m21:06:36.404737 [info ] [MainThread]:   dataproc_batch: None
[0m21:06:36.405200 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:06:36.520108 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:06:36.520750 [debug] [MainThread]: On debug: select 1 as id
[0m21:06:36.520968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:06:37.556719 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7800381c-8a63-4ce7-bec5-175a751e28d2&page=queryresults
[0m21:06:38.539720 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:06:38.541652 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:06:38.546363 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.093456, "process_in_blocks": "0", "process_kernel_time": 1.218343, "process_mem_max_rss": "341147648", "process_out_blocks": "0", "process_user_time": 2.814127}
[0m21:06:38.547522 [debug] [MainThread]: Command `dbt debug` succeeded at 21:06:38.547294 after 4.09 seconds
[0m21:06:38.548201 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:06:38.548922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11829b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1540061a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154006fe0>]}
[0m21:06:38.549633 [debug] [MainThread]: Flushing usage events
[0m21:06:39.539488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:50.666321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127534f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11443c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11443ca90>]}


============================== 21:19:50.669503 | 8b8fb621-b11a-41bd-ac7d-8a056016d051 ==============================
[0m21:19:50.669503 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:19:50.669820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:19:52.510050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b8fb621-b11a-41bd-ac7d-8a056016d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1747c7d60>]}
[0m21:19:52.541618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b8fb621-b11a-41bd-ac7d-8a056016d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143a9de0>]}
[0m21:19:52.541982 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:19:52.653924 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m21:19:52.655452 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.0343, "process_in_blocks": "0", "process_kernel_time": 1.463974, "process_mem_max_rss": "334872576", "process_out_blocks": "0", "process_user_time": 2.407334}
[0m21:19:52.655976 [debug] [MainThread]: Command `dbt build` failed at 21:19:52.655919 after 2.03 seconds
[0m21:19:52.656229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127534f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x175161600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x175162650>]}
[0m21:19:52.656444 [debug] [MainThread]: Flushing usage events
[0m21:19:53.720428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:31:13.956188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060436d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107194550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107197d90>]}


============================== 21:31:13.959484 | b41ed890-99eb-46cc-8340-8f97a1f19b39 ==============================
[0m21:31:13.959484 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:31:13.959870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:14.046863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b41ed890-99eb-46cc-8340-8f97a1f19b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5dff0>]}
[0m21:31:14.057145 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-iqj2l5o_'
[0m21:31:14.057442 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:31:14.235473 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:31:14.236035 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m21:31:14.947852 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m21:31:14.960919 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:31:15.055159 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:31:15.071112 [info ] [MainThread]: Updating lock file in file path: /Users/rishin/Downloads/automate-dv-demo-5.4/package-lock.yml
[0m21:31:15.075716 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-21blr00g'
[0m21:31:15.081029 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m21:31:15.839480 [info ] [MainThread]: Installed from version 0.9.7
[0m21:31:15.840043 [info ] [MainThread]: Updated version available: 0.11.2
[0m21:31:15.840456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b41ed890-99eb-46cc-8340-8f97a1f19b39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106369690>]}
[0m21:31:15.840911 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:31:16.215383 [info ] [MainThread]: Installed from version 1.3.0
[0m21:31:16.215754 [info ] [MainThread]: Up to date!
[0m21:31:16.216040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b41ed890-99eb-46cc-8340-8f97a1f19b39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107367a00>]}
[0m21:31:16.216338 [info ] [MainThread]: 
[0m21:31:16.216602 [info ] [MainThread]: Updates available for packages: ['Datavault-UK/automate_dv']                 
Update your versions in packages.yml, then run dbt deps
[0m21:31:16.218449 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.3111784, "process_in_blocks": "0", "process_kernel_time": 0.177379, "process_mem_max_rss": "109412352", "process_out_blocks": "0", "process_user_time": 0.840065}
[0m21:31:16.218826 [debug] [MainThread]: Command `dbt deps` succeeded at 21:31:16.218746 after 2.31 seconds
[0m21:31:16.219126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060436d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636a0e0>]}
[0m21:31:16.219395 [debug] [MainThread]: Flushing usage events
[0m21:31:17.224804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:31:34.479405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934fe50>]}


============================== 21:31:34.484633 | 5bced37a-ea71-4a3c-8caf-151678e065cb ==============================
[0m21:31:34.484633 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:31:34.485027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_inventory', 'send_anonymous_usage_stats': 'True'}
[0m21:31:34.485342 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:31:34.485529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108354c10>]}
[0m21:31:36.204494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109318100>]}
[0m21:31:36.236375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133270040>]}
[0m21:31:36.236753 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:31:36.358458 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:31:36.358967 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:31:36.359201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142347af0>]}
[0m21:31:37.957223 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
[0m21:31:37.963950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143de6170>]}
[0m21:31:38.022097 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:31:38.024092 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:31:38.036285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143e79f90>]}
[0m21:31:38.036651 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:31:38.036846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143e7bb20>]}
[0m21:31:38.037773 [info ] [MainThread]: 
[0m21:31:38.037971 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:31:38.038122 [info ] [MainThread]: 
[0m21:31:38.038387 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:31:38.038870 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:31:38.039078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:38.963657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:31:38.964472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:39.864030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db9b40>]}
[0m21:31:39.865708 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:39.872962 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m21:31:39.873915 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_inventory .......................... [RUN]
[0m21:31:39.874679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_inventory)
[0m21:31:39.875227 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m21:31:39.889818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m21:31:39.891076 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m21:31:39.919642 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m21:31:39.920613 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`PARTSUPP` AS a
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`SUPPLIER` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`PART` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`NATION` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`REGION` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m21:31:39.920990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:40.884056 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:02b0bd15-1590-483f-9ec2-939767be901f&page=queryresults
[0m21:31:40.886111 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:02b0bd15-1590-483f-9ec2-939767be901f&page=queryresults
[0m21:31:40.898254 [debug] [Thread-1 (]: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Invalid project ID 'SNOWFLAKE_SAMPLE_DATA'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:31:40.901591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143e8df00>]}
[0m21:31:40.902812 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_inventory ................. [[31mERROR[0m in 1.02s]
[0m21:31:40.903975 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m21:31:40.904798 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_inventory' to be skipped because of status 'error'.  Reason: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Invalid project ID 'SNOWFLAKE_SAMPLE_DATA'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql.
[0m21:31:40.906963 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:40.909269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:40.909749 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_inventory' was properly closed.
[0m21:31:40.910182 [info ] [MainThread]: 
[0m21:31:40.910585 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m21:31:40.911392 [debug] [MainThread]: Command end result
[0m21:31:40.956927 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:31:40.958317 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:31:40.962417 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:31:40.962636 [info ] [MainThread]: 
[0m21:31:40.962883 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:31:40.963072 [info ] [MainThread]: 
[0m21:31:40.963302 [error] [MainThread]: [31mFailure in model raw_inventory (models/raw_stage/raw_inventory.sql)[0m
[0m21:31:40.963523 [error] [MainThread]:   Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Invalid project ID 'SNOWFLAKE_SAMPLE_DATA'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:31:40.963691 [info ] [MainThread]: 
[0m21:31:40.963886 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:31:40.964046 [info ] [MainThread]: 
[0m21:31:40.964226 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:31:40.964536 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:31:40.965981 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.5326943, "process_in_blocks": "0", "process_kernel_time": 1.365275, "process_mem_max_rss": "357744640", "process_out_blocks": "0", "process_user_time": 4.501855}
[0m21:31:40.966265 [debug] [MainThread]: Command `dbt run` failed at 21:31:40.966215 after 6.53 seconds
[0m21:31:40.966495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077877c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a12170>]}
[0m21:31:40.966705 [debug] [MainThread]: Flushing usage events
[0m21:31:42.032730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:34:17.021478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066306d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106633be0>]}


============================== 21:34:17.024723 | a3c573ad-29fc-4b43-8656-ca03fc35986b ==============================
[0m21:34:17.024723 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:34:17.025113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:34:17.032486 [info ] [MainThread]: dbt version: 1.10.7
[0m21:34:17.032681 [info ] [MainThread]: python version: 3.10.8
[0m21:34:17.032827 [info ] [MainThread]: python path: /Users/rishin/bin/python
[0m21:34:17.032965 [info ] [MainThread]: os info: macOS-12.5-arm64-arm-64bit
[0m21:34:18.666318 [info ] [MainThread]: Using profiles dir at /Users/rishin/.dbt
[0m21:34:18.666617 [info ] [MainThread]: Using profiles.yml file at /Users/rishin/.dbt/profiles.yml
[0m21:34:18.666784 [info ] [MainThread]: Using dbt_project.yml file at /Users/rishin/Downloads/automate-dv-demo-5.4/dbt_project.yml
[0m21:34:18.666949 [info ] [MainThread]: adapter type: bigquery
[0m21:34:18.667090 [info ] [MainThread]: adapter version: 1.10.1
[0m21:34:18.725323 [info ] [MainThread]: Configuration:
[0m21:34:18.725622 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:34:18.725790 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:34:18.725936 [info ] [MainThread]: Required dependencies:
[0m21:34:18.726135 [debug] [MainThread]: Executing "git --help"
[0m21:34:19.275875 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:34:19.276812 [debug] [MainThread]: STDERR: "b''"
[0m21:34:19.277085 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:34:19.277360 [info ] [MainThread]: Connection:
[0m21:34:19.277723 [info ] [MainThread]:   method: service-account
[0m21:34:19.278040 [info ] [MainThread]:   database: trim-field-467501-p5
[0m21:34:19.278349 [info ] [MainThread]:   execution_project: trim-field-467501-p5
[0m21:34:19.278508 [info ] [MainThread]:   schema: dbt_dataset
[0m21:34:19.278658 [info ] [MainThread]:   location: US
[0m21:34:19.278797 [info ] [MainThread]:   priority: interactive
[0m21:34:19.278937 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:34:19.279071 [info ] [MainThread]:   impersonate_service_account: None
[0m21:34:19.279203 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:34:19.279334 [info ] [MainThread]:   job_retries: 1
[0m21:34:19.279466 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:34:19.279598 [info ] [MainThread]:   job_execution_timeout_seconds: 200
[0m21:34:19.279732 [info ] [MainThread]:   timeout_seconds: 200
[0m21:34:19.279861 [info ] [MainThread]:   client_id: None
[0m21:34:19.279986 [info ] [MainThread]:   token_uri: None
[0m21:34:19.280118 [info ] [MainThread]:   compute_region: None
[0m21:34:19.280386 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:34:19.280603 [info ] [MainThread]:   gcs_bucket: None
[0m21:34:19.280751 [info ] [MainThread]:   dataproc_batch: None
[0m21:34:19.281306 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:34:19.390421 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:34:19.391019 [debug] [MainThread]: On debug: select 1 as id
[0m21:34:19.391203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:20.620420 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f85891f4-2e05-4142-ad7e-36f6362b22cd&page=queryresults
[0m21:34:21.600995 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:34:21.602772 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:34:21.606932 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.630367, "process_in_blocks": "0", "process_kernel_time": 1.270676, "process_mem_max_rss": "336445440", "process_out_blocks": "0", "process_user_time": 2.704301}
[0m21:34:21.607807 [debug] [MainThread]: Command `dbt debug` succeeded at 21:34:21.607620 after 4.63 seconds
[0m21:34:21.608362 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:34:21.608950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1590062f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1590053c0>]}
[0m21:34:21.609592 [debug] [MainThread]: Flushing usage events
[0m21:34:22.609410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:03.543805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038a36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ffe50>]}


============================== 21:35:03.546956 | 0ac41305-a19f-4e3d-9f5b-5e0999277910 ==============================
[0m21:35:03.546956 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:35:03.547278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m raw_inventory', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:35:03.547575 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:35:03.547759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a04c10>]}
[0m21:35:05.310335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f71c60>]}
[0m21:35:05.345073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125fadbd0>]}
[0m21:35:05.346353 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:35:05.468944 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:35:05.568977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:05.569242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:05.573475 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_vault.t_links
[0m21:35:05.593280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363fc130>]}
[0m21:35:05.653666 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:35:05.655461 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:35:05.668054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1361847f0>]}
[0m21:35:05.668367 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:35:05.668547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1361876a0>]}
[0m21:35:05.669377 [info ] [MainThread]: 
[0m21:35:05.669576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:35:05.669720 [info ] [MainThread]: 
[0m21:35:05.669986 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:35:05.670464 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:35:05.670688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:06.624814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:35:06.625693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:07.541725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b71c0>]}
[0m21:35:07.542662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:07.549146 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m21:35:07.549986 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_inventory .......................... [RUN]
[0m21:35:07.550659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_inventory)
[0m21:35:07.551206 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m21:35:07.567006 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m21:35:07.568168 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m21:35:07.596841 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m21:35:07.597636 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`PARTSUPP` AS a
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`SUPPLIER` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`PART` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`NATION` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`REGION` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m21:35:07.598013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:08.552584 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:398dcb9a-d90b-4302-a424-046bfdd97596&page=queryresults
[0m21:35:08.554506 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:398dcb9a-d90b-4302-a424-046bfdd97596&page=queryresults
[0m21:35:08.566235 [debug] [Thread-1 (]: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Invalid project ID 'SNOWFLAKE_SAMPLE_DATA'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:35:08.569636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032fa380>]}
[0m21:35:08.570595 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_inventory ................. [[31mERROR[0m in 1.02s]
[0m21:35:08.571381 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m21:35:08.572028 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_inventory' to be skipped because of status 'error'.  Reason: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Invalid project ID 'SNOWFLAKE_SAMPLE_DATA'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql.
[0m21:35:08.574175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:08.576456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:08.576900 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_inventory' was properly closed.
[0m21:35:08.577280 [info ] [MainThread]: 
[0m21:35:08.577666 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m21:35:08.578491 [debug] [MainThread]: Command end result
[0m21:35:08.622068 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:35:08.623765 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:35:08.628078 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:35:08.628287 [info ] [MainThread]: 
[0m21:35:08.628518 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:35:08.628802 [info ] [MainThread]: 
[0m21:35:08.629063 [error] [MainThread]: [31mFailure in model raw_inventory (models/raw_stage/raw_inventory.sql)[0m
[0m21:35:08.629301 [error] [MainThread]:   Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Invalid project ID 'SNOWFLAKE_SAMPLE_DATA'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:35:08.629485 [info ] [MainThread]: 
[0m21:35:08.629691 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:35:08.629856 [info ] [MainThread]: 
[0m21:35:08.630040 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:35:08.630396 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:35:08.631895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.1298575, "process_in_blocks": "0", "process_kernel_time": 1.221223, "process_mem_max_rss": "340017152", "process_out_blocks": "0", "process_user_time": 3.21887}
[0m21:35:08.632238 [debug] [MainThread]: Command `dbt run` failed at 21:35:08.632183 after 5.13 seconds
[0m21:35:08.632490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038a36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125fadbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103971360>]}
[0m21:35:08.632732 [debug] [MainThread]: Flushing usage events
[0m21:35:09.791917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:15.092797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e17760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6cb80>]}


============================== 21:38:15.095919 | 5e9408ac-9365-42c6-8950-6d20890b15c3 ==============================
[0m21:38:15.095919 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:38:15.096251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m raw_inventory', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:38:15.096514 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:38:15.096692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edd3c0>]}
[0m21:38:16.839385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151e74a60>]}
[0m21:38:16.871593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b8f10>]}
[0m21:38:16.871972 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:38:16.995978 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:38:17.096421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:38:17.097699 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/schema.yml
[0m21:38:17.716980 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault
[0m21:38:17.723485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1535d5990>]}
[0m21:38:17.778477 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:38:17.780027 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:38:17.791834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1535d7ca0>]}
[0m21:38:17.792143 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:38:17.792319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1535d6860>]}
[0m21:38:17.793154 [info ] [MainThread]: 
[0m21:38:17.793338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:38:17.793475 [info ] [MainThread]: 
[0m21:38:17.793740 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:38:17.794261 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:38:17.794472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:18.725173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:38:18.725988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:38:19.636317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047db9d0>]}
[0m21:38:19.637961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:19.644884 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m21:38:19.645774 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_inventory .......................... [RUN]
[0m21:38:19.646480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_inventory)
[0m21:38:19.647035 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m21:38:19.661302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m21:38:19.662909 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m21:38:19.691047 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m21:38:19.692099 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `my-first-project-123`.`dbt_dataset`.`PARTSUPP` AS a
LEFT JOIN `my-first-project-123`.`dbt_dataset`.`SUPPLIER` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `my-first-project-123`.`dbt_dataset`.`PART` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `my-first-project-123`.`dbt_dataset`.`NATION` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `my-first-project-123`.`dbt_dataset`.`REGION` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m21:38:19.692479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:20.760712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f746e075-d3a8-4b98-9fde-136fd5188bf1&page=queryresults
[0m21:38:20.761585 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f746e075-d3a8-4b98-9fde-136fd5188bf1&page=queryresults
[0m21:38:20.768886 [debug] [Thread-1 (]: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Access Denied: Table my-first-project-123:dbt_dataset.NATION: User does not have permission to query table my-first-project-123:dbt_dataset.NATION, or perhaps it does not exist.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:38:20.770853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106160190>]}
[0m21:38:20.771520 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_inventory ................. [[31mERROR[0m in 1.12s]
[0m21:38:20.772050 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m21:38:20.772506 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_inventory' to be skipped because of status 'error'.  Reason: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Access Denied: Table my-first-project-123:dbt_dataset.NATION: User does not have permission to query table my-first-project-123:dbt_dataset.NATION, or perhaps it does not exist.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql.
[0m21:38:20.774102 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:20.775926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:20.776317 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_inventory' was properly closed.
[0m21:38:20.776624 [info ] [MainThread]: 
[0m21:38:20.776920 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m21:38:20.777499 [debug] [MainThread]: Command end result
[0m21:38:20.812942 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:38:20.814108 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:38:20.817828 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:38:20.818021 [info ] [MainThread]: 
[0m21:38:20.818237 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:38:20.818409 [info ] [MainThread]: 
[0m21:38:20.818619 [error] [MainThread]: [31mFailure in model raw_inventory (models/raw_stage/raw_inventory.sql)[0m
[0m21:38:20.818822 [error] [MainThread]:   Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Access Denied: Table my-first-project-123:dbt_dataset.NATION: User does not have permission to query table my-first-project-123:dbt_dataset.NATION, or perhaps it does not exist.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:38:20.818983 [info ] [MainThread]: 
[0m21:38:20.819161 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:38:20.819308 [info ] [MainThread]: 
[0m21:38:20.819473 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:38:20.819759 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:38:20.821090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.7746763, "process_in_blocks": "0", "process_kernel_time": 1.219333, "process_mem_max_rss": "364888064", "process_out_blocks": "0", "process_user_time": 3.785026}
[0m21:38:20.821355 [debug] [MainThread]: Command `dbt run` failed at 21:38:20.821308 after 5.77 seconds
[0m21:38:20.821580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e17760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15363fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15354d210>]}
[0m21:38:20.821780 [debug] [MainThread]: Flushing usage events
[0m21:38:21.984287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:39:43.340652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109568850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095697b0>]}


============================== 21:39:43.343569 | 4e3f5011-16a0-496d-a24c-e231fa72c98b ==============================
[0m21:39:43.343569 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:39:43.343883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m raw_inventory', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:39:43.344139 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:39:43.344316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e0fa0>]}
[0m21:39:45.053180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164ba1f60>]}
[0m21:39:45.085231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e65fc0>]}
[0m21:39:45.085605 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:39:45.212290 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:39:45.311827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:39:45.313044 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/schema.yml
[0m21:39:45.931117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.stage
[0m21:39:45.937587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1659d91e0>]}
[0m21:39:45.991786 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:39:45.993571 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:39:46.006340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1654a6ec0>]}
[0m21:39:46.006642 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:39:46.006824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1654a4e50>]}
[0m21:39:46.007657 [info ] [MainThread]: 
[0m21:39:46.007835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:39:46.007972 [info ] [MainThread]: 
[0m21:39:46.008218 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:39:46.008654 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:39:46.008849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:46.820419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:39:46.821311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:39:47.663934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164b6c370>]}
[0m21:39:47.665255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:39:47.671837 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m21:39:47.672737 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_inventory .......................... [RUN]
[0m21:39:47.673428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_inventory)
[0m21:39:47.673985 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m21:39:47.688458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m21:39:47.689859 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m21:39:47.717819 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m21:39:47.718866 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`PARTSUPP` AS a
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`SUPPLIER` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`PART` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`NATION` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`REGION` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m21:39:47.719265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:48.733935 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:8afd5458-29de-449d-bd3c-a7779a6adf75&page=queryresults
[0m21:39:48.752966 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:8afd5458-29de-449d-bd3c-a7779a6adf75&page=queryresults
[0m21:39:48.778894 [debug] [Thread-1 (]: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.NATION was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:39:48.790266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108765000>]}
[0m21:39:48.808581 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_inventory ................. [[31mERROR[0m in 1.11s]
[0m21:39:48.809548 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m21:39:48.810286 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_inventory' to be skipped because of status 'error'.  Reason: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.NATION was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql.
[0m21:39:48.812748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:39:48.815378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:48.815882 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_inventory' was properly closed.
[0m21:39:48.816353 [info ] [MainThread]: 
[0m21:39:48.816820 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m21:39:48.817804 [debug] [MainThread]: Command end result
[0m21:39:48.866462 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:39:48.867939 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:39:48.872270 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:39:48.872498 [info ] [MainThread]: 
[0m21:39:48.872760 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:39:48.872967 [info ] [MainThread]: 
[0m21:39:48.873227 [error] [MainThread]: [31mFailure in model raw_inventory (models/raw_stage/raw_inventory.sql)[0m
[0m21:39:48.873474 [error] [MainThread]:   Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.NATION was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:39:48.873655 [info ] [MainThread]: 
[0m21:39:48.873872 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:39:48.874051 [info ] [MainThread]: 
[0m21:39:48.874254 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:39:48.874592 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:39:48.876007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5762105, "process_in_blocks": "0", "process_kernel_time": 1.547226, "process_mem_max_rss": "360169472", "process_out_blocks": "0", "process_user_time": 3.488193}
[0m21:39:48.876331 [debug] [MainThread]: Command `dbt run` failed at 21:39:48.876270 after 5.58 seconds
[0m21:39:48.876577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e65fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164b6c370>]}
[0m21:39:48.876811 [debug] [MainThread]: Flushing usage events
[0m21:39:50.150227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:40:20.057823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ef6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092445e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109244ca0>]}


============================== 21:40:20.060732 | 277dad1a-f7e2-49e6-8d20-cd5fa81de805 ==============================
[0m21:40:20.060732 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:40:20.061054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m raw_inventory', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:40:20.061313 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:40:20.061493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '277dad1a-f7e2-49e6-8d20-cd5fa81de805', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b9390>]}
[0m21:40:21.752572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '277dad1a-f7e2-49e6-8d20-cd5fa81de805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106829d50>]}
[0m21:40:21.784315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '277dad1a-f7e2-49e6-8d20-cd5fa81de805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b68070>]}
[0m21:40:21.784695 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:40:21.906557 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:40:22.004890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:40:22.006107 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/schema.yml
[0m21:40:22.593402 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.raw_inventory' (models/raw_stage/raw_inventory.sql) depends on a source named 'tpch_sample.NATION' which was not found
[0m21:40:22.593814 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:40:22.595533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5789478, "process_in_blocks": "0", "process_kernel_time": 1.107629, "process_mem_max_rss": "355041280", "process_out_blocks": "0", "process_user_time": 3.455176}
[0m21:40:22.595781 [debug] [MainThread]: Command `dbt run` failed at 21:40:22.595728 after 2.58 seconds
[0m21:40:22.595976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ef6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155207400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155214370>]}
[0m21:40:22.596172 [debug] [MainThread]: Flushing usage events
[0m21:40:23.740531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:43:07.897789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb8940>]}


============================== 21:43:07.901111 | b162905c-25d2-4f3f-aa55-cdfd2eb24bca ==============================
[0m21:43:07.901111 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:43:07.901531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m raw_inventory', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:43:07.901884 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:43:07.902098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f25300>]}
[0m21:43:09.690819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6cc40>]}
[0m21:43:09.723006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102887430>]}
[0m21:43:09.723383 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:43:09.844744 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:43:09.954307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:43:09.954581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:43:09.958944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_stage
[0m21:43:09.978974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150120130>]}
[0m21:43:10.035084 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:43:10.037228 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:43:10.049359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146db77f0>]}
[0m21:43:10.049664 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:43:10.049851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146db7070>]}
[0m21:43:10.050678 [info ] [MainThread]: 
[0m21:43:10.050866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:43:10.051009 [info ] [MainThread]: 
[0m21:43:10.051275 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:43:10.051900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:43:10.052101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:10.959496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:43:10.960354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:11.808573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6f1f0>]}
[0m21:43:11.810149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:43:11.817126 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m21:43:11.818051 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_inventory .......................... [RUN]
[0m21:43:11.818801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_inventory)
[0m21:43:11.819353 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m21:43:11.835996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m21:43:11.837125 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m21:43:11.865767 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m21:43:11.866531 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`PARTSUPP` AS a
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`SUPPLIER` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`PART` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`NATION` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`REGION` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m21:43:11.866916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:13.009761 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:47bd8862-865d-4254-9002-9fe396bc2e2d&page=queryresults
[0m21:43:13.012458 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:47bd8862-865d-4254-9002-9fe396bc2e2d&page=queryresults
[0m21:43:13.022783 [debug] [Thread-1 (]: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.NATION was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:43:13.025535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146a54160>]}
[0m21:43:13.026485 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_inventory ................. [[31mERROR[0m in 1.20s]
[0m21:43:13.027213 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m21:43:13.027848 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_inventory' to be skipped because of status 'error'.  Reason: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.NATION was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql.
[0m21:43:13.030080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:43:13.032102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:13.032455 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_inventory' was properly closed.
[0m21:43:13.032802 [info ] [MainThread]: 
[0m21:43:13.033159 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m21:43:13.033845 [debug] [MainThread]: Command end result
[0m21:43:13.075036 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:43:13.076330 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:43:13.081011 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:43:13.081223 [info ] [MainThread]: 
[0m21:43:13.081460 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:43:13.081647 [info ] [MainThread]: 
[0m21:43:13.081874 [error] [MainThread]: [31mFailure in model raw_inventory (models/raw_stage/raw_inventory.sql)[0m
[0m21:43:13.082096 [error] [MainThread]:   Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.NATION was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:43:13.082266 [info ] [MainThread]: 
[0m21:43:13.082464 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:43:13.082626 [info ] [MainThread]: 
[0m21:43:13.082810 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:43:13.083129 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:43:13.084474 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.232894, "process_in_blocks": "0", "process_kernel_time": 1.245371, "process_mem_max_rss": "342769664", "process_out_blocks": "0", "process_user_time": 3.194874}
[0m21:43:13.084782 [debug] [MainThread]: Command `dbt run` failed at 21:43:13.084723 after 5.23 seconds
[0m21:43:13.085025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150122470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032cc160>]}
[0m21:43:13.085253 [debug] [MainThread]: Flushing usage events
[0m21:43:14.236013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:44:20.619033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107130310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071309d0>]}


============================== 21:44:20.622816 | db4eb0d3-b16c-4efc-a94a-802b82029e1e ==============================
[0m21:44:20.622816 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:44:20.623166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m raw_transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:44:20.623436 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:44:20.623621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709a950>]}
[0m21:44:22.406080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d1d50>]}
[0m21:44:22.437898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070981c0>]}
[0m21:44:22.438288 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:44:22.569060 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:44:22.665844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:44:22.666112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:44:22.670419 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_stage
[0m21:44:22.690128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140e24130>]}
[0m21:44:22.749666 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:44:22.751862 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:44:22.763748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140db6d70>]}
[0m21:44:22.764055 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:44:22.764235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140db74c0>]}
[0m21:44:22.765071 [info ] [MainThread]: 
[0m21:44:22.765267 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:44:22.765410 [info ] [MainThread]: 
[0m21:44:22.765672 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:44:22.766133 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:44:22.766331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:23.679050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:44:23.679899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:24.592554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e3190>]}
[0m21:44:24.593570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:24.599160 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m21:44:24.600027 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_transactions ....................... [RUN]
[0m21:44:24.600744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_transactions)
[0m21:44:24.601300 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m21:44:24.616650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m21:44:24.619994 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m21:44:24.649481 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m21:44:24.650381 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`ORDERS`  AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`CUSTOMER` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08');


[0m21:44:24.650763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:25.630702 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a9c05548-14cf-41b1-8070-fb87968709cd&page=queryresults
[0m21:44:25.632141 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a9c05548-14cf-41b1-8070-fb87968709cd&page=queryresults
[0m21:44:25.643498 [debug] [Thread-1 (]: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:44:25.646635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140957e20>]}
[0m21:44:25.647744 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_transactions .............. [[31mERROR[0m in 1.04s]
[0m21:44:25.648683 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m21:44:25.649376 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_transactions' to be skipped because of status 'error'.  Reason: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql.
[0m21:44:25.651608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:44:25.653944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:25.654630 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_transactions' was properly closed.
[0m21:44:25.655211 [info ] [MainThread]: 
[0m21:44:25.655684 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m21:44:25.656527 [debug] [MainThread]: Command end result
[0m21:44:25.700693 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:44:25.702158 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:44:25.707081 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:44:25.707282 [info ] [MainThread]: 
[0m21:44:25.707514 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:44:25.707699 [info ] [MainThread]: 
[0m21:44:25.707932 [error] [MainThread]: [31mFailure in model raw_transactions (models/raw_stage/raw_transactions.sql)[0m
[0m21:44:25.708152 [error] [MainThread]:   Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:44:25.708322 [info ] [MainThread]: 
[0m21:44:25.708526 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:44:25.708689 [info ] [MainThread]: 
[0m21:44:25.708875 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:44:25.709207 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:44:25.710542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.135398, "process_in_blocks": "0", "process_kernel_time": 1.309837, "process_mem_max_rss": "344883200", "process_out_blocks": "0", "process_user_time": 3.135076}
[0m21:44:25.710815 [debug] [MainThread]: Command `dbt run` failed at 21:44:25.710763 after 5.14 seconds
[0m21:44:25.711055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070981c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140db5d80>]}
[0m21:44:25.711278 [debug] [MainThread]: Flushing usage events
[0m21:44:26.656509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:46:16.765966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abf700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1c940>]}


============================== 21:46:16.769017 | 89d3549c-0d16-4253-89d0-adeaac7a79d6 ==============================
[0m21:46:16.769017 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:46:16.769395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m raw_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:46:16.769794 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:46:16.770170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b89300>]}
[0m21:46:18.471499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042fdd50>]}
[0m21:46:18.503306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a4f5b70>]}
[0m21:46:18.503666 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:46:18.624904 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:46:18.723169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:46:18.723438 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:46:18.727667 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.links
[0m21:46:18.747034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ae24130>]}
[0m21:46:18.804192 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:46:18.806131 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:46:18.818298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15adb6260>]}
[0m21:46:18.818605 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:46:18.818787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15adb6830>]}
[0m21:46:18.819627 [info ] [MainThread]: 
[0m21:46:18.819823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:46:18.819966 [info ] [MainThread]: 
[0m21:46:18.820236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:46:18.820698 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:46:18.820889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:19.604554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:46:19.605419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:20.508419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd31f0>]}
[0m21:46:20.509845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:46:20.516444 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m21:46:20.517296 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_transactions ....................... [RUN]
[0m21:46:20.517972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_transactions)
[0m21:46:20.518501 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m21:46:20.534261 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m21:46:20.535784 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m21:46:20.564821 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m21:46:20.565572 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`ORDERS`  AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`CUSTOMER` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08');


[0m21:46:20.565926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:21.653768 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6fdf761e-92b1-46fa-bf0c-327dfa6a6942&page=queryresults
[0m21:46:21.654193 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6fdf761e-92b1-46fa-bf0c-327dfa6a6942&page=queryresults
[0m21:46:21.659723 [debug] [Thread-1 (]: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:46:21.661394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0c310>]}
[0m21:46:21.661920 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_transactions .............. [[31mERROR[0m in 1.14s]
[0m21:46:21.662255 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m21:46:21.662559 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_transactions' to be skipped because of status 'error'.  Reason: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql.
[0m21:46:21.663685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:46:21.664747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:21.664953 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_transactions' was properly closed.
[0m21:46:21.665126 [info ] [MainThread]: 
[0m21:46:21.665307 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m21:46:21.665681 [debug] [MainThread]: Command end result
[0m21:46:21.693181 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:46:21.694332 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:46:21.697809 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:46:21.698003 [info ] [MainThread]: 
[0m21:46:21.698260 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:46:21.698457 [info ] [MainThread]: 
[0m21:46:21.698688 [error] [MainThread]: [31mFailure in model raw_transactions (models/raw_stage/raw_transactions.sql)[0m
[0m21:46:21.698891 [error] [MainThread]:   Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:46:21.699045 [info ] [MainThread]: 
[0m21:46:21.699226 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:46:21.699375 [info ] [MainThread]: 
[0m21:46:21.699548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:46:21.699850 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:46:21.701161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.9796658, "process_in_blocks": "0", "process_kernel_time": 1.194997, "process_mem_max_rss": "353484800", "process_out_blocks": "0", "process_user_time": 3.190936}
[0m21:46:21.701453 [debug] [MainThread]: Command `dbt run` failed at 21:46:21.701405 after 4.98 seconds
[0m21:46:21.701681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abf700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ae26920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed3400>]}
[0m21:46:21.701889 [debug] [MainThread]: Flushing usage events
[0m21:46:23.169932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:48:51.115880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fab6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091005e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109100ca0>]}


============================== 21:48:51.119092 | feec1ad0-47a0-41d1-8f5f-4dc58b76a50b ==============================
[0m21:48:51.119092 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:48:51.119433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_transactions', 'send_anonymous_usage_stats': 'True'}
[0m21:48:51.119690 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:48:51.119882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109075420>]}
[0m21:48:52.871028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163e7a080>]}
[0m21:48:52.902919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108effb50>]}
[0m21:48:52.903311 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:48:53.025023 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:48:53.124545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:48:53.124819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:48:53.129293 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_vault.sats
[0m21:48:53.149282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164f24130>]}
[0m21:48:53.210483 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:48:53.212966 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:48:53.225341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164ea4fd0>]}
[0m21:48:53.225656 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:48:53.225841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164ea4eb0>]}
[0m21:48:53.226698 [info ] [MainThread]: 
[0m21:48:53.226891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:53.227031 [info ] [MainThread]: 
[0m21:48:53.227294 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:48:53.227756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:48:53.227951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:54.130249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:48:54.132308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:55.006444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c1d20>]}
[0m21:48:55.008478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:55.016473 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m21:48:55.017493 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_transactions ....................... [RUN]
[0m21:48:55.018251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_transactions)
[0m21:48:55.018847 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m21:48:55.034929 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m21:48:55.036069 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m21:48:55.064920 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m21:48:55.065958 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`ORDERS`  AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`CUSTOMER` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08');


[0m21:48:55.066321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:56.068206 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a91f5cae-906f-49cc-9df7-11fd4c47a7f7&page=queryresults
[0m21:48:56.070088 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a91f5cae-906f-49cc-9df7-11fd4c47a7f7&page=queryresults
[0m21:48:56.081534 [debug] [Thread-1 (]: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:48:56.084811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164f3da80>]}
[0m21:48:56.086053 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_transactions .............. [[31mERROR[0m in 1.06s]
[0m21:48:56.086899 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m21:48:56.087524 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_transactions' to be skipped because of status 'error'.  Reason: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql.
[0m21:48:56.089827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:56.092101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:56.092501 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_transactions' was properly closed.
[0m21:48:56.092904 [info ] [MainThread]: 
[0m21:48:56.093300 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m21:48:56.094096 [debug] [MainThread]: Command end result
[0m21:48:56.139107 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:48:56.140589 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:48:56.145151 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:48:56.145375 [info ] [MainThread]: 
[0m21:48:56.145615 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:48:56.145805 [info ] [MainThread]: 
[0m21:48:56.146041 [error] [MainThread]: [31mFailure in model raw_transactions (models/raw_stage/raw_transactions.sql)[0m
[0m21:48:56.146260 [error] [MainThread]:   Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:48:56.146442 [info ] [MainThread]: 
[0m21:48:56.146643 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:48:56.146803 [info ] [MainThread]: 
[0m21:48:56.146989 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:48:56.147343 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:48:56.149114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0757785, "process_in_blocks": "0", "process_kernel_time": 1.222736, "process_mem_max_rss": "339410944", "process_out_blocks": "0", "process_user_time": 3.182068}
[0m21:48:56.149503 [debug] [MainThread]: Command `dbt run` failed at 21:48:56.149442 after 5.08 seconds
[0m21:48:56.149776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fab6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164f265c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d4940>]}
[0m21:48:56.150017 [debug] [MainThread]: Flushing usage events
[0m21:48:57.070500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:54:42.774916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075501f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075508b0>]}


============================== 21:54:42.777991 | ef9ef190-fd75-4f0f-97c9-9acb9cb77423 ==============================
[0m21:54:42.777991 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:54:42.778339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_transactions', 'send_anonymous_usage_stats': 'True'}
[0m21:54:42.778595 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:54:42.778781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ef9ef190-fd75-4f0f-97c9-9acb9cb77423', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107509b40>]}
[0m21:54:44.529186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef9ef190-fd75-4f0f-97c9-9acb9cb77423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751d060>]}
[0m21:54:44.560911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef9ef190-fd75-4f0f-97c9-9acb9cb77423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c0cd0>]}
[0m21:54:44.561283 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:54:44.693726 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:54:44.789606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:54:44.790838 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/schema.yml
[0m21:54:45.379841 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.raw_inventory' (models/raw_stage/raw_inventory.sql) depends on a source named 'tpch_sample.PART' which was not found
[0m21:54:45.380286 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:54:45.382541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6493084, "process_in_blocks": "0", "process_kernel_time": 1.285007, "process_mem_max_rss": "349175808", "process_out_blocks": "0", "process_user_time": 3.332811}
[0m21:54:45.382857 [debug] [MainThread]: Command `dbt run` failed at 21:54:45.382799 after 2.65 seconds
[0m21:54:45.383101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1634a5d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1634a5000>]}
[0m21:54:45.383327 [debug] [MainThread]: Flushing usage events
[0m21:54:46.584798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:57:49.302864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cff6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5fe50>]}


============================== 21:57:49.306289 | 4958bef7-a676-4900-b678-6bb9034802f2 ==============================
[0m21:57:49.306289 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:57:49.306626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m raw_transactions', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:57:49.306910 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:57:49.307116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e60c10>]}
[0m21:57:51.067685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163fccca0>]}
[0m21:57:51.099885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877ae00>]}
[0m21:57:51.100259 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:57:51.233087 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:57:51.330535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m21:57:51.331787 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/schema.yml
[0m21:57:51.331993 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_stage/raw_inventory.sql
[0m21:57:51.332165 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_stage/raw_transactions.sql
[0m21:57:51.332330 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_stage/raw_orders.sql
[0m21:57:51.953972 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_stage
[0m21:57:51.960453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1655d5570>]}
[0m21:57:52.018002 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:57:52.019962 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:57:52.032100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1655d5600>]}
[0m21:57:52.032401 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:57:52.032589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16553ead0>]}
[0m21:57:52.033417 [info ] [MainThread]: 
[0m21:57:52.033612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:57:52.033753 [info ] [MainThread]: 
[0m21:57:52.034003 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:57:52.034437 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:57:52.034627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:52.896830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:57:52.897572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:53.821815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e131c0>]}
[0m21:57:53.823277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:57:53.829398 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m21:57:53.830309 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_transactions ....................... [RUN]
[0m21:57:53.831014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_transactions)
[0m21:57:53.831582 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m21:57:53.844906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m21:57:53.846483 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m21:57:53.874214 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m21:57:53.874922 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')), 24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
        CASE ABS(MOD(RANDOM(1), 2)) + 1
            WHEN 1 THEN 'DR'
            WHEN 2 THEN 'CR'
        END AS VARCHAR(2)) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08');


[0m21:57:53.875293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:54.994689 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:8fd86511-8446-45dc-b67a-d53a693ae1c6&page=queryresults
[0m21:57:55.507714 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:8fd86511-8446-45dc-b67a-d53a693ae1c6&page=queryresults
[0m21:57:55.518724 [debug] [Thread-1 (]: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Function not found: TO_DATE at [21:23]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:57:55.521751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164fa6c50>]}
[0m21:57:55.523000 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_transactions .............. [[31mERROR[0m in 1.69s]
[0m21:57:55.523915 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m21:57:55.524546 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_transactions' to be skipped because of status 'error'.  Reason: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Function not found: TO_DATE at [21:23]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql.
[0m21:57:55.526872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:57:55.529062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:55.529498 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_transactions' was properly closed.
[0m21:57:55.529895 [info ] [MainThread]: 
[0m21:57:55.530302 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m21:57:55.531112 [debug] [MainThread]: Command end result
[0m21:57:55.579254 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:57:55.580596 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:57:55.584788 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:57:55.585001 [info ] [MainThread]: 
[0m21:57:55.585237 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:57:55.585425 [info ] [MainThread]: 
[0m21:57:55.585655 [error] [MainThread]: [31mFailure in model raw_transactions (models/raw_stage/raw_transactions.sql)[0m
[0m21:57:55.585874 [error] [MainThread]:   Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Function not found: TO_DATE at [21:23]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:57:55.586042 [info ] [MainThread]: 
[0m21:57:55.586236 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:57:55.586399 [info ] [MainThread]: 
[0m21:57:55.586581 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:57:55.586896 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:57:55.588304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.3375144, "process_in_blocks": "0", "process_kernel_time": 1.353986, "process_mem_max_rss": "349863936", "process_out_blocks": "0", "process_user_time": 3.684823}
[0m21:57:55.588567 [debug] [MainThread]: Command `dbt run` failed at 21:57:55.588516 after 6.34 seconds
[0m21:57:55.588804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cff6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877ae00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcd360>]}
[0m21:57:55.589029 [debug] [MainThread]: Flushing usage events
[0m21:57:56.603034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:00:29.358444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10370b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104864670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104867d90>]}


============================== 22:00:29.361507 | 4afd1711-bd9d-4fe0-8e53-5962d5ca5871 ==============================
[0m22:00:29.361507 [info ] [MainThread]: Running with dbt=1.10.7
[0m22:00:29.361873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_transactions', 'send_anonymous_usage_stats': 'True'}
[0m22:00:29.362186 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m22:00:29.362383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d0fa0>]}
[0m22:00:31.148823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b712a0>]}
[0m22:00:31.180806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bbad10>]}
[0m22:00:31.181193 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:00:31.308824 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m22:00:31.406472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:00:31.406881 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_stage/raw_transactions.sql
[0m22:00:31.543324 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.hubs
[0m22:00:31.552783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160ae0130>]}
[0m22:00:31.610226 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:00:31.612582 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:00:31.629617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1608a9ae0>]}
[0m22:00:31.629946 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m22:00:31.630129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1608a9ed0>]}
[0m22:00:31.630987 [info ] [MainThread]: 
[0m22:00:31.631190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:00:31.631341 [info ] [MainThread]: 
[0m22:00:31.631606 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:00:31.632085 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m22:00:31.632298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:32.476221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m22:00:32.476999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:33.629865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e90340>]}
[0m22:00:33.630950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:33.637582 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m22:00:33.638408 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_transactions ....................... [RUN]
[0m22:00:33.639109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_transactions)
[0m22:00:33.639650 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m22:00:33.653266 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m22:00:33.654676 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m22:00:33.683892 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m22:00:33.684646 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATE_ADD(b.O_ORDERDATE, INTERVAL 20 DAY) AS TRANSACTION_DATE,
    CAST(RPAD(CONCAT(CAST(b.O_ORDERKEY AS STRING), CAST(b.O_CUSTKEY AS STRING), FORMAT_DATE('%Y%m%d', b.O_ORDERDATE)), 24, '0') AS INT64) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
        CASE ABS(MOD(ABS(RAND()), 2)) + 1
            WHEN 1 THEN 'DR'
            WHEN 2 THEN 'CR'
        END AS STRING) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m22:00:33.685024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:34.751812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:e1a9978f-cfd0-4f05-984e-8ee49ea7f6ed&page=queryresults
[0m22:00:35.181376 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:e1a9978f-cfd0-4f05-984e-8ee49ea7f6ed&page=queryresults
[0m22:00:35.195921 [debug] [Thread-1 (]: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  No matching signature for function MOD
    Argument types: FLOAT64, INT64
    Signature: MOD(INT64, INT64)
      Argument 1: Unable to coerce type FLOAT64 to expected type INT64
    Signature: MOD(NUMERIC, NUMERIC)
      Argument 1: Unable to coerce type FLOAT64 to expected type NUMERIC
    Signature: MOD(BIGNUMERIC, BIGNUMERIC)
      Argument 1: Unable to coerce type FLOAT64 to expected type BIGNUMERIC at [14:18]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m22:00:35.199015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147f3b100>]}
[0m22:00:35.200072 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_transactions .............. [[31mERROR[0m in 1.56s]
[0m22:00:35.200966 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m22:00:35.201744 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_transactions' to be skipped because of status 'error'.  Reason: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  No matching signature for function MOD
    Argument types: FLOAT64, INT64
    Signature: MOD(INT64, INT64)
      Argument 1: Unable to coerce type FLOAT64 to expected type INT64
    Signature: MOD(NUMERIC, NUMERIC)
      Argument 1: Unable to coerce type FLOAT64 to expected type NUMERIC
    Signature: MOD(BIGNUMERIC, BIGNUMERIC)
      Argument 1: Unable to coerce type FLOAT64 to expected type BIGNUMERIC at [14:18]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql.
[0m22:00:35.204029 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:35.206248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:35.206659 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_transactions' was properly closed.
[0m22:00:35.207056 [info ] [MainThread]: 
[0m22:00:35.207457 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m22:00:35.208289 [debug] [MainThread]: Command end result
[0m22:00:35.340908 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:00:35.342028 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:00:35.345358 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m22:00:35.345528 [info ] [MainThread]: 
[0m22:00:35.345723 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:00:35.345883 [info ] [MainThread]: 
[0m22:00:35.346087 [error] [MainThread]: [31mFailure in model raw_transactions (models/raw_stage/raw_transactions.sql)[0m
[0m22:00:35.346288 [error] [MainThread]:   Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  No matching signature for function MOD
    Argument types: FLOAT64, INT64
    Signature: MOD(INT64, INT64)
      Argument 1: Unable to coerce type FLOAT64 to expected type INT64
    Signature: MOD(NUMERIC, NUMERIC)
      Argument 1: Unable to coerce type FLOAT64 to expected type NUMERIC
    Signature: MOD(BIGNUMERIC, BIGNUMERIC)
      Argument 1: Unable to coerce type FLOAT64 to expected type BIGNUMERIC at [14:18]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m22:00:35.346452 [info ] [MainThread]: 
[0m22:00:35.346630 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m22:00:35.346769 [info ] [MainThread]: 
[0m22:00:35.346932 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:00:35.347211 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:00:35.348731 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.031656, "process_in_blocks": "0", "process_kernel_time": 1.371899, "process_mem_max_rss": "348323840", "process_out_blocks": "0", "process_user_time": 3.265107}
[0m22:00:35.349047 [debug] [MainThread]: Command `dbt run` failed at 22:00:35.348995 after 6.03 seconds
[0m22:00:35.349345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10370b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020c9870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020ca650>]}
[0m22:00:35.349556 [debug] [MainThread]: Flushing usage events
[0m22:00:36.582693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:01:59.398165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084af6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109604610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109607e50>]}


============================== 22:01:59.401180 | 4a5e297d-9f9c-40a9-ac06-89e627fd141d ==============================
[0m22:01:59.401180 [info ] [MainThread]: Running with dbt=1.10.7
[0m22:01:59.401550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m raw_transactions', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:01:59.401811 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m22:01:59.402006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10860cc10>]}
[0m22:02:01.108087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d69d50>]}
[0m22:02:01.140164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953fbb0>]}
[0m22:02:01.140579 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:02:01.266610 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m22:02:01.368486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:02:01.368922 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_stage/raw_transactions.sql
[0m22:02:01.503798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
[0m22:02:01.515621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bb48130>]}
[0m22:02:01.571927 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:02:01.574073 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:02:01.585714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b929900>]}
[0m22:02:01.586050 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m22:02:01.586248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b929d20>]}
[0m22:02:01.587097 [info ] [MainThread]: 
[0m22:02:01.587285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:02:01.587425 [info ] [MainThread]: 
[0m22:02:01.587684 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:02:01.588131 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m22:02:01.588329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:02.431660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m22:02:02.432544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:03.335087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095bf1c0>]}
[0m22:02:03.336773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:03.343454 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m22:02:03.344308 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_transactions ....................... [RUN]
[0m22:02:03.345009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_transactions)
[0m22:02:03.345568 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m22:02:03.359112 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m22:02:03.360323 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m22:02:03.389181 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m22:02:03.389902 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATE_ADD(b.O_ORDERDATE, INTERVAL 20 DAY) AS TRANSACTION_DATE,
    CAST(RPAD(CONCAT(CAST(b.O_ORDERKEY AS STRING), CAST(b.O_CUSTKEY AS STRING), FORMAT_DATE('%Y%m%d', b.O_ORDERDATE)), 24, '0') AS INT64) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
        CASE FLOOR(RAND() * 2) + 1
            WHEN 1 THEN 'DR'
            WHEN 2 THEN 'CR'
        END AS STRING) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m22:02:03.390251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:04.556447 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:e50b90e0-0db4-45f1-92a0-b782cbeadb37&page=queryresults
[0m22:02:05.556479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f02380>]}
[0m22:02:05.557149 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dataset.raw_transactions .................. [[32mCREATE VIEW (0 processed)[0m in 2.21s]
[0m22:02:05.557477 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m22:02:05.558054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:02:05.559075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:05.559271 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_transactions' was properly closed.
[0m22:02:05.559447 [info ] [MainThread]: 
[0m22:02:05.559625 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m22:02:05.559989 [debug] [MainThread]: Command end result
[0m22:02:05.585455 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:02:05.586738 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:02:05.590087 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m22:02:05.590262 [info ] [MainThread]: 
[0m22:02:05.590486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:02:05.590642 [info ] [MainThread]: 
[0m22:02:05.590809 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:02:05.591085 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:02:05.592362 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.235995, "process_in_blocks": "0", "process_kernel_time": 1.222248, "process_mem_max_rss": "349798400", "process_out_blocks": "0", "process_user_time": 3.496234}
[0m22:02:05.592632 [debug] [MainThread]: Command `dbt run` succeeded at 22:02:05.592581 after 6.24 seconds
[0m22:02:05.592841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084af6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b934250>]}
[0m22:02:05.593045 [debug] [MainThread]: Flushing usage events
[0m22:02:06.713716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:02:19.899886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063db760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075344c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107534b80>]}


============================== 22:02:19.902872 | e6ff73ce-afd6-40a3-992e-efcb577c36a3 ==============================
[0m22:02:19.902872 [info ] [MainThread]: Running with dbt=1.10.7
[0m22:02:19.903204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m raw_orders', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:02:19.903470 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m22:02:19.903649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a13c0>]}
[0m22:02:21.580227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fd8d0>]}
[0m22:02:21.612069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a23e0>]}
[0m22:02:21.612480 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:02:21.740071 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m22:02:21.843420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:02:21.843720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:02:21.848130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.stage
[0m22:02:21.868148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b420130>]}
[0m22:02:21.924133 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:02:21.925793 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:02:21.938334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b3a4fd0>]}
[0m22:02:21.938643 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m22:02:21.938822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b3a6890>]}
[0m22:02:21.939638 [info ] [MainThread]: 
[0m22:02:21.939825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:02:21.939965 [info ] [MainThread]: 
[0m22:02:21.940224 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:02:21.940675 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m22:02:21.940880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:22.782236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m22:02:22.783007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:23.713319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106292d70>]}
[0m22:02:23.714522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:23.722056 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_orders
[0m22:02:23.722934 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_orders ............................. [RUN]
[0m22:02:23.723732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_orders)
[0m22:02:23.724324 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_orders
[0m22:02:23.740764 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_orders"
[0m22:02:23.741671 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_orders
[0m22:02:23.769450 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_orders"
[0m22:02:23.770282 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
  OPTIONS()
  as SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`lineitem` AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON c.C_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08');


[0m22:02:23.770698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:24.831884 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:758cd3be-0be0-4294-91bb-a1a1618d2fb8&page=queryresults
[0m22:02:25.345459 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:758cd3be-0be0-4294-91bb-a1a1618d2fb8&page=queryresults
[0m22:02:25.359426 [debug] [Thread-1 (]: Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
  Function not found: TO_DATE at [60:23]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_orders.sql
[0m22:02:25.362930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b4ccc40>]}
[0m22:02:25.364206 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_orders .................... [[31mERROR[0m in 1.64s]
[0m22:02:25.365087 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_orders
[0m22:02:25.365820 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_orders' to be skipped because of status 'error'.  Reason: Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
  Function not found: TO_DATE at [60:23]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_orders.sql.
[0m22:02:25.368785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:02:25.371229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:25.371719 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_orders' was properly closed.
[0m22:02:25.372123 [info ] [MainThread]: 
[0m22:02:25.372547 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m22:02:25.373734 [debug] [MainThread]: Command end result
[0m22:02:25.419544 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:02:25.420848 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:02:25.425292 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m22:02:25.425522 [info ] [MainThread]: 
[0m22:02:25.425779 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:02:25.425985 [info ] [MainThread]: 
[0m22:02:25.426384 [error] [MainThread]: [31mFailure in model raw_orders (models/raw_stage/raw_orders.sql)[0m
[0m22:02:25.426604 [error] [MainThread]:   Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
  Function not found: TO_DATE at [60:23]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_orders.sql
[0m22:02:25.426768 [info ] [MainThread]: 
[0m22:02:25.426965 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_orders.sql
[0m22:02:25.427128 [info ] [MainThread]: 
[0m22:02:25.427313 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:02:25.427643 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:02:25.429140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.570339, "process_in_blocks": "0", "process_kernel_time": 1.275699, "process_mem_max_rss": "345800704", "process_out_blocks": "0", "process_user_time": 3.135432}
[0m22:02:25.429470 [debug] [MainThread]: Command `dbt run` failed at 22:02:25.429411 after 5.57 seconds
[0m22:02:25.429719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063db760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b422740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a5637f0>]}
[0m22:02:25.429953 [debug] [MainThread]: Flushing usage events
[0m22:02:26.598473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:02:54.407846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bcf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2fe50>]}


============================== 22:02:54.411046 | 584bcaca-6e50-42e3-b6cb-816980d070a1 ==============================
[0m22:02:54.411046 [info ] [MainThread]: Running with dbt=1.10.7
[0m22:02:54.411394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_orders', 'send_anonymous_usage_stats': 'True'}
[0m22:02:54.411677 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m22:02:54.411871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d30c10>]}
[0m22:02:56.173161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce2350>]}
[0m22:02:56.205346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f71660>]}
[0m22:02:56.205730 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:02:56.335611 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m22:02:56.433334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:02:56.433755 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_stage/raw_orders.sql
[0m22:02:56.569890 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.hubs
[0m22:02:56.579030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1607f4130>]}
[0m22:02:56.639928 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:02:56.642068 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:02:56.655463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1604a5930>]}
[0m22:02:56.655779 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m22:02:56.655960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1604a5d20>]}
[0m22:02:56.656807 [info ] [MainThread]: 
[0m22:02:56.657008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:02:56.657150 [info ] [MainThread]: 
[0m22:02:56.657412 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:02:56.657887 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m22:02:56.658134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:57.616024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m22:02:57.616783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:58.527955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce31c0>]}
[0m22:02:58.529329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:58.534907 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_orders
[0m22:02:58.535770 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_orders ............................. [RUN]
[0m22:02:58.536455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_orders)
[0m22:02:58.537003 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_orders
[0m22:02:58.553002 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_orders"
[0m22:02:58.554037 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_orders
[0m22:02:58.582785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_orders"
[0m22:02:58.583510 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
  OPTIONS()
  as SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`lineitem` AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON c.C_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m22:02:58.583920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:59.697129 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b8db7889-dbf9-4306-9cef-7a56481d9b29&page=queryresults
[0m22:03:00.728418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136fb96f0>]}
[0m22:03:00.729016 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dataset.raw_orders ........................ [[32mCREATE VIEW (0 processed)[0m in 2.19s]
[0m22:03:00.729340 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_orders
[0m22:03:00.729888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:03:00.730814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:00.730976 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_orders' was properly closed.
[0m22:03:00.731128 [info ] [MainThread]: 
[0m22:03:00.731307 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m22:03:00.731642 [debug] [MainThread]: Command end result
[0m22:03:00.757021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:03:00.758465 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:03:00.762044 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m22:03:00.762218 [info ] [MainThread]: 
[0m22:03:00.762434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:03:00.762588 [info ] [MainThread]: 
[0m22:03:00.762750 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:03:00.763020 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:03:00.764314 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4024982, "process_in_blocks": "0", "process_kernel_time": 1.455902, "process_mem_max_rss": "355581952", "process_out_blocks": "0", "process_user_time": 3.226751}
[0m22:03:00.764568 [debug] [MainThread]: Command `dbt run` succeeded at 22:03:00.764521 after 6.40 seconds
[0m22:03:00.764765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bcf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103efb040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1607f4070>]}
[0m22:03:00.764953 [debug] [MainThread]: Flushing usage events
[0m22:03:01.809879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:03:15.123424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d30340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d30a00>]}


============================== 22:03:15.126477 | a34fbece-6b60-468c-93d8-125ca6a3253b ==============================
[0m22:03:15.126477 [info ] [MainThread]: Running with dbt=1.10.7
[0m22:03:15.126818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_inventory', 'send_anonymous_usage_stats': 'True'}
[0m22:03:15.127089 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m22:03:15.127276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cedb40>]}
[0m22:03:16.860277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160bce9e0>]}
[0m22:03:16.892399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642bdf0>]}
[0m22:03:16.892806 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:03:17.015288 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m22:03:17.109276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:03:17.109547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:03:17.113804 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
[0m22:03:17.133587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161524130>]}
[0m22:03:17.195991 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:03:17.198238 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:03:17.210083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1614b7a30>]}
[0m22:03:17.210398 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m22:03:17.210582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1614b68c0>]}
[0m22:03:17.211437 [info ] [MainThread]: 
[0m22:03:17.211639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:03:17.211781 [info ] [MainThread]: 
[0m22:03:17.212040 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:03:17.212489 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m22:03:17.212683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:18.083104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m22:03:18.083946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:19.103643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160ba2590>]}
[0m22:03:19.104796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:19.111072 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m22:03:19.112012 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_inventory .......................... [RUN]
[0m22:03:19.112760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_inventory)
[0m22:03:19.113357 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m22:03:19.129825 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m22:03:19.131177 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m22:03:19.159887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m22:03:19.160991 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`partsupp` AS a
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m22:03:19.161378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:20.425336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:85c08017-3590-4e1f-8383-47c976c44aea&page=queryresults
[0m22:03:21.526889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c0a0190>]}
[0m22:03:21.527494 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dataset.raw_inventory ..................... [[32mCREATE VIEW (0 processed)[0m in 2.41s]
[0m22:03:21.527892 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m22:03:21.528581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:03:21.529787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:21.530012 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_inventory' was properly closed.
[0m22:03:21.530219 [info ] [MainThread]: 
[0m22:03:21.530430 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m22:03:21.530862 [debug] [MainThread]: Command end result
[0m22:03:21.559725 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:03:21.560851 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:03:21.564669 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m22:03:21.564843 [info ] [MainThread]: 
[0m22:03:21.565056 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:03:21.565205 [info ] [MainThread]: 
[0m22:03:21.565377 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:03:21.565662 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:03:21.566942 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.484383, "process_in_blocks": "0", "process_kernel_time": 1.292819, "process_mem_max_rss": "348028928", "process_out_blocks": "0", "process_user_time": 3.172828}
[0m22:03:21.567185 [debug] [MainThread]: Command `dbt run` succeeded at 22:03:21.567138 after 6.48 seconds
[0m22:03:21.567391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1615cd570>]}
[0m22:03:21.567580 [debug] [MainThread]: Flushing usage events
[0m22:03:22.575331 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:12.711717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039ef640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b48400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b48ac0>]}


============================== 13:33:12.714951 | d9abae46-982c-44bd-9b6c-5dc2943f43ae ==============================
[0m13:33:12.714951 [info ] [MainThread]: Running with dbt=1.10.7
[0m13:33:12.715295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models path:models/stage', 'send_anonymous_usage_stats': 'True'}
[0m13:33:12.715567 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:33:12.715753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abbd30>]}
[0m13:33:14.567098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1267d0670>]}
[0m13:33:14.599806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446aec0>]}
[0m13:33:14.600243 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:33:14.722509 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m13:33:14.820987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:14.821257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:14.825516 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
[0m13:33:14.845344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f50130>]}
[0m13:33:14.903501 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m13:33:14.905466 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m13:33:14.918753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ee6050>]}
[0m13:33:14.919103 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m13:33:14.919295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ee74c0>]}
[0m13:33:14.920566 [info ] [MainThread]: 
[0m13:33:14.920758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:14.920898 [info ] [MainThread]: 
[0m13:33:14.921160 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:33:14.923685 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m13:33:14.923955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:45.705825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5_dbt_dataset'
[0m13:35:45.707692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:16.609105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12682a500>]}
[0m13:38:16.612528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:16.622200 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory
[0m13:38:16.623256 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_dataset.v_stg_inventory ........................ [RUN]
[0m13:38:16.624003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.v_stg_inventory)
[0m13:38:16.624491 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory
[0m13:38:16.674749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:48.187100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory"
[0m13:40:48.195466 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory
[0m13:40:48.213071 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory"
[0m13:40:48.214061 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m13:40:49.095017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:029f13e3-c4a1-4f0d-b3ab-50b8a9968aa9&page=queryresults
[0m13:40:49.539799 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:029f13e3-c4a1-4f0d-b3ab-50b8a9968aa9&page=queryresults
[0m13:40:49.556479 [debug] [Thread-1 (]: Database Error in model v_stg_inventory (models/stage/v_stg_inventory.sql)
  Function not found: TO_DATE at [243:8]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_inventory.sql
[0m13:40:49.566087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127002080>]}
[0m13:40:49.569381 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_dataset.v_stg_inventory ............... [[31mERROR[0m in 152.93s]
[0m13:40:49.570325 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory
[0m13:40:49.571767 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_orders
[0m13:40:49.572761 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.v_stg_inventory' to be skipped because of status 'error'.  Reason: Database Error in model v_stg_inventory (models/stage/v_stg_inventory.sql)
  Function not found: TO_DATE at [243:8]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_inventory.sql.
[0m13:40:49.573434 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_dataset.v_stg_orders ........................... [RUN]
[0m13:40:49.576248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory, now model.dbt_bq_sa.v_stg_orders)
[0m13:40:49.577322 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_orders
[0m13:40:49.586745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:21.007572 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_orders"
[0m13:43:21.010306 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_orders
[0m13:43:21.021060 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_orders"
[0m13:43:21.022082 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), '')))) AS STRING) AS ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS ORDER_CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINEITEM_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS LINK_LINEITEM_ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS INVENTORY_ALLOCATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS STRING))), ''), '^^')
    )))) AS STRING) AS LINEITEM_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS STRING))), ''), '^^')
    )))) AS STRING) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging;


[0m13:43:21.912228 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7dedf716-33dd-46a4-a989-ab9d34ea524a&page=queryresults
[0m13:43:22.418267 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7dedf716-33dd-46a4-a989-ab9d34ea524a&page=queryresults
[0m13:43:22.424385 [debug] [Thread-1 (]: Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
  Function not found: TO_DATE at [337:8]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_orders.sql
[0m13:43:22.426672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12725eef0>]}
[0m13:43:22.430130 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dbt_dataset.v_stg_orders .................. [[31mERROR[0m in 152.85s]
[0m13:43:22.431099 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_orders
[0m13:43:22.431725 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m13:43:22.432626 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.v_stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
  Function not found: TO_DATE at [337:8]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_orders.sql.
[0m13:43:22.433507 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_dataset.v_stg_transactions ..................... [RUN]
[0m13:43:22.435053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_orders, now model.dbt_bq_sa.v_stg_transactions)
[0m13:43:22.435656 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m13:43:22.445457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:27.968001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118938490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11893bf40>]}


============================== 13:45:27.971055 | 1252da49-e4a2-49fe-a53f-135deb9f2490 ==============================
[0m13:45:27.971055 [info ] [MainThread]: Running with dbt=1.10.7
[0m13:45:27.971375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models path:models/stage', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:45:27.971652 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:45:27.971845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187a5480>]}
[0m13:45:29.745073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a274e20>]}
[0m13:45:29.776734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118908040>]}
[0m13:45:29.777111 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:45:29.905735 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m13:45:30.011094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:45:30.011606 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/v_stg_orders.sql
[0m13:45:30.011841 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/v_stg_inventory.sql
[0m13:45:30.266682 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
[0m13:45:30.275867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b7a0130>]}
[0m13:45:30.419126 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m13:45:30.421803 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m13:45:30.433166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a084c0>]}
[0m13:45:30.433493 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m13:45:30.433677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154f8a530>]}
[0m13:45:30.434932 [info ] [MainThread]: 
[0m13:45:30.435132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:30.435276 [info ] [MainThread]: 
[0m13:45:30.435517 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:45:30.437822 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m13:45:30.438089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:01.265276 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5_dbt_dataset'
[0m13:48:01.267361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:32.319711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049bc340>]}
[0m13:50:32.325153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:32.356671 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory
[0m13:50:32.357878 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_dataset.v_stg_inventory ........................ [RUN]
[0m13:50:32.358808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.v_stg_inventory)
[0m13:50:32.359168 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory
[0m13:50:32.396085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:03.876555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory"
[0m13:53:03.879972 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory
[0m13:53:03.910033 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory"
[0m13:53:03.911347 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m13:53:04.875643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b8b8d66b-016e-4933-b174-5b227a1a5b8e&page=queryresults
[0m13:53:05.888091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b7a19f0>]}
[0m13:53:05.888912 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_dataset.v_stg_inventory ................... [[32mCREATE VIEW (0 processed)[0m in 153.53s]
[0m13:53:05.889289 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory
[0m13:53:05.889541 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_orders
[0m13:53:05.890913 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_dataset.v_stg_orders ........................... [RUN]
[0m13:53:05.892641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory, now model.dbt_bq_sa.v_stg_orders)
[0m13:53:05.893510 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_orders
[0m13:53:05.898493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:37.496596 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_orders"
[0m13:55:37.500696 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_orders
[0m13:55:37.505817 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_orders"
[0m13:55:37.507827 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), '')))) AS STRING) AS ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS ORDER_CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINEITEM_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS LINK_LINEITEM_ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS INVENTORY_ALLOCATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS STRING))), ''), '^^')
    )))) AS STRING) AS LINEITEM_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS STRING))), ''), '^^')
    )))) AS STRING) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE
FROM staging;


[0m13:55:38.430635 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:2524d526-51f7-4439-863e-2f92e46f40ca&page=queryresults
[0m13:55:39.416267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107129000>]}
[0m13:55:39.424150 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_dataset.v_stg_orders ...................... [[32mCREATE VIEW (0 processed)[0m in 153.52s]
[0m13:55:39.425442 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_orders
[0m13:55:39.427307 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m13:55:39.428748 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_dataset.v_stg_transactions ..................... [RUN]
[0m13:55:39.429627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_orders, now model.dbt_bq_sa.v_stg_transactions)
[0m13:55:39.430325 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m13:55:39.440924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:11.066462 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_transactions"
[0m13:58:11.086376 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_transactions
[0m13:58:11.095824 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_transactions"
[0m13:58:11.096885 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
  OPTIONS()
  as 







-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS TRANSACTION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS STRING))), '')))) AS STRING) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m13:58:11.911066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4d1d9769-1eb4-419b-be9c-68aab93859d1&page=queryresults
[0m13:58:12.392045 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4d1d9769-1eb4-419b-be9c-68aab93859d1&page=queryresults
[0m13:58:12.412151 [debug] [Thread-1 (]: Database Error in model v_stg_transactions (models/stage/v_stg_transactions.sql)
  Function not found: DATEADD; Did you mean date_add? at [45:5]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_transactions.sql
[0m13:58:12.413767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c3ebe20>]}
[0m13:58:12.415000 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dbt_dataset.v_stg_transactions ............ [[31mERROR[0m in 152.98s]
[0m13:58:12.415754 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_transactions
[0m13:58:12.416780 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.v_stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model v_stg_transactions (models/stage/v_stg_transactions.sql)
  Function not found: DATEADD; Did you mean date_add? at [45:5]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_transactions.sql.
[0m13:58:12.433010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:12.436311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:12.436666 [debug] [MainThread]: Connection 'list_trim-field-467501-p5' was properly closed.
[0m13:58:12.436980 [debug] [MainThread]: Connection 'model.dbt_bq_sa.v_stg_transactions' was properly closed.
[0m13:58:12.437983 [info ] [MainThread]: 
[0m13:58:12.438763 [info ] [MainThread]: Finished running 3 view models in 0 hours 12 minutes and 42.00 seconds (762.00s).
[0m13:58:12.440142 [debug] [MainThread]: Command end result
[0m13:58:12.497331 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m13:58:12.513948 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m13:58:12.524923 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m13:58:12.525143 [info ] [MainThread]: 
[0m13:58:12.525354 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:58:12.525519 [info ] [MainThread]: 
[0m13:58:12.525732 [error] [MainThread]: [31mFailure in model v_stg_transactions (models/stage/v_stg_transactions.sql)[0m
[0m13:58:12.525934 [error] [MainThread]:   Database Error in model v_stg_transactions (models/stage/v_stg_transactions.sql)
  Function not found: DATEADD; Did you mean date_add? at [45:5]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_transactions.sql
[0m13:58:12.526080 [info ] [MainThread]: 
[0m13:58:12.526255 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/stage/v_stg_transactions.sql
[0m13:58:12.526578 [info ] [MainThread]: 
[0m13:58:12.527168 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:58:12.528994 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:58:12.609526 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 764.7123, "process_in_blocks": "0", "process_kernel_time": 1.681003, "process_mem_max_rss": "357793792", "process_out_blocks": "0", "process_user_time": 3.835643}
[0m13:58:12.610951 [debug] [MainThread]: Command `dbt run` failed at 13:58:12.610883 after 764.71 seconds
[0m13:58:12.611665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c59420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a29de40>]}
[0m13:58:12.611926 [debug] [MainThread]: Flushing usage events
[0m13:58:13.524476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:16.544477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107718610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771be50>]}


============================== 14:01:16.547815 | 817b9143-d8b0-4445-90c1-2f95c7ed63e3 ==============================
[0m14:01:16.547815 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:01:16.548159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m v_stg_transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:01:16.548437 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:01:16.548625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671cc10>]}
[0m14:01:18.311969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf1d50>]}
[0m14:01:18.343778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149239930>]}
[0m14:01:18.344153 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m14:01:18.478868 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:01:18.535030 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:01:18.535366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fdac80>]}
[0m14:01:20.112213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.raw_vault
- models.raw_vault.links
- models.raw_stage
- models.raw_vault.sats
- models.raw_vault.t_links
- models.stage
- models.raw_vault.hubs
[0m14:01:20.118708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4bc130>]}
[0m14:01:20.176413 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m14:01:20.178329 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m14:01:20.190941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c471480>]}
[0m14:01:20.191307 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m14:01:20.191506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c472fe0>]}
[0m14:01:20.192410 [info ] [MainThread]: 
[0m14:01:20.192622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:01:20.192774 [info ] [MainThread]: 
[0m14:01:20.193040 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:01:20.193526 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m14:01:20.193751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:51.174375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m14:03:51.176876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:45.116163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059fff40>]}
[0m15:04:45.120176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:45.143894 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m15:04:45.144482 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.v_stg_transactions ..................... [RUN]
[0m15:04:45.144841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.v_stg_transactions)
[0m15:04:45.145076 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m15:04:45.173812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:16.671070 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_transactions"
[0m15:07:16.676421 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_transactions
[0m15:07:16.713680 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_transactions"
[0m15:07:16.714592 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
  OPTIONS()
  as 







-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATE_ADD(TRANSACTION_DATE, INTERVAL 1 DAY) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS TRANSACTION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS STRING))), '')))) AS STRING) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m15:07:17.846582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ad34f253-cc1a-42dd-a980-c4882b9af353&page=queryresults
[0m15:07:18.812452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1390a1930>]}
[0m15:07:18.813290 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dataset.v_stg_transactions ................ [[32mCREATE VIEW (0 processed)[0m in 153.67s]
[0m15:07:18.813805 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_transactions
[0m15:07:18.815301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:18.817277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:18.817504 [debug] [MainThread]: Connection 'model.dbt_bq_sa.v_stg_transactions' was properly closed.
[0m15:07:18.817746 [info ] [MainThread]: 
[0m15:07:18.817985 [info ] [MainThread]: Finished running 1 view model in 1 hours 5 minutes and 58.62 seconds (3958.62s).
[0m15:07:18.818466 [debug] [MainThread]: Command end result
[0m15:07:18.853777 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m15:07:18.856674 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m15:07:18.862159 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m15:07:18.862346 [info ] [MainThread]: 
[0m15:07:18.862575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:18.862733 [info ] [MainThread]: 
[0m15:07:18.863555 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:07:18.863980 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:07:18.881564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 451.30103, "process_in_blocks": "0", "process_kernel_time": 1.414834, "process_mem_max_rss": "348487680", "process_out_blocks": "0", "process_user_time": 4.658736}
[0m15:07:18.881877 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:18.881834 after 451.30 seconds
[0m15:07:18.882134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149239930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4bc190>]}
[0m15:07:18.882390 [debug] [MainThread]: Flushing usage events
[0m15:07:19.827832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:26.488824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063eb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107548280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107548940>]}


============================== 15:17:26.492191 | ea607177-3f89-491d-8c8a-3c3fc2f41c38 ==============================
[0m15:17:26.492191 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:17:26.492551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --models path:models/stage', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:17:26.492844 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:17:26.493036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b61d0>]}
[0m15:17:28.329862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b21d50>]}
[0m15:17:28.363106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531adbd0>]}
[0m15:17:28.363567 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m15:17:28.497621 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:17:28.601557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:28.601842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:28.606382 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.raw_vault.links
- models.stage
- models.raw_vault.hubs
- models.raw_vault
- models.raw_stage
- models.raw_vault.t_links
- models.raw_vault.sats
[0m15:17:28.626270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b5f0130>]}
[0m15:17:28.684598 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m15:17:28.686977 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m15:17:28.700276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15af974c0>]}
[0m15:17:28.700600 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m15:17:28.700779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15af96020>]}
[0m15:17:28.702040 [info ] [MainThread]: 
[0m15:17:28.702251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:28.702392 [info ] [MainThread]: 
[0m15:17:28.702656 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:17:28.705059 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m15:17:28.705279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:29.555744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m15:17:29.556541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:30.459101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ff1f0>]}
[0m15:17:30.460226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:30.466717 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory
[0m15:17:30.467555 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_dataset.v_stg_inventory ........................ [RUN]
[0m15:17:30.468237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.v_stg_inventory)
[0m15:17:30.468818 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory
[0m15:17:30.509817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:31.923173 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory"
[0m15:17:31.925249 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory
[0m15:17:31.941135 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory"
[0m15:17:31.942182 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m15:17:33.013496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f1a8167b-d780-4646-97ba-e99d2d97cd84&page=queryresults
[0m15:17:34.102346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b59b190>]}
[0m15:17:34.102980 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_dataset.v_stg_inventory ................... [[32mCREATE VIEW (0 processed)[0m in 3.63s]
[0m15:17:34.103424 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory
[0m15:17:34.103720 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_orders
[0m15:17:34.104151 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_dataset.v_stg_orders ........................... [RUN]
[0m15:17:34.104536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory, now model.dbt_bq_sa.v_stg_orders)
[0m15:17:34.104898 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_orders
[0m15:17:34.109916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:35.440686 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_orders"
[0m15:17:35.443277 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_orders
[0m15:17:35.445909 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_orders"
[0m15:17:35.447383 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), '')))) AS STRING) AS ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS ORDER_CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINEITEM_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS LINK_LINEITEM_ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS INVENTORY_ALLOCATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS STRING))), ''), '^^')
    )))) AS STRING) AS LINEITEM_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS STRING))), ''), '^^')
    )))) AS STRING) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE
FROM staging;


[0m15:17:36.382171 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:8388d926-1286-44ad-98b3-96914e24433c&page=queryresults
[0m15:17:37.302477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106738310>]}
[0m15:17:37.303022 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_dataset.v_stg_orders ...................... [[32mCREATE VIEW (0 processed)[0m in 3.20s]
[0m15:17:37.303424 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_orders
[0m15:17:37.303685 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m15:17:37.304050 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_dataset.v_stg_transactions ..................... [RUN]
[0m15:17:37.304369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_orders, now model.dbt_bq_sa.v_stg_transactions)
[0m15:17:37.304610 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m15:17:37.309117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:38.756091 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_transactions"
[0m15:17:38.758374 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_transactions
[0m15:17:38.763486 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_transactions"
[0m15:17:38.764548 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
  OPTIONS()
  as 







-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATE_ADD(TRANSACTION_DATE, INTERVAL 1 DAY) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS TRANSACTION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS STRING))), '')))) AS STRING) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m15:17:39.565629 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:00fcdb77-6b1e-448e-8cd1-bc09e93cc0b9&page=queryresults
[0m15:17:40.604873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b5a68c0>]}
[0m15:17:40.606342 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_dataset.v_stg_transactions ................ [[32mCREATE VIEW (0 processed)[0m in 3.30s]
[0m15:17:40.607280 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_transactions
[0m15:17:40.608974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:40.611560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:40.612024 [debug] [MainThread]: Connection 'model.dbt_bq_sa.v_stg_transactions' was properly closed.
[0m15:17:40.612612 [info ] [MainThread]: 
[0m15:17:40.613097 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 11.91 seconds (11.91s).
[0m15:17:40.614541 [debug] [MainThread]: Command end result
[0m15:17:40.791039 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m15:17:40.792436 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m15:17:40.796427 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m15:17:40.796598 [info ] [MainThread]: 
[0m15:17:40.796795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:40.796948 [info ] [MainThread]: 
[0m15:17:40.797113 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:17:40.797412 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:17:40.798886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.354991, "process_in_blocks": "0", "process_kernel_time": 1.515002, "process_mem_max_rss": "337526784", "process_out_blocks": "0", "process_user_time": 3.536741}
[0m15:17:40.799170 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:40.799120 after 14.36 seconds
[0m15:17:40.799381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063eb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b5f2740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e14220>]}
[0m15:17:40.799588 [debug] [MainThread]: Flushing usage events
[0m15:17:41.710036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:53.778178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103adf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c34400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c34ac0>]}


============================== 15:17:53.781074 | ea2831cf-4b86-430d-9bad-9f9d7e2dc682 ==============================
[0m15:17:53.781074 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:17:53.781405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --models path:models/raw_vault', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:17:53.781660 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:17:53.781834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba52d0>]}
[0m15:17:55.481913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e05f00>]}
[0m15:17:55.514068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10455bbb0>]}
[0m15:17:55.514457 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m15:17:55.634080 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:17:55.734049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:55.734323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:55.738610 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.raw_vault.sats
- models.raw_vault.hubs
- models.raw_vault
- models.raw_vault.t_links
- models.raw_vault.links
- models.raw_stage
- models.stage
[0m15:17:55.758133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1593f0130>]}
[0m15:17:55.814805 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m15:17:55.816287 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m15:17:55.828097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1591875e0>]}
[0m15:17:55.828394 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m15:17:55.828574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1591851e0>]}
[0m15:17:55.830136 [info ] [MainThread]: 
[0m15:17:55.830341 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:55.830487 [info ] [MainThread]: 
[0m15:17:55.830745 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:17:55.833859 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m15:17:55.834081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:56.621810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m15:17:56.622792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:57.477497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10230f580>]}
[0m15:17:57.479060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:57.486756 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_customer
[0m15:17:57.487611 [info ] [Thread-1 (]: 1 of 25 START sql view model dbt_dataset.hub_customer .......................... [RUN]
[0m15:17:57.488319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.hub_customer)
[0m15:17:57.488905 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_customer
[0m15:17:57.523909 [info ] [Thread-1 (]: 15:17:57 + Loading trim-field-467501-p5.dbt_dataset.hub_customer from 1 source(s)
[0m15:17:57.562200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_customer"
[0m15:17:57.562887 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_customer
[0m15:17:57.578930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_customer"
[0m15:17:57.579487 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_customer: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_customer"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_customer`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:17:57.579733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:58.996585 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:d86da214-4827-4024-b30d-943e0e81fae4&page=queryresults
[0m15:18:00.006146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1593a67d0>]}
[0m15:18:00.007427 [info ] [Thread-1 (]: 1 of 25 OK created sql view model dbt_dataset.hub_customer ..................... [[32mCREATE VIEW (0 processed)[0m in 2.51s]
[0m15:18:00.007933 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_customer
[0m15:18:00.008294 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_lineitem
[0m15:18:00.008803 [info ] [Thread-1 (]: 2 of 25 START sql view model dbt_dataset.hub_lineitem .......................... [RUN]
[0m15:18:00.009250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_customer, now model.dbt_bq_sa.hub_lineitem)
[0m15:18:00.009564 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_lineitem
[0m15:18:00.014604 [info ] [Thread-1 (]: 15:18:00 + Loading trim-field-467501-p5.dbt_dataset.hub_lineitem from 1 source(s)
[0m15:18:00.016742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_lineitem"
[0m15:18:00.017253 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_lineitem
[0m15:18:00.019683 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_lineitem"
[0m15:18:00.020125 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:00.020399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:01.181323 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:303cb75e-4525-487b-98f5-65f74cd9e988&page=queryresults
[0m15:18:02.100534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034520e0>]}
[0m15:18:02.102218 [info ] [Thread-1 (]: 2 of 25 OK created sql view model dbt_dataset.hub_lineitem ..................... [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m15:18:02.103196 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_lineitem
[0m15:18:02.103834 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_nation
[0m15:18:02.104676 [info ] [Thread-1 (]: 3 of 25 START sql view model dbt_dataset.hub_nation ............................ [RUN]
[0m15:18:02.105472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_lineitem, now model.dbt_bq_sa.hub_nation)
[0m15:18:02.106069 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_nation
[0m15:18:02.114946 [info ] [Thread-1 (]: 15:18:02 + Loading trim-field-467501-p5.dbt_dataset.hub_nation from 2 source(s)
[0m15:18:02.120550 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_nation"
[0m15:18:02.121717 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_nation
[0m15:18:02.127434 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_nation"
[0m15:18:02.128357 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m15:18:02.128884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:03.313478 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:545ee54b-f699-46a0-9bc1-eb94ba215961&page=queryresults
[0m15:18:04.146200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ad8040>]}
[0m15:18:04.147665 [info ] [Thread-1 (]: 3 of 25 OK created sql view model dbt_dataset.hub_nation ....................... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:18:04.148585 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_nation
[0m15:18:04.149188 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_order
[0m15:18:04.149998 [info ] [Thread-1 (]: 4 of 25 START sql view model dbt_dataset.hub_order ............................. [RUN]
[0m15:18:04.150771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_nation, now model.dbt_bq_sa.hub_order)
[0m15:18:04.151334 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_order
[0m15:18:04.159525 [info ] [Thread-1 (]: 15:18:04 + Loading trim-field-467501-p5.dbt_dataset.hub_order from 1 source(s)
[0m15:18:04.163923 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_order"
[0m15:18:04.164866 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_order
[0m15:18:04.169636 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_order"
[0m15:18:04.170564 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:04.171192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:05.369408 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:54d554a2-9197-485c-87f7-fb92319e4e07&page=queryresults
[0m15:18:06.304584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159acbb20>]}
[0m15:18:06.307315 [info ] [Thread-1 (]: 4 of 25 OK created sql view model dbt_dataset.hub_order ........................ [[32mCREATE VIEW (0 processed)[0m in 2.15s]
[0m15:18:06.308444 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_order
[0m15:18:06.309073 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_part
[0m15:18:06.309910 [info ] [Thread-1 (]: 5 of 25 START sql view model dbt_dataset.hub_part .............................. [RUN]
[0m15:18:06.310721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_order, now model.dbt_bq_sa.hub_part)
[0m15:18:06.311303 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_part
[0m15:18:06.322475 [info ] [Thread-1 (]: 15:18:06 + Loading trim-field-467501-p5.dbt_dataset.hub_part from 2 source(s)
[0m15:18:06.330702 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_part"
[0m15:18:06.331739 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_part
[0m15:18:06.336706 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_part"
[0m15:18:06.337697 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_part: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_part"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_part`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m15:18:06.338235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:07.464190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f7f33c60-ad33-416b-adaa-8af49e4e278a&page=queryresults
[0m15:18:08.354972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034520e0>]}
[0m15:18:08.356429 [info ] [Thread-1 (]: 5 of 25 OK created sql view model dbt_dataset.hub_part ......................... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:18:08.357357 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_part
[0m15:18:08.357984 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_region
[0m15:18:08.358846 [info ] [Thread-1 (]: 6 of 25 START sql view model dbt_dataset.hub_region ............................ [RUN]
[0m15:18:08.359624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_part, now model.dbt_bq_sa.hub_region)
[0m15:18:08.360204 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_region
[0m15:18:08.368428 [info ] [Thread-1 (]: 15:18:08 + Loading trim-field-467501-p5.dbt_dataset.hub_region from 2 source(s)
[0m15:18:08.374620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_region"
[0m15:18:08.375581 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_region
[0m15:18:08.380405 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_region"
[0m15:18:08.381479 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m15:18:08.381972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:09.664001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:be17caf9-4fe6-4018-97ed-d1eb18ce8800&page=queryresults
[0m15:18:10.482185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ad8040>]}
[0m15:18:10.483971 [info ] [Thread-1 (]: 6 of 25 OK created sql view model dbt_dataset.hub_region ....................... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m15:18:10.485155 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_region
[0m15:18:10.485844 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_supplier
[0m15:18:10.486666 [info ] [Thread-1 (]: 7 of 25 START sql view model dbt_dataset.hub_supplier .......................... [RUN]
[0m15:18:10.487496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_region, now model.dbt_bq_sa.hub_supplier)
[0m15:18:10.488101 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_supplier
[0m15:18:10.498497 [info ] [Thread-1 (]: 15:18:10 + Loading trim-field-467501-p5.dbt_dataset.hub_supplier from 2 source(s)
[0m15:18:10.504794 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_supplier"
[0m15:18:10.506619 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_supplier
[0m15:18:10.510792 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_supplier"
[0m15:18:10.511807 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_supplier: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_supplier"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_supplier`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m15:18:10.512372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:11.717723 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b9b7f4ba-4204-4579-aab7-2e98d136b97f&page=queryresults
[0m15:18:12.542768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ad28f0>]}
[0m15:18:12.544307 [info ] [Thread-1 (]: 7 of 25 OK created sql view model dbt_dataset.hub_supplier ..................... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m15:18:12.545275 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_supplier
[0m15:18:12.545866 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_nation
[0m15:18:12.546677 [info ] [Thread-1 (]: 8 of 25 START sql view model dbt_dataset.link_customer_nation .................. [RUN]
[0m15:18:12.547395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_supplier, now model.dbt_bq_sa.link_customer_nation)
[0m15:18:12.547974 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_nation
[0m15:18:12.561126 [info ] [Thread-1 (]: 15:18:12 + Loading trim-field-467501-p5.dbt_dataset.link_customer_nation from 1 source(s)
[0m15:18:12.582108 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_nation"
[0m15:18:12.582983 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_nation
[0m15:18:12.587827 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_nation"
[0m15:18:12.588690 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:12.589078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:13.656739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:e400fe7b-0d48-4e93-a5a8-e3b7deb95b2e&page=queryresults
[0m15:18:14.583704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ad28f0>]}
[0m15:18:14.584367 [info ] [Thread-1 (]: 8 of 25 OK created sql view model dbt_dataset.link_customer_nation ............. [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:18:14.584855 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_nation
[0m15:18:14.585208 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_order
[0m15:18:14.585670 [info ] [Thread-1 (]: 9 of 25 START sql view model dbt_dataset.link_customer_order ................... [RUN]
[0m15:18:14.586087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_nation, now model.dbt_bq_sa.link_customer_order)
[0m15:18:14.586397 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_order
[0m15:18:14.591015 [info ] [Thread-1 (]: 15:18:14 + Loading trim-field-467501-p5.dbt_dataset.link_customer_order from 1 source(s)
[0m15:18:14.593464 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_order"
[0m15:18:14.593997 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_order
[0m15:18:14.596801 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_order"
[0m15:18:14.597359 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:14.597683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:15.817526 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:d1ac953a-1a0b-4206-a07c-684f15d95865&page=queryresults
[0m15:18:16.847174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1599ac0d0>]}
[0m15:18:16.849307 [info ] [Thread-1 (]: 9 of 25 OK created sql view model dbt_dataset.link_customer_order .............. [[32mCREATE VIEW (0 processed)[0m in 2.26s]
[0m15:18:16.850368 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_order
[0m15:18:16.851012 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory
[0m15:18:16.851865 [info ] [Thread-1 (]: 10 of 25 START sql view model dbt_dataset.link_inventory ....................... [RUN]
[0m15:18:16.852751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_order, now model.dbt_bq_sa.link_inventory)
[0m15:18:16.853348 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory
[0m15:18:17.043135 [info ] [Thread-1 (]: 15:18:17 + Loading trim-field-467501-p5.dbt_dataset.link_inventory from 1 source(s)
[0m15:18:17.044984 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory"
[0m15:18:17.045433 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory
[0m15:18:17.047370 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory"
[0m15:18:17.047758 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:17.047982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:18.158805 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4753e3ba-83eb-41ac-939b-7a26f0ff79b7&page=queryresults
[0m15:18:18.958650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b15b70>]}
[0m15:18:18.960125 [info ] [Thread-1 (]: 10 of 25 OK created sql view model dbt_dataset.link_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 2.11s]
[0m15:18:18.961064 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory
[0m15:18:18.961815 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory_allocation
[0m15:18:18.962753 [info ] [Thread-1 (]: 11 of 25 START sql view model dbt_dataset.link_inventory_allocation ............ [RUN]
[0m15:18:18.963524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory, now model.dbt_bq_sa.link_inventory_allocation)
[0m15:18:18.964116 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory_allocation
[0m15:18:18.972628 [info ] [Thread-1 (]: 15:18:18 + Loading trim-field-467501-p5.dbt_dataset.link_inventory_allocation from 1 source(s)
[0m15:18:18.977311 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory_allocation"
[0m15:18:18.978189 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory_allocation
[0m15:18:18.984243 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory_allocation"
[0m15:18:18.985271 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory_allocation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory_allocation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:18.985782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:20.106601 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:253d9768-78c0-43f7-b5aa-5c1d1545fd2a&page=queryresults
[0m15:18:21.087911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159678dc0>]}
[0m15:18:21.089683 [info ] [Thread-1 (]: 11 of 25 OK created sql view model dbt_dataset.link_inventory_allocation ....... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m15:18:21.090792 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory_allocation
[0m15:18:21.091407 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_nation_region
[0m15:18:21.092328 [info ] [Thread-1 (]: 12 of 25 START sql view model dbt_dataset.link_nation_region ................... [RUN]
[0m15:18:21.093112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory_allocation, now model.dbt_bq_sa.link_nation_region)
[0m15:18:21.093752 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_nation_region
[0m15:18:21.102724 [info ] [Thread-1 (]: 15:18:21 + Loading trim-field-467501-p5.dbt_dataset.link_nation_region from 2 source(s)
[0m15:18:21.108942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_nation_region"
[0m15:18:21.110040 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_nation_region
[0m15:18:21.114516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_nation_region"
[0m15:18:21.115333 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_nation_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_nation_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_nation_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m15:18:21.115852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:22.266783 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:adcc9be8-7c66-4f31-a63a-cd9bbdf485f7&page=queryresults
[0m15:18:23.202137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10255f370>]}
[0m15:18:23.203459 [info ] [Thread-1 (]: 12 of 25 OK created sql view model dbt_dataset.link_nation_region .............. [[32mCREATE VIEW (0 processed)[0m in 2.11s]
[0m15:18:23.204367 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_nation_region
[0m15:18:23.204965 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_order_lineitem
[0m15:18:23.205834 [info ] [Thread-1 (]: 13 of 25 START sql view model dbt_dataset.link_order_lineitem .................. [RUN]
[0m15:18:23.206619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_nation_region, now model.dbt_bq_sa.link_order_lineitem)
[0m15:18:23.207243 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_order_lineitem
[0m15:18:23.217336 [info ] [Thread-1 (]: 15:18:23 + Loading trim-field-467501-p5.dbt_dataset.link_order_lineitem from 1 source(s)
[0m15:18:23.222011 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_order_lineitem"
[0m15:18:23.222988 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_order_lineitem
[0m15:18:23.227351 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_order_lineitem"
[0m15:18:23.228163 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_order_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_order_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:23.228637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:24.381987 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:53d6f3db-cfcf-4ec1-8000-413ef7078fc7&page=queryresults
[0m15:18:25.242443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10255f370>]}
[0m15:18:25.243964 [info ] [Thread-1 (]: 13 of 25 OK created sql view model dbt_dataset.link_order_lineitem ............. [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:18:25.244886 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_order_lineitem
[0m15:18:25.245498 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_supplier_nation
[0m15:18:25.246325 [info ] [Thread-1 (]: 14 of 25 START sql view model dbt_dataset.link_supplier_nation ................. [RUN]
[0m15:18:25.247139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_order_lineitem, now model.dbt_bq_sa.link_supplier_nation)
[0m15:18:25.247724 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_supplier_nation
[0m15:18:25.256377 [info ] [Thread-1 (]: 15:18:25 + Loading trim-field-467501-p5.dbt_dataset.link_supplier_nation from 1 source(s)
[0m15:18:25.261371 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_supplier_nation"
[0m15:18:25.262457 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_supplier_nation
[0m15:18:25.267066 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_supplier_nation"
[0m15:18:25.267873 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_supplier_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_supplier_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:25.268360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:26.763694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ea07948d-c133-4ad2-b4d0-bfd077b2fb1a&page=queryresults
[0m15:18:27.700505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba5750>]}
[0m15:18:27.702678 [info ] [Thread-1 (]: 14 of 25 OK created sql view model dbt_dataset.link_supplier_nation ............ [[32mCREATE VIEW (0 processed)[0m in 2.45s]
[0m15:18:27.703676 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_supplier_nation
[0m15:18:27.704343 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_inventory_details
[0m15:18:27.705234 [info ] [Thread-1 (]: 15 of 25 START sql view model dbt_dataset.sat_inv_inventory_details ............ [RUN]
[0m15:18:27.706095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_supplier_nation, now model.dbt_bq_sa.sat_inv_inventory_details)
[0m15:18:27.706688 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_inventory_details
[0m15:18:27.757588 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m15:18:27.758359 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_inventory_details
[0m15:18:27.761242 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m15:18:27.761836 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_inventory_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_inventory_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:27.762147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:28.990803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b956287c-c390-4c49-a73b-4e804e600ae9&page=queryresults
[0m15:18:29.913419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157b1d990>]}
[0m15:18:29.922783 [info ] [Thread-1 (]: 15 of 25 OK created sql view model dbt_dataset.sat_inv_inventory_details ....... [[32mCREATE VIEW (0 processed)[0m in 2.19s]
[0m15:18:29.925065 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_inventory_details
[0m15:18:29.928104 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_part_details
[0m15:18:29.929755 [info ] [Thread-1 (]: 16 of 25 START sql view model dbt_dataset.sat_inv_part_details ................. [RUN]
[0m15:18:29.930899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_inventory_details, now model.dbt_bq_sa.sat_inv_part_details)
[0m15:18:29.932983 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_part_details
[0m15:18:29.968624 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_part_details"
[0m15:18:29.969404 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_part_details
[0m15:18:29.973158 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_part_details"
[0m15:18:29.974703 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_part_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_part_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:29.975140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:31.113567 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:044ea188-de3f-4698-abe3-e31d7ed4992e&page=queryresults
[0m15:18:31.972515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b14a30>]}
[0m15:18:31.974552 [info ] [Thread-1 (]: 16 of 25 OK created sql view model dbt_dataset.sat_inv_part_details ............ [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:18:31.975472 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_part_details
[0m15:18:31.976072 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m15:18:31.976899 [info ] [Thread-1 (]: 17 of 25 START sql view model dbt_dataset.sat_inv_supp_nation_details .......... [RUN]
[0m15:18:31.977422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_part_details, now model.dbt_bq_sa.sat_inv_supp_nation_details)
[0m15:18:31.977857 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m15:18:32.003106 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m15:18:32.004200 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m15:18:32.010234 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m15:18:32.011122 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:32.011588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:33.210366 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a9fd8ee7-6441-46b6-9d93-6a733d814d11&page=queryresults
[0m15:18:34.039987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c09480>]}
[0m15:18:34.041168 [info ] [Thread-1 (]: 17 of 25 OK created sql view model dbt_dataset.sat_inv_supp_nation_details ..... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m15:18:34.042332 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m15:18:34.042975 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m15:18:34.043823 [info ] [Thread-1 (]: 18 of 25 START sql view model dbt_dataset.sat_inv_supp_region_details .......... [RUN]
[0m15:18:34.044537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_nation_details, now model.dbt_bq_sa.sat_inv_supp_region_details)
[0m15:18:34.045101 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_region_details
[0m15:18:34.056728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m15:18:34.057413 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_region_details
[0m15:18:34.060183 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m15:18:34.060715 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:34.061055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:35.333381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:86f91ede-f749-477c-a1e5-f3a92e5fbba1&page=queryresults
[0m15:18:37.346220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159af7c10>]}
[0m15:18:37.347477 [info ] [Thread-1 (]: 18 of 25 OK created sql view model dbt_dataset.sat_inv_supp_region_details ..... [[32mCREATE VIEW (0 processed)[0m in 3.30s]
[0m15:18:37.348068 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m15:18:37.348505 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supplier_details
[0m15:18:37.349142 [info ] [Thread-1 (]: 19 of 25 START sql view model dbt_dataset.sat_inv_supplier_details ............. [RUN]
[0m15:18:37.349640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_region_details, now model.dbt_bq_sa.sat_inv_supplier_details)
[0m15:18:37.350019 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supplier_details
[0m15:18:37.373054 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m15:18:37.377088 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supplier_details
[0m15:18:37.380370 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m15:18:37.381091 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supplier_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supplier_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:37.381449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:38.489209 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:829f3047-eb96-4eab-ac51-38abcb8c55ff&page=queryresults
[0m15:18:39.340208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c09480>]}
[0m15:18:39.341338 [info ] [Thread-1 (]: 19 of 25 OK created sql view model dbt_dataset.sat_inv_supplier_details ........ [[32mCREATE VIEW (0 processed)[0m in 1.99s]
[0m15:18:39.342209 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supplier_details
[0m15:18:39.342807 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m15:18:39.343587 [info ] [Thread-1 (]: 20 of 25 START sql view model dbt_dataset.sat_order_cust_nation_details ........ [RUN]
[0m15:18:39.344331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supplier_details, now model.dbt_bq_sa.sat_order_cust_nation_details)
[0m15:18:39.344782 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_nation_details
[0m15:18:39.353654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m15:18:39.354227 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_nation_details
[0m15:18:39.356526 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m15:18:39.357137 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:39.357419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:40.587832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7c914e29-9f93-494a-8e44-5751ff840177&page=queryresults
[0m15:18:41.617706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157f535b0>]}
[0m15:18:41.619403 [info ] [Thread-1 (]: 20 of 25 OK created sql view model dbt_dataset.sat_order_cust_nation_details ... [[32mCREATE VIEW (0 processed)[0m in 2.27s]
[0m15:18:41.620389 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m15:18:41.621045 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_region_details
[0m15:18:41.621926 [info ] [Thread-1 (]: 21 of 25 START sql view model dbt_dataset.sat_order_cust_region_details ........ [RUN]
[0m15:18:41.622768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_nation_details, now model.dbt_bq_sa.sat_order_cust_region_details)
[0m15:18:41.623386 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_region_details
[0m15:18:41.639781 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m15:18:41.640809 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_region_details
[0m15:18:41.645285 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m15:18:41.646159 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:41.646657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:42.641238 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ab25f6a5-4e66-48cf-b993-5603d89f2af5&page=queryresults
[0m15:18:43.445298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157f535b0>]}
[0m15:18:43.446667 [info ] [Thread-1 (]: 21 of 25 OK created sql view model dbt_dataset.sat_order_cust_region_details ... [[32mCREATE VIEW (0 processed)[0m in 1.82s]
[0m15:18:43.447654 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_region_details
[0m15:18:43.448307 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_customer_details
[0m15:18:43.449125 [info ] [Thread-1 (]: 22 of 25 START sql view model dbt_dataset.sat_order_customer_details ........... [RUN]
[0m15:18:43.450086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_region_details, now model.dbt_bq_sa.sat_order_customer_details)
[0m15:18:43.450677 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_customer_details
[0m15:18:43.466455 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_customer_details"
[0m15:18:43.467281 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_customer_details
[0m15:18:43.470928 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_customer_details"
[0m15:18:43.471662 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_customer_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_customer_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:43.472049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:44.802160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b6488b9c-63c0-4c0b-ba25-9a5f01d66727&page=queryresults
[0m15:18:45.590982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159abb850>]}
[0m15:18:46.834643 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m15:18:46.838753 [info ] [Thread-1 (]: 22 of 25 OK created sql view model dbt_dataset.sat_order_customer_details ...... [[32mCREATE VIEW (0 processed)[0m in 2.14s]
[0m15:18:46.840296 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_customer_details
[0m15:18:46.841251 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_lineitem_details
[0m15:18:46.842323 [info ] [Thread-1 (]: 23 of 25 START sql view model dbt_dataset.sat_order_lineitem_details ........... [RUN]
[0m15:18:46.842997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_customer_details, now model.dbt_bq_sa.sat_order_lineitem_details)
[0m15:18:46.843467 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_lineitem_details
[0m15:18:46.867467 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m15:18:46.868753 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_lineitem_details
[0m15:18:46.873658 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m15:18:46.874635 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_lineitem_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_lineitem_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:46.875107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:48.060207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:d714edd3-32b9-4e97-b696-7def24a773b0&page=queryresults
[0m15:18:48.881038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b92170>]}
[0m15:18:48.882463 [info ] [Thread-1 (]: 23 of 25 OK created sql view model dbt_dataset.sat_order_lineitem_details ...... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:18:48.883782 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_lineitem_details
[0m15:18:48.884637 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_order_details
[0m15:18:48.885968 [info ] [Thread-1 (]: 24 of 25 START sql view model dbt_dataset.sat_order_order_details .............. [RUN]
[0m15:18:48.886526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_lineitem_details, now model.dbt_bq_sa.sat_order_order_details)
[0m15:18:48.886802 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_order_details
[0m15:18:48.899787 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_order_details"
[0m15:18:48.900412 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_order_details
[0m15:18:48.904417 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_order_details"
[0m15:18:48.905088 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_order_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_order_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:48.905401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:50.005665 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a7cfb124-acd0-465f-8d42-e52ca71948a8&page=queryresults
[0m15:18:50.840681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10255d1b0>]}
[0m15:18:50.841976 [info ] [Thread-1 (]: 24 of 25 OK created sql view model dbt_dataset.sat_order_order_details ......... [[32mCREATE VIEW (0 processed)[0m in 1.95s]
[0m15:18:50.842925 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_order_details
[0m15:18:50.843690 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.t_link_transactions
[0m15:18:50.844537 [info ] [Thread-1 (]: 25 of 25 START sql view model dbt_dataset.t_link_transactions .................. [RUN]
[0m15:18:50.845310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_order_details, now model.dbt_bq_sa.t_link_transactions)
[0m15:18:50.846065 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.t_link_transactions
[0m15:18:50.876974 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.t_link_transactions"
[0m15:18:50.879218 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.t_link_transactions
[0m15:18:50.885006 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.t_link_transactions"
[0m15:18:50.888591 [debug] [Thread-1 (]: On model.dbt_bq_sa.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.t_link_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`t_link_transactions`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert;


[0m15:18:50.889344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:52.013371 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6182880b-3c9b-45b6-ae02-7e31e9a95fc4&page=queryresults
[0m15:18:52.824606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b3e920>]}
[0m15:18:52.825829 [info ] [Thread-1 (]: 25 of 25 OK created sql view model dbt_dataset.t_link_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 1.98s]
[0m15:18:52.826779 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.t_link_transactions
[0m15:18:52.828477 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:52.830084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:52.830355 [debug] [MainThread]: Connection 'model.dbt_bq_sa.t_link_transactions' was properly closed.
[0m15:18:52.830746 [info ] [MainThread]: 
[0m15:18:52.831008 [info ] [MainThread]: Finished running 25 view models in 0 hours 0 minutes and 57.00 seconds (57.00s).
[0m15:18:52.833773 [debug] [MainThread]: Command end result
[0m15:18:52.868944 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m15:18:52.874584 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m15:18:52.883797 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m15:18:52.884138 [info ] [MainThread]: 
[0m15:18:52.884464 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:52.884733 [info ] [MainThread]: 
[0m15:18:52.885018 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=25
[0m15:18:52.885571 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:18:52.887659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 59.156708, "process_in_blocks": "0", "process_kernel_time": 1.410755, "process_mem_max_rss": "337903616", "process_out_blocks": "0", "process_user_time": 5.937782}
[0m15:18:52.888173 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:52.888104 after 59.16 seconds
[0m15:18:52.888510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103adf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102319d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1593f2650>]}
[0m15:18:52.888789 [debug] [MainThread]: Flushing usage events
[0m15:18:53.839674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:28.232411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ceb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3cc40>]}


============================== 16:32:28.235697 | af66e0d0-56fb-45d2-b555-55619791eec4 ==============================
[0m16:32:28.235697 [info ] [MainThread]: Running with dbt=1.10.7
[0m16:32:28.236041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:32:30.159829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106035a20>]}
[0m16:32:30.191136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db3e80>]}
[0m16:32:30.191505 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:32:30.324668 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m16:32:30.428393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:30.428657 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:30.432866 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.raw_vault.t_links
- models.raw_stage
- models.stage
- models.raw_vault.hubs
- models.raw_vault.links
- models.raw_vault
- models.raw_vault.sats
[0m16:32:30.452784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1527f8670>]}
[0m16:32:30.512106 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m16:32:30.513854 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m16:32:30.526793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1527f9780>]}
[0m16:32:30.527094 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m16:32:30.527279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1527f9990>]}
[0m16:32:30.528709 [info ] [MainThread]: 
[0m16:32:30.528939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:30.529094 [info ] [MainThread]: 
[0m16:32:30.529365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:32:30.533102 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m16:32:30.533400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:31.358685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m16:32:31.359853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:32.273433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfb130>]}
[0m16:32:32.274440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:32.280381 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_orders
[0m16:32:32.281108 [info ] [Thread-1 (]: 1 of 31 START sql view model dbt_dataset.raw_orders ............................ [RUN]
[0m16:32:32.281725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_orders)
[0m16:32:32.282367 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_orders
[0m16:32:32.298446 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_orders"
[0m16:32:32.299848 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_orders
[0m16:32:32.326153 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_orders"
[0m16:32:32.326914 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
  OPTIONS()
  as SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`lineitem` AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON c.C_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m16:32:32.327325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:33.349105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:9f6ff983-6f63-46ff-bae2-c1b5b80abb0d&page=queryresults
[0m16:32:34.307197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a3b1720>]}
[0m16:32:34.307861 [info ] [Thread-1 (]: 1 of 31 OK created sql view model dbt_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.02s]
[0m16:32:34.308326 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_orders
[0m16:32:34.308632 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m16:32:34.309120 [info ] [Thread-1 (]: 2 of 31 START sql view model dbt_dataset.raw_transactions ...................... [RUN]
[0m16:32:34.309509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_orders, now model.dbt_bq_sa.raw_transactions)
[0m16:32:34.309821 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m16:32:34.313566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m16:32:34.314488 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m16:32:34.317174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m16:32:34.317657 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATE_ADD(b.O_ORDERDATE, INTERVAL 20 DAY) AS TRANSACTION_DATE,
    CAST(RPAD(CONCAT(CAST(b.O_ORDERKEY AS STRING), CAST(b.O_CUSTKEY AS STRING), FORMAT_DATE('%Y%m%d', b.O_ORDERDATE)), 24, '0') AS INT64) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
        CASE FLOOR(RAND() * 2) + 1
            WHEN 1 THEN 'DR'
            WHEN 2 THEN 'CR'
        END AS STRING) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m16:32:34.317961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:35.323540 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:0ad6fce4-3850-4c24-8cc6-87f4c6535c2e&page=queryresults
[0m16:32:36.176005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153126500>]}
[0m16:32:36.177320 [info ] [Thread-1 (]: 2 of 31 OK created sql view model dbt_dataset.raw_transactions ................. [[32mCREATE VIEW (0 processed)[0m in 1.87s]
[0m16:32:36.178228 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m16:32:36.178744 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m16:32:36.179575 [info ] [Thread-1 (]: 3 of 31 START sql view model dbt_dataset.raw_inventory ......................... [RUN]
[0m16:32:36.180249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_transactions, now model.dbt_bq_sa.raw_inventory)
[0m16:32:36.180732 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m16:32:36.189323 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m16:32:36.191408 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m16:32:36.195930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m16:32:36.197750 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`partsupp` AS a
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m16:32:36.198328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:37.345803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:46a827b1-d541-46ed-9693-83002985b883&page=queryresults
[0m16:32:38.299149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15279faf0>]}
[0m16:32:38.300943 [info ] [Thread-1 (]: 3 of 31 OK created sql view model dbt_dataset.raw_inventory .................... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m16:32:38.302035 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m16:32:38.302655 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_orders
[0m16:32:38.303638 [info ] [Thread-1 (]: 4 of 31 START sql view model dbt_dataset.v_stg_orders .......................... [RUN]
[0m16:32:38.304456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_inventory, now model.dbt_bq_sa.v_stg_orders)
[0m16:32:38.305069 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_orders
[0m16:32:38.341141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:39.928471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_orders"
[0m16:32:39.930065 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_orders
[0m16:32:39.932300 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_orders"
[0m16:32:39.933320 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), '')))) AS STRING) AS ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS ORDER_CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINEITEM_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS LINK_LINEITEM_ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS INVENTORY_ALLOCATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS STRING))), ''), '^^')
    )))) AS STRING) AS LINEITEM_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS STRING))), ''), '^^')
    )))) AS STRING) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE
FROM staging;


[0m16:32:40.753206 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:db695bd7-09b4-4a76-95a8-99567ee5ed63&page=queryresults
[0m16:32:41.599875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a3b1720>]}
[0m16:32:41.601305 [info ] [Thread-1 (]: 4 of 31 OK created sql view model dbt_dataset.v_stg_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 3.30s]
[0m16:32:41.602225 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_orders
[0m16:32:41.602832 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m16:32:41.604054 [info ] [Thread-1 (]: 5 of 31 START sql view model dbt_dataset.v_stg_transactions .................... [RUN]
[0m16:32:41.604799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_orders, now model.dbt_bq_sa.v_stg_transactions)
[0m16:32:41.605533 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m16:32:41.614211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:43.017284 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_transactions"
[0m16:32:43.020356 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_transactions
[0m16:32:43.026293 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_transactions"
[0m16:32:43.027433 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
  OPTIONS()
  as 







-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATE_ADD(TRANSACTION_DATE, INTERVAL 1 DAY) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS TRANSACTION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS STRING))), '')))) AS STRING) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m16:32:43.731762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:c4289e63-aea1-4041-8f37-f0f289cf310d&page=queryresults
[0m16:32:44.853707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153657430>]}
[0m16:32:44.855085 [info ] [Thread-1 (]: 5 of 31 OK created sql view model dbt_dataset.v_stg_transactions ............... [[32mCREATE VIEW (0 processed)[0m in 3.25s]
[0m16:32:44.855986 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_transactions
[0m16:32:44.856593 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory
[0m16:32:44.857586 [info ] [Thread-1 (]: 6 of 31 START sql view model dbt_dataset.v_stg_inventory ....................... [RUN]
[0m16:32:44.858388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_transactions, now model.dbt_bq_sa.v_stg_inventory)
[0m16:32:44.858937 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory
[0m16:32:44.869066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:46.284414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory"
[0m16:32:46.286290 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory
[0m16:32:46.289660 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory"
[0m16:32:46.290534 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m16:32:47.159279 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:12567b48-fd56-472a-a562-55d5482bd465&page=queryresults
[0m16:32:48.029701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153656e30>]}
[0m16:32:48.031252 [info ] [Thread-1 (]: 6 of 31 OK created sql view model dbt_dataset.v_stg_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 3.17s]
[0m16:32:48.032155 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory
[0m16:32:48.032759 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_customer
[0m16:32:48.033654 [info ] [Thread-1 (]: 7 of 31 START sql view model dbt_dataset.hub_customer .......................... [RUN]
[0m16:32:48.034819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory, now model.dbt_bq_sa.hub_customer)
[0m16:32:48.035479 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_customer
[0m16:32:48.062815 [info ] [Thread-1 (]: 16:32:48 + Loading trim-field-467501-p5.dbt_dataset.hub_customer from 1 source(s)
[0m16:32:48.103584 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_customer"
[0m16:32:48.105082 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_customer
[0m16:32:48.107926 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_customer"
[0m16:32:48.108361 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_customer: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_customer"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_customer`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:32:48.108629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:49.234183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:19e4620e-1962-4cff-a2f1-72e4c45e9eb1&page=queryresults
[0m16:32:50.087840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a3b1720>]}
[0m16:32:50.089719 [info ] [Thread-1 (]: 7 of 31 OK created sql view model dbt_dataset.hub_customer ..................... [[32mCREATE VIEW (0 processed)[0m in 2.05s]
[0m16:32:50.090651 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_customer
[0m16:32:50.091273 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_lineitem
[0m16:32:50.092178 [info ] [Thread-1 (]: 8 of 31 START sql view model dbt_dataset.hub_lineitem .......................... [RUN]
[0m16:32:50.092965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_customer, now model.dbt_bq_sa.hub_lineitem)
[0m16:32:50.093538 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_lineitem
[0m16:32:50.101997 [info ] [Thread-1 (]: 16:32:50 + Loading trim-field-467501-p5.dbt_dataset.hub_lineitem from 1 source(s)
[0m16:32:50.106252 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_lineitem"
[0m16:32:50.107137 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_lineitem
[0m16:32:50.111784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_lineitem"
[0m16:32:50.112713 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:32:50.113187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:51.220646 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f77ea92e-972a-4ced-97af-af2c63d13a02&page=queryresults
[0m16:32:52.123605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153656e30>]}
[0m16:32:52.124998 [info ] [Thread-1 (]: 8 of 31 OK created sql view model dbt_dataset.hub_lineitem ..................... [[32mCREATE VIEW (0 processed)[0m in 2.03s]
[0m16:32:52.125867 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_lineitem
[0m16:32:52.126455 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_order
[0m16:32:52.127290 [info ] [Thread-1 (]: 9 of 31 START sql view model dbt_dataset.hub_order ............................. [RUN]
[0m16:32:52.128076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_lineitem, now model.dbt_bq_sa.hub_order)
[0m16:32:52.128674 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_order
[0m16:32:52.138651 [info ] [Thread-1 (]: 16:32:52 + Loading trim-field-467501-p5.dbt_dataset.hub_order from 1 source(s)
[0m16:32:52.323663 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_order"
[0m16:32:52.324920 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_order
[0m16:32:52.326927 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_order"
[0m16:32:52.327302 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:32:52.327535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:53.524862 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f40f0939-a074-4145-8cb7-af4b67057b59&page=queryresults
[0m16:32:54.401778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1527ac340>]}
[0m16:32:54.403831 [info ] [Thread-1 (]: 9 of 31 OK created sql view model dbt_dataset.hub_order ........................ [[32mCREATE VIEW (0 processed)[0m in 2.27s]
[0m16:32:54.404956 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_order
[0m16:32:54.405573 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_nation
[0m16:32:54.406409 [info ] [Thread-1 (]: 10 of 31 START sql view model dbt_dataset.link_customer_nation ................. [RUN]
[0m16:32:54.407206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_order, now model.dbt_bq_sa.link_customer_nation)
[0m16:32:54.407973 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_nation
[0m16:32:54.422378 [info ] [Thread-1 (]: 16:32:54 + Loading trim-field-467501-p5.dbt_dataset.link_customer_nation from 1 source(s)
[0m16:32:54.443922 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_nation"
[0m16:32:54.444917 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_nation
[0m16:32:54.449482 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_nation"
[0m16:32:54.450415 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:32:54.450802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:55.597051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7004fefc-6eaf-4443-a1f4-316ef1034a6a&page=queryresults
[0m16:32:56.411902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15279f490>]}
[0m16:32:56.414046 [info ] [Thread-1 (]: 10 of 31 OK created sql view model dbt_dataset.link_customer_nation ............ [[32mCREATE VIEW (0 processed)[0m in 2.00s]
[0m16:32:56.414829 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_nation
[0m16:32:56.415859 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_order
[0m16:32:56.416683 [info ] [Thread-1 (]: 11 of 31 START sql view model dbt_dataset.link_customer_order .................. [RUN]
[0m16:32:56.418397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_nation, now model.dbt_bq_sa.link_customer_order)
[0m16:32:56.419315 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_order
[0m16:32:56.439250 [info ] [Thread-1 (]: 16:32:56 + Loading trim-field-467501-p5.dbt_dataset.link_customer_order from 1 source(s)
[0m16:32:56.444311 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_order"
[0m16:32:56.445046 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_order
[0m16:32:56.449007 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_order"
[0m16:32:56.450715 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:32:56.451976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:57.644382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a02384eb-422a-44a2-8a81-0f1a4021859c&page=queryresults
[0m16:32:58.511692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15279f3d0>]}
[0m16:32:58.513807 [info ] [Thread-1 (]: 11 of 31 OK created sql view model dbt_dataset.link_customer_order ............. [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m16:32:58.514707 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_order
[0m16:32:58.519423 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory_allocation
[0m16:32:58.520592 [info ] [Thread-1 (]: 12 of 31 START sql view model dbt_dataset.link_inventory_allocation ............ [RUN]
[0m16:32:58.521460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_order, now model.dbt_bq_sa.link_inventory_allocation)
[0m16:32:58.521940 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory_allocation
[0m16:32:58.543806 [info ] [Thread-1 (]: 16:32:58 + Loading trim-field-467501-p5.dbt_dataset.link_inventory_allocation from 1 source(s)
[0m16:32:58.554285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory_allocation"
[0m16:32:58.555182 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory_allocation
[0m16:32:58.561563 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory_allocation"
[0m16:32:58.562760 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory_allocation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory_allocation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:32:58.563206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:59.596983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ca74d77d-8dd9-4e58-99aa-e43adc29fe28&page=queryresults
[0m16:33:00.443713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1536ca9b0>]}
[0m16:33:00.445224 [info ] [Thread-1 (]: 12 of 31 OK created sql view model dbt_dataset.link_inventory_allocation ....... [[32mCREATE VIEW (0 processed)[0m in 1.92s]
[0m16:33:00.446127 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory_allocation
[0m16:33:00.446729 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_order_lineitem
[0m16:33:00.447409 [info ] [Thread-1 (]: 13 of 31 START sql view model dbt_dataset.link_order_lineitem .................. [RUN]
[0m16:33:00.447910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory_allocation, now model.dbt_bq_sa.link_order_lineitem)
[0m16:33:00.448204 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_order_lineitem
[0m16:33:00.452752 [info ] [Thread-1 (]: 16:33:00 + Loading trim-field-467501-p5.dbt_dataset.link_order_lineitem from 1 source(s)
[0m16:33:00.455545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_order_lineitem"
[0m16:33:00.456101 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_order_lineitem
[0m16:33:00.459131 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_order_lineitem"
[0m16:33:00.459797 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_order_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_order_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:33:00.460151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:01.577353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4c418526-f005-4f92-9d16-54d130fe9c58&page=queryresults
[0m16:33:02.424646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1536fd4e0>]}
[0m16:33:02.426128 [info ] [Thread-1 (]: 13 of 31 OK created sql view model dbt_dataset.link_order_lineitem ............. [[32mCREATE VIEW (0 processed)[0m in 1.98s]
[0m16:33:02.426865 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_order_lineitem
[0m16:33:02.427315 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m16:33:02.428534 [info ] [Thread-1 (]: 14 of 31 START sql view model dbt_dataset.sat_order_cust_nation_details ........ [RUN]
[0m16:33:02.429188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_order_lineitem, now model.dbt_bq_sa.sat_order_cust_nation_details)
[0m16:33:02.429455 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_nation_details
[0m16:33:02.483203 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m16:33:02.484225 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_nation_details
[0m16:33:02.487066 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m16:33:02.487760 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:02.488083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:03.633339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ae6f5a12-e4e1-4750-b81c-fa696adfc458&page=queryresults
[0m16:33:04.471910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153700e50>]}
[0m16:33:04.473114 [info ] [Thread-1 (]: 14 of 31 OK created sql view model dbt_dataset.sat_order_cust_nation_details ... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m16:33:04.473914 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m16:33:04.474335 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_region_details
[0m16:33:04.474669 [info ] [Thread-1 (]: 15 of 31 START sql view model dbt_dataset.sat_order_cust_region_details ........ [RUN]
[0m16:33:04.475316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_nation_details, now model.dbt_bq_sa.sat_order_cust_region_details)
[0m16:33:04.475723 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_region_details
[0m16:33:04.488903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m16:33:04.490060 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_region_details
[0m16:33:04.493732 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m16:33:04.494591 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:04.494986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:05.740086 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:07cc22a9-d027-474c-ab8e-f275cbf69083&page=queryresults
[0m16:33:06.587832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531269e0>]}
[0m16:33:06.591160 [info ] [Thread-1 (]: 15 of 31 OK created sql view model dbt_dataset.sat_order_cust_region_details ... [[32mCREATE VIEW (0 processed)[0m in 2.11s]
[0m16:33:06.592117 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_region_details
[0m16:33:06.592585 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_customer_details
[0m16:33:06.593181 [info ] [Thread-1 (]: 16 of 31 START sql view model dbt_dataset.sat_order_customer_details ........... [RUN]
[0m16:33:06.593508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_region_details, now model.dbt_bq_sa.sat_order_customer_details)
[0m16:33:06.593712 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_customer_details
[0m16:33:06.609933 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_customer_details"
[0m16:33:06.610517 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_customer_details
[0m16:33:06.618852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_customer_details"
[0m16:33:06.619585 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_customer_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_customer_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:06.619892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:07.703527 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ee2f6fd2-0b27-41ac-8613-49d940892490&page=queryresults
[0m16:33:08.680456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15311d990>]}
[0m16:33:08.681724 [info ] [Thread-1 (]: 16 of 31 OK created sql view model dbt_dataset.sat_order_customer_details ...... [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m16:33:08.682627 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_customer_details
[0m16:33:08.683220 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_lineitem_details
[0m16:33:08.684107 [info ] [Thread-1 (]: 17 of 31 START sql view model dbt_dataset.sat_order_lineitem_details ........... [RUN]
[0m16:33:08.684884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_customer_details, now model.dbt_bq_sa.sat_order_lineitem_details)
[0m16:33:08.685458 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_lineitem_details
[0m16:33:08.706944 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m16:33:08.707933 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_lineitem_details
[0m16:33:08.712278 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m16:33:08.712959 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_lineitem_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_lineitem_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:08.713382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:09.851393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b85c0611-b8c6-4bd1-883d-a1d579310af9&page=queryresults
[0m16:33:10.937983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15311d5d0>]}
[0m16:33:10.939101 [info ] [Thread-1 (]: 17 of 31 OK created sql view model dbt_dataset.sat_order_lineitem_details ...... [[32mCREATE VIEW (0 processed)[0m in 2.25s]
[0m16:33:10.939532 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_lineitem_details
[0m16:33:10.939864 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_order_details
[0m16:33:10.940357 [info ] [Thread-1 (]: 18 of 31 START sql view model dbt_dataset.sat_order_order_details .............. [RUN]
[0m16:33:10.940681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_lineitem_details, now model.dbt_bq_sa.sat_order_order_details)
[0m16:33:10.940893 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_order_details
[0m16:33:10.961741 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_order_details"
[0m16:33:10.962583 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_order_details
[0m16:33:10.965221 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_order_details"
[0m16:33:10.965784 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_order_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_order_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:10.966050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:12.023764 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:8c41a89d-2e73-4678-b0c4-1df74545bd62&page=queryresults
[0m16:33:12.871249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531269e0>]}
[0m16:33:12.872880 [info ] [Thread-1 (]: 18 of 31 OK created sql view model dbt_dataset.sat_order_order_details ......... [[32mCREATE VIEW (0 processed)[0m in 1.93s]
[0m16:33:12.874566 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_order_details
[0m16:33:12.875435 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.t_link_transactions
[0m16:33:12.876386 [info ] [Thread-1 (]: 19 of 31 START sql view model dbt_dataset.t_link_transactions .................. [RUN]
[0m16:33:12.877168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_order_details, now model.dbt_bq_sa.t_link_transactions)
[0m16:33:12.877488 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.t_link_transactions
[0m16:33:12.894764 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.t_link_transactions"
[0m16:33:12.895661 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.t_link_transactions
[0m16:33:12.899259 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.t_link_transactions"
[0m16:33:12.899858 [debug] [Thread-1 (]: On model.dbt_bq_sa.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.t_link_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`t_link_transactions`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert;


[0m16:33:12.900147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:14.084351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:c7ba7fba-9bd1-410b-9a4f-0f5e2c316ca7&page=queryresults
[0m16:33:15.400619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152681030>]}
[0m16:33:15.402088 [info ] [Thread-1 (]: 19 of 31 OK created sql view model dbt_dataset.t_link_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 2.52s]
[0m16:33:15.404047 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.t_link_transactions
[0m16:33:15.404480 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_nation
[0m16:33:15.404942 [info ] [Thread-1 (]: 20 of 31 START sql view model dbt_dataset.hub_nation ........................... [RUN]
[0m16:33:15.405357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.t_link_transactions, now model.dbt_bq_sa.hub_nation)
[0m16:33:15.405642 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_nation
[0m16:33:15.409741 [info ] [Thread-1 (]: 16:33:15 + Loading trim-field-467501-p5.dbt_dataset.hub_nation from 2 source(s)
[0m16:33:15.412952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_nation"
[0m16:33:15.413505 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_nation
[0m16:33:15.416130 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_nation"
[0m16:33:15.417255 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m16:33:15.417651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:16.555390 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:3340bcb8-6f8f-4bf4-9427-3bca7f80f692&page=queryresults
[0m16:33:17.443253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b331f0>]}
[0m16:33:17.444861 [info ] [Thread-1 (]: 20 of 31 OK created sql view model dbt_dataset.hub_nation ...................... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m16:33:17.446112 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_nation
[0m16:33:17.446762 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_part
[0m16:33:17.447592 [info ] [Thread-1 (]: 21 of 31 START sql view model dbt_dataset.hub_part ............................. [RUN]
[0m16:33:17.448258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_nation, now model.dbt_bq_sa.hub_part)
[0m16:33:17.448657 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_part
[0m16:33:17.455862 [info ] [Thread-1 (]: 16:33:17 + Loading trim-field-467501-p5.dbt_dataset.hub_part from 2 source(s)
[0m16:33:17.471916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_part"
[0m16:33:17.486134 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_part
[0m16:33:17.493429 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_part"
[0m16:33:17.494423 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_part: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_part"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_part`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m16:33:17.495849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:18.623773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ffa7ce84-1a81-4e28-9111-d04b8cd34342&page=queryresults
[0m16:33:19.459822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b331f0>]}
[0m16:33:19.461280 [info ] [Thread-1 (]: 21 of 31 OK created sql view model dbt_dataset.hub_part ........................ [[32mCREATE VIEW (0 processed)[0m in 2.01s]
[0m16:33:19.462231 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_part
[0m16:33:19.462881 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_region
[0m16:33:19.463430 [info ] [Thread-1 (]: 22 of 31 START sql view model dbt_dataset.hub_region ........................... [RUN]
[0m16:33:19.464066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_part, now model.dbt_bq_sa.hub_region)
[0m16:33:19.468091 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_region
[0m16:33:19.474280 [info ] [Thread-1 (]: 16:33:19 + Loading trim-field-467501-p5.dbt_dataset.hub_region from 2 source(s)
[0m16:33:19.477668 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_region"
[0m16:33:19.478461 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_region
[0m16:33:19.482299 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_region"
[0m16:33:19.482908 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m16:33:19.483206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:20.695079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:3278a004-25e9-4b24-9bae-fc51d8ac7c58&page=queryresults
[0m16:33:21.563279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152681030>]}
[0m16:33:21.564766 [info ] [Thread-1 (]: 22 of 31 OK created sql view model dbt_dataset.hub_region ...................... [[32mCREATE VIEW (0 processed)[0m in 2.10s]
[0m16:33:21.565722 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_region
[0m16:33:21.566345 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_supplier
[0m16:33:21.567073 [info ] [Thread-1 (]: 23 of 31 START sql view model dbt_dataset.hub_supplier ......................... [RUN]
[0m16:33:21.567499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_region, now model.dbt_bq_sa.hub_supplier)
[0m16:33:21.567776 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_supplier
[0m16:33:21.573478 [info ] [Thread-1 (]: 16:33:21 + Loading trim-field-467501-p5.dbt_dataset.hub_supplier from 2 source(s)
[0m16:33:21.577621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_supplier"
[0m16:33:21.578300 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_supplier
[0m16:33:21.580852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_supplier"
[0m16:33:21.581452 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_supplier: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_supplier"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_supplier`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m16:33:21.581794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:22.605216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:79adf02a-a81a-4dbf-93fb-bd1e0d4cde22&page=queryresults
[0m16:33:23.477562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152681030>]}
[0m16:33:24.692473 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m16:33:24.696781 [info ] [Thread-1 (]: 23 of 31 OK created sql view model dbt_dataset.hub_supplier .................... [[32mCREATE VIEW (0 processed)[0m in 1.91s]
[0m16:33:24.698408 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_supplier
[0m16:33:24.699329 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory
[0m16:33:24.700882 [info ] [Thread-1 (]: 24 of 31 START sql view model dbt_dataset.link_inventory ....................... [RUN]
[0m16:33:24.701938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_supplier, now model.dbt_bq_sa.link_inventory)
[0m16:33:24.703420 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory
[0m16:33:24.719748 [info ] [Thread-1 (]: 16:33:24 + Loading trim-field-467501-p5.dbt_dataset.link_inventory from 1 source(s)
[0m16:33:24.724952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory"
[0m16:33:24.725902 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory
[0m16:33:24.729150 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory"
[0m16:33:24.730177 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:33:24.730770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:25.926791 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a79b7787-8443-43e4-84d7-ce4bc5f142f3&page=queryresults
[0m16:33:26.762727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b331f0>]}
[0m16:33:26.765072 [info ] [Thread-1 (]: 24 of 31 OK created sql view model dbt_dataset.link_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m16:33:26.766178 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory
[0m16:33:26.766925 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_nation_region
[0m16:33:26.768214 [info ] [Thread-1 (]: 25 of 31 START sql view model dbt_dataset.link_nation_region ................... [RUN]
[0m16:33:26.769120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory, now model.dbt_bq_sa.link_nation_region)
[0m16:33:26.769614 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_nation_region
[0m16:33:26.781248 [info ] [Thread-1 (]: 16:33:26 + Loading trim-field-467501-p5.dbt_dataset.link_nation_region from 2 source(s)
[0m16:33:26.786922 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_nation_region"
[0m16:33:26.788720 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_nation_region
[0m16:33:26.794438 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_nation_region"
[0m16:33:26.795421 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_nation_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_nation_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_nation_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m16:33:26.795999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:28.019987 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a696cb0c-72f8-4a6f-b120-9e6d2e3bb8a5&page=queryresults
[0m16:33:28.856247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b331f0>]}
[0m16:33:28.857887 [info ] [Thread-1 (]: 25 of 31 OK created sql view model dbt_dataset.link_nation_region .............. [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m16:33:28.858827 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_nation_region
[0m16:33:28.859401 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_supplier_nation
[0m16:33:28.859893 [info ] [Thread-1 (]: 26 of 31 START sql view model dbt_dataset.link_supplier_nation ................. [RUN]
[0m16:33:28.860308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_nation_region, now model.dbt_bq_sa.link_supplier_nation)
[0m16:33:28.860581 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_supplier_nation
[0m16:33:28.866295 [info ] [Thread-1 (]: 16:33:28 + Loading trim-field-467501-p5.dbt_dataset.link_supplier_nation from 1 source(s)
[0m16:33:28.870612 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_supplier_nation"
[0m16:33:28.872148 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_supplier_nation
[0m16:33:28.877754 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_supplier_nation"
[0m16:33:28.879992 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_supplier_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_supplier_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:33:28.880752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:30.027633 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:83f1c8f7-e193-49ec-94e8-d5f4a9694009&page=queryresults
[0m16:33:30.824652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b331f0>]}
[0m16:33:30.826153 [info ] [Thread-1 (]: 26 of 31 OK created sql view model dbt_dataset.link_supplier_nation ............ [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m16:33:30.827082 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_supplier_nation
[0m16:33:30.827713 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_inventory_details
[0m16:33:30.828613 [info ] [Thread-1 (]: 27 of 31 START sql view model dbt_dataset.sat_inv_inventory_details ............ [RUN]
[0m16:33:30.829381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_supplier_nation, now model.dbt_bq_sa.sat_inv_inventory_details)
[0m16:33:30.829979 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_inventory_details
[0m16:33:30.847502 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m16:33:30.850868 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_inventory_details
[0m16:33:30.855837 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m16:33:30.857217 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_inventory_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_inventory_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:30.857730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:31.907705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f5548626-c948-4cc2-9919-1b2c5bb9c396&page=queryresults
[0m16:33:32.722299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15358e350>]}
[0m16:33:32.723214 [info ] [Thread-1 (]: 27 of 31 OK created sql view model dbt_dataset.sat_inv_inventory_details ....... [[32mCREATE VIEW (0 processed)[0m in 1.89s]
[0m16:33:32.723603 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_inventory_details
[0m16:33:32.723928 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_part_details
[0m16:33:32.727031 [info ] [Thread-1 (]: 28 of 31 START sql view model dbt_dataset.sat_inv_part_details ................. [RUN]
[0m16:33:32.728553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_inventory_details, now model.dbt_bq_sa.sat_inv_part_details)
[0m16:33:32.729137 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_part_details
[0m16:33:32.745833 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_part_details"
[0m16:33:32.747187 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_part_details
[0m16:33:32.750840 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_part_details"
[0m16:33:32.751452 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_part_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_part_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:32.751743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:34.100647 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:346c6528-717e-4f00-ad80-2ec885c567a3&page=queryresults
[0m16:33:34.991896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153055d80>]}
[0m16:33:34.993152 [info ] [Thread-1 (]: 28 of 31 OK created sql view model dbt_dataset.sat_inv_part_details ............ [[32mCREATE VIEW (0 processed)[0m in 2.26s]
[0m16:33:34.994117 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_part_details
[0m16:33:34.994607 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m16:33:34.995247 [info ] [Thread-1 (]: 29 of 31 START sql view model dbt_dataset.sat_inv_supp_nation_details .......... [RUN]
[0m16:33:34.995732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_part_details, now model.dbt_bq_sa.sat_inv_supp_nation_details)
[0m16:33:34.996093 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m16:33:35.011442 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m16:33:35.012136 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m16:33:35.015325 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m16:33:35.016006 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:35.016488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:36.308224 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:254ff54b-5a4b-4d57-9896-c59e9087ae91&page=queryresults
[0m16:33:37.121519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153055d80>]}
[0m16:33:37.123832 [info ] [Thread-1 (]: 29 of 31 OK created sql view model dbt_dataset.sat_inv_supp_nation_details ..... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m16:33:37.124928 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m16:33:37.125966 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m16:33:37.127549 [info ] [Thread-1 (]: 30 of 31 START sql view model dbt_dataset.sat_inv_supp_region_details .......... [RUN]
[0m16:33:37.128332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_nation_details, now model.dbt_bq_sa.sat_inv_supp_region_details)
[0m16:33:37.128849 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_region_details
[0m16:33:37.156866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m16:33:37.157904 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_region_details
[0m16:33:37.161882 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m16:33:37.162715 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:37.163168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:38.255534 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:581d098e-144d-4d33-85c2-1df5ae45a390&page=queryresults
[0m16:33:39.191718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15279e5c0>]}
[0m16:33:39.193290 [info ] [Thread-1 (]: 30 of 31 OK created sql view model dbt_dataset.sat_inv_supp_region_details ..... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m16:33:39.194208 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m16:33:39.194877 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supplier_details
[0m16:33:39.195906 [info ] [Thread-1 (]: 31 of 31 START sql view model dbt_dataset.sat_inv_supplier_details ............. [RUN]
[0m16:33:39.196708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_region_details, now model.dbt_bq_sa.sat_inv_supplier_details)
[0m16:33:39.197231 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supplier_details
[0m16:33:39.216650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m16:33:39.217885 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supplier_details
[0m16:33:39.222611 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m16:33:39.223406 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supplier_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supplier_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:39.223901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:40.405453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:bf35e173-3819-415d-bad0-54c61bc1607d&page=queryresults
[0m16:33:41.301204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153055d80>]}
[0m16:33:41.302892 [info ] [Thread-1 (]: 31 of 31 OK created sql view model dbt_dataset.sat_inv_supplier_details ........ [[32mCREATE VIEW (0 processed)[0m in 2.10s]
[0m16:33:41.306047 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supplier_details
[0m16:33:41.311633 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:33:41.327117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:41.327555 [debug] [MainThread]: Connection 'model.dbt_bq_sa.sat_inv_supplier_details' was properly closed.
[0m16:33:41.332386 [info ] [MainThread]: 
[0m16:33:41.341579 [info ] [MainThread]: Finished running 31 view models in 0 hours 1 minutes and 10.80 seconds (70.80s).
[0m16:33:41.348238 [debug] [MainThread]: Command end result
[0m16:33:41.597663 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m16:33:41.601979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m16:33:41.611269 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m16:33:41.611572 [info ] [MainThread]: 
[0m16:33:41.611827 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:41.612021 [info ] [MainThread]: 
[0m16:33:41.612222 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=31
[0m16:33:41.665546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 73.4794, "process_in_blocks": "0", "process_kernel_time": 1.62669, "process_mem_max_rss": "342720512", "process_out_blocks": "0", "process_user_time": 6.646591}
[0m16:33:41.667171 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:41.667047 after 73.48 seconds
[0m16:33:41.668518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ceb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045edd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153027b20>]}
[0m16:33:41.669040 [debug] [MainThread]: Flushing usage events
[0m16:33:42.573035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:30.887882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056cf6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106824580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106824c40>]}


============================== 20:05:30.891156 | cce3a638-4000-4c9d-84d5-e58106f17341 ==============================
[0m20:05:30.891156 [info ] [MainThread]: Running with dbt=1.10.7
[0m20:05:30.891481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:05:32.921254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1da20>]}
[0m20:05:32.954131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679be80>]}
[0m20:05:32.954558 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:05:33.087607 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m20:05:33.197652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m20:05:33.198114 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/stage/v_stg_inventory2.sql
[0m20:05:33.198318 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/stage/v_stg_inventory1.sql
[0m20:05:33.198529 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/v_stg_orders.sql
[0m20:05:33.495188 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.raw_vault.t_links
- models.raw_vault.sats
- models.raw_vault.hubs
- models.stage
- models.raw_vault
- models.raw_stage
- models.raw_vault.links
[0m20:05:33.506894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141bc8130>]}
[0m20:05:33.569415 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/manifest.json
[0m20:05:33.572122 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/semantic_manifest.json
[0m20:05:33.676025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141b14d00>]}
[0m20:05:33.676405 [info ] [MainThread]: Found 33 models, 8 sources, 854 macros
[0m20:05:33.676591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141b14d00>]}
[0m20:05:33.678014 [info ] [MainThread]: 
[0m20:05:33.678208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:05:33.678349 [info ] [MainThread]: 
[0m20:05:33.678597 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:05:33.682059 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m20:05:33.682263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:34.587950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m20:05:34.588915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:35.423023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e534f0>]}
[0m20:05:35.424330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:05:35.431227 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_orders
[0m20:05:35.432026 [info ] [Thread-1 (]: 1 of 33 START sql view model dbt_dataset.raw_orders ............................ [RUN]
[0m20:05:35.432665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_orders)
[0m20:05:35.433138 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_orders
[0m20:05:35.448094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_orders"
[0m20:05:35.449116 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_orders
[0m20:05:35.475361 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_orders"
[0m20:05:35.476085 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
  OPTIONS()
  as SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`lineitem` AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON c.C_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m20:05:35.476487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:36.568638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:33492154-7aff-4821-8589-9ae44fe95a98&page=queryresults
[0m20:05:37.514610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106175d50>]}
[0m20:05:37.515255 [info ] [Thread-1 (]: 1 of 33 OK created sql view model dbt_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.08s]
[0m20:05:37.515722 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_orders
[0m20:05:37.516036 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m20:05:37.516572 [info ] [Thread-1 (]: 2 of 33 START sql view model dbt_dataset.raw_transactions ...................... [RUN]
[0m20:05:37.516882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_orders, now model.dbt_bq_sa.raw_transactions)
[0m20:05:37.517152 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m20:05:37.520531 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m20:05:37.521064 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m20:05:37.524455 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m20:05:37.525326 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATE_ADD(b.O_ORDERDATE, INTERVAL 20 DAY) AS TRANSACTION_DATE,
    CAST(RPAD(CONCAT(CAST(b.O_ORDERKEY AS STRING), CAST(b.O_CUSTKEY AS STRING), FORMAT_DATE('%Y%m%d', b.O_ORDERDATE)), 24, '0') AS INT64) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
        CASE FLOOR(RAND() * 2) + 1
            WHEN 1 THEN 'DR'
            WHEN 2 THEN 'CR'
        END AS STRING) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m20:05:37.525683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:38.633781 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b24e27bb-e7f8-4998-b284-54b8d9fae67c&page=queryresults
[0m20:05:39.490264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:05:39.492244 [info ] [Thread-1 (]: 2 of 33 OK created sql view model dbt_dataset.raw_transactions ................. [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m20:05:39.493554 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m20:05:39.494240 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m20:05:39.495328 [info ] [Thread-1 (]: 3 of 33 START sql view model dbt_dataset.raw_inventory ......................... [RUN]
[0m20:05:39.496215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_transactions, now model.dbt_bq_sa.raw_inventory)
[0m20:05:39.496819 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m20:05:39.509067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m20:05:39.510403 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m20:05:39.515829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m20:05:39.516923 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`partsupp` AS a
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m20:05:39.517537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:40.722797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6f2d40ed-a79c-41bf-9bda-133ad2f7d318&page=queryresults
[0m20:05:41.673986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106176560>]}
[0m20:05:41.674508 [info ] [Thread-1 (]: 3 of 33 OK created sql view model dbt_dataset.raw_inventory .................... [[32mCREATE VIEW (0 processed)[0m in 2.18s]
[0m20:05:41.674861 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m20:05:41.675111 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_orders
[0m20:05:41.675516 [info ] [Thread-1 (]: 4 of 33 START sql view model dbt_dataset.v_stg_orders .......................... [RUN]
[0m20:05:41.675837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_inventory, now model.dbt_bq_sa.v_stg_orders)
[0m20:05:41.676055 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_orders
[0m20:05:41.680911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:43.030954 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_orders"
[0m20:05:43.032366 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_orders
[0m20:05:43.036208 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_orders"
[0m20:05:43.038649 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), '')))) AS STRING) AS ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS ORDER_CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINEITEM_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS LINK_LINEITEM_ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS INVENTORY_ALLOCATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS STRING))), ''), '^^')
    )))) AS STRING) AS LINEITEM_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS STRING))), ''), '^^')
    )))) AS STRING) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT * ,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE
FROM staging;


[0m20:05:43.846949 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a89ee1c1-be74-41e3-8a50-a048cbd0f207&page=queryresults
[0m20:05:44.723094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:05:44.725362 [info ] [Thread-1 (]: 4 of 33 OK created sql view model dbt_dataset.v_stg_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 3.05s]
[0m20:05:44.726423 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_orders
[0m20:05:44.727049 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m20:05:44.728164 [info ] [Thread-1 (]: 5 of 33 START sql view model dbt_dataset.v_stg_transactions .................... [RUN]
[0m20:05:44.729476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_orders, now model.dbt_bq_sa.v_stg_transactions)
[0m20:05:44.730057 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m20:05:44.744249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:46.115944 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_transactions"
[0m20:05:46.118218 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_transactions
[0m20:05:46.125655 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_transactions"
[0m20:05:46.126773 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
  OPTIONS()
  as 







-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATE_ADD(TRANSACTION_DATE, INTERVAL 1 DAY) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS TRANSACTION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS STRING))), '')))) AS STRING) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m20:05:46.825188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:e3dff855-254b-4d48-a572-5ae6be0c1a03&page=queryresults
[0m20:05:47.703858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14203fe20>]}
[0m20:05:47.705153 [info ] [Thread-1 (]: 5 of 33 OK created sql view model dbt_dataset.v_stg_transactions ............... [[32mCREATE VIEW (0 processed)[0m in 2.97s]
[0m20:05:47.705940 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_transactions
[0m20:05:47.706561 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory
[0m20:05:47.707436 [info ] [Thread-1 (]: 6 of 33 START sql view model dbt_dataset.v_stg_inventory ....................... [RUN]
[0m20:05:47.708333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_transactions, now model.dbt_bq_sa.v_stg_inventory)
[0m20:05:47.708790 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory
[0m20:05:47.718244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:49.180296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory"
[0m20:05:49.182927 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory
[0m20:05:49.186516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory"
[0m20:05:49.187639 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m20:05:49.940099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:5594cab1-567b-45d7-96fb-dbf77d7897a7&page=queryresults
[0m20:05:50.829630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14203fe20>]}
[0m20:05:50.831566 [info ] [Thread-1 (]: 6 of 33 OK created sql view model dbt_dataset.v_stg_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 3.12s]
[0m20:05:50.833035 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory
[0m20:05:50.833742 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory1
[0m20:05:50.835209 [info ] [Thread-1 (]: 7 of 33 START sql view model dbt_dataset.v_stg_inventory1 ...................... [RUN]
[0m20:05:50.835991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory, now model.dbt_bq_sa.v_stg_inventory1)
[0m20:05:50.836534 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory1
[0m20:05:50.847756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:52.277830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory1"
[0m20:05:52.279547 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory1
[0m20:05:52.283058 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory1"
[0m20:05:52.283960 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory1: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory1"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory1`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m20:05:53.028854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6591d633-0481-4988-99c5-6485a6ac300a&page=queryresults
[0m20:05:53.893569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106623700>]}
[0m20:05:53.895416 [info ] [Thread-1 (]: 7 of 33 OK created sql view model dbt_dataset.v_stg_inventory1 ................. [[32mCREATE VIEW (0 processed)[0m in 3.06s]
[0m20:05:53.896383 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory1
[0m20:05:53.897056 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory2
[0m20:05:53.898007 [info ] [Thread-1 (]: 8 of 33 START sql view model dbt_dataset.v_stg_inventory2 ...................... [RUN]
[0m20:05:53.898813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory1, now model.dbt_bq_sa.v_stg_inventory2)
[0m20:05:53.899427 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory2
[0m20:05:53.910664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:55.323224 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory2"
[0m20:05:55.324058 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory2
[0m20:05:55.327478 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory2"
[0m20:05:55.328377 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory2"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory2`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m20:05:56.080608 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a05f99e4-82cd-4ab1-bb6d-9234519df359&page=queryresults
[0m20:05:57.013238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:05:57.014338 [info ] [Thread-1 (]: 8 of 33 OK created sql view model dbt_dataset.v_stg_inventory2 ................. [[32mCREATE VIEW (0 processed)[0m in 3.11s]
[0m20:05:57.015070 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory2
[0m20:05:57.015583 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_customer
[0m20:05:57.016309 [info ] [Thread-1 (]: 9 of 33 START sql view model dbt_dataset.hub_customer .......................... [RUN]
[0m20:05:57.016959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory2, now model.dbt_bq_sa.hub_customer)
[0m20:05:57.017531 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_customer
[0m20:05:57.044048 [info ] [Thread-1 (]: 20:05:57 + Loading trim-field-467501-p5.dbt_dataset.hub_customer from 1 source(s)
[0m20:05:57.087219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_customer"
[0m20:05:57.088081 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_customer
[0m20:05:57.090414 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_customer"
[0m20:05:57.090820 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_customer: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_customer"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_customer`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:05:57.091065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:58.241710 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:95ba39d8-1ded-41e2-a6ca-7491194e70e4&page=queryresults
[0m20:05:59.160240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106623700>]}
[0m20:05:59.161326 [info ] [Thread-1 (]: 9 of 33 OK created sql view model dbt_dataset.hub_customer ..................... [[32mCREATE VIEW (0 processed)[0m in 2.14s]
[0m20:05:59.161859 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_customer
[0m20:05:59.162331 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_lineitem
[0m20:05:59.162867 [info ] [Thread-1 (]: 10 of 33 START sql view model dbt_dataset.hub_lineitem ......................... [RUN]
[0m20:05:59.163219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_customer, now model.dbt_bq_sa.hub_lineitem)
[0m20:05:59.163457 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_lineitem
[0m20:05:59.168789 [info ] [Thread-1 (]: 20:05:59 + Loading trim-field-467501-p5.dbt_dataset.hub_lineitem from 1 source(s)
[0m20:05:59.171089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_lineitem"
[0m20:05:59.171660 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_lineitem
[0m20:05:59.178019 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_lineitem"
[0m20:05:59.179041 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:05:59.179370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:00.487433 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:88add5fb-3b0f-47e7-9b3b-dc95b2e10166&page=queryresults
[0m20:06:01.519350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141b3fa90>]}
[0m20:06:01.519919 [info ] [Thread-1 (]: 10 of 33 OK created sql view model dbt_dataset.hub_lineitem .................... [[32mCREATE VIEW (0 processed)[0m in 2.36s]
[0m20:06:01.520333 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_lineitem
[0m20:06:01.520612 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_order
[0m20:06:01.521006 [info ] [Thread-1 (]: 11 of 33 START sql view model dbt_dataset.hub_order ............................ [RUN]
[0m20:06:01.521346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_lineitem, now model.dbt_bq_sa.hub_order)
[0m20:06:01.521605 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_order
[0m20:06:01.526010 [info ] [Thread-1 (]: 20:06:01 + Loading trim-field-467501-p5.dbt_dataset.hub_order from 1 source(s)
[0m20:06:01.528353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_order"
[0m20:06:01.528868 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_order
[0m20:06:01.534101 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_order"
[0m20:06:01.534844 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:01.535209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:02.644190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a9173ce0-3267-4985-8d71-c01c9aadef6d&page=queryresults
[0m20:06:03.529447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106174a60>]}
[0m20:06:03.535863 [info ] [Thread-1 (]: 11 of 33 OK created sql view model dbt_dataset.hub_order ....................... [[32mCREATE VIEW (0 processed)[0m in 2.01s]
[0m20:06:03.537750 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_order
[0m20:06:03.538298 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_nation
[0m20:06:03.539387 [info ] [Thread-1 (]: 12 of 33 START sql view model dbt_dataset.link_customer_nation ................. [RUN]
[0m20:06:03.540158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_order, now model.dbt_bq_sa.link_customer_nation)
[0m20:06:03.541671 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_nation
[0m20:06:03.560990 [info ] [Thread-1 (]: 20:06:03 + Loading trim-field-467501-p5.dbt_dataset.link_customer_nation from 1 source(s)
[0m20:06:03.577972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_nation"
[0m20:06:03.578705 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_nation
[0m20:06:03.587254 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_nation"
[0m20:06:03.589507 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:03.590090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:04.732141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ed1e729f-dcc6-4557-9126-1cd954d60c1e&page=queryresults
[0m20:06:05.639299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:05.641020 [info ] [Thread-1 (]: 12 of 33 OK created sql view model dbt_dataset.link_customer_nation ............ [[32mCREATE VIEW (0 processed)[0m in 2.10s]
[0m20:06:05.641976 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_nation
[0m20:06:05.642635 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_order
[0m20:06:05.643533 [info ] [Thread-1 (]: 13 of 33 START sql view model dbt_dataset.link_customer_order .................. [RUN]
[0m20:06:05.644387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_nation, now model.dbt_bq_sa.link_customer_order)
[0m20:06:05.645006 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_order
[0m20:06:05.653594 [info ] [Thread-1 (]: 20:06:05 + Loading trim-field-467501-p5.dbt_dataset.link_customer_order from 1 source(s)
[0m20:06:05.660073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_order"
[0m20:06:05.661236 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_order
[0m20:06:05.665761 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_order"
[0m20:06:05.667939 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:05.668635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:06.941731 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:94e599d2-99fc-483d-b951-6fd2003e8885&page=queryresults
[0m20:06:07.876512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106174a60>]}
[0m20:06:07.878123 [info ] [Thread-1 (]: 13 of 33 OK created sql view model dbt_dataset.link_customer_order ............. [[32mCREATE VIEW (0 processed)[0m in 2.23s]
[0m20:06:07.878761 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_order
[0m20:06:07.879289 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory_allocation
[0m20:06:07.880063 [info ] [Thread-1 (]: 14 of 33 START sql view model dbt_dataset.link_inventory_allocation ............ [RUN]
[0m20:06:07.880577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_order, now model.dbt_bq_sa.link_inventory_allocation)
[0m20:06:07.880909 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory_allocation
[0m20:06:07.888867 [info ] [Thread-1 (]: 20:06:07 + Loading trim-field-467501-p5.dbt_dataset.link_inventory_allocation from 1 source(s)
[0m20:06:07.895730 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory_allocation"
[0m20:06:07.896521 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory_allocation
[0m20:06:07.899955 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory_allocation"
[0m20:06:07.900702 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory_allocation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory_allocation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:07.901231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:09.004071 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:5f65edcc-fb5b-4272-8a0c-9d4b97e8bc78&page=queryresults
[0m20:06:09.823105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:09.824288 [info ] [Thread-1 (]: 14 of 33 OK created sql view model dbt_dataset.link_inventory_allocation ....... [[32mCREATE VIEW (0 processed)[0m in 1.94s]
[0m20:06:09.825181 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory_allocation
[0m20:06:09.825865 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_order_lineitem
[0m20:06:09.826984 [info ] [Thread-1 (]: 15 of 33 START sql view model dbt_dataset.link_order_lineitem .................. [RUN]
[0m20:06:09.827631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory_allocation, now model.dbt_bq_sa.link_order_lineitem)
[0m20:06:09.828090 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_order_lineitem
[0m20:06:09.838693 [info ] [Thread-1 (]: 20:06:09 + Loading trim-field-467501-p5.dbt_dataset.link_order_lineitem from 1 source(s)
[0m20:06:09.843277 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_order_lineitem"
[0m20:06:09.844565 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_order_lineitem
[0m20:06:09.849156 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_order_lineitem"
[0m20:06:09.850263 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_order_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_order_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:09.850781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:10.836209 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:53f2c791-195b-4edd-ad1f-0ff3957f25d0&page=queryresults
[0m20:06:11.668799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106174a60>]}
[0m20:06:11.670045 [info ] [Thread-1 (]: 15 of 33 OK created sql view model dbt_dataset.link_order_lineitem ............. [[32mCREATE VIEW (0 processed)[0m in 1.84s]
[0m20:06:11.670964 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_order_lineitem
[0m20:06:11.671599 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m20:06:11.672357 [info ] [Thread-1 (]: 16 of 33 START sql view model dbt_dataset.sat_order_cust_nation_details ........ [RUN]
[0m20:06:11.672996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_order_lineitem, now model.dbt_bq_sa.sat_order_cust_nation_details)
[0m20:06:11.673538 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_nation_details
[0m20:06:11.723408 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m20:06:11.724166 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_nation_details
[0m20:06:11.727010 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m20:06:11.727485 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:11.727797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:12.855329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:fcfd1d1a-daa5-4017-a383-db750d48ed66&page=queryresults
[0m20:06:13.675561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141363f40>]}
[0m20:06:13.676267 [info ] [Thread-1 (]: 16 of 33 OK created sql view model dbt_dataset.sat_order_cust_nation_details ... [[32mCREATE VIEW (0 processed)[0m in 2.00s]
[0m20:06:13.676691 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m20:06:13.676995 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_region_details
[0m20:06:13.677277 [info ] [Thread-1 (]: 17 of 33 START sql view model dbt_dataset.sat_order_cust_region_details ........ [RUN]
[0m20:06:13.677578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_nation_details, now model.dbt_bq_sa.sat_order_cust_region_details)
[0m20:06:13.677799 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_region_details
[0m20:06:13.689535 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m20:06:13.692469 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_region_details
[0m20:06:13.700027 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m20:06:13.700724 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:13.701088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:14.823562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7d6d8d38-6a70-4c20-8000-59a9565efbf3&page=queryresults
[0m20:06:15.646898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142248160>]}
[0m20:06:15.648090 [info ] [Thread-1 (]: 17 of 33 OK created sql view model dbt_dataset.sat_order_cust_region_details ... [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m20:06:15.648977 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_region_details
[0m20:06:15.649579 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_customer_details
[0m20:06:15.650499 [info ] [Thread-1 (]: 18 of 33 START sql view model dbt_dataset.sat_order_customer_details ........... [RUN]
[0m20:06:15.651304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_region_details, now model.dbt_bq_sa.sat_order_customer_details)
[0m20:06:15.651916 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_customer_details
[0m20:06:15.669168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_customer_details"
[0m20:06:15.670114 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_customer_details
[0m20:06:15.674529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_customer_details"
[0m20:06:15.675307 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_customer_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_customer_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:15.675746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:16.742072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7845fc69-c134-4c84-a139-0d27b077ecf7&page=queryresults
[0m20:06:17.585639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142248160>]}
[0m20:06:17.587297 [info ] [Thread-1 (]: 18 of 33 OK created sql view model dbt_dataset.sat_order_customer_details ...... [[32mCREATE VIEW (0 processed)[0m in 1.93s]
[0m20:06:17.588377 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_customer_details
[0m20:06:17.589116 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_lineitem_details
[0m20:06:17.590190 [info ] [Thread-1 (]: 19 of 33 START sql view model dbt_dataset.sat_order_lineitem_details ........... [RUN]
[0m20:06:17.591031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_customer_details, now model.dbt_bq_sa.sat_order_lineitem_details)
[0m20:06:17.591659 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_lineitem_details
[0m20:06:17.613904 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m20:06:17.615017 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_lineitem_details
[0m20:06:17.618849 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m20:06:17.619521 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_lineitem_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_lineitem_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:17.619948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:18.596311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:bcb54efc-863d-40e7-b342-3110a4b1f7bf&page=queryresults
[0m20:06:19.418817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:19.420352 [info ] [Thread-1 (]: 19 of 33 OK created sql view model dbt_dataset.sat_order_lineitem_details ...... [[32mCREATE VIEW (0 processed)[0m in 1.83s]
[0m20:06:19.421302 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_lineitem_details
[0m20:06:19.421955 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_order_details
[0m20:06:19.422829 [info ] [Thread-1 (]: 20 of 33 START sql view model dbt_dataset.sat_order_order_details .............. [RUN]
[0m20:06:19.423656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_lineitem_details, now model.dbt_bq_sa.sat_order_order_details)
[0m20:06:19.424299 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_order_details
[0m20:06:19.442651 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_order_details"
[0m20:06:19.443567 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_order_details
[0m20:06:19.447678 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_order_details"
[0m20:06:19.448389 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_order_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_order_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:19.448822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:20.624663 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:9d69c411-e2f8-47d9-adda-4094d9ab9bc6&page=queryresults
[0m20:06:21.470825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1421993f0>]}
[0m20:06:21.472314 [info ] [Thread-1 (]: 20 of 33 OK created sql view model dbt_dataset.sat_order_order_details ......... [[32mCREATE VIEW (0 processed)[0m in 2.05s]
[0m20:06:21.473365 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_order_details
[0m20:06:21.473847 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.t_link_transactions
[0m20:06:21.474302 [info ] [Thread-1 (]: 21 of 33 START sql view model dbt_dataset.t_link_transactions .................. [RUN]
[0m20:06:21.474681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_order_details, now model.dbt_bq_sa.t_link_transactions)
[0m20:06:21.474956 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.t_link_transactions
[0m20:06:21.496168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.t_link_transactions"
[0m20:06:21.498700 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.t_link_transactions
[0m20:06:21.502119 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.t_link_transactions"
[0m20:06:21.502799 [debug] [Thread-1 (]: On model.dbt_bq_sa.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.t_link_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`t_link_transactions`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert;


[0m20:06:21.503161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:22.669293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:792b1d6e-628f-4a6b-95d4-39033f29ea4c&page=queryresults
[0m20:06:23.495185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:23.497365 [info ] [Thread-1 (]: 21 of 33 OK created sql view model dbt_dataset.t_link_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 2.02s]
[0m20:06:23.498430 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.t_link_transactions
[0m20:06:23.499229 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_nation
[0m20:06:23.500369 [info ] [Thread-1 (]: 22 of 33 START sql view model dbt_dataset.hub_nation ........................... [RUN]
[0m20:06:23.501063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.t_link_transactions, now model.dbt_bq_sa.hub_nation)
[0m20:06:23.501654 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_nation
[0m20:06:23.520640 [info ] [Thread-1 (]: 20:06:23 + Loading trim-field-467501-p5.dbt_dataset.hub_nation from 2 source(s)
[0m20:06:23.530458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_nation"
[0m20:06:23.532877 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_nation
[0m20:06:23.537637 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_nation"
[0m20:06:23.538470 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m20:06:23.538957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:24.627718 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4ffcb3b8-db78-4935-8cc7-dafa44b77c87&page=queryresults
[0m20:06:25.400347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:25.402347 [info ] [Thread-1 (]: 22 of 33 OK created sql view model dbt_dataset.hub_nation ...................... [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m20:06:25.404030 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_nation
[0m20:06:25.404731 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_part
[0m20:06:25.405689 [info ] [Thread-1 (]: 23 of 33 START sql view model dbt_dataset.hub_part ............................. [RUN]
[0m20:06:25.406601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_nation, now model.dbt_bq_sa.hub_part)
[0m20:06:25.407224 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_part
[0m20:06:25.416158 [info ] [Thread-1 (]: 20:06:25 + Loading trim-field-467501-p5.dbt_dataset.hub_part from 2 source(s)
[0m20:06:25.422752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_part"
[0m20:06:25.423906 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_part
[0m20:06:25.430752 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_part"
[0m20:06:25.431867 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_part: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_part"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_part`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m20:06:25.432396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:26.507932 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:c78ac672-7cfe-40ca-9610-cb28ff8632ae&page=queryresults
[0m20:06:27.363981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:28.891505 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m20:06:28.893034 [info ] [Thread-1 (]: 23 of 33 OK created sql view model dbt_dataset.hub_part ........................ [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m20:06:28.893723 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_part
[0m20:06:28.894182 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_region
[0m20:06:28.894788 [info ] [Thread-1 (]: 24 of 33 START sql view model dbt_dataset.hub_region ........................... [RUN]
[0m20:06:28.895462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_part, now model.dbt_bq_sa.hub_region)
[0m20:06:28.895910 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_region
[0m20:06:28.902934 [info ] [Thread-1 (]: 20:06:28 + Loading trim-field-467501-p5.dbt_dataset.hub_region from 2 source(s)
[0m20:06:28.908039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_region"
[0m20:06:28.909074 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_region
[0m20:06:28.912856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_region"
[0m20:06:28.913570 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m20:06:28.913978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:30.076039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6b56c6f5-5c8a-41e6-829d-ea5e8eb14bfb&page=queryresults
[0m20:06:31.014481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:31.015860 [info ] [Thread-1 (]: 24 of 33 OK created sql view model dbt_dataset.hub_region ...................... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m20:06:31.016816 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_region
[0m20:06:31.017468 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_supplier
[0m20:06:31.018465 [info ] [Thread-1 (]: 25 of 33 START sql view model dbt_dataset.hub_supplier ......................... [RUN]
[0m20:06:31.019311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_region, now model.dbt_bq_sa.hub_supplier)
[0m20:06:31.019945 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_supplier
[0m20:06:31.031096 [info ] [Thread-1 (]: 20:06:31 + Loading trim-field-467501-p5.dbt_dataset.hub_supplier from 2 source(s)
[0m20:06:31.037415 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_supplier"
[0m20:06:31.038419 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_supplier
[0m20:06:31.042724 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_supplier"
[0m20:06:31.043572 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_supplier: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_supplier"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_supplier`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m20:06:31.044086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:32.101257 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:64e92fa4-e810-42f8-88fe-1a6fdbfcde7d&page=queryresults
[0m20:06:32.936318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:32.938435 [info ] [Thread-1 (]: 25 of 33 OK created sql view model dbt_dataset.hub_supplier .................... [[32mCREATE VIEW (0 processed)[0m in 1.92s]
[0m20:06:32.939847 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_supplier
[0m20:06:32.940722 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory
[0m20:06:32.941678 [info ] [Thread-1 (]: 26 of 33 START sql view model dbt_dataset.link_inventory ....................... [RUN]
[0m20:06:32.942563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_supplier, now model.dbt_bq_sa.link_inventory)
[0m20:06:32.943181 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory
[0m20:06:32.952402 [info ] [Thread-1 (]: 20:06:32 + Loading trim-field-467501-p5.dbt_dataset.link_inventory from 1 source(s)
[0m20:06:32.957773 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory"
[0m20:06:32.958733 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory
[0m20:06:32.964586 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory"
[0m20:06:32.965394 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:32.965883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:34.043225 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:5f2b7336-f4b5-49a5-8304-a5a253cb2285&page=queryresults
[0m20:06:34.849331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:34.850974 [info ] [Thread-1 (]: 26 of 33 OK created sql view model dbt_dataset.link_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 1.91s]
[0m20:06:34.851945 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory
[0m20:06:34.852647 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_nation_region
[0m20:06:34.853564 [info ] [Thread-1 (]: 27 of 33 START sql view model dbt_dataset.link_nation_region ................... [RUN]
[0m20:06:34.854421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory, now model.dbt_bq_sa.link_nation_region)
[0m20:06:34.855055 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_nation_region
[0m20:06:34.868885 [info ] [Thread-1 (]: 20:06:34 + Loading trim-field-467501-p5.dbt_dataset.link_nation_region from 2 source(s)
[0m20:06:34.875238 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_nation_region"
[0m20:06:34.876096 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_nation_region
[0m20:06:34.880930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_nation_region"
[0m20:06:34.881940 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_nation_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_nation_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_nation_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m20:06:34.882478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:36.232075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ff04a6d0-f615-4fd8-8b81-44330a832432&page=queryresults
[0m20:06:37.059125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:37.061113 [info ] [Thread-1 (]: 27 of 33 OK created sql view model dbt_dataset.link_nation_region .............. [[32mCREATE VIEW (0 processed)[0m in 2.20s]
[0m20:06:37.062653 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_nation_region
[0m20:06:37.063291 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_supplier_nation
[0m20:06:37.064124 [info ] [Thread-1 (]: 28 of 33 START sql view model dbt_dataset.link_supplier_nation ................. [RUN]
[0m20:06:37.064974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_nation_region, now model.dbt_bq_sa.link_supplier_nation)
[0m20:06:37.065598 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_supplier_nation
[0m20:06:37.079576 [info ] [Thread-1 (]: 20:06:37 + Loading trim-field-467501-p5.dbt_dataset.link_supplier_nation from 1 source(s)
[0m20:06:37.085168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_supplier_nation"
[0m20:06:37.086111 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_supplier_nation
[0m20:06:37.090743 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_supplier_nation"
[0m20:06:37.091683 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_supplier_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_supplier_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:37.092177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:38.270809 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:92ce8060-0622-4f94-82ca-3a23e7d48323&page=queryresults
[0m20:06:39.107433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:39.109280 [info ] [Thread-1 (]: 28 of 33 OK created sql view model dbt_dataset.link_supplier_nation ............ [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m20:06:39.110444 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_supplier_nation
[0m20:06:39.111096 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_inventory_details
[0m20:06:39.111984 [info ] [Thread-1 (]: 29 of 33 START sql view model dbt_dataset.sat_inv_inventory_details ............ [RUN]
[0m20:06:39.112809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_supplier_nation, now model.dbt_bq_sa.sat_inv_inventory_details)
[0m20:06:39.113425 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_inventory_details
[0m20:06:39.131114 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m20:06:39.132179 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_inventory_details
[0m20:06:39.137701 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m20:06:39.138527 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_inventory_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_inventory_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:39.139029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:40.187913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:20753a31-432e-4846-b20e-04b1a03556f1&page=queryresults
[0m20:06:41.131885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1421387f0>]}
[0m20:06:41.133490 [info ] [Thread-1 (]: 29 of 33 OK created sql view model dbt_dataset.sat_inv_inventory_details ....... [[32mCREATE VIEW (0 processed)[0m in 2.02s]
[0m20:06:41.134541 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_inventory_details
[0m20:06:41.135224 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_part_details
[0m20:06:41.136102 [info ] [Thread-1 (]: 30 of 33 START sql view model dbt_dataset.sat_inv_part_details ................. [RUN]
[0m20:06:41.136832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_inventory_details, now model.dbt_bq_sa.sat_inv_part_details)
[0m20:06:41.137405 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_part_details
[0m20:06:41.157045 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_part_details"
[0m20:06:41.158355 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_part_details
[0m20:06:41.162812 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_part_details"
[0m20:06:41.163950 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_part_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_part_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:41.164425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:42.299630 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:27d22f24-3db8-4600-83d2-89b5e35da421&page=queryresults
[0m20:06:43.127319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:43.129296 [info ] [Thread-1 (]: 30 of 33 OK created sql view model dbt_dataset.sat_inv_part_details ............ [[32mCREATE VIEW (0 processed)[0m in 1.99s]
[0m20:06:43.130242 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_part_details
[0m20:06:43.130899 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m20:06:43.131760 [info ] [Thread-1 (]: 31 of 33 START sql view model dbt_dataset.sat_inv_supp_nation_details .......... [RUN]
[0m20:06:43.132631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_part_details, now model.dbt_bq_sa.sat_inv_supp_nation_details)
[0m20:06:43.133240 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m20:06:43.151215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m20:06:43.152497 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m20:06:43.156784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m20:06:43.157562 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:43.158052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:44.517693 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:45d1ff90-52c4-4954-8af2-e16aedfb8cd6&page=queryresults
[0m20:06:45.370799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1421387f0>]}
[0m20:06:45.372625 [info ] [Thread-1 (]: 31 of 33 OK created sql view model dbt_dataset.sat_inv_supp_nation_details ..... [[32mCREATE VIEW (0 processed)[0m in 2.24s]
[0m20:06:45.373600 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m20:06:45.374232 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m20:06:45.375138 [info ] [Thread-1 (]: 32 of 33 START sql view model dbt_dataset.sat_inv_supp_region_details .......... [RUN]
[0m20:06:45.375957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_nation_details, now model.dbt_bq_sa.sat_inv_supp_region_details)
[0m20:06:45.376582 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_region_details
[0m20:06:45.392713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m20:06:45.393868 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_region_details
[0m20:06:45.399562 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m20:06:45.400383 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:45.400876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:46.416212 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:5af62d83-aeca-4718-9920-cd45d964c8ee&page=queryresults
[0m20:06:47.308109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1421387f0>]}
[0m20:06:47.309583 [info ] [Thread-1 (]: 32 of 33 OK created sql view model dbt_dataset.sat_inv_supp_region_details ..... [[32mCREATE VIEW (0 processed)[0m in 1.93s]
[0m20:06:47.310516 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m20:06:47.311157 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supplier_details
[0m20:06:47.312002 [info ] [Thread-1 (]: 33 of 33 START sql view model dbt_dataset.sat_inv_supplier_details ............. [RUN]
[0m20:06:47.312820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_region_details, now model.dbt_bq_sa.sat_inv_supplier_details)
[0m20:06:47.313435 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supplier_details
[0m20:06:47.330633 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m20:06:47.331678 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supplier_details
[0m20:06:47.335918 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m20:06:47.336800 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supplier_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supplier_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:47.337279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:48.523976 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:007725e7-ae52-4ef0-ab0a-0a72aa0bb076&page=queryresults
[0m20:06:49.407949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142400be0>]}
[0m20:06:49.409571 [info ] [Thread-1 (]: 33 of 33 OK created sql view model dbt_dataset.sat_inv_supplier_details ........ [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m20:06:49.410504 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supplier_details
[0m20:06:49.414450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:06:49.417220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:49.417627 [debug] [MainThread]: Connection 'model.dbt_bq_sa.sat_inv_supplier_details' was properly closed.
[0m20:06:49.418284 [info ] [MainThread]: 
[0m20:06:49.418739 [info ] [MainThread]: Finished running 33 view models in 0 hours 1 minutes and 15.74 seconds (75.74s).
[0m20:06:49.425187 [debug] [MainThread]: Command end result
[0m20:06:49.478030 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/manifest.json
[0m20:06:49.482432 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/semantic_manifest.json
[0m20:06:49.490609 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/run_results.json
[0m20:06:49.490947 [info ] [MainThread]: 
[0m20:06:49.491209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:06:49.491408 [info ] [MainThread]: 
[0m20:06:49.491852 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m20:06:49.496085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 78.65324, "process_in_blocks": "0", "process_kernel_time": 1.580839, "process_mem_max_rss": "344113152", "process_out_blocks": "0", "process_user_time": 7.166947}
[0m20:06:49.496732 [debug] [MainThread]: Command `dbt run` succeeded at 20:06:49.496674 after 78.65 seconds
[0m20:06:49.497032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056cf6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141bcab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e50250>]}
[0m20:06:49.497272 [debug] [MainThread]: Flushing usage events
[0m20:06:50.902550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:09.792983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3304f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a330bb0>]}


============================== 14:07:09.795932 | 55b3768c-c396-48ce-a9e5-14699aec73ef ==============================
[0m14:07:09.795932 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:07:09.796249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m hub_customer', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:09.796519 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:07:09.796717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55b3768c-c396-48ce-a9e5-14699aec73ef', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a5300>]}
[0m14:07:14.115128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55b3768c-c396-48ce-a9e5-14699aec73ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc5d50>]}
[0m14:07:14.147067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55b3768c-c396-48ce-a9e5-14699aec73ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a4940>]}
[0m14:07:14.147454 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m14:07:14.314848 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:07:14.426095 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 1 files changed.
[0m14:07:14.426494 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/eqqui_hub_customer.sql
[0m14:07:14.426678 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/stage/equi_v_stg_transaction.sql
[0m14:07:14.426838 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/equi_link_customer_nation.sql
[0m14:07:14.426978 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/stage/v_stg_inventory1.sql
[0m14:07:14.427114 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/stage/v_stg_inventory2.sql
[0m14:07:14.427298 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/hub_customer.sql
[0m14:07:14.590406 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.eqqui_hub_customer' (models/raw_vault/hubs/eqqui_hub_customer.sql) depends on a source named 'raw.v_stg_orders' which was not found
[0m14:07:14.591381 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:07:14.622001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.876288, "process_in_blocks": "0", "process_kernel_time": 1.064067, "process_mem_max_rss": "337723392", "process_out_blocks": "0", "process_user_time": 3.160642}
[0m14:07:14.622451 [debug] [MainThread]: Command `dbt run` failed at 14:07:14.622380 after 4.88 seconds
[0m14:07:14.622741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e0043d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16de81fc0>]}
[0m14:07:14.623061 [debug] [MainThread]: Flushing usage events
[0m14:07:15.823558 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:49.133427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10419f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fbfa0>]}


============================== 14:07:49.136352 | 89cf7d90-2e75-45d3-81d7-67b05477cedd ==============================
[0m14:07:49.136352 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:07:49.136665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:51.334319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89cf7d90-2e75-45d3-81d7-67b05477cedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102975d50>]}
[0m14:07:51.394098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89cf7d90-2e75-45d3-81d7-67b05477cedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105267a90>]}
[0m14:07:51.394612 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m14:07:51.571664 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:07:51.677373 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 1 files changed.
[0m14:07:51.677809 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/stage/equi_v_stg_transaction.sql
[0m14:07:51.678018 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/eqqui_hub_customer.sql
[0m14:07:51.678189 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/equi_link_customer_nation.sql
[0m14:07:51.678338 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/stage/v_stg_inventory2.sql
[0m14:07:51.678477 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/stage/v_stg_inventory1.sql
[0m14:07:51.678664 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/hub_customer.sql
[0m14:07:51.860262 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.equi_v_stg_transaction' (models/stage/equi_v_stg_transaction.sql) depends on a source named 'raw.raw_transactions' which was not found
[0m14:07:51.862164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7683115, "process_in_blocks": "0", "process_kernel_time": 0.964485, "process_mem_max_rss": "312737792", "process_out_blocks": "0", "process_user_time": 3.516051}
[0m14:07:51.862508 [debug] [MainThread]: Command `dbt run` failed at 14:07:51.862438 after 2.77 seconds
[0m14:07:51.862773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10419f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042fe350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f9ef610>]}
[0m14:07:51.863010 [debug] [MainThread]: Flushing usage events
[0m14:07:52.770922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:09.641155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119344c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111937f10>]}


============================== 14:10:09.644437 | 4d59c97c-e077-4225-a65d-6a8890fe6bae ==============================
[0m14:10:09.644437 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:10:09.644770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:11.533568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633a050>]}
[0m14:10:11.565876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153df01c0>]}
[0m14:10:11.566269 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m14:10:11.695536 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:10:11.802212 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 1 files changed.
[0m14:10:11.802558 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/stage/v_stg_inventory2.sql
[0m14:10:11.802718 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/stage/v_stg_inventory1.sql
[0m14:10:11.802944 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/hub_customer.sql
[0m14:10:11.972163 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.raw_stage
- models.raw_vault.links
- models.raw_vault.sats
- models.raw_vault.t_links
- models.raw_vault.hubs
- models.raw_vault
- models.stage
[0m14:10:11.982241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1559cd7b0>]}
[0m14:10:12.040848 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/manifest.json
[0m14:10:12.043250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/semantic_manifest.json
[0m14:10:12.055476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153eed000>]}
[0m14:10:12.055774 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m14:10:12.055957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153eed5d0>]}
[0m14:10:12.057316 [info ] [MainThread]: 
[0m14:10:12.057541 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:10:12.057693 [info ] [MainThread]: 
[0m14:10:12.057998 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:10:12.062187 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m14:10:12.062485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:12.895140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m14:10:12.896216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:13.828956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153d96a10>]}
[0m14:10:13.829995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:13.837469 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_orders
[0m14:10:13.838264 [info ] [Thread-1 (]: 1 of 31 START sql view model dbt_dataset.raw_orders ............................ [RUN]
[0m14:10:13.838914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_orders)
[0m14:10:13.839526 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_orders
[0m14:10:13.855749 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_orders"
[0m14:10:13.856879 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_orders
[0m14:10:13.883334 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_orders"
[0m14:10:13.884170 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
  OPTIONS()
  as SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`lineitem` AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON c.C_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m14:10:13.884578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:15.248133 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:314edebb-6e66-4a87-9405-1974a4f64b37&page=queryresults
[0m14:10:16.432877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154c13df0>]}
[0m14:10:16.433480 [info ] [Thread-1 (]: 1 of 31 OK created sql view model dbt_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.59s]
[0m14:10:16.433797 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_orders
[0m14:10:16.434016 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m14:10:16.434361 [info ] [Thread-1 (]: 2 of 31 START sql view model dbt_dataset.raw_transactions ...................... [RUN]
[0m14:10:16.434589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_orders, now model.dbt_bq_sa.raw_transactions)
[0m14:10:16.434775 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m14:10:16.436998 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m14:10:16.437359 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m14:10:16.439290 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m14:10:16.439912 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATE_ADD(b.O_ORDERDATE, INTERVAL 20 DAY) AS TRANSACTION_DATE,
    CAST(RPAD(CONCAT(CAST(b.O_ORDERKEY AS STRING), CAST(b.O_CUSTKEY AS STRING), FORMAT_DATE('%Y%m%d', b.O_ORDERDATE)), 24, '0') AS INT64) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
        CASE FLOOR(RAND() * 2) + 1
            WHEN 1 THEN 'DR'
            WHEN 2 THEN 'CR'
        END AS STRING) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m14:10:16.440157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:17.428099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:d31d0f5f-37ff-4383-b2d2-951904a8e025&page=queryresults
[0m14:10:18.335279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110115000>]}
[0m14:10:18.337011 [info ] [Thread-1 (]: 2 of 31 OK created sql view model dbt_dataset.raw_transactions ................. [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m14:10:18.337938 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m14:10:18.338604 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m14:10:18.339498 [info ] [Thread-1 (]: 3 of 31 START sql view model dbt_dataset.raw_inventory ......................... [RUN]
[0m14:10:18.340461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_transactions, now model.dbt_bq_sa.raw_inventory)
[0m14:10:18.341398 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m14:10:18.352463 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m14:10:18.353651 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m14:10:18.361368 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m14:10:18.362584 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`partsupp` AS a
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m14:10:18.363234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:19.835339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:aa80c2ac-0ec2-446f-9865-3f5a5191788b&page=queryresults
[0m14:10:20.673494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110115000>]}
[0m14:10:20.675423 [info ] [Thread-1 (]: 3 of 31 OK created sql view model dbt_dataset.raw_inventory .................... [[32mCREATE VIEW (0 processed)[0m in 2.33s]
[0m14:10:20.676722 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m14:10:20.677394 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_orders
[0m14:10:20.678295 [info ] [Thread-1 (]: 4 of 31 START sql view model dbt_dataset.v_stg_orders .......................... [RUN]
[0m14:10:20.679322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_inventory, now model.dbt_bq_sa.v_stg_orders)
[0m14:10:20.679910 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_orders
[0m14:10:20.719913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:22.307881 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_orders"
[0m14:10:22.309648 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_orders
[0m14:10:22.312627 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_orders"
[0m14:10:22.313976 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), '')))) AS STRING) AS ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS ORDER_CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINEITEM_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS LINK_LINEITEM_ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS INVENTORY_ALLOCATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS STRING))), ''), '^^')
    )))) AS STRING) AS LINEITEM_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS STRING))), ''), '^^')
    )))) AS STRING) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT * ,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE
FROM staging;


[0m14:10:23.344351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a8feca10-eec5-473b-abd6-0c8f8d41c658&page=queryresults
[0m14:10:24.319901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:24.327437 [info ] [Thread-1 (]: 4 of 31 OK created sql view model dbt_dataset.v_stg_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 3.64s]
[0m14:10:24.328805 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_orders
[0m14:10:24.329329 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m14:10:24.331111 [info ] [Thread-1 (]: 5 of 31 START sql view model dbt_dataset.v_stg_transactions .................... [RUN]
[0m14:10:24.333540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_orders, now model.dbt_bq_sa.v_stg_transactions)
[0m14:10:24.334430 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m14:10:24.351003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:25.894801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_transactions"
[0m14:10:25.898043 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_transactions
[0m14:10:25.905051 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_transactions"
[0m14:10:25.906033 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
  OPTIONS()
  as 







-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATE_ADD(TRANSACTION_DATE, INTERVAL 1 DAY) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS TRANSACTION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS STRING))), '')))) AS STRING) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m14:10:26.614868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:9036ef0b-3a01-4880-8692-d53e9580ccf3&page=queryresults
[0m14:10:27.467511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153f3e4a0>]}
[0m14:10:27.468353 [info ] [Thread-1 (]: 5 of 31 OK created sql view model dbt_dataset.v_stg_transactions ............... [[32mCREATE VIEW (0 processed)[0m in 3.14s]
[0m14:10:27.468798 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_transactions
[0m14:10:27.469101 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory
[0m14:10:27.469424 [info ] [Thread-1 (]: 6 of 31 START sql view model dbt_dataset.v_stg_inventory ....................... [RUN]
[0m14:10:27.470125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_transactions, now model.dbt_bq_sa.v_stg_inventory)
[0m14:10:27.470599 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory
[0m14:10:27.476981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:28.871953 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory"
[0m14:10:28.884869 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory
[0m14:10:28.921441 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory"
[0m14:10:28.923022 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m14:10:29.917428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:1570c1ce-ba6e-44fd-b4e9-4e6449f39c7f&page=queryresults
[0m14:10:30.966087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:30.967418 [info ] [Thread-1 (]: 6 of 31 OK created sql view model dbt_dataset.v_stg_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 3.50s]
[0m14:10:30.968179 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory
[0m14:10:30.968895 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_customer
[0m14:10:30.971316 [info ] [Thread-1 (]: 7 of 31 START sql incremental model dbt_dataset.hub_customer ................... [RUN]
[0m14:10:30.972122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory, now model.dbt_bq_sa.hub_customer)
[0m14:10:30.972914 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_customer
[0m14:10:31.000251 [info ] [Thread-1 (]: 14:10:30 + Loading trim-field-467501-p5.dbt_dataset.hub_customer from 1 source(s)
[0m14:10:31.003706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_customer"
[0m14:10:31.006041 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_customer
[0m14:10:31.034583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:31.864145 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_customer"
[0m14:10:31.866623 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_customer: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_customer"} */

  
    

    create or replace table `trim-field-467501-p5`.`dbt_dataset`.`hub_customer`
      
    
    

    
    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m14:10:32.854983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:50fca26e-9dca-404c-bf2b-b4b379c25f4a&page=queryresults
[0m14:10:38.899996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1559b4fd0>]}
[0m14:10:38.902268 [info ] [Thread-1 (]: 7 of 31 OK created sql incremental model dbt_dataset.hub_customer .............. [[32mCREATE TABLE (0.0 rows, 224.0 Bytes processed)[0m in 7.93s]
[0m14:10:38.902927 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_customer
[0m14:10:38.904078 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_lineitem
[0m14:10:38.906569 [info ] [Thread-1 (]: 8 of 31 START sql view model dbt_dataset.hub_lineitem .......................... [RUN]
[0m14:10:38.909203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_customer, now model.dbt_bq_sa.hub_lineitem)
[0m14:10:38.909995 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_lineitem
[0m14:10:38.924206 [info ] [Thread-1 (]: 14:10:38 + Loading trim-field-467501-p5.dbt_dataset.hub_lineitem from 1 source(s)
[0m14:10:38.928067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_lineitem"
[0m14:10:38.928854 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_lineitem
[0m14:10:38.935101 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_lineitem"
[0m14:10:38.936013 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:10:38.936385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:40.132563 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a661997a-e083-4382-a714-bf6566b7d872&page=queryresults
[0m14:10:41.049961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:41.051573 [info ] [Thread-1 (]: 8 of 31 OK created sql view model dbt_dataset.hub_lineitem ..................... [[32mCREATE VIEW (0 processed)[0m in 2.14s]
[0m14:10:41.052295 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_lineitem
[0m14:10:41.053887 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_order
[0m14:10:41.055312 [info ] [Thread-1 (]: 9 of 31 START sql view model dbt_dataset.hub_order ............................. [RUN]
[0m14:10:41.056062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_lineitem, now model.dbt_bq_sa.hub_order)
[0m14:10:41.056597 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_order
[0m14:10:41.062741 [info ] [Thread-1 (]: 14:10:41 + Loading trim-field-467501-p5.dbt_dataset.hub_order from 1 source(s)
[0m14:10:41.065887 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_order"
[0m14:10:41.067810 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_order
[0m14:10:41.072780 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_order"
[0m14:10:41.073851 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:10:41.074400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:42.198306 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:89e97041-3a43-468a-b733-8fa5cd83ac60&page=queryresults
[0m14:10:42.998051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:42.999527 [info ] [Thread-1 (]: 9 of 31 OK created sql view model dbt_dataset.hub_order ........................ [[32mCREATE VIEW (0 processed)[0m in 1.94s]
[0m14:10:43.000425 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_order
[0m14:10:43.001109 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_nation
[0m14:10:43.003988 [info ] [Thread-1 (]: 10 of 31 START sql view model dbt_dataset.link_customer_nation ................. [RUN]
[0m14:10:43.004733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_order, now model.dbt_bq_sa.link_customer_nation)
[0m14:10:43.005483 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_nation
[0m14:10:43.032495 [info ] [Thread-1 (]: 14:10:43 + Loading trim-field-467501-p5.dbt_dataset.link_customer_nation from 1 source(s)
[0m14:10:43.059005 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_nation"
[0m14:10:43.059859 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_nation
[0m14:10:43.070217 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_nation"
[0m14:10:43.071559 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:10:43.071940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:44.260336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:d3e9c9f2-eaf6-4ffa-a8a0-90b1b3185d7b&page=queryresults
[0m14:10:45.151567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f4f8e0>]}
[0m14:10:45.153010 [info ] [Thread-1 (]: 10 of 31 OK created sql view model dbt_dataset.link_customer_nation ............ [[32mCREATE VIEW (0 processed)[0m in 2.15s]
[0m14:10:45.153555 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_nation
[0m14:10:45.153876 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_order
[0m14:10:45.154654 [info ] [Thread-1 (]: 11 of 31 START sql view model dbt_dataset.link_customer_order .................. [RUN]
[0m14:10:45.155371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_nation, now model.dbt_bq_sa.link_customer_order)
[0m14:10:45.155690 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_order
[0m14:10:45.160849 [info ] [Thread-1 (]: 14:10:45 + Loading trim-field-467501-p5.dbt_dataset.link_customer_order from 1 source(s)
[0m14:10:45.164762 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_order"
[0m14:10:45.165499 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_order
[0m14:10:45.168465 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_order"
[0m14:10:45.169168 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:10:45.169481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:46.383055 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f1aef74c-b437-4eca-861f-aca441ba694e&page=queryresults
[0m14:10:47.230282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:47.231237 [info ] [Thread-1 (]: 11 of 31 OK created sql view model dbt_dataset.link_customer_order ............. [[32mCREATE VIEW (0 processed)[0m in 2.07s]
[0m14:10:47.231696 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_order
[0m14:10:47.232074 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory_allocation
[0m14:10:47.232690 [info ] [Thread-1 (]: 12 of 31 START sql view model dbt_dataset.link_inventory_allocation ............ [RUN]
[0m14:10:47.233169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_order, now model.dbt_bq_sa.link_inventory_allocation)
[0m14:10:47.233581 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory_allocation
[0m14:10:47.245861 [info ] [Thread-1 (]: 14:10:47 + Loading trim-field-467501-p5.dbt_dataset.link_inventory_allocation from 1 source(s)
[0m14:10:47.251379 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory_allocation"
[0m14:10:47.252571 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory_allocation
[0m14:10:47.256173 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory_allocation"
[0m14:10:47.257300 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory_allocation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory_allocation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:10:47.257996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:48.336406 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:c2a8293d-6398-40fb-93fb-56523ca3cfc6&page=queryresults
[0m14:10:49.236150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:49.237237 [info ] [Thread-1 (]: 12 of 31 OK created sql view model dbt_dataset.link_inventory_allocation ....... [[32mCREATE VIEW (0 processed)[0m in 2.00s]
[0m14:10:49.237772 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory_allocation
[0m14:10:49.238097 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_order_lineitem
[0m14:10:49.238417 [info ] [Thread-1 (]: 13 of 31 START sql view model dbt_dataset.link_order_lineitem .................. [RUN]
[0m14:10:49.238755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory_allocation, now model.dbt_bq_sa.link_order_lineitem)
[0m14:10:49.239090 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_order_lineitem
[0m14:10:49.243196 [info ] [Thread-1 (]: 14:10:49 + Loading trim-field-467501-p5.dbt_dataset.link_order_lineitem from 1 source(s)
[0m14:10:49.245782 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_order_lineitem"
[0m14:10:49.247630 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_order_lineitem
[0m14:10:49.252121 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_order_lineitem"
[0m14:10:49.252858 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_order_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_order_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:10:49.254024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:50.423704 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:2be49f0f-dedc-48a4-b69a-c6f4a301f9dd&page=queryresults
[0m14:10:51.282750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f355d0>]}
[0m14:10:51.283830 [info ] [Thread-1 (]: 13 of 31 OK created sql view model dbt_dataset.link_order_lineitem ............. [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m14:10:51.284345 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_order_lineitem
[0m14:10:51.284744 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m14:10:51.285509 [info ] [Thread-1 (]: 14 of 31 START sql view model dbt_dataset.sat_order_cust_nation_details ........ [RUN]
[0m14:10:51.286047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_order_lineitem, now model.dbt_bq_sa.sat_order_cust_nation_details)
[0m14:10:51.286387 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_nation_details
[0m14:10:51.329313 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m14:10:51.330183 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_nation_details
[0m14:10:51.332822 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m14:10:51.333335 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:10:51.333793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:52.822757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:40efbf2d-1809-4aa4-8ffb-db62ab8df793&page=queryresults
[0m14:10:53.622082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:53.623353 [info ] [Thread-1 (]: 14 of 31 OK created sql view model dbt_dataset.sat_order_cust_nation_details ... [[32mCREATE VIEW (0 processed)[0m in 2.34s]
[0m14:10:53.624171 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m14:10:53.624539 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_region_details
[0m14:10:53.625032 [info ] [Thread-1 (]: 15 of 31 START sql view model dbt_dataset.sat_order_cust_region_details ........ [RUN]
[0m14:10:53.625433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_nation_details, now model.dbt_bq_sa.sat_order_cust_region_details)
[0m14:10:53.625711 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_region_details
[0m14:10:53.634206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m14:10:53.635141 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_region_details
[0m14:10:53.640900 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m14:10:53.642591 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:10:53.643018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:54.741848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:5d509d1b-6eb3-48e6-86d4-11f155f6713a&page=queryresults
[0m14:10:55.594266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f3d810>]}
[0m14:10:55.595571 [info ] [Thread-1 (]: 15 of 31 OK created sql view model dbt_dataset.sat_order_cust_region_details ... [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m14:10:55.597162 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_region_details
[0m14:10:55.599008 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_customer_details
[0m14:10:55.600074 [info ] [Thread-1 (]: 16 of 31 START sql view model dbt_dataset.sat_order_customer_details ........... [RUN]
[0m14:10:55.600673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_region_details, now model.dbt_bq_sa.sat_order_customer_details)
[0m14:10:55.601050 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_customer_details
[0m14:10:55.615034 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_customer_details"
[0m14:10:55.616668 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_customer_details
[0m14:10:55.620728 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_customer_details"
[0m14:10:55.621621 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_customer_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_customer_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:10:55.622049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:56.694838 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4a929187-6438-4904-8153-bed15529e588&page=queryresults
[0m14:10:57.548522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f3c070>]}
[0m14:10:57.555429 [info ] [Thread-1 (]: 16 of 31 OK created sql view model dbt_dataset.sat_order_customer_details ...... [[32mCREATE VIEW (0 processed)[0m in 1.95s]
[0m14:10:57.556435 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_customer_details
[0m14:10:57.557011 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_lineitem_details
[0m14:10:57.557876 [info ] [Thread-1 (]: 17 of 31 START sql view model dbt_dataset.sat_order_lineitem_details ........... [RUN]
[0m14:10:57.558416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_customer_details, now model.dbt_bq_sa.sat_order_lineitem_details)
[0m14:10:57.558792 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_lineitem_details
[0m14:10:57.584014 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m14:10:57.585313 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_lineitem_details
[0m14:10:57.589518 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m14:10:57.590403 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_lineitem_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_lineitem_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:10:57.590807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:58.740913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:3719a9ec-14cb-4143-bd8f-e7cce2189cfc&page=queryresults
[0m14:10:59.928684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:59.930221 [info ] [Thread-1 (]: 17 of 31 OK created sql view model dbt_dataset.sat_order_lineitem_details ...... [[32mCREATE VIEW (0 processed)[0m in 2.37s]
[0m14:10:59.936141 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_lineitem_details
[0m14:10:59.937358 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_order_details
[0m14:10:59.938281 [info ] [Thread-1 (]: 18 of 31 START sql view model dbt_dataset.sat_order_order_details .............. [RUN]
[0m14:10:59.939203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_lineitem_details, now model.dbt_bq_sa.sat_order_order_details)
[0m14:10:59.939820 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_order_details
[0m14:10:59.950852 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_order_details"
[0m14:10:59.951655 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_order_details
[0m14:10:59.954170 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_order_details"
[0m14:10:59.954928 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_order_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_order_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:10:59.955221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:01.044132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:46b6b12a-12c8-4d81-907a-7ce274c4b9ac&page=queryresults
[0m14:11:01.875095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155fa4dc0>]}
[0m14:11:01.876910 [info ] [Thread-1 (]: 18 of 31 OK created sql view model dbt_dataset.sat_order_order_details ......... [[32mCREATE VIEW (0 processed)[0m in 1.93s]
[0m14:11:01.877387 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_order_details
[0m14:11:01.877752 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.t_link_transactions
[0m14:11:01.878334 [info ] [Thread-1 (]: 19 of 31 START sql view model dbt_dataset.t_link_transactions .................. [RUN]
[0m14:11:01.878847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_order_details, now model.dbt_bq_sa.t_link_transactions)
[0m14:11:01.879173 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.t_link_transactions
[0m14:11:01.907866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.t_link_transactions"
[0m14:11:01.908855 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.t_link_transactions
[0m14:11:01.911589 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.t_link_transactions"
[0m14:11:01.912074 [debug] [Thread-1 (]: On model.dbt_bq_sa.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.t_link_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`t_link_transactions`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert;


[0m14:11:01.912353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:03.034865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:606cf555-d693-4963-909e-39b166944b08&page=queryresults
[0m14:11:03.844173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:11:03.845453 [info ] [Thread-1 (]: 19 of 31 OK created sql view model dbt_dataset.t_link_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m14:11:03.845942 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.t_link_transactions
[0m14:11:03.846412 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_nation
[0m14:11:03.847134 [info ] [Thread-1 (]: 20 of 31 START sql view model dbt_dataset.hub_nation ........................... [RUN]
[0m14:11:03.847600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.t_link_transactions, now model.dbt_bq_sa.hub_nation)
[0m14:11:03.847897 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_nation
[0m14:11:03.862238 [info ] [Thread-1 (]: 14:11:03 + Loading trim-field-467501-p5.dbt_dataset.hub_nation from 2 source(s)
[0m14:11:03.867341 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_nation"
[0m14:11:03.868163 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_nation
[0m14:11:03.875355 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_nation"
[0m14:11:03.876193 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m14:11:03.876616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:04.988502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f853c7cc-2432-42f0-ad0d-cfae1f060f50&page=queryresults
[0m14:11:05.821094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:11:05.822335 [info ] [Thread-1 (]: 20 of 31 OK created sql view model dbt_dataset.hub_nation ...................... [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m14:11:05.823174 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_nation
[0m14:11:05.823881 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_part
[0m14:11:05.824676 [info ] [Thread-1 (]: 21 of 31 START sql view model dbt_dataset.hub_part ............................. [RUN]
[0m14:11:05.825191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_nation, now model.dbt_bq_sa.hub_part)
[0m14:11:05.825575 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_part
[0m14:11:05.830422 [info ] [Thread-1 (]: 14:11:05 + Loading trim-field-467501-p5.dbt_dataset.hub_part from 2 source(s)
[0m14:11:05.842173 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_part"
[0m14:11:05.842777 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_part
[0m14:11:05.845497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_part"
[0m14:11:05.846015 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_part: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_part"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_part`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m14:11:05.846343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:06.988895 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:197cf831-f459-4457-963e-2f582b356313&page=queryresults
[0m14:11:07.832614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e83760>]}
[0m14:11:07.834121 [info ] [Thread-1 (]: 21 of 31 OK created sql view model dbt_dataset.hub_part ........................ [[32mCREATE VIEW (0 processed)[0m in 2.01s]
[0m14:11:07.835296 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_part
[0m14:11:07.835935 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_region
[0m14:11:07.836429 [info ] [Thread-1 (]: 22 of 31 START sql view model dbt_dataset.hub_region ........................... [RUN]
[0m14:11:07.836830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_part, now model.dbt_bq_sa.hub_region)
[0m14:11:07.837085 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_region
[0m14:11:07.841410 [info ] [Thread-1 (]: 14:11:07 + Loading trim-field-467501-p5.dbt_dataset.hub_region from 2 source(s)
[0m14:11:07.844557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_region"
[0m14:11:07.845808 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_region
[0m14:11:07.848621 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_region"
[0m14:11:07.849460 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m14:11:07.849806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:08.995697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:30b7a3bf-7916-4e1a-b291-d4b18f66beaa&page=queryresults
[0m14:11:09.895284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e86f20>]}
[0m14:11:09.897424 [info ] [Thread-1 (]: 22 of 31 OK created sql view model dbt_dataset.hub_region ...................... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m14:11:09.898256 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_region
[0m14:11:09.898662 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_supplier
[0m14:11:09.899211 [info ] [Thread-1 (]: 23 of 31 START sql view model dbt_dataset.hub_supplier ......................... [RUN]
[0m14:11:09.899768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_region, now model.dbt_bq_sa.hub_supplier)
[0m14:11:09.900143 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_supplier
[0m14:11:09.906000 [info ] [Thread-1 (]: 14:11:09 + Loading trim-field-467501-p5.dbt_dataset.hub_supplier from 2 source(s)
[0m14:11:09.911476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_supplier"
[0m14:11:09.912325 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_supplier
[0m14:11:09.916009 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_supplier"
[0m14:11:09.916918 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_supplier: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_supplier"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_supplier`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m14:11:09.917467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:10.980560 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:9c47ae3f-6e81-49de-b792-0433716fe291&page=queryresults
[0m14:11:11.767366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155eabf40>]}
[0m14:11:13.079349 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m14:11:13.087945 [info ] [Thread-1 (]: 23 of 31 OK created sql view model dbt_dataset.hub_supplier .................... [[32mCREATE VIEW (0 processed)[0m in 1.87s]
[0m14:11:13.090343 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_supplier
[0m14:11:13.091918 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory
[0m14:11:13.093151 [info ] [Thread-1 (]: 24 of 31 START sql view model dbt_dataset.link_inventory ....................... [RUN]
[0m14:11:13.094579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_supplier, now model.dbt_bq_sa.link_inventory)
[0m14:11:13.096786 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory
[0m14:11:13.128658 [info ] [Thread-1 (]: 14:11:13 + Loading trim-field-467501-p5.dbt_dataset.link_inventory from 1 source(s)
[0m14:11:13.139153 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory"
[0m14:11:13.141408 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory
[0m14:11:13.150835 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory"
[0m14:11:13.151540 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:11:13.151895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:14.337246 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b0a4c65d-48b5-4d12-a09f-d25fb29759d7&page=queryresults
[0m14:11:15.128998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155eabf40>]}
[0m14:11:15.130106 [info ] [Thread-1 (]: 24 of 31 OK created sql view model dbt_dataset.link_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 2.03s]
[0m14:11:15.130536 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory
[0m14:11:15.130871 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_nation_region
[0m14:11:15.131566 [info ] [Thread-1 (]: 25 of 31 START sql view model dbt_dataset.link_nation_region ................... [RUN]
[0m14:11:15.131946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory, now model.dbt_bq_sa.link_nation_region)
[0m14:11:15.132194 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_nation_region
[0m14:11:15.138515 [info ] [Thread-1 (]: 14:11:15 + Loading trim-field-467501-p5.dbt_dataset.link_nation_region from 2 source(s)
[0m14:11:15.142409 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_nation_region"
[0m14:11:15.143040 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_nation_region
[0m14:11:15.146373 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_nation_region"
[0m14:11:15.147210 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_nation_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_nation_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_nation_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m14:11:15.147907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:16.212237 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:dbd5b8fa-47d6-4cc4-99a9-d53bfee1dbb6&page=queryresults
[0m14:11:17.089407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156163f40>]}
[0m14:11:17.089990 [info ] [Thread-1 (]: 25 of 31 OK created sql view model dbt_dataset.link_nation_region .............. [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m14:11:17.090395 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_nation_region
[0m14:11:17.090668 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_supplier_nation
[0m14:11:17.090976 [info ] [Thread-1 (]: 26 of 31 START sql view model dbt_dataset.link_supplier_nation ................. [RUN]
[0m14:11:17.091264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_nation_region, now model.dbt_bq_sa.link_supplier_nation)
[0m14:11:17.091689 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_supplier_nation
[0m14:11:17.099532 [info ] [Thread-1 (]: 14:11:17 + Loading trim-field-467501-p5.dbt_dataset.link_supplier_nation from 1 source(s)
[0m14:11:17.102484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_supplier_nation"
[0m14:11:17.103070 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_supplier_nation
[0m14:11:17.105907 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_supplier_nation"
[0m14:11:17.106477 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_supplier_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_supplier_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:11:17.106752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:18.222855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4aa358e0-bce9-4f19-950e-b0982e365b3e&page=queryresults
[0m14:11:19.145021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155eb3730>]}
[0m14:11:19.146476 [info ] [Thread-1 (]: 26 of 31 OK created sql view model dbt_dataset.link_supplier_nation ............ [[32mCREATE VIEW (0 processed)[0m in 2.05s]
[0m14:11:19.147861 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_supplier_nation
[0m14:11:19.148323 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_inventory_details
[0m14:11:19.148815 [info ] [Thread-1 (]: 27 of 31 START sql view model dbt_dataset.sat_inv_inventory_details ............ [RUN]
[0m14:11:19.149198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_supplier_nation, now model.dbt_bq_sa.sat_inv_inventory_details)
[0m14:11:19.149451 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_inventory_details
[0m14:11:19.158497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m14:11:19.159194 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_inventory_details
[0m14:11:19.162850 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m14:11:19.163608 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_inventory_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_inventory_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:11:19.163915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:20.196776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:33d93cbf-00b0-4d3a-add5-3c7911fafeb7&page=queryresults
[0m14:11:21.189794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156163f40>]}
[0m14:11:21.191155 [info ] [Thread-1 (]: 27 of 31 OK created sql view model dbt_dataset.sat_inv_inventory_details ....... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m14:11:21.191691 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_inventory_details
[0m14:11:21.191996 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_part_details
[0m14:11:21.192952 [info ] [Thread-1 (]: 28 of 31 START sql view model dbt_dataset.sat_inv_part_details ................. [RUN]
[0m14:11:21.193621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_inventory_details, now model.dbt_bq_sa.sat_inv_part_details)
[0m14:11:21.193946 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_part_details
[0m14:11:21.206629 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_part_details"
[0m14:11:21.207955 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_part_details
[0m14:11:21.214835 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_part_details"
[0m14:11:21.215473 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_part_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_part_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:11:21.215747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:22.324159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6ca019ae-5945-41c4-a82f-0ea4b94ab27b&page=queryresults
[0m14:11:23.096115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1561b04f0>]}
[0m14:11:23.097897 [info ] [Thread-1 (]: 28 of 31 OK created sql view model dbt_dataset.sat_inv_part_details ............ [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m14:11:23.098802 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_part_details
[0m14:11:23.099483 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m14:11:23.100268 [info ] [Thread-1 (]: 29 of 31 START sql view model dbt_dataset.sat_inv_supp_nation_details .......... [RUN]
[0m14:11:23.100787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_part_details, now model.dbt_bq_sa.sat_inv_supp_nation_details)
[0m14:11:23.101088 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m14:11:23.110068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m14:11:23.111818 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m14:11:23.114553 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m14:11:23.115078 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:11:23.115383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:24.313799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f0840e19-1be5-4fad-b834-15070ff3f443&page=queryresults
[0m14:11:25.484356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15619a920>]}
[0m14:11:25.486219 [info ] [Thread-1 (]: 29 of 31 OK created sql view model dbt_dataset.sat_inv_supp_nation_details ..... [[32mCREATE VIEW (0 processed)[0m in 2.38s]
[0m14:11:25.487336 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m14:11:25.488562 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m14:11:25.490151 [info ] [Thread-1 (]: 30 of 31 START sql view model dbt_dataset.sat_inv_supp_region_details .......... [RUN]
[0m14:11:25.491187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_nation_details, now model.dbt_bq_sa.sat_inv_supp_region_details)
[0m14:11:25.492033 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_region_details
[0m14:11:25.504111 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m14:11:25.505256 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_region_details
[0m14:11:25.507828 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m14:11:25.508825 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:11:25.509115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:26.772255 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:2c32a91a-971a-4624-a50b-c37f8fcd7060&page=queryresults
[0m14:11:27.691986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155ecd7b0>]}
[0m14:11:27.694521 [info ] [Thread-1 (]: 30 of 31 OK created sql view model dbt_dataset.sat_inv_supp_region_details ..... [[32mCREATE VIEW (0 processed)[0m in 2.20s]
[0m14:11:27.695390 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m14:11:27.695945 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supplier_details
[0m14:11:27.696545 [info ] [Thread-1 (]: 31 of 31 START sql view model dbt_dataset.sat_inv_supplier_details ............. [RUN]
[0m14:11:27.696930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_region_details, now model.dbt_bq_sa.sat_inv_supplier_details)
[0m14:11:27.697180 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supplier_details
[0m14:11:27.725560 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m14:11:27.733708 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supplier_details
[0m14:11:27.767132 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m14:11:27.771502 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supplier_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supplier_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:11:27.776775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:28.905007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:e9d4427d-f2ff-4576-8357-7aca3089a665&page=queryresults
[0m14:11:29.785661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1561fabf0>]}
[0m14:11:29.786894 [info ] [Thread-1 (]: 31 of 31 OK created sql view model dbt_dataset.sat_inv_supplier_details ........ [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m14:11:29.787809 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supplier_details
[0m14:11:29.792454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:29.794232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:29.794544 [debug] [MainThread]: Connection 'model.dbt_bq_sa.sat_inv_supplier_details' was properly closed.
[0m14:11:29.795296 [info ] [MainThread]: 
[0m14:11:29.795785 [info ] [MainThread]: Finished running 1 incremental model, 30 view models in 0 hours 1 minutes and 17.74 seconds (77.74s).
[0m14:11:29.798986 [debug] [MainThread]: Command end result
[0m14:11:29.835916 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/manifest.json
[0m14:11:29.844444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/semantic_manifest.json
[0m14:11:29.867074 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/run_results.json
[0m14:11:29.867385 [info ] [MainThread]: 
[0m14:11:29.867816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:29.868166 [info ] [MainThread]: 
[0m14:11:29.868373 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=31
[0m14:11:29.872933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 80.27878, "process_in_blocks": "0", "process_kernel_time": 1.956144, "process_mem_max_rss": "343703552", "process_out_blocks": "0", "process_user_time": 6.313053}
[0m14:11:29.873896 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:29.873831 after 80.28 seconds
[0m14:11:29.874605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153df01c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154acbdf0>]}
[0m14:11:29.874825 [debug] [MainThread]: Flushing usage events
[0m14:11:30.784207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:27.343597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a0b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b301f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b308b0>]}


============================== 10:35:27.346676 | 618d1e9f-6969-4c41-b30f-3a3878fd45db ==============================
[0m10:35:27.346676 [info ] [MainThread]: Running with dbt=1.10.7
[0m10:35:27.346998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:35:27.428636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '618d1e9f-6969-4c41-b30f-3a3878fd45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c42560>]}
[0m10:35:27.474919 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-yyfbi_tx'
[0m10:35:27.475197 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:35:27.581958 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:35:27.582605 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m10:35:28.091597 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m10:35:28.099646 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:35:28.164310 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:35:28.173500 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m10:35:28.701361 [info ] [MainThread]: Installed from version 0.9.7
[0m10:35:28.701838 [info ] [MainThread]: Updated version available: 0.11.2
[0m10:35:28.702201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '618d1e9f-6969-4c41-b30f-3a3878fd45db', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104305690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d03c40>]}
[0m10:35:28.702613 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:35:29.147458 [info ] [MainThread]: Installed from version 1.3.0
[0m10:35:29.147774 [info ] [MainThread]: Up to date!
[0m10:35:29.148021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '618d1e9f-6969-4c41-b30f-3a3878fd45db', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103380a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d03c40>]}
[0m10:35:29.148290 [info ] [MainThread]: 
[0m10:35:29.148489 [info ] [MainThread]: Updates available for packages: ['Datavault-UK/automate_dv']                 
Update your versions in packages.yml, then run dbt deps
[0m10:35:29.182590 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8849363, "process_in_blocks": "0", "process_kernel_time": 0.254441, "process_mem_max_rss": "109740032", "process_out_blocks": "0", "process_user_time": 0.873805}
[0m10:35:29.183068 [debug] [MainThread]: Command `dbt deps` succeeded at 10:35:29.182986 after 1.89 seconds
[0m10:35:29.183350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a0b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c407f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c405e0>]}
[0m10:35:29.183612 [debug] [MainThread]: Flushing usage events
[0m10:35:30.375009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:36:08.545974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fe76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105138850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051381c0>]}


============================== 10:36:08.549225 | f098c068-05eb-4492-9f36-356736e13a07 ==============================
[0m10:36:08.549225 [info ] [MainThread]: Running with dbt=1.10.7
[0m10:36:08.549552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models path:models/stage', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:36:08.549808 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m10:36:08.549987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f098c068-05eb-4492-9f36-356736e13a07', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104140c10>]}
[0m10:36:10.741931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f098c068-05eb-4492-9f36-356736e13a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028e9d50>]}
[0m10:36:10.773196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f098c068-05eb-4492-9f36-356736e13a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f8f1d50>]}
[0m10:36:10.773550 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m10:36:10.933234 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m10:36:10.992778 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:36:10.993099 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:36:10.993316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f098c068-05eb-4492-9f36-356736e13a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a02c80>]}
[0m10:36:12.013150 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m10:36:12.013770 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:36:12.015327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.516037, "process_in_blocks": "0", "process_kernel_time": 1.22489, "process_mem_max_rss": "337625088", "process_out_blocks": "0", "process_user_time": 3.769034}
[0m10:36:12.015702 [debug] [MainThread]: Command `dbt run` failed at 10:36:12.015641 after 3.52 seconds
[0m10:36:12.015922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fe76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1412ab3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14140da50>]}
[0m10:36:12.016126 [debug] [MainThread]: Flushing usage events
[0m10:36:13.054885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:39:09.759407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550ca90>]}


============================== 10:39:09.762404 | d0c03998-6836-4286-a26a-b20112852542 ==============================
[0m10:39:09.762404 [info ] [MainThread]: Running with dbt=1.10.7
[0m10:39:09.762754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m dbt_stg_trips', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:39:09.763009 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m10:39:09.763206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd0c03998-6836-4286-a26a-b20112852542', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547a3b0>]}
[0m10:39:11.522345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0c03998-6836-4286-a26a-b20112852542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158399030>]}
[0m10:39:11.553904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0c03998-6836-4286-a26a-b20112852542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158411630>]}
[0m10:39:11.554260 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m10:39:11.690002 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m10:39:11.746537 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:39:11.746853 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:39:11.747051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0c03998-6836-4286-a26a-b20112852542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dcfb20>]}
[0m10:39:12.824600 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m10:39:12.825224 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:39:12.827083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1085887, "process_in_blocks": "0", "process_kernel_time": 1.192384, "process_mem_max_rss": "337772544", "process_out_blocks": "0", "process_user_time": 3.698072}
[0m10:39:12.827598 [debug] [MainThread]: Command `dbt run` failed at 10:39:12.827532 after 3.11 seconds
[0m10:39:12.827863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1588446d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158d0d0c0>]}
[0m10:39:12.830068 [debug] [MainThread]: Flushing usage events
[0m10:39:13.914870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:41:40.161009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066343d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106634a90>]}


============================== 10:41:40.163917 | 7e5b66ca-86c1-421f-8668-d293d235e227 ==============================
[0m10:41:40.163917 [info ] [MainThread]: Running with dbt=1.10.7
[0m10:41:40.164236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select path:models/stage', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:41:42.041621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e5b66ca-86c1-421f-8668-d293d235e227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102821d50>]}
[0m10:41:42.072984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e5b66ca-86c1-421f-8668-d293d235e227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105683100>]}
[0m10:41:42.073369 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m10:41:42.198972 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m10:41:42.255487 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:41:42.255829 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:41:42.256032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e5b66ca-86c1-421f-8668-d293d235e227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055fbb20>]}
[0m10:41:43.273616 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m10:41:43.275210 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.156394, "process_in_blocks": "0", "process_kernel_time": 1.392145, "process_mem_max_rss": "338034688", "process_out_blocks": "0", "process_user_time": 3.652967}
[0m10:41:43.275590 [debug] [MainThread]: Command `dbt run` failed at 10:41:43.275526 after 3.16 seconds
[0m10:41:43.275822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168539570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16930d990>]}
[0m10:41:43.276030 [debug] [MainThread]: Flushing usage events
[0m10:41:44.214922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:03.831966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084876a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dc580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dfd60>]}


============================== 10:44:03.835038 | 7f8c2ee4-4e94-447f-b1e0-9d8bd1de55ca ==============================
[0m10:44:03.835038 [info ] [MainThread]: Running with dbt=1.10.7
[0m10:44:03.835377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:44:03.918529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f8c2ee4-4e94-447f-b1e0-9d8bd1de55ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dd9c0>]}
[0m10:44:03.929694 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-0k3kwp0v'
[0m10:44:03.929966 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:44:04.037635 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:44:04.038291 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m10:44:04.382587 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m10:44:04.394047 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:44:04.486659 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:44:04.507577 [info ] [MainThread]: Updating lock file in file path: /Users/rishin/PycharmProjects/automate-dv-demo-5.4/package-lock.yml
[0m10:44:04.550440 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-0drzfb94'
[0m10:44:04.554522 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m10:44:04.974081 [info ] [MainThread]: Installed from version 0.11.2
[0m10:44:04.974522 [info ] [MainThread]: Up to date!
[0m10:44:04.974837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7f8c2ee4-4e94-447f-b1e0-9d8bd1de55ca', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109847190>]}
[0m10:44:04.975192 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:44:05.449827 [info ] [MainThread]: Installed from version 1.3.0
[0m10:44:05.450248 [info ] [MainThread]: Up to date!
[0m10:44:05.450509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7f8c2ee4-4e94-447f-b1e0-9d8bd1de55ca', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d16c0>]}
[0m10:44:05.452308 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.6619674, "process_in_blocks": "0", "process_kernel_time": 0.216322, "process_mem_max_rss": "109920256", "process_out_blocks": "0", "process_user_time": 0.852134}
[0m10:44:05.452674 [debug] [MainThread]: Command `dbt deps` succeeded at 10:44:05.452600 after 1.66 seconds
[0m10:44:05.452921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084876a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dd9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a7880>]}
[0m10:44:05.453157 [debug] [MainThread]: Flushing usage events
[0m10:44:06.579821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:32.063502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079307c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079301f0>]}


============================== 10:44:32.066401 | f4af6494-1c90-4e69-bb87-5c49752c8151 ==============================
[0m10:44:32.066401 [info ] [MainThread]: Running with dbt=1.10.7
[0m10:44:32.066729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select path:models/stage', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:44:33.954420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4af6494-1c90-4e69-bb87-5c49752c8151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106129a20>]}
[0m10:44:33.986111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4af6494-1c90-4e69-bb87-5c49752c8151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a4a90>]}
[0m10:44:33.986487 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m10:44:34.121515 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m10:44:34.176808 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:44:34.177153 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:44:34.177315 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:44:34.177488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4af6494-1c90-4e69-bb87-5c49752c8151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fbb20>]}
[0m10:44:35.193988 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m10:44:35.195418 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1719587, "process_in_blocks": "0", "process_kernel_time": 1.13718, "process_mem_max_rss": "337608704", "process_out_blocks": "0", "process_user_time": 3.825295}
[0m10:44:35.195793 [debug] [MainThread]: Command `dbt run` failed at 10:44:35.195733 after 3.17 seconds
[0m10:44:35.196008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1629a5b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162d23340>]}
[0m10:44:35.196206 [debug] [MainThread]: Flushing usage events
[0m10:44:36.273800 [debug] [MainThread]: An error was encountered while trying to flush usage events
