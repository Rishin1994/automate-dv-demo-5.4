[0m21:04:45.276166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f17e0>]}


============================== 21:04:45.279117 | c58a28b6-f745-4b4f-a862-de7a88b70a5d ==============================
[0m21:04:45.279117 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:04:45.279434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m21:04:45.287760 [info ] [MainThread]: dbt version: 1.10.7
[0m21:04:45.288040 [info ] [MainThread]: python version: 3.10.8
[0m21:04:45.288199 [info ] [MainThread]: python path: /Users/rishin/bin/python
[0m21:04:45.288348 [info ] [MainThread]: os info: macOS-12.5-arm64-arm-64bit
[0m21:04:45.294581 [info ] [MainThread]: Using profiles dir at /Users/rishin/.dbt
[0m21:04:45.294955 [info ] [MainThread]: Using profiles.yml file at /Users/rishin/.dbt/profiles.yml
[0m21:04:45.295157 [info ] [MainThread]: Using dbt_project.yml file at /Users/rishin/Downloads/automate-dv-demo-5.4/dbt_project.yml
[0m21:04:45.357697 [info ] [MainThread]: Configuration:
[0m21:04:45.358100 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m21:04:45.358273 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:04:45.358423 [info ] [MainThread]: Required dependencies:
[0m21:04:45.358627 [debug] [MainThread]: Executing "git --help"
[0m21:04:45.924148 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:04:45.925040 [debug] [MainThread]: STDERR: "b''"
[0m21:04:45.925276 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:04:45.925470 [info ] [MainThread]: Connection test skipped since no profile was found
[0m21:04:45.925639 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:04:45.925791 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'dbtvault_snowflake_demo'


[0m21:04:45.927596 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.6971695, "process_in_blocks": "0", "process_kernel_time": 0.071794, "process_mem_max_rss": "106692608", "process_out_blocks": "0", "process_user_time": 0.730742}
[0m21:04:45.928074 [debug] [MainThread]: Command `dbt debug` failed at 21:04:45.927997 after 0.70 seconds
[0m21:04:45.928521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769f6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108146da0>]}
[0m21:04:45.928848 [debug] [MainThread]: Flushing usage events
[0m21:04:47.067132 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:06:34.496648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11829b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e304c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e33dc0>]}


============================== 21:06:34.499827 | 0e5bcd50-2e33-446d-9f8e-a7d0023fed15 ==============================
[0m21:06:34.499827 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:06:34.500179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:06:34.507320 [info ] [MainThread]: dbt version: 1.10.7
[0m21:06:34.507515 [info ] [MainThread]: python version: 3.10.8
[0m21:06:34.507661 [info ] [MainThread]: python path: /Users/rishin/bin/python
[0m21:06:34.507806 [info ] [MainThread]: os info: macOS-12.5-arm64-arm-64bit
[0m21:06:36.318297 [info ] [MainThread]: Using profiles dir at /Users/rishin/.dbt
[0m21:06:36.318634 [info ] [MainThread]: Using profiles.yml file at /Users/rishin/.dbt/profiles.yml
[0m21:06:36.318798 [info ] [MainThread]: Using dbt_project.yml file at /Users/rishin/Downloads/automate-dv-demo-5.4/dbt_project.yml
[0m21:06:36.318961 [info ] [MainThread]: adapter type: bigquery
[0m21:06:36.319123 [info ] [MainThread]: adapter version: 1.10.1
[0m21:06:36.377186 [info ] [MainThread]: Configuration:
[0m21:06:36.377486 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:06:36.377646 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:06:36.377797 [info ] [MainThread]: Required dependencies:
[0m21:06:36.378111 [debug] [MainThread]: Executing "git --help"
[0m21:06:36.400468 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:06:36.401431 [debug] [MainThread]: STDERR: "b''"
[0m21:06:36.401661 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:06:36.401951 [info ] [MainThread]: Connection:
[0m21:06:36.402348 [info ] [MainThread]:   method: service-account
[0m21:06:36.402501 [info ] [MainThread]:   database: trim-field-467501-p5
[0m21:06:36.402638 [info ] [MainThread]:   execution_project: trim-field-467501-p5
[0m21:06:36.402773 [info ] [MainThread]:   schema: dbt_dataset
[0m21:06:36.402906 [info ] [MainThread]:   location: US
[0m21:06:36.403040 [info ] [MainThread]:   priority: interactive
[0m21:06:36.403171 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:06:36.403300 [info ] [MainThread]:   impersonate_service_account: None
[0m21:06:36.403433 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:06:36.403562 [info ] [MainThread]:   job_retries: 1
[0m21:06:36.403691 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:06:36.403819 [info ] [MainThread]:   job_execution_timeout_seconds: 200
[0m21:06:36.403948 [info ] [MainThread]:   timeout_seconds: 200
[0m21:06:36.404076 [info ] [MainThread]:   client_id: None
[0m21:06:36.404218 [info ] [MainThread]:   token_uri: None
[0m21:06:36.404348 [info ] [MainThread]:   compute_region: None
[0m21:06:36.404478 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:06:36.404610 [info ] [MainThread]:   gcs_bucket: None
[0m21:06:36.404737 [info ] [MainThread]:   dataproc_batch: None
[0m21:06:36.405200 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:06:36.520108 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:06:36.520750 [debug] [MainThread]: On debug: select 1 as id
[0m21:06:36.520968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:06:37.556719 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7800381c-8a63-4ce7-bec5-175a751e28d2&page=queryresults
[0m21:06:38.539720 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:06:38.541652 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:06:38.546363 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.093456, "process_in_blocks": "0", "process_kernel_time": 1.218343, "process_mem_max_rss": "341147648", "process_out_blocks": "0", "process_user_time": 2.814127}
[0m21:06:38.547522 [debug] [MainThread]: Command `dbt debug` succeeded at 21:06:38.547294 after 4.09 seconds
[0m21:06:38.548201 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:06:38.548922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11829b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1540061a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154006fe0>]}
[0m21:06:38.549633 [debug] [MainThread]: Flushing usage events
[0m21:06:39.539488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:50.666321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127534f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11443c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11443ca90>]}


============================== 21:19:50.669503 | 8b8fb621-b11a-41bd-ac7d-8a056016d051 ==============================
[0m21:19:50.669503 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:19:50.669820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:19:52.510050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b8fb621-b11a-41bd-ac7d-8a056016d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1747c7d60>]}
[0m21:19:52.541618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b8fb621-b11a-41bd-ac7d-8a056016d051', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143a9de0>]}
[0m21:19:52.541982 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:19:52.653924 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m21:19:52.655452 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.0343, "process_in_blocks": "0", "process_kernel_time": 1.463974, "process_mem_max_rss": "334872576", "process_out_blocks": "0", "process_user_time": 2.407334}
[0m21:19:52.655976 [debug] [MainThread]: Command `dbt build` failed at 21:19:52.655919 after 2.03 seconds
[0m21:19:52.656229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127534f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x175161600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x175162650>]}
[0m21:19:52.656444 [debug] [MainThread]: Flushing usage events
[0m21:19:53.720428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:31:13.956188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060436d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107194550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107197d90>]}


============================== 21:31:13.959484 | b41ed890-99eb-46cc-8340-8f97a1f19b39 ==============================
[0m21:31:13.959484 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:31:13.959870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:14.046863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b41ed890-99eb-46cc-8340-8f97a1f19b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5dff0>]}
[0m21:31:14.057145 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-iqj2l5o_'
[0m21:31:14.057442 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:31:14.235473 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:31:14.236035 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m21:31:14.947852 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m21:31:14.960919 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:31:15.055159 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:31:15.071112 [info ] [MainThread]: Updating lock file in file path: /Users/rishin/Downloads/automate-dv-demo-5.4/package-lock.yml
[0m21:31:15.075716 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-21blr00g'
[0m21:31:15.081029 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m21:31:15.839480 [info ] [MainThread]: Installed from version 0.9.7
[0m21:31:15.840043 [info ] [MainThread]: Updated version available: 0.11.2
[0m21:31:15.840456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b41ed890-99eb-46cc-8340-8f97a1f19b39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106369690>]}
[0m21:31:15.840911 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:31:16.215383 [info ] [MainThread]: Installed from version 1.3.0
[0m21:31:16.215754 [info ] [MainThread]: Up to date!
[0m21:31:16.216040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b41ed890-99eb-46cc-8340-8f97a1f19b39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107367a00>]}
[0m21:31:16.216338 [info ] [MainThread]: 
[0m21:31:16.216602 [info ] [MainThread]: Updates available for packages: ['Datavault-UK/automate_dv']                 
Update your versions in packages.yml, then run dbt deps
[0m21:31:16.218449 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.3111784, "process_in_blocks": "0", "process_kernel_time": 0.177379, "process_mem_max_rss": "109412352", "process_out_blocks": "0", "process_user_time": 0.840065}
[0m21:31:16.218826 [debug] [MainThread]: Command `dbt deps` succeeded at 21:31:16.218746 after 2.31 seconds
[0m21:31:16.219126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060436d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636a0e0>]}
[0m21:31:16.219395 [debug] [MainThread]: Flushing usage events
[0m21:31:17.224804 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:31:34.479405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10934fe50>]}


============================== 21:31:34.484633 | 5bced37a-ea71-4a3c-8caf-151678e065cb ==============================
[0m21:31:34.484633 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:31:34.485027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_inventory', 'send_anonymous_usage_stats': 'True'}
[0m21:31:34.485342 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:31:34.485529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108354c10>]}
[0m21:31:36.204494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109318100>]}
[0m21:31:36.236375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133270040>]}
[0m21:31:36.236753 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:31:36.358458 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:31:36.358967 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:31:36.359201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142347af0>]}
[0m21:31:37.957223 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
[0m21:31:37.963950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143de6170>]}
[0m21:31:38.022097 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:31:38.024092 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:31:38.036285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143e79f90>]}
[0m21:31:38.036651 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:31:38.036846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143e7bb20>]}
[0m21:31:38.037773 [info ] [MainThread]: 
[0m21:31:38.037971 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:31:38.038122 [info ] [MainThread]: 
[0m21:31:38.038387 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:31:38.038870 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:31:38.039078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:38.963657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:31:38.964472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:31:39.864030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db9b40>]}
[0m21:31:39.865708 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:39.872962 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m21:31:39.873915 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_inventory .......................... [RUN]
[0m21:31:39.874679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_inventory)
[0m21:31:39.875227 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m21:31:39.889818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m21:31:39.891076 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m21:31:39.919642 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m21:31:39.920613 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`PARTSUPP` AS a
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`SUPPLIER` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`PART` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`NATION` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`REGION` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m21:31:39.920990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:31:40.884056 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:02b0bd15-1590-483f-9ec2-939767be901f&page=queryresults
[0m21:31:40.886111 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:02b0bd15-1590-483f-9ec2-939767be901f&page=queryresults
[0m21:31:40.898254 [debug] [Thread-1 (]: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Invalid project ID 'SNOWFLAKE_SAMPLE_DATA'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:31:40.901591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bced37a-ea71-4a3c-8caf-151678e065cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143e8df00>]}
[0m21:31:40.902812 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_inventory ................. [[31mERROR[0m in 1.02s]
[0m21:31:40.903975 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m21:31:40.904798 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_inventory' to be skipped because of status 'error'.  Reason: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Invalid project ID 'SNOWFLAKE_SAMPLE_DATA'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql.
[0m21:31:40.906963 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:31:40.909269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:40.909749 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_inventory' was properly closed.
[0m21:31:40.910182 [info ] [MainThread]: 
[0m21:31:40.910585 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m21:31:40.911392 [debug] [MainThread]: Command end result
[0m21:31:40.956927 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:31:40.958317 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:31:40.962417 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:31:40.962636 [info ] [MainThread]: 
[0m21:31:40.962883 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:31:40.963072 [info ] [MainThread]: 
[0m21:31:40.963302 [error] [MainThread]: [31mFailure in model raw_inventory (models/raw_stage/raw_inventory.sql)[0m
[0m21:31:40.963523 [error] [MainThread]:   Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Invalid project ID 'SNOWFLAKE_SAMPLE_DATA'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:31:40.963691 [info ] [MainThread]: 
[0m21:31:40.963886 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:31:40.964046 [info ] [MainThread]: 
[0m21:31:40.964226 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:31:40.964536 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:31:40.965981 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.5326943, "process_in_blocks": "0", "process_kernel_time": 1.365275, "process_mem_max_rss": "357744640", "process_out_blocks": "0", "process_user_time": 4.501855}
[0m21:31:40.966265 [debug] [MainThread]: Command `dbt run` failed at 21:31:40.966215 after 6.53 seconds
[0m21:31:40.966495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077877c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a12170>]}
[0m21:31:40.966705 [debug] [MainThread]: Flushing usage events
[0m21:31:42.032730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:34:17.021478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066306d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106633be0>]}


============================== 21:34:17.024723 | a3c573ad-29fc-4b43-8656-ca03fc35986b ==============================
[0m21:34:17.024723 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:34:17.025113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:34:17.032486 [info ] [MainThread]: dbt version: 1.10.7
[0m21:34:17.032681 [info ] [MainThread]: python version: 3.10.8
[0m21:34:17.032827 [info ] [MainThread]: python path: /Users/rishin/bin/python
[0m21:34:17.032965 [info ] [MainThread]: os info: macOS-12.5-arm64-arm-64bit
[0m21:34:18.666318 [info ] [MainThread]: Using profiles dir at /Users/rishin/.dbt
[0m21:34:18.666617 [info ] [MainThread]: Using profiles.yml file at /Users/rishin/.dbt/profiles.yml
[0m21:34:18.666784 [info ] [MainThread]: Using dbt_project.yml file at /Users/rishin/Downloads/automate-dv-demo-5.4/dbt_project.yml
[0m21:34:18.666949 [info ] [MainThread]: adapter type: bigquery
[0m21:34:18.667090 [info ] [MainThread]: adapter version: 1.10.1
[0m21:34:18.725323 [info ] [MainThread]: Configuration:
[0m21:34:18.725622 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:34:18.725790 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:34:18.725936 [info ] [MainThread]: Required dependencies:
[0m21:34:18.726135 [debug] [MainThread]: Executing "git --help"
[0m21:34:19.275875 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:34:19.276812 [debug] [MainThread]: STDERR: "b''"
[0m21:34:19.277085 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:34:19.277360 [info ] [MainThread]: Connection:
[0m21:34:19.277723 [info ] [MainThread]:   method: service-account
[0m21:34:19.278040 [info ] [MainThread]:   database: trim-field-467501-p5
[0m21:34:19.278349 [info ] [MainThread]:   execution_project: trim-field-467501-p5
[0m21:34:19.278508 [info ] [MainThread]:   schema: dbt_dataset
[0m21:34:19.278658 [info ] [MainThread]:   location: US
[0m21:34:19.278797 [info ] [MainThread]:   priority: interactive
[0m21:34:19.278937 [info ] [MainThread]:   maximum_bytes_billed: None
[0m21:34:19.279071 [info ] [MainThread]:   impersonate_service_account: None
[0m21:34:19.279203 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m21:34:19.279334 [info ] [MainThread]:   job_retries: 1
[0m21:34:19.279466 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m21:34:19.279598 [info ] [MainThread]:   job_execution_timeout_seconds: 200
[0m21:34:19.279732 [info ] [MainThread]:   timeout_seconds: 200
[0m21:34:19.279861 [info ] [MainThread]:   client_id: None
[0m21:34:19.279986 [info ] [MainThread]:   token_uri: None
[0m21:34:19.280118 [info ] [MainThread]:   compute_region: None
[0m21:34:19.280386 [info ] [MainThread]:   dataproc_cluster_name: None
[0m21:34:19.280603 [info ] [MainThread]:   gcs_bucket: None
[0m21:34:19.280751 [info ] [MainThread]:   dataproc_batch: None
[0m21:34:19.281306 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:34:19.390421 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m21:34:19.391019 [debug] [MainThread]: On debug: select 1 as id
[0m21:34:19.391203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:34:20.620420 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f85891f4-2e05-4142-ad7e-36f6362b22cd&page=queryresults
[0m21:34:21.600995 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:34:21.602772 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:34:21.606932 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.630367, "process_in_blocks": "0", "process_kernel_time": 1.270676, "process_mem_max_rss": "336445440", "process_out_blocks": "0", "process_user_time": 2.704301}
[0m21:34:21.607807 [debug] [MainThread]: Command `dbt debug` succeeded at 21:34:21.607620 after 4.63 seconds
[0m21:34:21.608362 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:34:21.608950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1590062f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1590053c0>]}
[0m21:34:21.609592 [debug] [MainThread]: Flushing usage events
[0m21:34:22.609410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:03.543805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038a36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ffe50>]}


============================== 21:35:03.546956 | 0ac41305-a19f-4e3d-9f5b-5e0999277910 ==============================
[0m21:35:03.546956 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:35:03.547278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m raw_inventory', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:35:03.547575 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:35:03.547759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a04c10>]}
[0m21:35:05.310335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125f71c60>]}
[0m21:35:05.345073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125fadbd0>]}
[0m21:35:05.346353 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:35:05.468944 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:35:05.568977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:05.569242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:05.573475 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_vault.t_links
[0m21:35:05.593280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363fc130>]}
[0m21:35:05.653666 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:35:05.655461 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:35:05.668054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1361847f0>]}
[0m21:35:05.668367 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:35:05.668547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1361876a0>]}
[0m21:35:05.669377 [info ] [MainThread]: 
[0m21:35:05.669576 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:35:05.669720 [info ] [MainThread]: 
[0m21:35:05.669986 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:35:05.670464 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:35:05.670688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:06.624814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:35:06.625693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:07.541725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b71c0>]}
[0m21:35:07.542662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:07.549146 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m21:35:07.549986 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_inventory .......................... [RUN]
[0m21:35:07.550659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_inventory)
[0m21:35:07.551206 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m21:35:07.567006 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m21:35:07.568168 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m21:35:07.596841 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m21:35:07.597636 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`PARTSUPP` AS a
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`SUPPLIER` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`PART` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`NATION` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `SNOWFLAKE_SAMPLE_DATA`.`TPCH_SF10`.`REGION` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m21:35:07.598013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:08.552584 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:398dcb9a-d90b-4302-a424-046bfdd97596&page=queryresults
[0m21:35:08.554506 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:398dcb9a-d90b-4302-a424-046bfdd97596&page=queryresults
[0m21:35:08.566235 [debug] [Thread-1 (]: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Invalid project ID 'SNOWFLAKE_SAMPLE_DATA'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:35:08.569636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac41305-a19f-4e3d-9f5b-5e0999277910', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032fa380>]}
[0m21:35:08.570595 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_inventory ................. [[31mERROR[0m in 1.02s]
[0m21:35:08.571381 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m21:35:08.572028 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_inventory' to be skipped because of status 'error'.  Reason: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Invalid project ID 'SNOWFLAKE_SAMPLE_DATA'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql.
[0m21:35:08.574175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:35:08.576456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:08.576900 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_inventory' was properly closed.
[0m21:35:08.577280 [info ] [MainThread]: 
[0m21:35:08.577666 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m21:35:08.578491 [debug] [MainThread]: Command end result
[0m21:35:08.622068 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:35:08.623765 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:35:08.628078 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:35:08.628287 [info ] [MainThread]: 
[0m21:35:08.628518 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:35:08.628802 [info ] [MainThread]: 
[0m21:35:08.629063 [error] [MainThread]: [31mFailure in model raw_inventory (models/raw_stage/raw_inventory.sql)[0m
[0m21:35:08.629301 [error] [MainThread]:   Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Invalid project ID 'SNOWFLAKE_SAMPLE_DATA'. Project IDs must contain 6-63 lowercase letters, digits, or dashes. Some project IDs also include domain name separated by a colon. IDs must start with a letter and may not end with a dash.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:35:08.629485 [info ] [MainThread]: 
[0m21:35:08.629691 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:35:08.629856 [info ] [MainThread]: 
[0m21:35:08.630040 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:35:08.630396 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:35:08.631895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.1298575, "process_in_blocks": "0", "process_kernel_time": 1.221223, "process_mem_max_rss": "340017152", "process_out_blocks": "0", "process_user_time": 3.21887}
[0m21:35:08.632238 [debug] [MainThread]: Command `dbt run` failed at 21:35:08.632183 after 5.13 seconds
[0m21:35:08.632490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038a36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125fadbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103971360>]}
[0m21:35:08.632732 [debug] [MainThread]: Flushing usage events
[0m21:35:09.791917 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:38:15.092797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e17760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6cb80>]}


============================== 21:38:15.095919 | 5e9408ac-9365-42c6-8950-6d20890b15c3 ==============================
[0m21:38:15.095919 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:38:15.096251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m raw_inventory', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:38:15.096514 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:38:15.096692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edd3c0>]}
[0m21:38:16.839385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151e74a60>]}
[0m21:38:16.871593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b8f10>]}
[0m21:38:16.871972 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:38:16.995978 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:38:17.096421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:38:17.097699 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/schema.yml
[0m21:38:17.716980 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault
[0m21:38:17.723485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1535d5990>]}
[0m21:38:17.778477 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:38:17.780027 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:38:17.791834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1535d7ca0>]}
[0m21:38:17.792143 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:38:17.792319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1535d6860>]}
[0m21:38:17.793154 [info ] [MainThread]: 
[0m21:38:17.793338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:38:17.793475 [info ] [MainThread]: 
[0m21:38:17.793740 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:38:17.794261 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:38:17.794472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:38:18.725173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:38:18.725988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:38:19.636317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047db9d0>]}
[0m21:38:19.637961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:38:19.644884 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m21:38:19.645774 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_inventory .......................... [RUN]
[0m21:38:19.646480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_inventory)
[0m21:38:19.647035 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m21:38:19.661302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m21:38:19.662909 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m21:38:19.691047 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m21:38:19.692099 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `my-first-project-123`.`dbt_dataset`.`PARTSUPP` AS a
LEFT JOIN `my-first-project-123`.`dbt_dataset`.`SUPPLIER` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `my-first-project-123`.`dbt_dataset`.`PART` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `my-first-project-123`.`dbt_dataset`.`NATION` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `my-first-project-123`.`dbt_dataset`.`REGION` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m21:38:19.692479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:38:20.760712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f746e075-d3a8-4b98-9fde-136fd5188bf1&page=queryresults
[0m21:38:20.761585 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f746e075-d3a8-4b98-9fde-136fd5188bf1&page=queryresults
[0m21:38:20.768886 [debug] [Thread-1 (]: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Access Denied: Table my-first-project-123:dbt_dataset.NATION: User does not have permission to query table my-first-project-123:dbt_dataset.NATION, or perhaps it does not exist.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:38:20.770853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e9408ac-9365-42c6-8950-6d20890b15c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106160190>]}
[0m21:38:20.771520 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_inventory ................. [[31mERROR[0m in 1.12s]
[0m21:38:20.772050 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m21:38:20.772506 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_inventory' to be skipped because of status 'error'.  Reason: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Access Denied: Table my-first-project-123:dbt_dataset.NATION: User does not have permission to query table my-first-project-123:dbt_dataset.NATION, or perhaps it does not exist.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql.
[0m21:38:20.774102 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:38:20.775926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:38:20.776317 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_inventory' was properly closed.
[0m21:38:20.776624 [info ] [MainThread]: 
[0m21:38:20.776920 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m21:38:20.777499 [debug] [MainThread]: Command end result
[0m21:38:20.812942 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:38:20.814108 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:38:20.817828 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:38:20.818021 [info ] [MainThread]: 
[0m21:38:20.818237 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:38:20.818409 [info ] [MainThread]: 
[0m21:38:20.818619 [error] [MainThread]: [31mFailure in model raw_inventory (models/raw_stage/raw_inventory.sql)[0m
[0m21:38:20.818822 [error] [MainThread]:   Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Access Denied: Table my-first-project-123:dbt_dataset.NATION: User does not have permission to query table my-first-project-123:dbt_dataset.NATION, or perhaps it does not exist.
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:38:20.818983 [info ] [MainThread]: 
[0m21:38:20.819161 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:38:20.819308 [info ] [MainThread]: 
[0m21:38:20.819473 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:38:20.819759 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:38:20.821090 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.7746763, "process_in_blocks": "0", "process_kernel_time": 1.219333, "process_mem_max_rss": "364888064", "process_out_blocks": "0", "process_user_time": 3.785026}
[0m21:38:20.821355 [debug] [MainThread]: Command `dbt run` failed at 21:38:20.821308 after 5.77 seconds
[0m21:38:20.821580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e17760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15363fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15354d210>]}
[0m21:38:20.821780 [debug] [MainThread]: Flushing usage events
[0m21:38:21.984287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:39:43.340652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109568850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095697b0>]}


============================== 21:39:43.343569 | 4e3f5011-16a0-496d-a24c-e231fa72c98b ==============================
[0m21:39:43.343569 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:39:43.343883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m raw_inventory', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:39:43.344139 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:39:43.344316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094e0fa0>]}
[0m21:39:45.053180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164ba1f60>]}
[0m21:39:45.085231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e65fc0>]}
[0m21:39:45.085605 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:39:45.212290 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:39:45.311827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:39:45.313044 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/schema.yml
[0m21:39:45.931117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.stage
[0m21:39:45.937587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1659d91e0>]}
[0m21:39:45.991786 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:39:45.993571 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:39:46.006340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1654a6ec0>]}
[0m21:39:46.006642 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:39:46.006824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1654a4e50>]}
[0m21:39:46.007657 [info ] [MainThread]: 
[0m21:39:46.007835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:39:46.007972 [info ] [MainThread]: 
[0m21:39:46.008218 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:39:46.008654 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:39:46.008849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:46.820419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:39:46.821311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:39:47.663934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164b6c370>]}
[0m21:39:47.665255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:39:47.671837 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m21:39:47.672737 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_inventory .......................... [RUN]
[0m21:39:47.673428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_inventory)
[0m21:39:47.673985 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m21:39:47.688458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m21:39:47.689859 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m21:39:47.717819 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m21:39:47.718866 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`PARTSUPP` AS a
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`SUPPLIER` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`PART` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`NATION` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`REGION` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m21:39:47.719265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:48.733935 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:8afd5458-29de-449d-bd3c-a7779a6adf75&page=queryresults
[0m21:39:48.752966 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:8afd5458-29de-449d-bd3c-a7779a6adf75&page=queryresults
[0m21:39:48.778894 [debug] [Thread-1 (]: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.NATION was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:39:48.790266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e3f5011-16a0-496d-a24c-e231fa72c98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108765000>]}
[0m21:39:48.808581 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_inventory ................. [[31mERROR[0m in 1.11s]
[0m21:39:48.809548 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m21:39:48.810286 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_inventory' to be skipped because of status 'error'.  Reason: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.NATION was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql.
[0m21:39:48.812748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:39:48.815378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:48.815882 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_inventory' was properly closed.
[0m21:39:48.816353 [info ] [MainThread]: 
[0m21:39:48.816820 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m21:39:48.817804 [debug] [MainThread]: Command end result
[0m21:39:48.866462 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:39:48.867939 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:39:48.872270 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:39:48.872498 [info ] [MainThread]: 
[0m21:39:48.872760 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:39:48.872967 [info ] [MainThread]: 
[0m21:39:48.873227 [error] [MainThread]: [31mFailure in model raw_inventory (models/raw_stage/raw_inventory.sql)[0m
[0m21:39:48.873474 [error] [MainThread]:   Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.NATION was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:39:48.873655 [info ] [MainThread]: 
[0m21:39:48.873872 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:39:48.874051 [info ] [MainThread]: 
[0m21:39:48.874254 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:39:48.874592 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:39:48.876007 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.5762105, "process_in_blocks": "0", "process_kernel_time": 1.547226, "process_mem_max_rss": "360169472", "process_out_blocks": "0", "process_user_time": 3.488193}
[0m21:39:48.876331 [debug] [MainThread]: Command `dbt run` failed at 21:39:48.876270 after 5.58 seconds
[0m21:39:48.876577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e65fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164b6c370>]}
[0m21:39:48.876811 [debug] [MainThread]: Flushing usage events
[0m21:39:50.150227 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:40:20.057823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ef6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092445e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109244ca0>]}


============================== 21:40:20.060732 | 277dad1a-f7e2-49e6-8d20-cd5fa81de805 ==============================
[0m21:40:20.060732 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:40:20.061054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m raw_inventory', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:40:20.061313 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:40:20.061493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '277dad1a-f7e2-49e6-8d20-cd5fa81de805', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b9390>]}
[0m21:40:21.752572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '277dad1a-f7e2-49e6-8d20-cd5fa81de805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106829d50>]}
[0m21:40:21.784315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '277dad1a-f7e2-49e6-8d20-cd5fa81de805', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b68070>]}
[0m21:40:21.784695 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:40:21.906557 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:40:22.004890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:40:22.006107 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/schema.yml
[0m21:40:22.593402 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.raw_inventory' (models/raw_stage/raw_inventory.sql) depends on a source named 'tpch_sample.NATION' which was not found
[0m21:40:22.593814 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:40:22.595533 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5789478, "process_in_blocks": "0", "process_kernel_time": 1.107629, "process_mem_max_rss": "355041280", "process_out_blocks": "0", "process_user_time": 3.455176}
[0m21:40:22.595781 [debug] [MainThread]: Command `dbt run` failed at 21:40:22.595728 after 2.58 seconds
[0m21:40:22.595976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ef6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155207400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155214370>]}
[0m21:40:22.596172 [debug] [MainThread]: Flushing usage events
[0m21:40:23.740531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:43:07.897789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb8940>]}


============================== 21:43:07.901111 | b162905c-25d2-4f3f-aa55-cdfd2eb24bca ==============================
[0m21:43:07.901111 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:43:07.901531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m raw_inventory', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:43:07.901884 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:43:07.902098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f25300>]}
[0m21:43:09.690819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6cc40>]}
[0m21:43:09.723006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102887430>]}
[0m21:43:09.723383 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:43:09.844744 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:43:09.954307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:43:09.954581 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:43:09.958944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_stage
[0m21:43:09.978974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150120130>]}
[0m21:43:10.035084 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:43:10.037228 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:43:10.049359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146db77f0>]}
[0m21:43:10.049664 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:43:10.049851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146db7070>]}
[0m21:43:10.050678 [info ] [MainThread]: 
[0m21:43:10.050866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:43:10.051009 [info ] [MainThread]: 
[0m21:43:10.051275 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:43:10.051900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:43:10.052101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:43:10.959496 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:43:10.960354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:43:11.808573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6f1f0>]}
[0m21:43:11.810149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:43:11.817126 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m21:43:11.818051 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_inventory .......................... [RUN]
[0m21:43:11.818801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_inventory)
[0m21:43:11.819353 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m21:43:11.835996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m21:43:11.837125 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m21:43:11.865767 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m21:43:11.866531 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`PARTSUPP` AS a
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`SUPPLIER` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`PART` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`NATION` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`REGION` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m21:43:11.866916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:43:13.009761 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:47bd8862-865d-4254-9002-9fe396bc2e2d&page=queryresults
[0m21:43:13.012458 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:47bd8862-865d-4254-9002-9fe396bc2e2d&page=queryresults
[0m21:43:13.022783 [debug] [Thread-1 (]: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.NATION was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:43:13.025535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b162905c-25d2-4f3f-aa55-cdfd2eb24bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146a54160>]}
[0m21:43:13.026485 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_inventory ................. [[31mERROR[0m in 1.20s]
[0m21:43:13.027213 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m21:43:13.027848 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_inventory' to be skipped because of status 'error'.  Reason: Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.NATION was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql.
[0m21:43:13.030080 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:43:13.032102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:13.032455 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_inventory' was properly closed.
[0m21:43:13.032802 [info ] [MainThread]: 
[0m21:43:13.033159 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m21:43:13.033845 [debug] [MainThread]: Command end result
[0m21:43:13.075036 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:43:13.076330 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:43:13.081011 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:43:13.081223 [info ] [MainThread]: 
[0m21:43:13.081460 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:43:13.081647 [info ] [MainThread]: 
[0m21:43:13.081874 [error] [MainThread]: [31mFailure in model raw_inventory (models/raw_stage/raw_inventory.sql)[0m
[0m21:43:13.082096 [error] [MainThread]:   Database Error in model raw_inventory (models/raw_stage/raw_inventory.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.NATION was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:43:13.082266 [info ] [MainThread]: 
[0m21:43:13.082464 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_inventory.sql
[0m21:43:13.082626 [info ] [MainThread]: 
[0m21:43:13.082810 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:43:13.083129 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:43:13.084474 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.232894, "process_in_blocks": "0", "process_kernel_time": 1.245371, "process_mem_max_rss": "342769664", "process_out_blocks": "0", "process_user_time": 3.194874}
[0m21:43:13.084782 [debug] [MainThread]: Command `dbt run` failed at 21:43:13.084723 after 5.23 seconds
[0m21:43:13.085025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150122470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032cc160>]}
[0m21:43:13.085253 [debug] [MainThread]: Flushing usage events
[0m21:43:14.236013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:44:20.619033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107130310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071309d0>]}


============================== 21:44:20.622816 | db4eb0d3-b16c-4efc-a94a-802b82029e1e ==============================
[0m21:44:20.622816 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:44:20.623166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m raw_transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:44:20.623436 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:44:20.623621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10709a950>]}
[0m21:44:22.406080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d1d50>]}
[0m21:44:22.437898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070981c0>]}
[0m21:44:22.438288 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:44:22.569060 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:44:22.665844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:44:22.666112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:44:22.670419 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_stage
[0m21:44:22.690128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140e24130>]}
[0m21:44:22.749666 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:44:22.751862 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:44:22.763748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140db6d70>]}
[0m21:44:22.764055 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:44:22.764235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140db74c0>]}
[0m21:44:22.765071 [info ] [MainThread]: 
[0m21:44:22.765267 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:44:22.765410 [info ] [MainThread]: 
[0m21:44:22.765672 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:44:22.766133 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:44:22.766331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:23.679050 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:44:23.679899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:44:24.592554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e3190>]}
[0m21:44:24.593570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:44:24.599160 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m21:44:24.600027 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_transactions ....................... [RUN]
[0m21:44:24.600744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_transactions)
[0m21:44:24.601300 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m21:44:24.616650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m21:44:24.619994 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m21:44:24.649481 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m21:44:24.650381 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`ORDERS`  AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`CUSTOMER` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08');


[0m21:44:24.650763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:44:25.630702 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a9c05548-14cf-41b1-8070-fb87968709cd&page=queryresults
[0m21:44:25.632141 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a9c05548-14cf-41b1-8070-fb87968709cd&page=queryresults
[0m21:44:25.643498 [debug] [Thread-1 (]: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:44:25.646635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db4eb0d3-b16c-4efc-a94a-802b82029e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140957e20>]}
[0m21:44:25.647744 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_transactions .............. [[31mERROR[0m in 1.04s]
[0m21:44:25.648683 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m21:44:25.649376 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_transactions' to be skipped because of status 'error'.  Reason: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql.
[0m21:44:25.651608 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:44:25.653944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:44:25.654630 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_transactions' was properly closed.
[0m21:44:25.655211 [info ] [MainThread]: 
[0m21:44:25.655684 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m21:44:25.656527 [debug] [MainThread]: Command end result
[0m21:44:25.700693 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:44:25.702158 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:44:25.707081 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:44:25.707282 [info ] [MainThread]: 
[0m21:44:25.707514 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:44:25.707699 [info ] [MainThread]: 
[0m21:44:25.707932 [error] [MainThread]: [31mFailure in model raw_transactions (models/raw_stage/raw_transactions.sql)[0m
[0m21:44:25.708152 [error] [MainThread]:   Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:44:25.708322 [info ] [MainThread]: 
[0m21:44:25.708526 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:44:25.708689 [info ] [MainThread]: 
[0m21:44:25.708875 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:44:25.709207 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:44:25.710542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.135398, "process_in_blocks": "0", "process_kernel_time": 1.309837, "process_mem_max_rss": "344883200", "process_out_blocks": "0", "process_user_time": 3.135076}
[0m21:44:25.710815 [debug] [MainThread]: Command `dbt run` failed at 21:44:25.710763 after 5.14 seconds
[0m21:44:25.711055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fcf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070981c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140db5d80>]}
[0m21:44:25.711278 [debug] [MainThread]: Flushing usage events
[0m21:44:26.656509 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:46:16.765966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abf700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c1c940>]}


============================== 21:46:16.769017 | 89d3549c-0d16-4253-89d0-adeaac7a79d6 ==============================
[0m21:46:16.769017 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:46:16.769395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m raw_transactions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:46:16.769794 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:46:16.770170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b89300>]}
[0m21:46:18.471499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042fdd50>]}
[0m21:46:18.503306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a4f5b70>]}
[0m21:46:18.503666 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:46:18.624904 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:46:18.723169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:46:18.723438 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:46:18.727667 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.links
[0m21:46:18.747034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ae24130>]}
[0m21:46:18.804192 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:46:18.806131 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:46:18.818298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15adb6260>]}
[0m21:46:18.818605 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:46:18.818787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15adb6830>]}
[0m21:46:18.819627 [info ] [MainThread]: 
[0m21:46:18.819823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:46:18.819966 [info ] [MainThread]: 
[0m21:46:18.820236 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:46:18.820698 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:46:18.820889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:19.604554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:46:19.605419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:46:20.508419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd31f0>]}
[0m21:46:20.509845 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:46:20.516444 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m21:46:20.517296 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_transactions ....................... [RUN]
[0m21:46:20.517972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_transactions)
[0m21:46:20.518501 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m21:46:20.534261 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m21:46:20.535784 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m21:46:20.564821 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m21:46:20.565572 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`ORDERS`  AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`CUSTOMER` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08');


[0m21:46:20.565926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:46:21.653768 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6fdf761e-92b1-46fa-bf0c-327dfa6a6942&page=queryresults
[0m21:46:21.654193 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6fdf761e-92b1-46fa-bf0c-327dfa6a6942&page=queryresults
[0m21:46:21.659723 [debug] [Thread-1 (]: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:46:21.661394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89d3549c-0d16-4253-89d0-adeaac7a79d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0c310>]}
[0m21:46:21.661920 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_transactions .............. [[31mERROR[0m in 1.14s]
[0m21:46:21.662255 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m21:46:21.662559 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_transactions' to be skipped because of status 'error'.  Reason: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql.
[0m21:46:21.663685 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:46:21.664747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:21.664953 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_transactions' was properly closed.
[0m21:46:21.665126 [info ] [MainThread]: 
[0m21:46:21.665307 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m21:46:21.665681 [debug] [MainThread]: Command end result
[0m21:46:21.693181 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:46:21.694332 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:46:21.697809 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:46:21.698003 [info ] [MainThread]: 
[0m21:46:21.698260 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:46:21.698457 [info ] [MainThread]: 
[0m21:46:21.698688 [error] [MainThread]: [31mFailure in model raw_transactions (models/raw_stage/raw_transactions.sql)[0m
[0m21:46:21.698891 [error] [MainThread]:   Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:46:21.699045 [info ] [MainThread]: 
[0m21:46:21.699226 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:46:21.699375 [info ] [MainThread]: 
[0m21:46:21.699548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:46:21.699850 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:46:21.701161 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.9796658, "process_in_blocks": "0", "process_kernel_time": 1.194997, "process_mem_max_rss": "353484800", "process_out_blocks": "0", "process_user_time": 3.190936}
[0m21:46:21.701453 [debug] [MainThread]: Command `dbt run` failed at 21:46:21.701405 after 4.98 seconds
[0m21:46:21.701681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abf700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ae26920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ed3400>]}
[0m21:46:21.701889 [debug] [MainThread]: Flushing usage events
[0m21:46:23.169932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:48:51.115880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fab6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091005e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109100ca0>]}


============================== 21:48:51.119092 | feec1ad0-47a0-41d1-8f5f-4dc58b76a50b ==============================
[0m21:48:51.119092 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:48:51.119433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_transactions', 'send_anonymous_usage_stats': 'True'}
[0m21:48:51.119690 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:48:51.119882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109075420>]}
[0m21:48:52.871028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163e7a080>]}
[0m21:48:52.902919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108effb50>]}
[0m21:48:52.903311 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:48:53.025023 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:48:53.124545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:48:53.124819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:48:53.129293 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_vault.sats
[0m21:48:53.149282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164f24130>]}
[0m21:48:53.210483 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:48:53.212966 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:48:53.225341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164ea4fd0>]}
[0m21:48:53.225656 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:48:53.225841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164ea4eb0>]}
[0m21:48:53.226698 [info ] [MainThread]: 
[0m21:48:53.226891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:53.227031 [info ] [MainThread]: 
[0m21:48:53.227294 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:48:53.227756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:48:53.227951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:54.130249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:48:54.132308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:48:55.006444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c1d20>]}
[0m21:48:55.008478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:55.016473 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m21:48:55.017493 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_transactions ....................... [RUN]
[0m21:48:55.018251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_transactions)
[0m21:48:55.018847 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m21:48:55.034929 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m21:48:55.036069 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m21:48:55.064920 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m21:48:55.065958 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')),  24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
    CASE ABS(MOD(RANDOM(1), 2)) + 1
        WHEN 1 THEN 'DR'
        WHEN 2 THEN 'CR'
    END AS VARCHAR(2)) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`ORDERS`  AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`CUSTOMER` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08');


[0m21:48:55.066321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:56.068206 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a91f5cae-906f-49cc-9df7-11fd4c47a7f7&page=queryresults
[0m21:48:56.070088 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a91f5cae-906f-49cc-9df7-11fd4c47a7f7&page=queryresults
[0m21:48:56.081534 [debug] [Thread-1 (]: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:48:56.084811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'feec1ad0-47a0-41d1-8f5f-4dc58b76a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164f3da80>]}
[0m21:48:56.086053 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_transactions .............. [[31mERROR[0m in 1.06s]
[0m21:48:56.086899 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m21:48:56.087524 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_transactions' to be skipped because of status 'error'.  Reason: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql.
[0m21:48:56.089827 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:48:56.092101 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:56.092501 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_transactions' was properly closed.
[0m21:48:56.092904 [info ] [MainThread]: 
[0m21:48:56.093300 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m21:48:56.094096 [debug] [MainThread]: Command end result
[0m21:48:56.139107 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:48:56.140589 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:48:56.145151 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:48:56.145375 [info ] [MainThread]: 
[0m21:48:56.145615 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:48:56.145805 [info ] [MainThread]: 
[0m21:48:56.146041 [error] [MainThread]: [31mFailure in model raw_transactions (models/raw_stage/raw_transactions.sql)[0m
[0m21:48:56.146260 [error] [MainThread]:   Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Not found: Table trim-field-467501-p5:dbt_dataset.CUSTOMER was not found in location US
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:48:56.146442 [info ] [MainThread]: 
[0m21:48:56.146643 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:48:56.146803 [info ] [MainThread]: 
[0m21:48:56.146989 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:48:56.147343 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:48:56.149114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.0757785, "process_in_blocks": "0", "process_kernel_time": 1.222736, "process_mem_max_rss": "339410944", "process_out_blocks": "0", "process_user_time": 3.182068}
[0m21:48:56.149503 [debug] [MainThread]: Command `dbt run` failed at 21:48:56.149442 after 5.08 seconds
[0m21:48:56.149776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fab6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164f265c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d4940>]}
[0m21:48:56.150017 [debug] [MainThread]: Flushing usage events
[0m21:48:57.070500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:54:42.774916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075501f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075508b0>]}


============================== 21:54:42.777991 | ef9ef190-fd75-4f0f-97c9-9acb9cb77423 ==============================
[0m21:54:42.777991 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:54:42.778339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_transactions', 'send_anonymous_usage_stats': 'True'}
[0m21:54:42.778595 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:54:42.778781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ef9ef190-fd75-4f0f-97c9-9acb9cb77423', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107509b40>]}
[0m21:54:44.529186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef9ef190-fd75-4f0f-97c9-9acb9cb77423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751d060>]}
[0m21:54:44.560911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef9ef190-fd75-4f0f-97c9-9acb9cb77423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c0cd0>]}
[0m21:54:44.561283 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:54:44.693726 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:54:44.789606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:54:44.790838 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/schema.yml
[0m21:54:45.379841 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.raw_inventory' (models/raw_stage/raw_inventory.sql) depends on a source named 'tpch_sample.PART' which was not found
[0m21:54:45.380286 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:54:45.382541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6493084, "process_in_blocks": "0", "process_kernel_time": 1.285007, "process_mem_max_rss": "349175808", "process_out_blocks": "0", "process_user_time": 3.332811}
[0m21:54:45.382857 [debug] [MainThread]: Command `dbt run` failed at 21:54:45.382799 after 2.65 seconds
[0m21:54:45.383101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1634a5d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1634a5000>]}
[0m21:54:45.383327 [debug] [MainThread]: Flushing usage events
[0m21:54:46.584798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:57:49.302864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cff6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e5fe50>]}


============================== 21:57:49.306289 | 4958bef7-a676-4900-b678-6bb9034802f2 ==============================
[0m21:57:49.306289 [info ] [MainThread]: Running with dbt=1.10.7
[0m21:57:49.306626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m raw_transactions', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:57:49.306910 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m21:57:49.307116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e60c10>]}
[0m21:57:51.067685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163fccca0>]}
[0m21:57:51.099885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877ae00>]}
[0m21:57:51.100259 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m21:57:51.233087 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m21:57:51.330535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m21:57:51.331787 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/schema.yml
[0m21:57:51.331993 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_stage/raw_inventory.sql
[0m21:57:51.332165 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_stage/raw_transactions.sql
[0m21:57:51.332330 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_stage/raw_orders.sql
[0m21:57:51.953972 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_stage
[0m21:57:51.960453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1655d5570>]}
[0m21:57:52.018002 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:57:52.019962 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:57:52.032100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1655d5600>]}
[0m21:57:52.032401 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m21:57:52.032589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16553ead0>]}
[0m21:57:52.033417 [info ] [MainThread]: 
[0m21:57:52.033612 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:57:52.033753 [info ] [MainThread]: 
[0m21:57:52.034003 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:57:52.034437 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m21:57:52.034627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:52.896830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m21:57:52.897572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:57:53.821815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e131c0>]}
[0m21:57:53.823277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:57:53.829398 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m21:57:53.830309 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_transactions ....................... [RUN]
[0m21:57:53.831014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_transactions)
[0m21:57:53.831582 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m21:57:53.844906 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m21:57:53.846483 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m21:57:53.874214 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m21:57:53.874922 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATEADD(DAY, 20, b.O_ORDERDATE) AS TRANSACTION_DATE,
    TO_NUMBER(RPAD(CONCAT(b.O_ORDERKEY, b.O_CUSTKEY, TO_CHAR(b.O_ORDERDATE, 'YYYYMMDD')), 24, '0')) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
        CASE ABS(MOD(RANDOM(1), 2)) + 1
            WHEN 1 THEN 'DR'
            WHEN 2 THEN 'CR'
        END AS VARCHAR(2)) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08');


[0m21:57:53.875293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:57:54.994689 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:8fd86511-8446-45dc-b67a-d53a693ae1c6&page=queryresults
[0m21:57:55.507714 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:8fd86511-8446-45dc-b67a-d53a693ae1c6&page=queryresults
[0m21:57:55.518724 [debug] [Thread-1 (]: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Function not found: TO_DATE at [21:23]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:57:55.521751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4958bef7-a676-4900-b678-6bb9034802f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164fa6c50>]}
[0m21:57:55.523000 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_transactions .............. [[31mERROR[0m in 1.69s]
[0m21:57:55.523915 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m21:57:55.524546 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_transactions' to be skipped because of status 'error'.  Reason: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Function not found: TO_DATE at [21:23]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql.
[0m21:57:55.526872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:57:55.529062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:55.529498 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_transactions' was properly closed.
[0m21:57:55.529895 [info ] [MainThread]: 
[0m21:57:55.530302 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m21:57:55.531112 [debug] [MainThread]: Command end result
[0m21:57:55.579254 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m21:57:55.580596 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m21:57:55.584788 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m21:57:55.585001 [info ] [MainThread]: 
[0m21:57:55.585237 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:57:55.585425 [info ] [MainThread]: 
[0m21:57:55.585655 [error] [MainThread]: [31mFailure in model raw_transactions (models/raw_stage/raw_transactions.sql)[0m
[0m21:57:55.585874 [error] [MainThread]:   Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  Function not found: TO_DATE at [21:23]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:57:55.586042 [info ] [MainThread]: 
[0m21:57:55.586236 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m21:57:55.586399 [info ] [MainThread]: 
[0m21:57:55.586581 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m21:57:55.586896 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:57:55.588304 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.3375144, "process_in_blocks": "0", "process_kernel_time": 1.353986, "process_mem_max_rss": "349863936", "process_out_blocks": "0", "process_user_time": 3.684823}
[0m21:57:55.588567 [debug] [MainThread]: Command `dbt run` failed at 21:57:55.588516 after 6.34 seconds
[0m21:57:55.588804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cff6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877ae00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dcd360>]}
[0m21:57:55.589029 [debug] [MainThread]: Flushing usage events
[0m21:57:56.603034 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:00:29.358444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10370b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104864670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104867d90>]}


============================== 22:00:29.361507 | 4afd1711-bd9d-4fe0-8e53-5962d5ca5871 ==============================
[0m22:00:29.361507 [info ] [MainThread]: Running with dbt=1.10.7
[0m22:00:29.361873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_transactions', 'send_anonymous_usage_stats': 'True'}
[0m22:00:29.362186 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m22:00:29.362383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d0fa0>]}
[0m22:00:31.148823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b712a0>]}
[0m22:00:31.180806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137bbad10>]}
[0m22:00:31.181193 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:00:31.308824 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m22:00:31.406472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:00:31.406881 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_stage/raw_transactions.sql
[0m22:00:31.543324 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.hubs
[0m22:00:31.552783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160ae0130>]}
[0m22:00:31.610226 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:00:31.612582 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:00:31.629617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1608a9ae0>]}
[0m22:00:31.629946 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m22:00:31.630129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1608a9ed0>]}
[0m22:00:31.630987 [info ] [MainThread]: 
[0m22:00:31.631190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:00:31.631341 [info ] [MainThread]: 
[0m22:00:31.631606 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:00:31.632085 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m22:00:31.632298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:32.476221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m22:00:32.476999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:00:33.629865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101e90340>]}
[0m22:00:33.630950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:33.637582 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m22:00:33.638408 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_transactions ....................... [RUN]
[0m22:00:33.639109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_transactions)
[0m22:00:33.639650 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m22:00:33.653266 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m22:00:33.654676 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m22:00:33.683892 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m22:00:33.684646 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATE_ADD(b.O_ORDERDATE, INTERVAL 20 DAY) AS TRANSACTION_DATE,
    CAST(RPAD(CONCAT(CAST(b.O_ORDERKEY AS STRING), CAST(b.O_CUSTKEY AS STRING), FORMAT_DATE('%Y%m%d', b.O_ORDERDATE)), 24, '0') AS INT64) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
        CASE ABS(MOD(ABS(RAND()), 2)) + 1
            WHEN 1 THEN 'DR'
            WHEN 2 THEN 'CR'
        END AS STRING) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m22:00:33.685024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:00:34.751812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:e1a9978f-cfd0-4f05-984e-8ee49ea7f6ed&page=queryresults
[0m22:00:35.181376 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:e1a9978f-cfd0-4f05-984e-8ee49ea7f6ed&page=queryresults
[0m22:00:35.195921 [debug] [Thread-1 (]: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  No matching signature for function MOD
    Argument types: FLOAT64, INT64
    Signature: MOD(INT64, INT64)
      Argument 1: Unable to coerce type FLOAT64 to expected type INT64
    Signature: MOD(NUMERIC, NUMERIC)
      Argument 1: Unable to coerce type FLOAT64 to expected type NUMERIC
    Signature: MOD(BIGNUMERIC, BIGNUMERIC)
      Argument 1: Unable to coerce type FLOAT64 to expected type BIGNUMERIC at [14:18]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m22:00:35.199015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afd1711-bd9d-4fe0-8e53-5962d5ca5871', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147f3b100>]}
[0m22:00:35.200072 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_transactions .............. [[31mERROR[0m in 1.56s]
[0m22:00:35.200966 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m22:00:35.201744 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_transactions' to be skipped because of status 'error'.  Reason: Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  No matching signature for function MOD
    Argument types: FLOAT64, INT64
    Signature: MOD(INT64, INT64)
      Argument 1: Unable to coerce type FLOAT64 to expected type INT64
    Signature: MOD(NUMERIC, NUMERIC)
      Argument 1: Unable to coerce type FLOAT64 to expected type NUMERIC
    Signature: MOD(BIGNUMERIC, BIGNUMERIC)
      Argument 1: Unable to coerce type FLOAT64 to expected type BIGNUMERIC at [14:18]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql.
[0m22:00:35.204029 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:00:35.206248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:35.206659 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_transactions' was properly closed.
[0m22:00:35.207056 [info ] [MainThread]: 
[0m22:00:35.207457 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m22:00:35.208289 [debug] [MainThread]: Command end result
[0m22:00:35.340908 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:00:35.342028 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:00:35.345358 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m22:00:35.345528 [info ] [MainThread]: 
[0m22:00:35.345723 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:00:35.345883 [info ] [MainThread]: 
[0m22:00:35.346087 [error] [MainThread]: [31mFailure in model raw_transactions (models/raw_stage/raw_transactions.sql)[0m
[0m22:00:35.346288 [error] [MainThread]:   Database Error in model raw_transactions (models/raw_stage/raw_transactions.sql)
  No matching signature for function MOD
    Argument types: FLOAT64, INT64
    Signature: MOD(INT64, INT64)
      Argument 1: Unable to coerce type FLOAT64 to expected type INT64
    Signature: MOD(NUMERIC, NUMERIC)
      Argument 1: Unable to coerce type FLOAT64 to expected type NUMERIC
    Signature: MOD(BIGNUMERIC, BIGNUMERIC)
      Argument 1: Unable to coerce type FLOAT64 to expected type BIGNUMERIC at [14:18]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m22:00:35.346452 [info ] [MainThread]: 
[0m22:00:35.346630 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_transactions.sql
[0m22:00:35.346769 [info ] [MainThread]: 
[0m22:00:35.346932 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:00:35.347211 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:00:35.348731 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.031656, "process_in_blocks": "0", "process_kernel_time": 1.371899, "process_mem_max_rss": "348323840", "process_out_blocks": "0", "process_user_time": 3.265107}
[0m22:00:35.349047 [debug] [MainThread]: Command `dbt run` failed at 22:00:35.348995 after 6.03 seconds
[0m22:00:35.349345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10370b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020c9870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020ca650>]}
[0m22:00:35.349556 [debug] [MainThread]: Flushing usage events
[0m22:00:36.582693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:01:59.398165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084af6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109604610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109607e50>]}


============================== 22:01:59.401180 | 4a5e297d-9f9c-40a9-ac06-89e627fd141d ==============================
[0m22:01:59.401180 [info ] [MainThread]: Running with dbt=1.10.7
[0m22:01:59.401550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m raw_transactions', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:01:59.401811 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m22:01:59.402006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10860cc10>]}
[0m22:02:01.108087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d69d50>]}
[0m22:02:01.140164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10953fbb0>]}
[0m22:02:01.140579 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:02:01.266610 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m22:02:01.368486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:02:01.368922 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_stage/raw_transactions.sql
[0m22:02:01.503798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
[0m22:02:01.515621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bb48130>]}
[0m22:02:01.571927 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:02:01.574073 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:02:01.585714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b929900>]}
[0m22:02:01.586050 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m22:02:01.586248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b929d20>]}
[0m22:02:01.587097 [info ] [MainThread]: 
[0m22:02:01.587285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:02:01.587425 [info ] [MainThread]: 
[0m22:02:01.587684 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:02:01.588131 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m22:02:01.588329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:02.431660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m22:02:02.432544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:03.335087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095bf1c0>]}
[0m22:02:03.336773 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:03.343454 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m22:02:03.344308 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_transactions ....................... [RUN]
[0m22:02:03.345009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_transactions)
[0m22:02:03.345568 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m22:02:03.359112 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m22:02:03.360323 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m22:02:03.389181 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m22:02:03.389902 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATE_ADD(b.O_ORDERDATE, INTERVAL 20 DAY) AS TRANSACTION_DATE,
    CAST(RPAD(CONCAT(CAST(b.O_ORDERKEY AS STRING), CAST(b.O_CUSTKEY AS STRING), FORMAT_DATE('%Y%m%d', b.O_ORDERDATE)), 24, '0') AS INT64) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
        CASE FLOOR(RAND() * 2) + 1
            WHEN 1 THEN 'DR'
            WHEN 2 THEN 'CR'
        END AS STRING) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m22:02:03.390251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:04.556447 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:e50b90e0-0db4-45f1-92a0-b782cbeadb37&page=queryresults
[0m22:02:05.556479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a5e297d-9f9c-40a9-ac06-89e627fd141d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f02380>]}
[0m22:02:05.557149 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dataset.raw_transactions .................. [[32mCREATE VIEW (0 processed)[0m in 2.21s]
[0m22:02:05.557477 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m22:02:05.558054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:02:05.559075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:05.559271 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_transactions' was properly closed.
[0m22:02:05.559447 [info ] [MainThread]: 
[0m22:02:05.559625 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m22:02:05.559989 [debug] [MainThread]: Command end result
[0m22:02:05.585455 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:02:05.586738 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:02:05.590087 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m22:02:05.590262 [info ] [MainThread]: 
[0m22:02:05.590486 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:02:05.590642 [info ] [MainThread]: 
[0m22:02:05.590809 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:02:05.591085 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:02:05.592362 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.235995, "process_in_blocks": "0", "process_kernel_time": 1.222248, "process_mem_max_rss": "349798400", "process_out_blocks": "0", "process_user_time": 3.496234}
[0m22:02:05.592632 [debug] [MainThread]: Command `dbt run` succeeded at 22:02:05.592581 after 6.24 seconds
[0m22:02:05.592841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084af6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b934250>]}
[0m22:02:05.593045 [debug] [MainThread]: Flushing usage events
[0m22:02:06.713716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:02:19.899886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063db760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075344c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107534b80>]}


============================== 22:02:19.902872 | e6ff73ce-afd6-40a3-992e-efcb577c36a3 ==============================
[0m22:02:19.902872 [info ] [MainThread]: Running with dbt=1.10.7
[0m22:02:19.903204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m raw_orders', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:02:19.903470 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m22:02:19.903649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a13c0>]}
[0m22:02:21.580227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fd8d0>]}
[0m22:02:21.612069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a23e0>]}
[0m22:02:21.612480 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:02:21.740071 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m22:02:21.843420 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:02:21.843720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:02:21.848130 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.stage
[0m22:02:21.868148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b420130>]}
[0m22:02:21.924133 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:02:21.925793 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:02:21.938334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b3a4fd0>]}
[0m22:02:21.938643 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m22:02:21.938822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b3a6890>]}
[0m22:02:21.939638 [info ] [MainThread]: 
[0m22:02:21.939825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:02:21.939965 [info ] [MainThread]: 
[0m22:02:21.940224 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:02:21.940675 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m22:02:21.940880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:22.782236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m22:02:22.783007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:23.713319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106292d70>]}
[0m22:02:23.714522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:23.722056 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_orders
[0m22:02:23.722934 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_orders ............................. [RUN]
[0m22:02:23.723732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_orders)
[0m22:02:23.724324 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_orders
[0m22:02:23.740764 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_orders"
[0m22:02:23.741671 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_orders
[0m22:02:23.769450 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_orders"
[0m22:02:23.770282 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
  OPTIONS()
  as SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`lineitem` AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON c.C_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = TO_DATE('1992-01-08');


[0m22:02:23.770698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:24.831884 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:758cd3be-0be0-4294-91bb-a1a1618d2fb8&page=queryresults
[0m22:02:25.345459 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:758cd3be-0be0-4294-91bb-a1a1618d2fb8&page=queryresults
[0m22:02:25.359426 [debug] [Thread-1 (]: Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
  Function not found: TO_DATE at [60:23]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_orders.sql
[0m22:02:25.362930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6ff73ce-afd6-40a3-992e-efcb577c36a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b4ccc40>]}
[0m22:02:25.364206 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dataset.raw_orders .................... [[31mERROR[0m in 1.64s]
[0m22:02:25.365087 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_orders
[0m22:02:25.365820 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.raw_orders' to be skipped because of status 'error'.  Reason: Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
  Function not found: TO_DATE at [60:23]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_orders.sql.
[0m22:02:25.368785 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:02:25.371229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:25.371719 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_orders' was properly closed.
[0m22:02:25.372123 [info ] [MainThread]: 
[0m22:02:25.372547 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m22:02:25.373734 [debug] [MainThread]: Command end result
[0m22:02:25.419544 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:02:25.420848 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:02:25.425292 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m22:02:25.425522 [info ] [MainThread]: 
[0m22:02:25.425779 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:02:25.425985 [info ] [MainThread]: 
[0m22:02:25.426384 [error] [MainThread]: [31mFailure in model raw_orders (models/raw_stage/raw_orders.sql)[0m
[0m22:02:25.426604 [error] [MainThread]:   Database Error in model raw_orders (models/raw_stage/raw_orders.sql)
  Function not found: TO_DATE at [60:23]
  compiled code at target/run/dbt_bq_sa/models/raw_stage/raw_orders.sql
[0m22:02:25.426768 [info ] [MainThread]: 
[0m22:02:25.426965 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/raw_stage/raw_orders.sql
[0m22:02:25.427128 [info ] [MainThread]: 
[0m22:02:25.427313 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:02:25.427643 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:02:25.429140 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.570339, "process_in_blocks": "0", "process_kernel_time": 1.275699, "process_mem_max_rss": "345800704", "process_out_blocks": "0", "process_user_time": 3.135432}
[0m22:02:25.429470 [debug] [MainThread]: Command `dbt run` failed at 22:02:25.429411 after 5.57 seconds
[0m22:02:25.429719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063db760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b422740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a5637f0>]}
[0m22:02:25.429953 [debug] [MainThread]: Flushing usage events
[0m22:02:26.598473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:02:54.407846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bcf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2fe50>]}


============================== 22:02:54.411046 | 584bcaca-6e50-42e3-b6cb-816980d070a1 ==============================
[0m22:02:54.411046 [info ] [MainThread]: Running with dbt=1.10.7
[0m22:02:54.411394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_orders', 'send_anonymous_usage_stats': 'True'}
[0m22:02:54.411677 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m22:02:54.411871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d30c10>]}
[0m22:02:56.173161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce2350>]}
[0m22:02:56.205346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136f71660>]}
[0m22:02:56.205730 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:02:56.335611 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m22:02:56.433334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:02:56.433755 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_stage/raw_orders.sql
[0m22:02:56.569890 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.hubs
[0m22:02:56.579030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1607f4130>]}
[0m22:02:56.639928 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:02:56.642068 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:02:56.655463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1604a5930>]}
[0m22:02:56.655779 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m22:02:56.655960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1604a5d20>]}
[0m22:02:56.656807 [info ] [MainThread]: 
[0m22:02:56.657008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:02:56.657150 [info ] [MainThread]: 
[0m22:02:56.657412 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:02:56.657887 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m22:02:56.658134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:57.616024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m22:02:57.616783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:58.527955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ce31c0>]}
[0m22:02:58.529329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:02:58.534907 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_orders
[0m22:02:58.535770 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_orders ............................. [RUN]
[0m22:02:58.536455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_orders)
[0m22:02:58.537003 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_orders
[0m22:02:58.553002 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_orders"
[0m22:02:58.554037 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_orders
[0m22:02:58.582785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_orders"
[0m22:02:58.583510 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
  OPTIONS()
  as SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`lineitem` AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON c.C_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m22:02:58.583920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:59.697129 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b8db7889-dbf9-4306-9cef-7a56481d9b29&page=queryresults
[0m22:03:00.728418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '584bcaca-6e50-42e3-b6cb-816980d070a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136fb96f0>]}
[0m22:03:00.729016 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dataset.raw_orders ........................ [[32mCREATE VIEW (0 processed)[0m in 2.19s]
[0m22:03:00.729340 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_orders
[0m22:03:00.729888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:03:00.730814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:00.730976 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_orders' was properly closed.
[0m22:03:00.731128 [info ] [MainThread]: 
[0m22:03:00.731307 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m22:03:00.731642 [debug] [MainThread]: Command end result
[0m22:03:00.757021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:03:00.758465 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:03:00.762044 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m22:03:00.762218 [info ] [MainThread]: 
[0m22:03:00.762434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:03:00.762588 [info ] [MainThread]: 
[0m22:03:00.762750 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:03:00.763020 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:03:00.764314 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4024982, "process_in_blocks": "0", "process_kernel_time": 1.455902, "process_mem_max_rss": "355581952", "process_out_blocks": "0", "process_user_time": 3.226751}
[0m22:03:00.764568 [debug] [MainThread]: Command `dbt run` succeeded at 22:03:00.764521 after 6.40 seconds
[0m22:03:00.764765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bcf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103efb040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1607f4070>]}
[0m22:03:00.764953 [debug] [MainThread]: Flushing usage events
[0m22:03:01.809879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:03:15.123424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d30340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d30a00>]}


============================== 22:03:15.126477 | a34fbece-6b60-468c-93d8-125ca6a3253b ==============================
[0m22:03:15.126477 [info ] [MainThread]: Running with dbt=1.10.7
[0m22:03:15.126818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m raw_inventory', 'send_anonymous_usage_stats': 'True'}
[0m22:03:15.127089 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m22:03:15.127276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cedb40>]}
[0m22:03:16.860277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160bce9e0>]}
[0m22:03:16.892399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642bdf0>]}
[0m22:03:16.892806 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m22:03:17.015288 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m22:03:17.109276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:03:17.109547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:03:17.113804 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
[0m22:03:17.133587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161524130>]}
[0m22:03:17.195991 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:03:17.198238 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:03:17.210083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1614b7a30>]}
[0m22:03:17.210398 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m22:03:17.210582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1614b68c0>]}
[0m22:03:17.211437 [info ] [MainThread]: 
[0m22:03:17.211639 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:03:17.211781 [info ] [MainThread]: 
[0m22:03:17.212040 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:03:17.212489 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m22:03:17.212683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:18.083104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m22:03:18.083946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:03:19.103643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160ba2590>]}
[0m22:03:19.104796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:19.111072 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m22:03:19.112012 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.raw_inventory .......................... [RUN]
[0m22:03:19.112760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_inventory)
[0m22:03:19.113357 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m22:03:19.129825 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m22:03:19.131177 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m22:03:19.159887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m22:03:19.160991 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`partsupp` AS a
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m22:03:19.161378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:03:20.425336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:85c08017-3590-4e1f-8383-47c976c44aea&page=queryresults
[0m22:03:21.526889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a34fbece-6b60-468c-93d8-125ca6a3253b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c0a0190>]}
[0m22:03:21.527494 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dataset.raw_inventory ..................... [[32mCREATE VIEW (0 processed)[0m in 2.41s]
[0m22:03:21.527892 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m22:03:21.528581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:03:21.529787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:21.530012 [debug] [MainThread]: Connection 'model.dbt_bq_sa.raw_inventory' was properly closed.
[0m22:03:21.530219 [info ] [MainThread]: 
[0m22:03:21.530430 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m22:03:21.530862 [debug] [MainThread]: Command end result
[0m22:03:21.559725 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m22:03:21.560851 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m22:03:21.564669 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m22:03:21.564843 [info ] [MainThread]: 
[0m22:03:21.565056 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:03:21.565205 [info ] [MainThread]: 
[0m22:03:21.565377 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:03:21.565662 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:03:21.566942 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.484383, "process_in_blocks": "0", "process_kernel_time": 1.292819, "process_mem_max_rss": "348028928", "process_out_blocks": "0", "process_user_time": 3.172828}
[0m22:03:21.567185 [debug] [MainThread]: Command `dbt run` succeeded at 22:03:21.567138 after 6.48 seconds
[0m22:03:21.567391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1615cd570>]}
[0m22:03:21.567580 [debug] [MainThread]: Flushing usage events
[0m22:03:22.575331 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:12.711717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039ef640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b48400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b48ac0>]}


============================== 13:33:12.714951 | d9abae46-982c-44bd-9b6c-5dc2943f43ae ==============================
[0m13:33:12.714951 [info ] [MainThread]: Running with dbt=1.10.7
[0m13:33:12.715295 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models path:models/stage', 'send_anonymous_usage_stats': 'True'}
[0m13:33:12.715567 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:33:12.715753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abbd30>]}
[0m13:33:14.567098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1267d0670>]}
[0m13:33:14.599806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446aec0>]}
[0m13:33:14.600243 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:33:14.722509 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m13:33:14.820987 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:14.821257 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:14.825516 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.raw_vault.t_links
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
[0m13:33:14.845344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f50130>]}
[0m13:33:14.903501 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m13:33:14.905466 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m13:33:14.918753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ee6050>]}
[0m13:33:14.919103 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m13:33:14.919295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ee74c0>]}
[0m13:33:14.920566 [info ] [MainThread]: 
[0m13:33:14.920758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:33:14.920898 [info ] [MainThread]: 
[0m13:33:14.921160 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:33:14.923685 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m13:33:14.923955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:45.705825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5_dbt_dataset'
[0m13:35:45.707692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:16.609105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12682a500>]}
[0m13:38:16.612528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:16.622200 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory
[0m13:38:16.623256 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_dataset.v_stg_inventory ........................ [RUN]
[0m13:38:16.624003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.v_stg_inventory)
[0m13:38:16.624491 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory
[0m13:38:16.674749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:48.187100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory"
[0m13:40:48.195466 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory
[0m13:40:48.213071 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory"
[0m13:40:48.214061 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       TO_DATE('1992-01-08') AS LOAD_DATE,
       TO_DATE('1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m13:40:49.095017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:029f13e3-c4a1-4f0d-b3ab-50b8a9968aa9&page=queryresults
[0m13:40:49.539799 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:029f13e3-c4a1-4f0d-b3ab-50b8a9968aa9&page=queryresults
[0m13:40:49.556479 [debug] [Thread-1 (]: Database Error in model v_stg_inventory (models/stage/v_stg_inventory.sql)
  Function not found: TO_DATE at [243:8]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_inventory.sql
[0m13:40:49.566087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127002080>]}
[0m13:40:49.569381 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_dataset.v_stg_inventory ............... [[31mERROR[0m in 152.93s]
[0m13:40:49.570325 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory
[0m13:40:49.571767 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_orders
[0m13:40:49.572761 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.v_stg_inventory' to be skipped because of status 'error'.  Reason: Database Error in model v_stg_inventory (models/stage/v_stg_inventory.sql)
  Function not found: TO_DATE at [243:8]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_inventory.sql.
[0m13:40:49.573434 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_dataset.v_stg_orders ........................... [RUN]
[0m13:40:49.576248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory, now model.dbt_bq_sa.v_stg_orders)
[0m13:40:49.577322 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_orders
[0m13:40:49.586745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:21.007572 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_orders"
[0m13:43:21.010306 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_orders
[0m13:43:21.021060 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_orders"
[0m13:43:21.022082 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), '')))) AS STRING) AS ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS ORDER_CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINEITEM_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS LINK_LINEITEM_ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS INVENTORY_ALLOCATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS STRING))), ''), '^^')
    )))) AS STRING) AS LINEITEM_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS STRING))), ''), '^^')
    )))) AS STRING) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       TO_DATE('1992-01-08') AS LOAD_DATE
FROM staging;


[0m13:43:21.912228 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7dedf716-33dd-46a4-a989-ab9d34ea524a&page=queryresults
[0m13:43:22.418267 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7dedf716-33dd-46a4-a989-ab9d34ea524a&page=queryresults
[0m13:43:22.424385 [debug] [Thread-1 (]: Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
  Function not found: TO_DATE at [337:8]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_orders.sql
[0m13:43:22.426672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9abae46-982c-44bd-9b6c-5dc2943f43ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12725eef0>]}
[0m13:43:22.430130 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model dbt_dataset.v_stg_orders .................. [[31mERROR[0m in 152.85s]
[0m13:43:22.431099 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_orders
[0m13:43:22.431725 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m13:43:22.432626 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.v_stg_orders' to be skipped because of status 'error'.  Reason: Database Error in model v_stg_orders (models/stage/v_stg_orders.sql)
  Function not found: TO_DATE at [337:8]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_orders.sql.
[0m13:43:22.433507 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_dataset.v_stg_transactions ..................... [RUN]
[0m13:43:22.435053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_orders, now model.dbt_bq_sa.v_stg_transactions)
[0m13:43:22.435656 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m13:43:22.445457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:27.968001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118938490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11893bf40>]}


============================== 13:45:27.971055 | 1252da49-e4a2-49fe-a53f-135deb9f2490 ==============================
[0m13:45:27.971055 [info ] [MainThread]: Running with dbt=1.10.7
[0m13:45:27.971375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models path:models/stage', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:45:27.971652 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m13:45:27.971845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187a5480>]}
[0m13:45:29.745073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a274e20>]}
[0m13:45:29.776734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118908040>]}
[0m13:45:29.777111 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m13:45:29.905735 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m13:45:30.011094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:45:30.011606 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/v_stg_orders.sql
[0m13:45:30.011841 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/v_stg_inventory.sql
[0m13:45:30.266682 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.dbtvault_snowflake_demo.raw_stage
- models.dbtvault_snowflake_demo.raw_vault
- models.dbtvault_snowflake_demo.raw_vault.links
- models.dbtvault_snowflake_demo.raw_vault.hubs
- models.dbtvault_snowflake_demo.raw_vault.sats
- models.dbtvault_snowflake_demo.stage
- models.dbtvault_snowflake_demo.raw_vault.t_links
[0m13:45:30.275867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b7a0130>]}
[0m13:45:30.419126 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m13:45:30.421803 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m13:45:30.433166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a084c0>]}
[0m13:45:30.433493 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m13:45:30.433677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154f8a530>]}
[0m13:45:30.434932 [info ] [MainThread]: 
[0m13:45:30.435132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:45:30.435276 [info ] [MainThread]: 
[0m13:45:30.435517 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:45:30.437822 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m13:45:30.438089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:01.265276 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5_dbt_dataset'
[0m13:48:01.267361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:32.319711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049bc340>]}
[0m13:50:32.325153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:32.356671 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory
[0m13:50:32.357878 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_dataset.v_stg_inventory ........................ [RUN]
[0m13:50:32.358808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.v_stg_inventory)
[0m13:50:32.359168 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory
[0m13:50:32.396085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:53:03.876555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory"
[0m13:53:03.879972 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory
[0m13:53:03.910033 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory"
[0m13:53:03.911347 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m13:53:04.875643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b8b8d66b-016e-4933-b174-5b227a1a5b8e&page=queryresults
[0m13:53:05.888091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b7a19f0>]}
[0m13:53:05.888912 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_dataset.v_stg_inventory ................... [[32mCREATE VIEW (0 processed)[0m in 153.53s]
[0m13:53:05.889289 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory
[0m13:53:05.889541 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_orders
[0m13:53:05.890913 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_dataset.v_stg_orders ........................... [RUN]
[0m13:53:05.892641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory, now model.dbt_bq_sa.v_stg_orders)
[0m13:53:05.893510 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_orders
[0m13:53:05.898493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:37.496596 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_orders"
[0m13:55:37.500696 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_orders
[0m13:55:37.505817 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_orders"
[0m13:55:37.507827 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), '')))) AS STRING) AS ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS ORDER_CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINEITEM_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS LINK_LINEITEM_ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS INVENTORY_ALLOCATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS STRING))), ''), '^^')
    )))) AS STRING) AS LINEITEM_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS STRING))), ''), '^^')
    )))) AS STRING) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE
FROM staging;


[0m13:55:38.430635 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:2524d526-51f7-4439-863e-2f92e46f40ca&page=queryresults
[0m13:55:39.416267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107129000>]}
[0m13:55:39.424150 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_dataset.v_stg_orders ...................... [[32mCREATE VIEW (0 processed)[0m in 153.52s]
[0m13:55:39.425442 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_orders
[0m13:55:39.427307 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m13:55:39.428748 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_dataset.v_stg_transactions ..................... [RUN]
[0m13:55:39.429627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_orders, now model.dbt_bq_sa.v_stg_transactions)
[0m13:55:39.430325 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m13:55:39.440924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:11.066462 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_transactions"
[0m13:58:11.086376 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_transactions
[0m13:58:11.095824 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_transactions"
[0m13:58:11.096885 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
  OPTIONS()
  as 







-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATEADD(DAY, 1, TRANSACTION_DATE) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS TRANSACTION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS STRING))), '')))) AS STRING) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m13:58:11.911066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4d1d9769-1eb4-419b-be9c-68aab93859d1&page=queryresults
[0m13:58:12.392045 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4d1d9769-1eb4-419b-be9c-68aab93859d1&page=queryresults
[0m13:58:12.412151 [debug] [Thread-1 (]: Database Error in model v_stg_transactions (models/stage/v_stg_transactions.sql)
  Function not found: DATEADD; Did you mean date_add? at [45:5]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_transactions.sql
[0m13:58:12.413767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1252da49-e4a2-49fe-a53f-135deb9f2490', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c3ebe20>]}
[0m13:58:12.415000 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model dbt_dataset.v_stg_transactions ............ [[31mERROR[0m in 152.98s]
[0m13:58:12.415754 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_transactions
[0m13:58:12.416780 [debug] [Thread-4 (]: Marking all children of 'model.dbt_bq_sa.v_stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model v_stg_transactions (models/stage/v_stg_transactions.sql)
  Function not found: DATEADD; Did you mean date_add? at [45:5]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_transactions.sql.
[0m13:58:12.433010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:12.436311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:12.436666 [debug] [MainThread]: Connection 'list_trim-field-467501-p5' was properly closed.
[0m13:58:12.436980 [debug] [MainThread]: Connection 'model.dbt_bq_sa.v_stg_transactions' was properly closed.
[0m13:58:12.437983 [info ] [MainThread]: 
[0m13:58:12.438763 [info ] [MainThread]: Finished running 3 view models in 0 hours 12 minutes and 42.00 seconds (762.00s).
[0m13:58:12.440142 [debug] [MainThread]: Command end result
[0m13:58:12.497331 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m13:58:12.513948 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m13:58:12.524923 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m13:58:12.525143 [info ] [MainThread]: 
[0m13:58:12.525354 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:58:12.525519 [info ] [MainThread]: 
[0m13:58:12.525732 [error] [MainThread]: [31mFailure in model v_stg_transactions (models/stage/v_stg_transactions.sql)[0m
[0m13:58:12.525934 [error] [MainThread]:   Database Error in model v_stg_transactions (models/stage/v_stg_transactions.sql)
  Function not found: DATEADD; Did you mean date_add? at [45:5]
  compiled code at target/run/dbt_bq_sa/models/stage/v_stg_transactions.sql
[0m13:58:12.526080 [info ] [MainThread]: 
[0m13:58:12.526255 [info ] [MainThread]:   compiled code at target/compiled/dbt_bq_sa/models/stage/v_stg_transactions.sql
[0m13:58:12.526578 [info ] [MainThread]: 
[0m13:58:12.527168 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m13:58:12.528994 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:58:12.609526 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 764.7123, "process_in_blocks": "0", "process_kernel_time": 1.681003, "process_mem_max_rss": "357793792", "process_out_blocks": "0", "process_user_time": 3.835643}
[0m13:58:12.610951 [debug] [MainThread]: Command `dbt run` failed at 13:58:12.610883 after 764.71 seconds
[0m13:58:12.611665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c9f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c59420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a29de40>]}
[0m13:58:12.611926 [debug] [MainThread]: Flushing usage events
[0m13:58:13.524476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:16.544477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107718610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771be50>]}


============================== 14:01:16.547815 | 817b9143-d8b0-4445-90c1-2f95c7ed63e3 ==============================
[0m14:01:16.547815 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:01:16.548159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m v_stg_transactions', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:01:16.548437 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:01:16.548625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671cc10>]}
[0m14:01:18.311969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf1d50>]}
[0m14:01:18.343778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149239930>]}
[0m14:01:18.344153 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m14:01:18.478868 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:01:18.535030 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:01:18.535366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fdac80>]}
[0m14:01:20.112213 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.raw_vault
- models.raw_vault.links
- models.raw_stage
- models.raw_vault.sats
- models.raw_vault.t_links
- models.stage
- models.raw_vault.hubs
[0m14:01:20.118708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4bc130>]}
[0m14:01:20.176413 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m14:01:20.178329 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m14:01:20.190941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c471480>]}
[0m14:01:20.191307 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m14:01:20.191506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c472fe0>]}
[0m14:01:20.192410 [info ] [MainThread]: 
[0m14:01:20.192622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:01:20.192774 [info ] [MainThread]: 
[0m14:01:20.193040 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:01:20.193526 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m14:01:20.193751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:51.174375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m14:03:51.176876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:45.116163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059fff40>]}
[0m15:04:45.120176 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:45.143894 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m15:04:45.144482 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dataset.v_stg_transactions ..................... [RUN]
[0m15:04:45.144841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.v_stg_transactions)
[0m15:04:45.145076 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m15:04:45.173812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:16.671070 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_transactions"
[0m15:07:16.676421 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_transactions
[0m15:07:16.713680 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_transactions"
[0m15:07:16.714592 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
  OPTIONS()
  as 







-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATE_ADD(TRANSACTION_DATE, INTERVAL 1 DAY) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS TRANSACTION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS STRING))), '')))) AS STRING) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m15:07:17.846582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ad34f253-cc1a-42dd-a980-c4882b9af353&page=queryresults
[0m15:07:18.812452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '817b9143-d8b0-4445-90c1-2f95c7ed63e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1390a1930>]}
[0m15:07:18.813290 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dataset.v_stg_transactions ................ [[32mCREATE VIEW (0 processed)[0m in 153.67s]
[0m15:07:18.813805 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_transactions
[0m15:07:18.815301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:18.817277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:18.817504 [debug] [MainThread]: Connection 'model.dbt_bq_sa.v_stg_transactions' was properly closed.
[0m15:07:18.817746 [info ] [MainThread]: 
[0m15:07:18.817985 [info ] [MainThread]: Finished running 1 view model in 1 hours 5 minutes and 58.62 seconds (3958.62s).
[0m15:07:18.818466 [debug] [MainThread]: Command end result
[0m15:07:18.853777 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m15:07:18.856674 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m15:07:18.862159 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m15:07:18.862346 [info ] [MainThread]: 
[0m15:07:18.862575 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:18.862733 [info ] [MainThread]: 
[0m15:07:18.863555 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:07:18.863980 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:07:18.881564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 451.30103, "process_in_blocks": "0", "process_kernel_time": 1.414834, "process_mem_max_rss": "348487680", "process_out_blocks": "0", "process_user_time": 4.658736}
[0m15:07:18.881877 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:18.881834 after 451.30 seconds
[0m15:07:18.882134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149239930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c4bc190>]}
[0m15:07:18.882390 [debug] [MainThread]: Flushing usage events
[0m15:07:19.827832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:26.488824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063eb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107548280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107548940>]}


============================== 15:17:26.492191 | ea607177-3f89-491d-8c8a-3c3fc2f41c38 ==============================
[0m15:17:26.492191 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:17:26.492551 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --models path:models/stage', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:17:26.492844 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:17:26.493036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b61d0>]}
[0m15:17:28.329862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b21d50>]}
[0m15:17:28.363106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531adbd0>]}
[0m15:17:28.363567 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m15:17:28.497621 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:17:28.601557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:28.601842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:28.606382 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.raw_vault.links
- models.stage
- models.raw_vault.hubs
- models.raw_vault
- models.raw_stage
- models.raw_vault.t_links
- models.raw_vault.sats
[0m15:17:28.626270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b5f0130>]}
[0m15:17:28.684598 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m15:17:28.686977 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m15:17:28.700276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15af974c0>]}
[0m15:17:28.700600 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m15:17:28.700779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15af96020>]}
[0m15:17:28.702040 [info ] [MainThread]: 
[0m15:17:28.702251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:28.702392 [info ] [MainThread]: 
[0m15:17:28.702656 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:17:28.705059 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m15:17:28.705279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:29.555744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m15:17:29.556541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:30.459101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ff1f0>]}
[0m15:17:30.460226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:30.466717 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory
[0m15:17:30.467555 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_dataset.v_stg_inventory ........................ [RUN]
[0m15:17:30.468237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.v_stg_inventory)
[0m15:17:30.468818 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory
[0m15:17:30.509817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:31.923173 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory"
[0m15:17:31.925249 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory
[0m15:17:31.941135 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory"
[0m15:17:31.942182 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m15:17:33.013496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f1a8167b-d780-4646-97ba-e99d2d97cd84&page=queryresults
[0m15:17:34.102346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b59b190>]}
[0m15:17:34.102980 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_dataset.v_stg_inventory ................... [[32mCREATE VIEW (0 processed)[0m in 3.63s]
[0m15:17:34.103424 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory
[0m15:17:34.103720 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_orders
[0m15:17:34.104151 [info ] [Thread-1 (]: 2 of 3 START sql view model dbt_dataset.v_stg_orders ........................... [RUN]
[0m15:17:34.104536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory, now model.dbt_bq_sa.v_stg_orders)
[0m15:17:34.104898 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_orders
[0m15:17:34.109916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:35.440686 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_orders"
[0m15:17:35.443277 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_orders
[0m15:17:35.445909 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_orders"
[0m15:17:35.447383 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), '')))) AS STRING) AS ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS ORDER_CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINEITEM_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS LINK_LINEITEM_ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS INVENTORY_ALLOCATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS STRING))), ''), '^^')
    )))) AS STRING) AS LINEITEM_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS STRING))), ''), '^^')
    )))) AS STRING) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE
FROM staging;


[0m15:17:36.382171 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:8388d926-1286-44ad-98b3-96914e24433c&page=queryresults
[0m15:17:37.302477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106738310>]}
[0m15:17:37.303022 [info ] [Thread-1 (]: 2 of 3 OK created sql view model dbt_dataset.v_stg_orders ...................... [[32mCREATE VIEW (0 processed)[0m in 3.20s]
[0m15:17:37.303424 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_orders
[0m15:17:37.303685 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m15:17:37.304050 [info ] [Thread-1 (]: 3 of 3 START sql view model dbt_dataset.v_stg_transactions ..................... [RUN]
[0m15:17:37.304369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_orders, now model.dbt_bq_sa.v_stg_transactions)
[0m15:17:37.304610 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m15:17:37.309117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:38.756091 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_transactions"
[0m15:17:38.758374 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_transactions
[0m15:17:38.763486 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_transactions"
[0m15:17:38.764548 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
  OPTIONS()
  as 







-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATE_ADD(TRANSACTION_DATE, INTERVAL 1 DAY) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS TRANSACTION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS STRING))), '')))) AS STRING) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m15:17:39.565629 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:00fcdb77-6b1e-448e-8cd1-bc09e93cc0b9&page=queryresults
[0m15:17:40.604873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea607177-3f89-491d-8c8a-3c3fc2f41c38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b5a68c0>]}
[0m15:17:40.606342 [info ] [Thread-1 (]: 3 of 3 OK created sql view model dbt_dataset.v_stg_transactions ................ [[32mCREATE VIEW (0 processed)[0m in 3.30s]
[0m15:17:40.607280 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_transactions
[0m15:17:40.608974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:17:40.611560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:40.612024 [debug] [MainThread]: Connection 'model.dbt_bq_sa.v_stg_transactions' was properly closed.
[0m15:17:40.612612 [info ] [MainThread]: 
[0m15:17:40.613097 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 11.91 seconds (11.91s).
[0m15:17:40.614541 [debug] [MainThread]: Command end result
[0m15:17:40.791039 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m15:17:40.792436 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m15:17:40.796427 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m15:17:40.796598 [info ] [MainThread]: 
[0m15:17:40.796795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:17:40.796948 [info ] [MainThread]: 
[0m15:17:40.797113 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:17:40.797412 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:17:40.798886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.354991, "process_in_blocks": "0", "process_kernel_time": 1.515002, "process_mem_max_rss": "337526784", "process_out_blocks": "0", "process_user_time": 3.536741}
[0m15:17:40.799170 [debug] [MainThread]: Command `dbt run` succeeded at 15:17:40.799120 after 14.36 seconds
[0m15:17:40.799381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063eb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b5f2740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e14220>]}
[0m15:17:40.799588 [debug] [MainThread]: Flushing usage events
[0m15:17:41.710036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:53.778178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103adf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c34400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c34ac0>]}


============================== 15:17:53.781074 | ea2831cf-4b86-430d-9bad-9f9d7e2dc682 ==============================
[0m15:17:53.781074 [info ] [MainThread]: Running with dbt=1.10.7
[0m15:17:53.781405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --models path:models/raw_vault', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:17:53.781660 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m15:17:53.781834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba52d0>]}
[0m15:17:55.481913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e05f00>]}
[0m15:17:55.514068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10455bbb0>]}
[0m15:17:55.514457 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m15:17:55.634080 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m15:17:55.734049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:17:55.734323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:17:55.738610 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.raw_vault.sats
- models.raw_vault.hubs
- models.raw_vault
- models.raw_vault.t_links
- models.raw_vault.links
- models.raw_stage
- models.stage
[0m15:17:55.758133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1593f0130>]}
[0m15:17:55.814805 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m15:17:55.816287 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m15:17:55.828097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1591875e0>]}
[0m15:17:55.828394 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m15:17:55.828574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1591851e0>]}
[0m15:17:55.830136 [info ] [MainThread]: 
[0m15:17:55.830341 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:17:55.830487 [info ] [MainThread]: 
[0m15:17:55.830745 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:17:55.833859 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m15:17:55.834081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:56.621810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m15:17:56.622792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:17:57.477497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10230f580>]}
[0m15:17:57.479060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:57.486756 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_customer
[0m15:17:57.487611 [info ] [Thread-1 (]: 1 of 25 START sql view model dbt_dataset.hub_customer .......................... [RUN]
[0m15:17:57.488319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.hub_customer)
[0m15:17:57.488905 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_customer
[0m15:17:57.523909 [info ] [Thread-1 (]: 15:17:57 + Loading trim-field-467501-p5.dbt_dataset.hub_customer from 1 source(s)
[0m15:17:57.562200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_customer"
[0m15:17:57.562887 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_customer
[0m15:17:57.578930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_customer"
[0m15:17:57.579487 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_customer: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_customer"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_customer`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:17:57.579733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:17:58.996585 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:d86da214-4827-4024-b30d-943e0e81fae4&page=queryresults
[0m15:18:00.006146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1593a67d0>]}
[0m15:18:00.007427 [info ] [Thread-1 (]: 1 of 25 OK created sql view model dbt_dataset.hub_customer ..................... [[32mCREATE VIEW (0 processed)[0m in 2.51s]
[0m15:18:00.007933 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_customer
[0m15:18:00.008294 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_lineitem
[0m15:18:00.008803 [info ] [Thread-1 (]: 2 of 25 START sql view model dbt_dataset.hub_lineitem .......................... [RUN]
[0m15:18:00.009250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_customer, now model.dbt_bq_sa.hub_lineitem)
[0m15:18:00.009564 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_lineitem
[0m15:18:00.014604 [info ] [Thread-1 (]: 15:18:00 + Loading trim-field-467501-p5.dbt_dataset.hub_lineitem from 1 source(s)
[0m15:18:00.016742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_lineitem"
[0m15:18:00.017253 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_lineitem
[0m15:18:00.019683 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_lineitem"
[0m15:18:00.020125 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:00.020399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:01.181323 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:303cb75e-4525-487b-98f5-65f74cd9e988&page=queryresults
[0m15:18:02.100534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034520e0>]}
[0m15:18:02.102218 [info ] [Thread-1 (]: 2 of 25 OK created sql view model dbt_dataset.hub_lineitem ..................... [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m15:18:02.103196 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_lineitem
[0m15:18:02.103834 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_nation
[0m15:18:02.104676 [info ] [Thread-1 (]: 3 of 25 START sql view model dbt_dataset.hub_nation ............................ [RUN]
[0m15:18:02.105472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_lineitem, now model.dbt_bq_sa.hub_nation)
[0m15:18:02.106069 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_nation
[0m15:18:02.114946 [info ] [Thread-1 (]: 15:18:02 + Loading trim-field-467501-p5.dbt_dataset.hub_nation from 2 source(s)
[0m15:18:02.120550 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_nation"
[0m15:18:02.121717 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_nation
[0m15:18:02.127434 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_nation"
[0m15:18:02.128357 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m15:18:02.128884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:03.313478 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:545ee54b-f699-46a0-9bc1-eb94ba215961&page=queryresults
[0m15:18:04.146200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ad8040>]}
[0m15:18:04.147665 [info ] [Thread-1 (]: 3 of 25 OK created sql view model dbt_dataset.hub_nation ....................... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:18:04.148585 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_nation
[0m15:18:04.149188 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_order
[0m15:18:04.149998 [info ] [Thread-1 (]: 4 of 25 START sql view model dbt_dataset.hub_order ............................. [RUN]
[0m15:18:04.150771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_nation, now model.dbt_bq_sa.hub_order)
[0m15:18:04.151334 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_order
[0m15:18:04.159525 [info ] [Thread-1 (]: 15:18:04 + Loading trim-field-467501-p5.dbt_dataset.hub_order from 1 source(s)
[0m15:18:04.163923 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_order"
[0m15:18:04.164866 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_order
[0m15:18:04.169636 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_order"
[0m15:18:04.170564 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:04.171192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:05.369408 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:54d554a2-9197-485c-87f7-fb92319e4e07&page=queryresults
[0m15:18:06.304584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159acbb20>]}
[0m15:18:06.307315 [info ] [Thread-1 (]: 4 of 25 OK created sql view model dbt_dataset.hub_order ........................ [[32mCREATE VIEW (0 processed)[0m in 2.15s]
[0m15:18:06.308444 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_order
[0m15:18:06.309073 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_part
[0m15:18:06.309910 [info ] [Thread-1 (]: 5 of 25 START sql view model dbt_dataset.hub_part .............................. [RUN]
[0m15:18:06.310721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_order, now model.dbt_bq_sa.hub_part)
[0m15:18:06.311303 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_part
[0m15:18:06.322475 [info ] [Thread-1 (]: 15:18:06 + Loading trim-field-467501-p5.dbt_dataset.hub_part from 2 source(s)
[0m15:18:06.330702 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_part"
[0m15:18:06.331739 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_part
[0m15:18:06.336706 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_part"
[0m15:18:06.337697 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_part: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_part"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_part`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m15:18:06.338235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:07.464190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f7f33c60-ad33-416b-adaa-8af49e4e278a&page=queryresults
[0m15:18:08.354972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034520e0>]}
[0m15:18:08.356429 [info ] [Thread-1 (]: 5 of 25 OK created sql view model dbt_dataset.hub_part ......................... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:18:08.357357 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_part
[0m15:18:08.357984 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_region
[0m15:18:08.358846 [info ] [Thread-1 (]: 6 of 25 START sql view model dbt_dataset.hub_region ............................ [RUN]
[0m15:18:08.359624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_part, now model.dbt_bq_sa.hub_region)
[0m15:18:08.360204 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_region
[0m15:18:08.368428 [info ] [Thread-1 (]: 15:18:08 + Loading trim-field-467501-p5.dbt_dataset.hub_region from 2 source(s)
[0m15:18:08.374620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_region"
[0m15:18:08.375581 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_region
[0m15:18:08.380405 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_region"
[0m15:18:08.381479 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m15:18:08.381972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:09.664001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:be17caf9-4fe6-4018-97ed-d1eb18ce8800&page=queryresults
[0m15:18:10.482185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ad8040>]}
[0m15:18:10.483971 [info ] [Thread-1 (]: 6 of 25 OK created sql view model dbt_dataset.hub_region ....................... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m15:18:10.485155 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_region
[0m15:18:10.485844 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_supplier
[0m15:18:10.486666 [info ] [Thread-1 (]: 7 of 25 START sql view model dbt_dataset.hub_supplier .......................... [RUN]
[0m15:18:10.487496 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_region, now model.dbt_bq_sa.hub_supplier)
[0m15:18:10.488101 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_supplier
[0m15:18:10.498497 [info ] [Thread-1 (]: 15:18:10 + Loading trim-field-467501-p5.dbt_dataset.hub_supplier from 2 source(s)
[0m15:18:10.504794 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_supplier"
[0m15:18:10.506619 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_supplier
[0m15:18:10.510792 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_supplier"
[0m15:18:10.511807 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_supplier: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_supplier"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_supplier`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m15:18:10.512372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:11.717723 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b9b7f4ba-4204-4579-aab7-2e98d136b97f&page=queryresults
[0m15:18:12.542768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ad28f0>]}
[0m15:18:12.544307 [info ] [Thread-1 (]: 7 of 25 OK created sql view model dbt_dataset.hub_supplier ..................... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m15:18:12.545275 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_supplier
[0m15:18:12.545866 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_nation
[0m15:18:12.546677 [info ] [Thread-1 (]: 8 of 25 START sql view model dbt_dataset.link_customer_nation .................. [RUN]
[0m15:18:12.547395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_supplier, now model.dbt_bq_sa.link_customer_nation)
[0m15:18:12.547974 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_nation
[0m15:18:12.561126 [info ] [Thread-1 (]: 15:18:12 + Loading trim-field-467501-p5.dbt_dataset.link_customer_nation from 1 source(s)
[0m15:18:12.582108 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_nation"
[0m15:18:12.582983 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_nation
[0m15:18:12.587827 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_nation"
[0m15:18:12.588690 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:12.589078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:13.656739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:e400fe7b-0d48-4e93-a5a8-e3b7deb95b2e&page=queryresults
[0m15:18:14.583704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159ad28f0>]}
[0m15:18:14.584367 [info ] [Thread-1 (]: 8 of 25 OK created sql view model dbt_dataset.link_customer_nation ............. [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:18:14.584855 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_nation
[0m15:18:14.585208 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_order
[0m15:18:14.585670 [info ] [Thread-1 (]: 9 of 25 START sql view model dbt_dataset.link_customer_order ................... [RUN]
[0m15:18:14.586087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_nation, now model.dbt_bq_sa.link_customer_order)
[0m15:18:14.586397 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_order
[0m15:18:14.591015 [info ] [Thread-1 (]: 15:18:14 + Loading trim-field-467501-p5.dbt_dataset.link_customer_order from 1 source(s)
[0m15:18:14.593464 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_order"
[0m15:18:14.593997 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_order
[0m15:18:14.596801 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_order"
[0m15:18:14.597359 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:14.597683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:15.817526 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:d1ac953a-1a0b-4206-a07c-684f15d95865&page=queryresults
[0m15:18:16.847174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1599ac0d0>]}
[0m15:18:16.849307 [info ] [Thread-1 (]: 9 of 25 OK created sql view model dbt_dataset.link_customer_order .............. [[32mCREATE VIEW (0 processed)[0m in 2.26s]
[0m15:18:16.850368 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_order
[0m15:18:16.851012 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory
[0m15:18:16.851865 [info ] [Thread-1 (]: 10 of 25 START sql view model dbt_dataset.link_inventory ....................... [RUN]
[0m15:18:16.852751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_order, now model.dbt_bq_sa.link_inventory)
[0m15:18:16.853348 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory
[0m15:18:17.043135 [info ] [Thread-1 (]: 15:18:17 + Loading trim-field-467501-p5.dbt_dataset.link_inventory from 1 source(s)
[0m15:18:17.044984 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory"
[0m15:18:17.045433 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory
[0m15:18:17.047370 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory"
[0m15:18:17.047758 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:17.047982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:18.158805 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4753e3ba-83eb-41ac-939b-7a26f0ff79b7&page=queryresults
[0m15:18:18.958650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b15b70>]}
[0m15:18:18.960125 [info ] [Thread-1 (]: 10 of 25 OK created sql view model dbt_dataset.link_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 2.11s]
[0m15:18:18.961064 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory
[0m15:18:18.961815 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory_allocation
[0m15:18:18.962753 [info ] [Thread-1 (]: 11 of 25 START sql view model dbt_dataset.link_inventory_allocation ............ [RUN]
[0m15:18:18.963524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory, now model.dbt_bq_sa.link_inventory_allocation)
[0m15:18:18.964116 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory_allocation
[0m15:18:18.972628 [info ] [Thread-1 (]: 15:18:18 + Loading trim-field-467501-p5.dbt_dataset.link_inventory_allocation from 1 source(s)
[0m15:18:18.977311 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory_allocation"
[0m15:18:18.978189 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory_allocation
[0m15:18:18.984243 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory_allocation"
[0m15:18:18.985271 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory_allocation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory_allocation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:18.985782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:20.106601 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:253d9768-78c0-43f7-b5aa-5c1d1545fd2a&page=queryresults
[0m15:18:21.087911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159678dc0>]}
[0m15:18:21.089683 [info ] [Thread-1 (]: 11 of 25 OK created sql view model dbt_dataset.link_inventory_allocation ....... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m15:18:21.090792 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory_allocation
[0m15:18:21.091407 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_nation_region
[0m15:18:21.092328 [info ] [Thread-1 (]: 12 of 25 START sql view model dbt_dataset.link_nation_region ................... [RUN]
[0m15:18:21.093112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory_allocation, now model.dbt_bq_sa.link_nation_region)
[0m15:18:21.093752 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_nation_region
[0m15:18:21.102724 [info ] [Thread-1 (]: 15:18:21 + Loading trim-field-467501-p5.dbt_dataset.link_nation_region from 2 source(s)
[0m15:18:21.108942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_nation_region"
[0m15:18:21.110040 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_nation_region
[0m15:18:21.114516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_nation_region"
[0m15:18:21.115333 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_nation_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_nation_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_nation_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m15:18:21.115852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:22.266783 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:adcc9be8-7c66-4f31-a63a-cd9bbdf485f7&page=queryresults
[0m15:18:23.202137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10255f370>]}
[0m15:18:23.203459 [info ] [Thread-1 (]: 12 of 25 OK created sql view model dbt_dataset.link_nation_region .............. [[32mCREATE VIEW (0 processed)[0m in 2.11s]
[0m15:18:23.204367 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_nation_region
[0m15:18:23.204965 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_order_lineitem
[0m15:18:23.205834 [info ] [Thread-1 (]: 13 of 25 START sql view model dbt_dataset.link_order_lineitem .................. [RUN]
[0m15:18:23.206619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_nation_region, now model.dbt_bq_sa.link_order_lineitem)
[0m15:18:23.207243 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_order_lineitem
[0m15:18:23.217336 [info ] [Thread-1 (]: 15:18:23 + Loading trim-field-467501-p5.dbt_dataset.link_order_lineitem from 1 source(s)
[0m15:18:23.222011 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_order_lineitem"
[0m15:18:23.222988 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_order_lineitem
[0m15:18:23.227351 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_order_lineitem"
[0m15:18:23.228163 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_order_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_order_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:23.228637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:24.381987 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:53d6f3db-cfcf-4ec1-8000-413ef7078fc7&page=queryresults
[0m15:18:25.242443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10255f370>]}
[0m15:18:25.243964 [info ] [Thread-1 (]: 13 of 25 OK created sql view model dbt_dataset.link_order_lineitem ............. [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:18:25.244886 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_order_lineitem
[0m15:18:25.245498 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_supplier_nation
[0m15:18:25.246325 [info ] [Thread-1 (]: 14 of 25 START sql view model dbt_dataset.link_supplier_nation ................. [RUN]
[0m15:18:25.247139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_order_lineitem, now model.dbt_bq_sa.link_supplier_nation)
[0m15:18:25.247724 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_supplier_nation
[0m15:18:25.256377 [info ] [Thread-1 (]: 15:18:25 + Loading trim-field-467501-p5.dbt_dataset.link_supplier_nation from 1 source(s)
[0m15:18:25.261371 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_supplier_nation"
[0m15:18:25.262457 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_supplier_nation
[0m15:18:25.267066 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_supplier_nation"
[0m15:18:25.267873 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_supplier_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_supplier_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m15:18:25.268360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:26.763694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ea07948d-c133-4ad2-b4d0-bfd077b2fb1a&page=queryresults
[0m15:18:27.700505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba5750>]}
[0m15:18:27.702678 [info ] [Thread-1 (]: 14 of 25 OK created sql view model dbt_dataset.link_supplier_nation ............ [[32mCREATE VIEW (0 processed)[0m in 2.45s]
[0m15:18:27.703676 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_supplier_nation
[0m15:18:27.704343 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_inventory_details
[0m15:18:27.705234 [info ] [Thread-1 (]: 15 of 25 START sql view model dbt_dataset.sat_inv_inventory_details ............ [RUN]
[0m15:18:27.706095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_supplier_nation, now model.dbt_bq_sa.sat_inv_inventory_details)
[0m15:18:27.706688 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_inventory_details
[0m15:18:27.757588 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m15:18:27.758359 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_inventory_details
[0m15:18:27.761242 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m15:18:27.761836 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_inventory_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_inventory_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:27.762147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:28.990803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b956287c-c390-4c49-a73b-4e804e600ae9&page=queryresults
[0m15:18:29.913419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157b1d990>]}
[0m15:18:29.922783 [info ] [Thread-1 (]: 15 of 25 OK created sql view model dbt_dataset.sat_inv_inventory_details ....... [[32mCREATE VIEW (0 processed)[0m in 2.19s]
[0m15:18:29.925065 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_inventory_details
[0m15:18:29.928104 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_part_details
[0m15:18:29.929755 [info ] [Thread-1 (]: 16 of 25 START sql view model dbt_dataset.sat_inv_part_details ................. [RUN]
[0m15:18:29.930899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_inventory_details, now model.dbt_bq_sa.sat_inv_part_details)
[0m15:18:29.932983 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_part_details
[0m15:18:29.968624 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_part_details"
[0m15:18:29.969404 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_part_details
[0m15:18:29.973158 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_part_details"
[0m15:18:29.974703 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_part_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_part_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:29.975140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:31.113567 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:044ea188-de3f-4698-abe3-e31d7ed4992e&page=queryresults
[0m15:18:31.972515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b14a30>]}
[0m15:18:31.974552 [info ] [Thread-1 (]: 16 of 25 OK created sql view model dbt_dataset.sat_inv_part_details ............ [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:18:31.975472 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_part_details
[0m15:18:31.976072 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m15:18:31.976899 [info ] [Thread-1 (]: 17 of 25 START sql view model dbt_dataset.sat_inv_supp_nation_details .......... [RUN]
[0m15:18:31.977422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_part_details, now model.dbt_bq_sa.sat_inv_supp_nation_details)
[0m15:18:31.977857 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m15:18:32.003106 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m15:18:32.004200 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m15:18:32.010234 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m15:18:32.011122 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:32.011588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:33.210366 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a9fd8ee7-6441-46b6-9d93-6a733d814d11&page=queryresults
[0m15:18:34.039987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c09480>]}
[0m15:18:34.041168 [info ] [Thread-1 (]: 17 of 25 OK created sql view model dbt_dataset.sat_inv_supp_nation_details ..... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m15:18:34.042332 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m15:18:34.042975 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m15:18:34.043823 [info ] [Thread-1 (]: 18 of 25 START sql view model dbt_dataset.sat_inv_supp_region_details .......... [RUN]
[0m15:18:34.044537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_nation_details, now model.dbt_bq_sa.sat_inv_supp_region_details)
[0m15:18:34.045101 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_region_details
[0m15:18:34.056728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m15:18:34.057413 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_region_details
[0m15:18:34.060183 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m15:18:34.060715 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:34.061055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:35.333381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:86f91ede-f749-477c-a1e5-f3a92e5fbba1&page=queryresults
[0m15:18:37.346220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159af7c10>]}
[0m15:18:37.347477 [info ] [Thread-1 (]: 18 of 25 OK created sql view model dbt_dataset.sat_inv_supp_region_details ..... [[32mCREATE VIEW (0 processed)[0m in 3.30s]
[0m15:18:37.348068 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m15:18:37.348505 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supplier_details
[0m15:18:37.349142 [info ] [Thread-1 (]: 19 of 25 START sql view model dbt_dataset.sat_inv_supplier_details ............. [RUN]
[0m15:18:37.349640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_region_details, now model.dbt_bq_sa.sat_inv_supplier_details)
[0m15:18:37.350019 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supplier_details
[0m15:18:37.373054 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m15:18:37.377088 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supplier_details
[0m15:18:37.380370 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m15:18:37.381091 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supplier_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supplier_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:37.381449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:38.489209 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:829f3047-eb96-4eab-ac51-38abcb8c55ff&page=queryresults
[0m15:18:39.340208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c09480>]}
[0m15:18:39.341338 [info ] [Thread-1 (]: 19 of 25 OK created sql view model dbt_dataset.sat_inv_supplier_details ........ [[32mCREATE VIEW (0 processed)[0m in 1.99s]
[0m15:18:39.342209 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supplier_details
[0m15:18:39.342807 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m15:18:39.343587 [info ] [Thread-1 (]: 20 of 25 START sql view model dbt_dataset.sat_order_cust_nation_details ........ [RUN]
[0m15:18:39.344331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supplier_details, now model.dbt_bq_sa.sat_order_cust_nation_details)
[0m15:18:39.344782 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_nation_details
[0m15:18:39.353654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m15:18:39.354227 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_nation_details
[0m15:18:39.356526 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m15:18:39.357137 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:39.357419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:40.587832 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7c914e29-9f93-494a-8e44-5751ff840177&page=queryresults
[0m15:18:41.617706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157f535b0>]}
[0m15:18:41.619403 [info ] [Thread-1 (]: 20 of 25 OK created sql view model dbt_dataset.sat_order_cust_nation_details ... [[32mCREATE VIEW (0 processed)[0m in 2.27s]
[0m15:18:41.620389 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m15:18:41.621045 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_region_details
[0m15:18:41.621926 [info ] [Thread-1 (]: 21 of 25 START sql view model dbt_dataset.sat_order_cust_region_details ........ [RUN]
[0m15:18:41.622768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_nation_details, now model.dbt_bq_sa.sat_order_cust_region_details)
[0m15:18:41.623386 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_region_details
[0m15:18:41.639781 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m15:18:41.640809 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_region_details
[0m15:18:41.645285 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m15:18:41.646159 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:41.646657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:42.641238 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ab25f6a5-4e66-48cf-b993-5603d89f2af5&page=queryresults
[0m15:18:43.445298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x157f535b0>]}
[0m15:18:43.446667 [info ] [Thread-1 (]: 21 of 25 OK created sql view model dbt_dataset.sat_order_cust_region_details ... [[32mCREATE VIEW (0 processed)[0m in 1.82s]
[0m15:18:43.447654 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_region_details
[0m15:18:43.448307 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_customer_details
[0m15:18:43.449125 [info ] [Thread-1 (]: 22 of 25 START sql view model dbt_dataset.sat_order_customer_details ........... [RUN]
[0m15:18:43.450086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_region_details, now model.dbt_bq_sa.sat_order_customer_details)
[0m15:18:43.450677 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_customer_details
[0m15:18:43.466455 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_customer_details"
[0m15:18:43.467281 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_customer_details
[0m15:18:43.470928 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_customer_details"
[0m15:18:43.471662 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_customer_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_customer_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:43.472049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:44.802160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b6488b9c-63c0-4c0b-ba25-9a5f01d66727&page=queryresults
[0m15:18:45.590982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159abb850>]}
[0m15:18:46.834643 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m15:18:46.838753 [info ] [Thread-1 (]: 22 of 25 OK created sql view model dbt_dataset.sat_order_customer_details ...... [[32mCREATE VIEW (0 processed)[0m in 2.14s]
[0m15:18:46.840296 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_customer_details
[0m15:18:46.841251 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_lineitem_details
[0m15:18:46.842323 [info ] [Thread-1 (]: 23 of 25 START sql view model dbt_dataset.sat_order_lineitem_details ........... [RUN]
[0m15:18:46.842997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_customer_details, now model.dbt_bq_sa.sat_order_lineitem_details)
[0m15:18:46.843467 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_lineitem_details
[0m15:18:46.867467 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m15:18:46.868753 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_lineitem_details
[0m15:18:46.873658 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m15:18:46.874635 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_lineitem_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_lineitem_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:46.875107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:48.060207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:d714edd3-32b9-4e97-b696-7def24a773b0&page=queryresults
[0m15:18:48.881038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b92170>]}
[0m15:18:48.882463 [info ] [Thread-1 (]: 23 of 25 OK created sql view model dbt_dataset.sat_order_lineitem_details ...... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m15:18:48.883782 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_lineitem_details
[0m15:18:48.884637 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_order_details
[0m15:18:48.885968 [info ] [Thread-1 (]: 24 of 25 START sql view model dbt_dataset.sat_order_order_details .............. [RUN]
[0m15:18:48.886526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_lineitem_details, now model.dbt_bq_sa.sat_order_order_details)
[0m15:18:48.886802 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_order_details
[0m15:18:48.899787 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_order_details"
[0m15:18:48.900412 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_order_details
[0m15:18:48.904417 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_order_details"
[0m15:18:48.905088 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_order_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_order_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m15:18:48.905401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:50.005665 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a7cfb124-acd0-465f-8d42-e52ca71948a8&page=queryresults
[0m15:18:50.840681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10255d1b0>]}
[0m15:18:50.841976 [info ] [Thread-1 (]: 24 of 25 OK created sql view model dbt_dataset.sat_order_order_details ......... [[32mCREATE VIEW (0 processed)[0m in 1.95s]
[0m15:18:50.842925 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_order_details
[0m15:18:50.843690 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.t_link_transactions
[0m15:18:50.844537 [info ] [Thread-1 (]: 25 of 25 START sql view model dbt_dataset.t_link_transactions .................. [RUN]
[0m15:18:50.845310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_order_details, now model.dbt_bq_sa.t_link_transactions)
[0m15:18:50.846065 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.t_link_transactions
[0m15:18:50.876974 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.t_link_transactions"
[0m15:18:50.879218 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.t_link_transactions
[0m15:18:50.885006 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.t_link_transactions"
[0m15:18:50.888591 [debug] [Thread-1 (]: On model.dbt_bq_sa.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.t_link_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`t_link_transactions`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert;


[0m15:18:50.889344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:18:52.013371 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6182880b-3c9b-45b6-ae02-7e31e9a95fc4&page=queryresults
[0m15:18:52.824606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea2831cf-4b86-430d-9bad-9f9d7e2dc682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159b3e920>]}
[0m15:18:52.825829 [info ] [Thread-1 (]: 25 of 25 OK created sql view model dbt_dataset.t_link_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 1.98s]
[0m15:18:52.826779 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.t_link_transactions
[0m15:18:52.828477 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:18:52.830084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:52.830355 [debug] [MainThread]: Connection 'model.dbt_bq_sa.t_link_transactions' was properly closed.
[0m15:18:52.830746 [info ] [MainThread]: 
[0m15:18:52.831008 [info ] [MainThread]: Finished running 25 view models in 0 hours 0 minutes and 57.00 seconds (57.00s).
[0m15:18:52.833773 [debug] [MainThread]: Command end result
[0m15:18:52.868944 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m15:18:52.874584 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m15:18:52.883797 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m15:18:52.884138 [info ] [MainThread]: 
[0m15:18:52.884464 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:52.884733 [info ] [MainThread]: 
[0m15:18:52.885018 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=25
[0m15:18:52.885571 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:18:52.887659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 59.156708, "process_in_blocks": "0", "process_kernel_time": 1.410755, "process_mem_max_rss": "337903616", "process_out_blocks": "0", "process_user_time": 5.937782}
[0m15:18:52.888173 [debug] [MainThread]: Command `dbt run` succeeded at 15:18:52.888104 after 59.16 seconds
[0m15:18:52.888510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103adf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102319d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1593f2650>]}
[0m15:18:52.888789 [debug] [MainThread]: Flushing usage events
[0m15:18:53.839674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:28.232411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ceb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3cc40>]}


============================== 16:32:28.235697 | af66e0d0-56fb-45d2-b555-55619791eec4 ==============================
[0m16:32:28.235697 [info ] [MainThread]: Running with dbt=1.10.7
[0m16:32:28.236041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/Downloads/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:32:30.159829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106035a20>]}
[0m16:32:30.191136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db3e80>]}
[0m16:32:30.191505 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m16:32:30.324668 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m16:32:30.428393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:30.428657 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:30.432866 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.raw_vault.t_links
- models.raw_stage
- models.stage
- models.raw_vault.hubs
- models.raw_vault.links
- models.raw_vault
- models.raw_vault.sats
[0m16:32:30.452784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1527f8670>]}
[0m16:32:30.512106 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m16:32:30.513854 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m16:32:30.526793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1527f9780>]}
[0m16:32:30.527094 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m16:32:30.527279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1527f9990>]}
[0m16:32:30.528709 [info ] [MainThread]: 
[0m16:32:30.528939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:30.529094 [info ] [MainThread]: 
[0m16:32:30.529365 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:32:30.533102 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m16:32:30.533400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:31.358685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m16:32:31.359853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:32.273433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfb130>]}
[0m16:32:32.274440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:32.280381 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_orders
[0m16:32:32.281108 [info ] [Thread-1 (]: 1 of 31 START sql view model dbt_dataset.raw_orders ............................ [RUN]
[0m16:32:32.281725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_orders)
[0m16:32:32.282367 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_orders
[0m16:32:32.298446 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_orders"
[0m16:32:32.299848 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_orders
[0m16:32:32.326153 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_orders"
[0m16:32:32.326914 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
  OPTIONS()
  as SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`lineitem` AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON c.C_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m16:32:32.327325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:33.349105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:9f6ff983-6f63-46ff-bae2-c1b5b80abb0d&page=queryresults
[0m16:32:34.307197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a3b1720>]}
[0m16:32:34.307861 [info ] [Thread-1 (]: 1 of 31 OK created sql view model dbt_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.02s]
[0m16:32:34.308326 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_orders
[0m16:32:34.308632 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m16:32:34.309120 [info ] [Thread-1 (]: 2 of 31 START sql view model dbt_dataset.raw_transactions ...................... [RUN]
[0m16:32:34.309509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_orders, now model.dbt_bq_sa.raw_transactions)
[0m16:32:34.309821 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m16:32:34.313566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m16:32:34.314488 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m16:32:34.317174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m16:32:34.317657 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATE_ADD(b.O_ORDERDATE, INTERVAL 20 DAY) AS TRANSACTION_DATE,
    CAST(RPAD(CONCAT(CAST(b.O_ORDERKEY AS STRING), CAST(b.O_CUSTKEY AS STRING), FORMAT_DATE('%Y%m%d', b.O_ORDERDATE)), 24, '0') AS INT64) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
        CASE FLOOR(RAND() * 2) + 1
            WHEN 1 THEN 'DR'
            WHEN 2 THEN 'CR'
        END AS STRING) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m16:32:34.317961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:35.323540 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:0ad6fce4-3850-4c24-8cc6-87f4c6535c2e&page=queryresults
[0m16:32:36.176005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153126500>]}
[0m16:32:36.177320 [info ] [Thread-1 (]: 2 of 31 OK created sql view model dbt_dataset.raw_transactions ................. [[32mCREATE VIEW (0 processed)[0m in 1.87s]
[0m16:32:36.178228 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m16:32:36.178744 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m16:32:36.179575 [info ] [Thread-1 (]: 3 of 31 START sql view model dbt_dataset.raw_inventory ......................... [RUN]
[0m16:32:36.180249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_transactions, now model.dbt_bq_sa.raw_inventory)
[0m16:32:36.180732 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m16:32:36.189323 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m16:32:36.191408 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m16:32:36.195930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m16:32:36.197750 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`partsupp` AS a
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m16:32:36.198328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:37.345803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:46a827b1-d541-46ed-9693-83002985b883&page=queryresults
[0m16:32:38.299149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15279faf0>]}
[0m16:32:38.300943 [info ] [Thread-1 (]: 3 of 31 OK created sql view model dbt_dataset.raw_inventory .................... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m16:32:38.302035 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m16:32:38.302655 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_orders
[0m16:32:38.303638 [info ] [Thread-1 (]: 4 of 31 START sql view model dbt_dataset.v_stg_orders .......................... [RUN]
[0m16:32:38.304456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_inventory, now model.dbt_bq_sa.v_stg_orders)
[0m16:32:38.305069 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_orders
[0m16:32:38.341141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:39.928471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_orders"
[0m16:32:39.930065 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_orders
[0m16:32:39.932300 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_orders"
[0m16:32:39.933320 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders`
  OPTIONS()
  as 







WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), '')))) AS STRING) AS ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS ORDER_CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINEITEM_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS LINK_LINEITEM_ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS INVENTORY_ALLOCATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS STRING))), ''), '^^')
    )))) AS STRING) AS LINEITEM_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS STRING))), ''), '^^')
    )))) AS STRING) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE
FROM staging;


[0m16:32:40.753206 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:db695bd7-09b4-4a76-95a8-99567ee5ed63&page=queryresults
[0m16:32:41.599875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a3b1720>]}
[0m16:32:41.601305 [info ] [Thread-1 (]: 4 of 31 OK created sql view model dbt_dataset.v_stg_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 3.30s]
[0m16:32:41.602225 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_orders
[0m16:32:41.602832 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m16:32:41.604054 [info ] [Thread-1 (]: 5 of 31 START sql view model dbt_dataset.v_stg_transactions .................... [RUN]
[0m16:32:41.604799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_orders, now model.dbt_bq_sa.v_stg_transactions)
[0m16:32:41.605533 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m16:32:41.614211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:43.017284 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_transactions"
[0m16:32:43.020356 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_transactions
[0m16:32:43.026293 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_transactions"
[0m16:32:43.027433 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
  OPTIONS()
  as 







-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATE_ADD(TRANSACTION_DATE, INTERVAL 1 DAY) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS TRANSACTION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS STRING))), '')))) AS STRING) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m16:32:43.731762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:c4289e63-aea1-4041-8f37-f0f289cf310d&page=queryresults
[0m16:32:44.853707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153657430>]}
[0m16:32:44.855085 [info ] [Thread-1 (]: 5 of 31 OK created sql view model dbt_dataset.v_stg_transactions ............... [[32mCREATE VIEW (0 processed)[0m in 3.25s]
[0m16:32:44.855986 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_transactions
[0m16:32:44.856593 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory
[0m16:32:44.857586 [info ] [Thread-1 (]: 6 of 31 START sql view model dbt_dataset.v_stg_inventory ....................... [RUN]
[0m16:32:44.858388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_transactions, now model.dbt_bq_sa.v_stg_inventory)
[0m16:32:44.858937 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory
[0m16:32:44.869066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:46.284414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory"
[0m16:32:46.286290 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory
[0m16:32:46.289660 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory"
[0m16:32:46.290534 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m16:32:47.159279 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:12567b48-fd56-472a-a562-55d5482bd465&page=queryresults
[0m16:32:48.029701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153656e30>]}
[0m16:32:48.031252 [info ] [Thread-1 (]: 6 of 31 OK created sql view model dbt_dataset.v_stg_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 3.17s]
[0m16:32:48.032155 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory
[0m16:32:48.032759 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_customer
[0m16:32:48.033654 [info ] [Thread-1 (]: 7 of 31 START sql view model dbt_dataset.hub_customer .......................... [RUN]
[0m16:32:48.034819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory, now model.dbt_bq_sa.hub_customer)
[0m16:32:48.035479 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_customer
[0m16:32:48.062815 [info ] [Thread-1 (]: 16:32:48 + Loading trim-field-467501-p5.dbt_dataset.hub_customer from 1 source(s)
[0m16:32:48.103584 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_customer"
[0m16:32:48.105082 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_customer
[0m16:32:48.107926 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_customer"
[0m16:32:48.108361 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_customer: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_customer"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_customer`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:32:48.108629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:49.234183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:19e4620e-1962-4cff-a2f1-72e4c45e9eb1&page=queryresults
[0m16:32:50.087840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a3b1720>]}
[0m16:32:50.089719 [info ] [Thread-1 (]: 7 of 31 OK created sql view model dbt_dataset.hub_customer ..................... [[32mCREATE VIEW (0 processed)[0m in 2.05s]
[0m16:32:50.090651 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_customer
[0m16:32:50.091273 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_lineitem
[0m16:32:50.092178 [info ] [Thread-1 (]: 8 of 31 START sql view model dbt_dataset.hub_lineitem .......................... [RUN]
[0m16:32:50.092965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_customer, now model.dbt_bq_sa.hub_lineitem)
[0m16:32:50.093538 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_lineitem
[0m16:32:50.101997 [info ] [Thread-1 (]: 16:32:50 + Loading trim-field-467501-p5.dbt_dataset.hub_lineitem from 1 source(s)
[0m16:32:50.106252 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_lineitem"
[0m16:32:50.107137 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_lineitem
[0m16:32:50.111784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_lineitem"
[0m16:32:50.112713 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:32:50.113187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:51.220646 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f77ea92e-972a-4ced-97af-af2c63d13a02&page=queryresults
[0m16:32:52.123605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153656e30>]}
[0m16:32:52.124998 [info ] [Thread-1 (]: 8 of 31 OK created sql view model dbt_dataset.hub_lineitem ..................... [[32mCREATE VIEW (0 processed)[0m in 2.03s]
[0m16:32:52.125867 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_lineitem
[0m16:32:52.126455 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_order
[0m16:32:52.127290 [info ] [Thread-1 (]: 9 of 31 START sql view model dbt_dataset.hub_order ............................. [RUN]
[0m16:32:52.128076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_lineitem, now model.dbt_bq_sa.hub_order)
[0m16:32:52.128674 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_order
[0m16:32:52.138651 [info ] [Thread-1 (]: 16:32:52 + Loading trim-field-467501-p5.dbt_dataset.hub_order from 1 source(s)
[0m16:32:52.323663 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_order"
[0m16:32:52.324920 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_order
[0m16:32:52.326927 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_order"
[0m16:32:52.327302 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:32:52.327535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:53.524862 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f40f0939-a074-4145-8cb7-af4b67057b59&page=queryresults
[0m16:32:54.401778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1527ac340>]}
[0m16:32:54.403831 [info ] [Thread-1 (]: 9 of 31 OK created sql view model dbt_dataset.hub_order ........................ [[32mCREATE VIEW (0 processed)[0m in 2.27s]
[0m16:32:54.404956 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_order
[0m16:32:54.405573 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_nation
[0m16:32:54.406409 [info ] [Thread-1 (]: 10 of 31 START sql view model dbt_dataset.link_customer_nation ................. [RUN]
[0m16:32:54.407206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_order, now model.dbt_bq_sa.link_customer_nation)
[0m16:32:54.407973 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_nation
[0m16:32:54.422378 [info ] [Thread-1 (]: 16:32:54 + Loading trim-field-467501-p5.dbt_dataset.link_customer_nation from 1 source(s)
[0m16:32:54.443922 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_nation"
[0m16:32:54.444917 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_nation
[0m16:32:54.449482 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_nation"
[0m16:32:54.450415 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:32:54.450802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:55.597051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7004fefc-6eaf-4443-a1f4-316ef1034a6a&page=queryresults
[0m16:32:56.411902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15279f490>]}
[0m16:32:56.414046 [info ] [Thread-1 (]: 10 of 31 OK created sql view model dbt_dataset.link_customer_nation ............ [[32mCREATE VIEW (0 processed)[0m in 2.00s]
[0m16:32:56.414829 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_nation
[0m16:32:56.415859 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_order
[0m16:32:56.416683 [info ] [Thread-1 (]: 11 of 31 START sql view model dbt_dataset.link_customer_order .................. [RUN]
[0m16:32:56.418397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_nation, now model.dbt_bq_sa.link_customer_order)
[0m16:32:56.419315 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_order
[0m16:32:56.439250 [info ] [Thread-1 (]: 16:32:56 + Loading trim-field-467501-p5.dbt_dataset.link_customer_order from 1 source(s)
[0m16:32:56.444311 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_order"
[0m16:32:56.445046 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_order
[0m16:32:56.449007 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_order"
[0m16:32:56.450715 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:32:56.451976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:57.644382 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a02384eb-422a-44a2-8a81-0f1a4021859c&page=queryresults
[0m16:32:58.511692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15279f3d0>]}
[0m16:32:58.513807 [info ] [Thread-1 (]: 11 of 31 OK created sql view model dbt_dataset.link_customer_order ............. [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m16:32:58.514707 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_order
[0m16:32:58.519423 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory_allocation
[0m16:32:58.520592 [info ] [Thread-1 (]: 12 of 31 START sql view model dbt_dataset.link_inventory_allocation ............ [RUN]
[0m16:32:58.521460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_order, now model.dbt_bq_sa.link_inventory_allocation)
[0m16:32:58.521940 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory_allocation
[0m16:32:58.543806 [info ] [Thread-1 (]: 16:32:58 + Loading trim-field-467501-p5.dbt_dataset.link_inventory_allocation from 1 source(s)
[0m16:32:58.554285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory_allocation"
[0m16:32:58.555182 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory_allocation
[0m16:32:58.561563 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory_allocation"
[0m16:32:58.562760 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory_allocation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory_allocation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:32:58.563206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:59.596983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ca74d77d-8dd9-4e58-99aa-e43adc29fe28&page=queryresults
[0m16:33:00.443713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1536ca9b0>]}
[0m16:33:00.445224 [info ] [Thread-1 (]: 12 of 31 OK created sql view model dbt_dataset.link_inventory_allocation ....... [[32mCREATE VIEW (0 processed)[0m in 1.92s]
[0m16:33:00.446127 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory_allocation
[0m16:33:00.446729 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_order_lineitem
[0m16:33:00.447409 [info ] [Thread-1 (]: 13 of 31 START sql view model dbt_dataset.link_order_lineitem .................. [RUN]
[0m16:33:00.447910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory_allocation, now model.dbt_bq_sa.link_order_lineitem)
[0m16:33:00.448204 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_order_lineitem
[0m16:33:00.452752 [info ] [Thread-1 (]: 16:33:00 + Loading trim-field-467501-p5.dbt_dataset.link_order_lineitem from 1 source(s)
[0m16:33:00.455545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_order_lineitem"
[0m16:33:00.456101 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_order_lineitem
[0m16:33:00.459131 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_order_lineitem"
[0m16:33:00.459797 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_order_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_order_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:33:00.460151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:01.577353 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4c418526-f005-4f92-9d16-54d130fe9c58&page=queryresults
[0m16:33:02.424646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1536fd4e0>]}
[0m16:33:02.426128 [info ] [Thread-1 (]: 13 of 31 OK created sql view model dbt_dataset.link_order_lineitem ............. [[32mCREATE VIEW (0 processed)[0m in 1.98s]
[0m16:33:02.426865 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_order_lineitem
[0m16:33:02.427315 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m16:33:02.428534 [info ] [Thread-1 (]: 14 of 31 START sql view model dbt_dataset.sat_order_cust_nation_details ........ [RUN]
[0m16:33:02.429188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_order_lineitem, now model.dbt_bq_sa.sat_order_cust_nation_details)
[0m16:33:02.429455 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_nation_details
[0m16:33:02.483203 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m16:33:02.484225 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_nation_details
[0m16:33:02.487066 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m16:33:02.487760 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:02.488083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:03.633339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ae6f5a12-e4e1-4750-b81c-fa696adfc458&page=queryresults
[0m16:33:04.471910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153700e50>]}
[0m16:33:04.473114 [info ] [Thread-1 (]: 14 of 31 OK created sql view model dbt_dataset.sat_order_cust_nation_details ... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m16:33:04.473914 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m16:33:04.474335 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_region_details
[0m16:33:04.474669 [info ] [Thread-1 (]: 15 of 31 START sql view model dbt_dataset.sat_order_cust_region_details ........ [RUN]
[0m16:33:04.475316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_nation_details, now model.dbt_bq_sa.sat_order_cust_region_details)
[0m16:33:04.475723 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_region_details
[0m16:33:04.488903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m16:33:04.490060 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_region_details
[0m16:33:04.493732 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m16:33:04.494591 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:04.494986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:05.740086 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:07cc22a9-d027-474c-ab8e-f275cbf69083&page=queryresults
[0m16:33:06.587832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531269e0>]}
[0m16:33:06.591160 [info ] [Thread-1 (]: 15 of 31 OK created sql view model dbt_dataset.sat_order_cust_region_details ... [[32mCREATE VIEW (0 processed)[0m in 2.11s]
[0m16:33:06.592117 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_region_details
[0m16:33:06.592585 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_customer_details
[0m16:33:06.593181 [info ] [Thread-1 (]: 16 of 31 START sql view model dbt_dataset.sat_order_customer_details ........... [RUN]
[0m16:33:06.593508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_region_details, now model.dbt_bq_sa.sat_order_customer_details)
[0m16:33:06.593712 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_customer_details
[0m16:33:06.609933 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_customer_details"
[0m16:33:06.610517 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_customer_details
[0m16:33:06.618852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_customer_details"
[0m16:33:06.619585 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_customer_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_customer_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:06.619892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:07.703527 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ee2f6fd2-0b27-41ac-8613-49d940892490&page=queryresults
[0m16:33:08.680456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15311d990>]}
[0m16:33:08.681724 [info ] [Thread-1 (]: 16 of 31 OK created sql view model dbt_dataset.sat_order_customer_details ...... [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m16:33:08.682627 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_customer_details
[0m16:33:08.683220 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_lineitem_details
[0m16:33:08.684107 [info ] [Thread-1 (]: 17 of 31 START sql view model dbt_dataset.sat_order_lineitem_details ........... [RUN]
[0m16:33:08.684884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_customer_details, now model.dbt_bq_sa.sat_order_lineitem_details)
[0m16:33:08.685458 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_lineitem_details
[0m16:33:08.706944 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m16:33:08.707933 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_lineitem_details
[0m16:33:08.712278 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m16:33:08.712959 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_lineitem_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_lineitem_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:08.713382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:09.851393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b85c0611-b8c6-4bd1-883d-a1d579310af9&page=queryresults
[0m16:33:10.937983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15311d5d0>]}
[0m16:33:10.939101 [info ] [Thread-1 (]: 17 of 31 OK created sql view model dbt_dataset.sat_order_lineitem_details ...... [[32mCREATE VIEW (0 processed)[0m in 2.25s]
[0m16:33:10.939532 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_lineitem_details
[0m16:33:10.939864 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_order_details
[0m16:33:10.940357 [info ] [Thread-1 (]: 18 of 31 START sql view model dbt_dataset.sat_order_order_details .............. [RUN]
[0m16:33:10.940681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_lineitem_details, now model.dbt_bq_sa.sat_order_order_details)
[0m16:33:10.940893 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_order_details
[0m16:33:10.961741 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_order_details"
[0m16:33:10.962583 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_order_details
[0m16:33:10.965221 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_order_details"
[0m16:33:10.965784 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_order_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_order_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:10.966050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:12.023764 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:8c41a89d-2e73-4678-b0c4-1df74545bd62&page=queryresults
[0m16:33:12.871249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1531269e0>]}
[0m16:33:12.872880 [info ] [Thread-1 (]: 18 of 31 OK created sql view model dbt_dataset.sat_order_order_details ......... [[32mCREATE VIEW (0 processed)[0m in 1.93s]
[0m16:33:12.874566 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_order_details
[0m16:33:12.875435 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.t_link_transactions
[0m16:33:12.876386 [info ] [Thread-1 (]: 19 of 31 START sql view model dbt_dataset.t_link_transactions .................. [RUN]
[0m16:33:12.877168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_order_details, now model.dbt_bq_sa.t_link_transactions)
[0m16:33:12.877488 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.t_link_transactions
[0m16:33:12.894764 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.t_link_transactions"
[0m16:33:12.895661 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.t_link_transactions
[0m16:33:12.899259 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.t_link_transactions"
[0m16:33:12.899858 [debug] [Thread-1 (]: On model.dbt_bq_sa.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.t_link_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`t_link_transactions`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert;


[0m16:33:12.900147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:14.084351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:c7ba7fba-9bd1-410b-9a4f-0f5e2c316ca7&page=queryresults
[0m16:33:15.400619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152681030>]}
[0m16:33:15.402088 [info ] [Thread-1 (]: 19 of 31 OK created sql view model dbt_dataset.t_link_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 2.52s]
[0m16:33:15.404047 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.t_link_transactions
[0m16:33:15.404480 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_nation
[0m16:33:15.404942 [info ] [Thread-1 (]: 20 of 31 START sql view model dbt_dataset.hub_nation ........................... [RUN]
[0m16:33:15.405357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.t_link_transactions, now model.dbt_bq_sa.hub_nation)
[0m16:33:15.405642 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_nation
[0m16:33:15.409741 [info ] [Thread-1 (]: 16:33:15 + Loading trim-field-467501-p5.dbt_dataset.hub_nation from 2 source(s)
[0m16:33:15.412952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_nation"
[0m16:33:15.413505 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_nation
[0m16:33:15.416130 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_nation"
[0m16:33:15.417255 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m16:33:15.417651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:16.555390 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:3340bcb8-6f8f-4bf4-9427-3bca7f80f692&page=queryresults
[0m16:33:17.443253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b331f0>]}
[0m16:33:17.444861 [info ] [Thread-1 (]: 20 of 31 OK created sql view model dbt_dataset.hub_nation ...................... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m16:33:17.446112 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_nation
[0m16:33:17.446762 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_part
[0m16:33:17.447592 [info ] [Thread-1 (]: 21 of 31 START sql view model dbt_dataset.hub_part ............................. [RUN]
[0m16:33:17.448258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_nation, now model.dbt_bq_sa.hub_part)
[0m16:33:17.448657 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_part
[0m16:33:17.455862 [info ] [Thread-1 (]: 16:33:17 + Loading trim-field-467501-p5.dbt_dataset.hub_part from 2 source(s)
[0m16:33:17.471916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_part"
[0m16:33:17.486134 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_part
[0m16:33:17.493429 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_part"
[0m16:33:17.494423 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_part: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_part"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_part`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m16:33:17.495849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:18.623773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ffa7ce84-1a81-4e28-9111-d04b8cd34342&page=queryresults
[0m16:33:19.459822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b331f0>]}
[0m16:33:19.461280 [info ] [Thread-1 (]: 21 of 31 OK created sql view model dbt_dataset.hub_part ........................ [[32mCREATE VIEW (0 processed)[0m in 2.01s]
[0m16:33:19.462231 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_part
[0m16:33:19.462881 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_region
[0m16:33:19.463430 [info ] [Thread-1 (]: 22 of 31 START sql view model dbt_dataset.hub_region ........................... [RUN]
[0m16:33:19.464066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_part, now model.dbt_bq_sa.hub_region)
[0m16:33:19.468091 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_region
[0m16:33:19.474280 [info ] [Thread-1 (]: 16:33:19 + Loading trim-field-467501-p5.dbt_dataset.hub_region from 2 source(s)
[0m16:33:19.477668 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_region"
[0m16:33:19.478461 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_region
[0m16:33:19.482299 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_region"
[0m16:33:19.482908 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m16:33:19.483206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:20.695079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:3278a004-25e9-4b24-9bae-fc51d8ac7c58&page=queryresults
[0m16:33:21.563279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152681030>]}
[0m16:33:21.564766 [info ] [Thread-1 (]: 22 of 31 OK created sql view model dbt_dataset.hub_region ...................... [[32mCREATE VIEW (0 processed)[0m in 2.10s]
[0m16:33:21.565722 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_region
[0m16:33:21.566345 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_supplier
[0m16:33:21.567073 [info ] [Thread-1 (]: 23 of 31 START sql view model dbt_dataset.hub_supplier ......................... [RUN]
[0m16:33:21.567499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_region, now model.dbt_bq_sa.hub_supplier)
[0m16:33:21.567776 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_supplier
[0m16:33:21.573478 [info ] [Thread-1 (]: 16:33:21 + Loading trim-field-467501-p5.dbt_dataset.hub_supplier from 2 source(s)
[0m16:33:21.577621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_supplier"
[0m16:33:21.578300 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_supplier
[0m16:33:21.580852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_supplier"
[0m16:33:21.581452 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_supplier: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_supplier"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_supplier`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m16:33:21.581794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:22.605216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:79adf02a-a81a-4dbf-93fb-bd1e0d4cde22&page=queryresults
[0m16:33:23.477562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152681030>]}
[0m16:33:24.692473 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m16:33:24.696781 [info ] [Thread-1 (]: 23 of 31 OK created sql view model dbt_dataset.hub_supplier .................... [[32mCREATE VIEW (0 processed)[0m in 1.91s]
[0m16:33:24.698408 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_supplier
[0m16:33:24.699329 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory
[0m16:33:24.700882 [info ] [Thread-1 (]: 24 of 31 START sql view model dbt_dataset.link_inventory ....................... [RUN]
[0m16:33:24.701938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_supplier, now model.dbt_bq_sa.link_inventory)
[0m16:33:24.703420 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory
[0m16:33:24.719748 [info ] [Thread-1 (]: 16:33:24 + Loading trim-field-467501-p5.dbt_dataset.link_inventory from 1 source(s)
[0m16:33:24.724952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory"
[0m16:33:24.725902 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory
[0m16:33:24.729150 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory"
[0m16:33:24.730177 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:33:24.730770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:25.926791 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a79b7787-8443-43e4-84d7-ce4bc5f142f3&page=queryresults
[0m16:33:26.762727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b331f0>]}
[0m16:33:26.765072 [info ] [Thread-1 (]: 24 of 31 OK created sql view model dbt_dataset.link_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m16:33:26.766178 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory
[0m16:33:26.766925 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_nation_region
[0m16:33:26.768214 [info ] [Thread-1 (]: 25 of 31 START sql view model dbt_dataset.link_nation_region ................... [RUN]
[0m16:33:26.769120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory, now model.dbt_bq_sa.link_nation_region)
[0m16:33:26.769614 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_nation_region
[0m16:33:26.781248 [info ] [Thread-1 (]: 16:33:26 + Loading trim-field-467501-p5.dbt_dataset.link_nation_region from 2 source(s)
[0m16:33:26.786922 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_nation_region"
[0m16:33:26.788720 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_nation_region
[0m16:33:26.794438 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_nation_region"
[0m16:33:26.795421 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_nation_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_nation_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_nation_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m16:33:26.795999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:28.019987 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a696cb0c-72f8-4a6f-b120-9e6d2e3bb8a5&page=queryresults
[0m16:33:28.856247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b331f0>]}
[0m16:33:28.857887 [info ] [Thread-1 (]: 25 of 31 OK created sql view model dbt_dataset.link_nation_region .............. [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m16:33:28.858827 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_nation_region
[0m16:33:28.859401 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_supplier_nation
[0m16:33:28.859893 [info ] [Thread-1 (]: 26 of 31 START sql view model dbt_dataset.link_supplier_nation ................. [RUN]
[0m16:33:28.860308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_nation_region, now model.dbt_bq_sa.link_supplier_nation)
[0m16:33:28.860581 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_supplier_nation
[0m16:33:28.866295 [info ] [Thread-1 (]: 16:33:28 + Loading trim-field-467501-p5.dbt_dataset.link_supplier_nation from 1 source(s)
[0m16:33:28.870612 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_supplier_nation"
[0m16:33:28.872148 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_supplier_nation
[0m16:33:28.877754 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_supplier_nation"
[0m16:33:28.879992 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_supplier_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_supplier_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m16:33:28.880752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:30.027633 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:83f1c8f7-e193-49ec-94e8-d5f4a9694009&page=queryresults
[0m16:33:30.824652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149b331f0>]}
[0m16:33:30.826153 [info ] [Thread-1 (]: 26 of 31 OK created sql view model dbt_dataset.link_supplier_nation ............ [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m16:33:30.827082 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_supplier_nation
[0m16:33:30.827713 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_inventory_details
[0m16:33:30.828613 [info ] [Thread-1 (]: 27 of 31 START sql view model dbt_dataset.sat_inv_inventory_details ............ [RUN]
[0m16:33:30.829381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_supplier_nation, now model.dbt_bq_sa.sat_inv_inventory_details)
[0m16:33:30.829979 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_inventory_details
[0m16:33:30.847502 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m16:33:30.850868 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_inventory_details
[0m16:33:30.855837 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m16:33:30.857217 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_inventory_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_inventory_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:30.857730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:31.907705 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f5548626-c948-4cc2-9919-1b2c5bb9c396&page=queryresults
[0m16:33:32.722299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15358e350>]}
[0m16:33:32.723214 [info ] [Thread-1 (]: 27 of 31 OK created sql view model dbt_dataset.sat_inv_inventory_details ....... [[32mCREATE VIEW (0 processed)[0m in 1.89s]
[0m16:33:32.723603 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_inventory_details
[0m16:33:32.723928 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_part_details
[0m16:33:32.727031 [info ] [Thread-1 (]: 28 of 31 START sql view model dbt_dataset.sat_inv_part_details ................. [RUN]
[0m16:33:32.728553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_inventory_details, now model.dbt_bq_sa.sat_inv_part_details)
[0m16:33:32.729137 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_part_details
[0m16:33:32.745833 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_part_details"
[0m16:33:32.747187 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_part_details
[0m16:33:32.750840 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_part_details"
[0m16:33:32.751452 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_part_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_part_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:32.751743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:34.100647 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:346c6528-717e-4f00-ad80-2ec885c567a3&page=queryresults
[0m16:33:34.991896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153055d80>]}
[0m16:33:34.993152 [info ] [Thread-1 (]: 28 of 31 OK created sql view model dbt_dataset.sat_inv_part_details ............ [[32mCREATE VIEW (0 processed)[0m in 2.26s]
[0m16:33:34.994117 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_part_details
[0m16:33:34.994607 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m16:33:34.995247 [info ] [Thread-1 (]: 29 of 31 START sql view model dbt_dataset.sat_inv_supp_nation_details .......... [RUN]
[0m16:33:34.995732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_part_details, now model.dbt_bq_sa.sat_inv_supp_nation_details)
[0m16:33:34.996093 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m16:33:35.011442 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m16:33:35.012136 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m16:33:35.015325 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m16:33:35.016006 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:35.016488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:36.308224 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:254ff54b-5a4b-4d57-9896-c59e9087ae91&page=queryresults
[0m16:33:37.121519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153055d80>]}
[0m16:33:37.123832 [info ] [Thread-1 (]: 29 of 31 OK created sql view model dbt_dataset.sat_inv_supp_nation_details ..... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m16:33:37.124928 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m16:33:37.125966 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m16:33:37.127549 [info ] [Thread-1 (]: 30 of 31 START sql view model dbt_dataset.sat_inv_supp_region_details .......... [RUN]
[0m16:33:37.128332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_nation_details, now model.dbt_bq_sa.sat_inv_supp_region_details)
[0m16:33:37.128849 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_region_details
[0m16:33:37.156866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m16:33:37.157904 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_region_details
[0m16:33:37.161882 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m16:33:37.162715 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:37.163168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:38.255534 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:581d098e-144d-4d33-85c2-1df5ae45a390&page=queryresults
[0m16:33:39.191718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15279e5c0>]}
[0m16:33:39.193290 [info ] [Thread-1 (]: 30 of 31 OK created sql view model dbt_dataset.sat_inv_supp_region_details ..... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m16:33:39.194208 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m16:33:39.194877 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supplier_details
[0m16:33:39.195906 [info ] [Thread-1 (]: 31 of 31 START sql view model dbt_dataset.sat_inv_supplier_details ............. [RUN]
[0m16:33:39.196708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_region_details, now model.dbt_bq_sa.sat_inv_supplier_details)
[0m16:33:39.197231 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supplier_details
[0m16:33:39.216650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m16:33:39.217885 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supplier_details
[0m16:33:39.222611 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m16:33:39.223406 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supplier_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supplier_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m16:33:39.223901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:40.405453 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:bf35e173-3819-415d-bad0-54c61bc1607d&page=queryresults
[0m16:33:41.301204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af66e0d0-56fb-45d2-b555-55619791eec4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153055d80>]}
[0m16:33:41.302892 [info ] [Thread-1 (]: 31 of 31 OK created sql view model dbt_dataset.sat_inv_supplier_details ........ [[32mCREATE VIEW (0 processed)[0m in 2.10s]
[0m16:33:41.306047 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supplier_details
[0m16:33:41.311633 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:33:41.327117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:41.327555 [debug] [MainThread]: Connection 'model.dbt_bq_sa.sat_inv_supplier_details' was properly closed.
[0m16:33:41.332386 [info ] [MainThread]: 
[0m16:33:41.341579 [info ] [MainThread]: Finished running 31 view models in 0 hours 1 minutes and 10.80 seconds (70.80s).
[0m16:33:41.348238 [debug] [MainThread]: Command end result
[0m16:33:41.597663 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/manifest.json
[0m16:33:41.601979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/Downloads/automate-dv-demo-5.4/target/semantic_manifest.json
[0m16:33:41.611269 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/Downloads/automate-dv-demo-5.4/target/run_results.json
[0m16:33:41.611572 [info ] [MainThread]: 
[0m16:33:41.611827 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:41.612021 [info ] [MainThread]: 
[0m16:33:41.612222 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=31
[0m16:33:41.665546 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 73.4794, "process_in_blocks": "0", "process_kernel_time": 1.62669, "process_mem_max_rss": "342720512", "process_out_blocks": "0", "process_user_time": 6.646591}
[0m16:33:41.667171 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:41.667047 after 73.48 seconds
[0m16:33:41.668518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ceb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045edd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153027b20>]}
[0m16:33:41.669040 [debug] [MainThread]: Flushing usage events
[0m16:33:42.573035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:05:30.887882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056cf6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106824580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106824c40>]}


============================== 20:05:30.891156 | cce3a638-4000-4c9d-84d5-e58106f17341 ==============================
[0m20:05:30.891156 [info ] [MainThread]: Running with dbt=1.10.7
[0m20:05:30.891481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:05:32.921254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1da20>]}
[0m20:05:32.954131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679be80>]}
[0m20:05:32.954558 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m20:05:33.087607 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m20:05:33.197652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m20:05:33.198114 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/stage/v_stg_inventory2.sql
[0m20:05:33.198318 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/stage/v_stg_inventory1.sql
[0m20:05:33.198529 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/v_stg_orders.sql
[0m20:05:33.495188 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.raw_vault.t_links
- models.raw_vault.sats
- models.raw_vault.hubs
- models.stage
- models.raw_vault
- models.raw_stage
- models.raw_vault.links
[0m20:05:33.506894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141bc8130>]}
[0m20:05:33.569415 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/manifest.json
[0m20:05:33.572122 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/semantic_manifest.json
[0m20:05:33.676025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141b14d00>]}
[0m20:05:33.676405 [info ] [MainThread]: Found 33 models, 8 sources, 854 macros
[0m20:05:33.676591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141b14d00>]}
[0m20:05:33.678014 [info ] [MainThread]: 
[0m20:05:33.678208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:05:33.678349 [info ] [MainThread]: 
[0m20:05:33.678597 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:05:33.682059 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m20:05:33.682263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:05:34.587950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m20:05:34.588915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:05:35.423023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e534f0>]}
[0m20:05:35.424330 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:05:35.431227 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_orders
[0m20:05:35.432026 [info ] [Thread-1 (]: 1 of 33 START sql view model dbt_dataset.raw_orders ............................ [RUN]
[0m20:05:35.432665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_orders)
[0m20:05:35.433138 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_orders
[0m20:05:35.448094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_orders"
[0m20:05:35.449116 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_orders
[0m20:05:35.475361 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_orders"
[0m20:05:35.476085 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
  OPTIONS()
  as SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`lineitem` AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON c.C_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m20:05:35.476487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:36.568638 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:33492154-7aff-4821-8589-9ae44fe95a98&page=queryresults
[0m20:05:37.514610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106175d50>]}
[0m20:05:37.515255 [info ] [Thread-1 (]: 1 of 33 OK created sql view model dbt_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.08s]
[0m20:05:37.515722 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_orders
[0m20:05:37.516036 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m20:05:37.516572 [info ] [Thread-1 (]: 2 of 33 START sql view model dbt_dataset.raw_transactions ...................... [RUN]
[0m20:05:37.516882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_orders, now model.dbt_bq_sa.raw_transactions)
[0m20:05:37.517152 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m20:05:37.520531 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m20:05:37.521064 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m20:05:37.524455 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m20:05:37.525326 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATE_ADD(b.O_ORDERDATE, INTERVAL 20 DAY) AS TRANSACTION_DATE,
    CAST(RPAD(CONCAT(CAST(b.O_ORDERKEY AS STRING), CAST(b.O_CUSTKEY AS STRING), FORMAT_DATE('%Y%m%d', b.O_ORDERDATE)), 24, '0') AS INT64) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
        CASE FLOOR(RAND() * 2) + 1
            WHEN 1 THEN 'DR'
            WHEN 2 THEN 'CR'
        END AS STRING) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m20:05:37.525683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:38.633781 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b24e27bb-e7f8-4998-b284-54b8d9fae67c&page=queryresults
[0m20:05:39.490264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:05:39.492244 [info ] [Thread-1 (]: 2 of 33 OK created sql view model dbt_dataset.raw_transactions ................. [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m20:05:39.493554 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m20:05:39.494240 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m20:05:39.495328 [info ] [Thread-1 (]: 3 of 33 START sql view model dbt_dataset.raw_inventory ......................... [RUN]
[0m20:05:39.496215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_transactions, now model.dbt_bq_sa.raw_inventory)
[0m20:05:39.496819 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m20:05:39.509067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m20:05:39.510403 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m20:05:39.515829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m20:05:39.516923 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`partsupp` AS a
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m20:05:39.517537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:40.722797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6f2d40ed-a79c-41bf-9bda-133ad2f7d318&page=queryresults
[0m20:05:41.673986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106176560>]}
[0m20:05:41.674508 [info ] [Thread-1 (]: 3 of 33 OK created sql view model dbt_dataset.raw_inventory .................... [[32mCREATE VIEW (0 processed)[0m in 2.18s]
[0m20:05:41.674861 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m20:05:41.675111 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_orders
[0m20:05:41.675516 [info ] [Thread-1 (]: 4 of 33 START sql view model dbt_dataset.v_stg_orders .......................... [RUN]
[0m20:05:41.675837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_inventory, now model.dbt_bq_sa.v_stg_orders)
[0m20:05:41.676055 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_orders
[0m20:05:41.680911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:43.030954 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_orders"
[0m20:05:43.032366 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_orders
[0m20:05:43.036208 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_orders"
[0m20:05:43.038649 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), '')))) AS STRING) AS ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS ORDER_CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINEITEM_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS LINK_LINEITEM_ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS INVENTORY_ALLOCATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS STRING))), ''), '^^')
    )))) AS STRING) AS LINEITEM_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS STRING))), ''), '^^')
    )))) AS STRING) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT * ,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE
FROM staging;


[0m20:05:43.846949 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a89ee1c1-be74-41e3-8a50-a048cbd0f207&page=queryresults
[0m20:05:44.723094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:05:44.725362 [info ] [Thread-1 (]: 4 of 33 OK created sql view model dbt_dataset.v_stg_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 3.05s]
[0m20:05:44.726423 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_orders
[0m20:05:44.727049 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m20:05:44.728164 [info ] [Thread-1 (]: 5 of 33 START sql view model dbt_dataset.v_stg_transactions .................... [RUN]
[0m20:05:44.729476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_orders, now model.dbt_bq_sa.v_stg_transactions)
[0m20:05:44.730057 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m20:05:44.744249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:46.115944 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_transactions"
[0m20:05:46.118218 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_transactions
[0m20:05:46.125655 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_transactions"
[0m20:05:46.126773 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
  OPTIONS()
  as 







-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATE_ADD(TRANSACTION_DATE, INTERVAL 1 DAY) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS TRANSACTION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS STRING))), '')))) AS STRING) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m20:05:46.825188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:e3dff855-254b-4d48-a572-5ae6be0c1a03&page=queryresults
[0m20:05:47.703858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14203fe20>]}
[0m20:05:47.705153 [info ] [Thread-1 (]: 5 of 33 OK created sql view model dbt_dataset.v_stg_transactions ............... [[32mCREATE VIEW (0 processed)[0m in 2.97s]
[0m20:05:47.705940 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_transactions
[0m20:05:47.706561 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory
[0m20:05:47.707436 [info ] [Thread-1 (]: 6 of 33 START sql view model dbt_dataset.v_stg_inventory ....................... [RUN]
[0m20:05:47.708333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_transactions, now model.dbt_bq_sa.v_stg_inventory)
[0m20:05:47.708790 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory
[0m20:05:47.718244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:49.180296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory"
[0m20:05:49.182927 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory
[0m20:05:49.186516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory"
[0m20:05:49.187639 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m20:05:49.940099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:5594cab1-567b-45d7-96fb-dbf77d7897a7&page=queryresults
[0m20:05:50.829630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14203fe20>]}
[0m20:05:50.831566 [info ] [Thread-1 (]: 6 of 33 OK created sql view model dbt_dataset.v_stg_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 3.12s]
[0m20:05:50.833035 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory
[0m20:05:50.833742 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory1
[0m20:05:50.835209 [info ] [Thread-1 (]: 7 of 33 START sql view model dbt_dataset.v_stg_inventory1 ...................... [RUN]
[0m20:05:50.835991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory, now model.dbt_bq_sa.v_stg_inventory1)
[0m20:05:50.836534 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory1
[0m20:05:50.847756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:52.277830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory1"
[0m20:05:52.279547 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory1
[0m20:05:52.283058 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory1"
[0m20:05:52.283960 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory1: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory1"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory1`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m20:05:53.028854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6591d633-0481-4988-99c5-6485a6ac300a&page=queryresults
[0m20:05:53.893569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106623700>]}
[0m20:05:53.895416 [info ] [Thread-1 (]: 7 of 33 OK created sql view model dbt_dataset.v_stg_inventory1 ................. [[32mCREATE VIEW (0 processed)[0m in 3.06s]
[0m20:05:53.896383 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory1
[0m20:05:53.897056 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory2
[0m20:05:53.898007 [info ] [Thread-1 (]: 8 of 33 START sql view model dbt_dataset.v_stg_inventory2 ...................... [RUN]
[0m20:05:53.898813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory1, now model.dbt_bq_sa.v_stg_inventory2)
[0m20:05:53.899427 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory2
[0m20:05:53.910664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:55.323224 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory2"
[0m20:05:55.324058 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory2
[0m20:05:55.327478 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory2"
[0m20:05:55.328377 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory2: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory2"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory2`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m20:05:56.080608 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a05f99e4-82cd-4ab1-bb6d-9234519df359&page=queryresults
[0m20:05:57.013238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:05:57.014338 [info ] [Thread-1 (]: 8 of 33 OK created sql view model dbt_dataset.v_stg_inventory2 ................. [[32mCREATE VIEW (0 processed)[0m in 3.11s]
[0m20:05:57.015070 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory2
[0m20:05:57.015583 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_customer
[0m20:05:57.016309 [info ] [Thread-1 (]: 9 of 33 START sql view model dbt_dataset.hub_customer .......................... [RUN]
[0m20:05:57.016959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory2, now model.dbt_bq_sa.hub_customer)
[0m20:05:57.017531 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_customer
[0m20:05:57.044048 [info ] [Thread-1 (]: 20:05:57 + Loading trim-field-467501-p5.dbt_dataset.hub_customer from 1 source(s)
[0m20:05:57.087219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_customer"
[0m20:05:57.088081 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_customer
[0m20:05:57.090414 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_customer"
[0m20:05:57.090820 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_customer: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_customer"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_customer`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:05:57.091065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:05:58.241710 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:95ba39d8-1ded-41e2-a6ca-7491194e70e4&page=queryresults
[0m20:05:59.160240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106623700>]}
[0m20:05:59.161326 [info ] [Thread-1 (]: 9 of 33 OK created sql view model dbt_dataset.hub_customer ..................... [[32mCREATE VIEW (0 processed)[0m in 2.14s]
[0m20:05:59.161859 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_customer
[0m20:05:59.162331 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_lineitem
[0m20:05:59.162867 [info ] [Thread-1 (]: 10 of 33 START sql view model dbt_dataset.hub_lineitem ......................... [RUN]
[0m20:05:59.163219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_customer, now model.dbt_bq_sa.hub_lineitem)
[0m20:05:59.163457 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_lineitem
[0m20:05:59.168789 [info ] [Thread-1 (]: 20:05:59 + Loading trim-field-467501-p5.dbt_dataset.hub_lineitem from 1 source(s)
[0m20:05:59.171089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_lineitem"
[0m20:05:59.171660 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_lineitem
[0m20:05:59.178019 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_lineitem"
[0m20:05:59.179041 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:05:59.179370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:00.487433 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:88add5fb-3b0f-47e7-9b3b-dc95b2e10166&page=queryresults
[0m20:06:01.519350 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141b3fa90>]}
[0m20:06:01.519919 [info ] [Thread-1 (]: 10 of 33 OK created sql view model dbt_dataset.hub_lineitem .................... [[32mCREATE VIEW (0 processed)[0m in 2.36s]
[0m20:06:01.520333 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_lineitem
[0m20:06:01.520612 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_order
[0m20:06:01.521006 [info ] [Thread-1 (]: 11 of 33 START sql view model dbt_dataset.hub_order ............................ [RUN]
[0m20:06:01.521346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_lineitem, now model.dbt_bq_sa.hub_order)
[0m20:06:01.521605 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_order
[0m20:06:01.526010 [info ] [Thread-1 (]: 20:06:01 + Loading trim-field-467501-p5.dbt_dataset.hub_order from 1 source(s)
[0m20:06:01.528353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_order"
[0m20:06:01.528868 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_order
[0m20:06:01.534101 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_order"
[0m20:06:01.534844 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:01.535209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:02.644190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a9173ce0-3267-4985-8d71-c01c9aadef6d&page=queryresults
[0m20:06:03.529447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106174a60>]}
[0m20:06:03.535863 [info ] [Thread-1 (]: 11 of 33 OK created sql view model dbt_dataset.hub_order ....................... [[32mCREATE VIEW (0 processed)[0m in 2.01s]
[0m20:06:03.537750 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_order
[0m20:06:03.538298 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_nation
[0m20:06:03.539387 [info ] [Thread-1 (]: 12 of 33 START sql view model dbt_dataset.link_customer_nation ................. [RUN]
[0m20:06:03.540158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_order, now model.dbt_bq_sa.link_customer_nation)
[0m20:06:03.541671 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_nation
[0m20:06:03.560990 [info ] [Thread-1 (]: 20:06:03 + Loading trim-field-467501-p5.dbt_dataset.link_customer_nation from 1 source(s)
[0m20:06:03.577972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_nation"
[0m20:06:03.578705 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_nation
[0m20:06:03.587254 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_nation"
[0m20:06:03.589507 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:03.590090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:04.732141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ed1e729f-dcc6-4557-9126-1cd954d60c1e&page=queryresults
[0m20:06:05.639299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:05.641020 [info ] [Thread-1 (]: 12 of 33 OK created sql view model dbt_dataset.link_customer_nation ............ [[32mCREATE VIEW (0 processed)[0m in 2.10s]
[0m20:06:05.641976 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_nation
[0m20:06:05.642635 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_order
[0m20:06:05.643533 [info ] [Thread-1 (]: 13 of 33 START sql view model dbt_dataset.link_customer_order .................. [RUN]
[0m20:06:05.644387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_nation, now model.dbt_bq_sa.link_customer_order)
[0m20:06:05.645006 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_order
[0m20:06:05.653594 [info ] [Thread-1 (]: 20:06:05 + Loading trim-field-467501-p5.dbt_dataset.link_customer_order from 1 source(s)
[0m20:06:05.660073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_order"
[0m20:06:05.661236 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_order
[0m20:06:05.665761 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_order"
[0m20:06:05.667939 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:05.668635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:06.941731 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:94e599d2-99fc-483d-b951-6fd2003e8885&page=queryresults
[0m20:06:07.876512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106174a60>]}
[0m20:06:07.878123 [info ] [Thread-1 (]: 13 of 33 OK created sql view model dbt_dataset.link_customer_order ............. [[32mCREATE VIEW (0 processed)[0m in 2.23s]
[0m20:06:07.878761 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_order
[0m20:06:07.879289 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory_allocation
[0m20:06:07.880063 [info ] [Thread-1 (]: 14 of 33 START sql view model dbt_dataset.link_inventory_allocation ............ [RUN]
[0m20:06:07.880577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_order, now model.dbt_bq_sa.link_inventory_allocation)
[0m20:06:07.880909 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory_allocation
[0m20:06:07.888867 [info ] [Thread-1 (]: 20:06:07 + Loading trim-field-467501-p5.dbt_dataset.link_inventory_allocation from 1 source(s)
[0m20:06:07.895730 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory_allocation"
[0m20:06:07.896521 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory_allocation
[0m20:06:07.899955 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory_allocation"
[0m20:06:07.900702 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory_allocation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory_allocation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:07.901231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:09.004071 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:5f65edcc-fb5b-4272-8a0c-9d4b97e8bc78&page=queryresults
[0m20:06:09.823105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:09.824288 [info ] [Thread-1 (]: 14 of 33 OK created sql view model dbt_dataset.link_inventory_allocation ....... [[32mCREATE VIEW (0 processed)[0m in 1.94s]
[0m20:06:09.825181 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory_allocation
[0m20:06:09.825865 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_order_lineitem
[0m20:06:09.826984 [info ] [Thread-1 (]: 15 of 33 START sql view model dbt_dataset.link_order_lineitem .................. [RUN]
[0m20:06:09.827631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory_allocation, now model.dbt_bq_sa.link_order_lineitem)
[0m20:06:09.828090 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_order_lineitem
[0m20:06:09.838693 [info ] [Thread-1 (]: 20:06:09 + Loading trim-field-467501-p5.dbt_dataset.link_order_lineitem from 1 source(s)
[0m20:06:09.843277 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_order_lineitem"
[0m20:06:09.844565 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_order_lineitem
[0m20:06:09.849156 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_order_lineitem"
[0m20:06:09.850263 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_order_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_order_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:09.850781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:10.836209 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:53f2c791-195b-4edd-ad1f-0ff3957f25d0&page=queryresults
[0m20:06:11.668799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106174a60>]}
[0m20:06:11.670045 [info ] [Thread-1 (]: 15 of 33 OK created sql view model dbt_dataset.link_order_lineitem ............. [[32mCREATE VIEW (0 processed)[0m in 1.84s]
[0m20:06:11.670964 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_order_lineitem
[0m20:06:11.671599 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m20:06:11.672357 [info ] [Thread-1 (]: 16 of 33 START sql view model dbt_dataset.sat_order_cust_nation_details ........ [RUN]
[0m20:06:11.672996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_order_lineitem, now model.dbt_bq_sa.sat_order_cust_nation_details)
[0m20:06:11.673538 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_nation_details
[0m20:06:11.723408 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m20:06:11.724166 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_nation_details
[0m20:06:11.727010 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m20:06:11.727485 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:11.727797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:12.855329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:fcfd1d1a-daa5-4017-a383-db750d48ed66&page=queryresults
[0m20:06:13.675561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141363f40>]}
[0m20:06:13.676267 [info ] [Thread-1 (]: 16 of 33 OK created sql view model dbt_dataset.sat_order_cust_nation_details ... [[32mCREATE VIEW (0 processed)[0m in 2.00s]
[0m20:06:13.676691 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m20:06:13.676995 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_region_details
[0m20:06:13.677277 [info ] [Thread-1 (]: 17 of 33 START sql view model dbt_dataset.sat_order_cust_region_details ........ [RUN]
[0m20:06:13.677578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_nation_details, now model.dbt_bq_sa.sat_order_cust_region_details)
[0m20:06:13.677799 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_region_details
[0m20:06:13.689535 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m20:06:13.692469 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_region_details
[0m20:06:13.700027 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m20:06:13.700724 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:13.701088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:14.823562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7d6d8d38-6a70-4c20-8000-59a9565efbf3&page=queryresults
[0m20:06:15.646898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142248160>]}
[0m20:06:15.648090 [info ] [Thread-1 (]: 17 of 33 OK created sql view model dbt_dataset.sat_order_cust_region_details ... [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m20:06:15.648977 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_region_details
[0m20:06:15.649579 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_customer_details
[0m20:06:15.650499 [info ] [Thread-1 (]: 18 of 33 START sql view model dbt_dataset.sat_order_customer_details ........... [RUN]
[0m20:06:15.651304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_region_details, now model.dbt_bq_sa.sat_order_customer_details)
[0m20:06:15.651916 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_customer_details
[0m20:06:15.669168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_customer_details"
[0m20:06:15.670114 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_customer_details
[0m20:06:15.674529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_customer_details"
[0m20:06:15.675307 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_customer_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_customer_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:15.675746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:16.742072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:7845fc69-c134-4c84-a139-0d27b077ecf7&page=queryresults
[0m20:06:17.585639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142248160>]}
[0m20:06:17.587297 [info ] [Thread-1 (]: 18 of 33 OK created sql view model dbt_dataset.sat_order_customer_details ...... [[32mCREATE VIEW (0 processed)[0m in 1.93s]
[0m20:06:17.588377 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_customer_details
[0m20:06:17.589116 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_lineitem_details
[0m20:06:17.590190 [info ] [Thread-1 (]: 19 of 33 START sql view model dbt_dataset.sat_order_lineitem_details ........... [RUN]
[0m20:06:17.591031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_customer_details, now model.dbt_bq_sa.sat_order_lineitem_details)
[0m20:06:17.591659 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_lineitem_details
[0m20:06:17.613904 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m20:06:17.615017 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_lineitem_details
[0m20:06:17.618849 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m20:06:17.619521 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_lineitem_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_lineitem_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:17.619948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:18.596311 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:bcb54efc-863d-40e7-b342-3110a4b1f7bf&page=queryresults
[0m20:06:19.418817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:19.420352 [info ] [Thread-1 (]: 19 of 33 OK created sql view model dbt_dataset.sat_order_lineitem_details ...... [[32mCREATE VIEW (0 processed)[0m in 1.83s]
[0m20:06:19.421302 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_lineitem_details
[0m20:06:19.421955 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_order_details
[0m20:06:19.422829 [info ] [Thread-1 (]: 20 of 33 START sql view model dbt_dataset.sat_order_order_details .............. [RUN]
[0m20:06:19.423656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_lineitem_details, now model.dbt_bq_sa.sat_order_order_details)
[0m20:06:19.424299 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_order_details
[0m20:06:19.442651 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_order_details"
[0m20:06:19.443567 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_order_details
[0m20:06:19.447678 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_order_details"
[0m20:06:19.448389 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_order_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_order_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:19.448822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:20.624663 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:9d69c411-e2f8-47d9-adda-4094d9ab9bc6&page=queryresults
[0m20:06:21.470825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1421993f0>]}
[0m20:06:21.472314 [info ] [Thread-1 (]: 20 of 33 OK created sql view model dbt_dataset.sat_order_order_details ......... [[32mCREATE VIEW (0 processed)[0m in 2.05s]
[0m20:06:21.473365 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_order_details
[0m20:06:21.473847 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.t_link_transactions
[0m20:06:21.474302 [info ] [Thread-1 (]: 21 of 33 START sql view model dbt_dataset.t_link_transactions .................. [RUN]
[0m20:06:21.474681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_order_details, now model.dbt_bq_sa.t_link_transactions)
[0m20:06:21.474956 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.t_link_transactions
[0m20:06:21.496168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.t_link_transactions"
[0m20:06:21.498700 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.t_link_transactions
[0m20:06:21.502119 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.t_link_transactions"
[0m20:06:21.502799 [debug] [Thread-1 (]: On model.dbt_bq_sa.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.t_link_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`t_link_transactions`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert;


[0m20:06:21.503161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:22.669293 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:792b1d6e-628f-4a6b-95d4-39033f29ea4c&page=queryresults
[0m20:06:23.495185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:23.497365 [info ] [Thread-1 (]: 21 of 33 OK created sql view model dbt_dataset.t_link_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 2.02s]
[0m20:06:23.498430 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.t_link_transactions
[0m20:06:23.499229 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_nation
[0m20:06:23.500369 [info ] [Thread-1 (]: 22 of 33 START sql view model dbt_dataset.hub_nation ........................... [RUN]
[0m20:06:23.501063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.t_link_transactions, now model.dbt_bq_sa.hub_nation)
[0m20:06:23.501654 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_nation
[0m20:06:23.520640 [info ] [Thread-1 (]: 20:06:23 + Loading trim-field-467501-p5.dbt_dataset.hub_nation from 2 source(s)
[0m20:06:23.530458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_nation"
[0m20:06:23.532877 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_nation
[0m20:06:23.537637 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_nation"
[0m20:06:23.538470 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m20:06:23.538957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:24.627718 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4ffcb3b8-db78-4935-8cc7-dafa44b77c87&page=queryresults
[0m20:06:25.400347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:25.402347 [info ] [Thread-1 (]: 22 of 33 OK created sql view model dbt_dataset.hub_nation ...................... [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m20:06:25.404030 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_nation
[0m20:06:25.404731 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_part
[0m20:06:25.405689 [info ] [Thread-1 (]: 23 of 33 START sql view model dbt_dataset.hub_part ............................. [RUN]
[0m20:06:25.406601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_nation, now model.dbt_bq_sa.hub_part)
[0m20:06:25.407224 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_part
[0m20:06:25.416158 [info ] [Thread-1 (]: 20:06:25 + Loading trim-field-467501-p5.dbt_dataset.hub_part from 2 source(s)
[0m20:06:25.422752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_part"
[0m20:06:25.423906 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_part
[0m20:06:25.430752 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_part"
[0m20:06:25.431867 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_part: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_part"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_part`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m20:06:25.432396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:26.507932 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:c78ac672-7cfe-40ca-9610-cb28ff8632ae&page=queryresults
[0m20:06:27.363981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:28.891505 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m20:06:28.893034 [info ] [Thread-1 (]: 23 of 33 OK created sql view model dbt_dataset.hub_part ........................ [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m20:06:28.893723 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_part
[0m20:06:28.894182 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_region
[0m20:06:28.894788 [info ] [Thread-1 (]: 24 of 33 START sql view model dbt_dataset.hub_region ........................... [RUN]
[0m20:06:28.895462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_part, now model.dbt_bq_sa.hub_region)
[0m20:06:28.895910 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_region
[0m20:06:28.902934 [info ] [Thread-1 (]: 20:06:28 + Loading trim-field-467501-p5.dbt_dataset.hub_region from 2 source(s)
[0m20:06:28.908039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_region"
[0m20:06:28.909074 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_region
[0m20:06:28.912856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_region"
[0m20:06:28.913570 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m20:06:28.913978 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:30.076039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6b56c6f5-5c8a-41e6-829d-ea5e8eb14bfb&page=queryresults
[0m20:06:31.014481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:31.015860 [info ] [Thread-1 (]: 24 of 33 OK created sql view model dbt_dataset.hub_region ...................... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m20:06:31.016816 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_region
[0m20:06:31.017468 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_supplier
[0m20:06:31.018465 [info ] [Thread-1 (]: 25 of 33 START sql view model dbt_dataset.hub_supplier ......................... [RUN]
[0m20:06:31.019311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_region, now model.dbt_bq_sa.hub_supplier)
[0m20:06:31.019945 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_supplier
[0m20:06:31.031096 [info ] [Thread-1 (]: 20:06:31 + Loading trim-field-467501-p5.dbt_dataset.hub_supplier from 2 source(s)
[0m20:06:31.037415 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_supplier"
[0m20:06:31.038419 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_supplier
[0m20:06:31.042724 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_supplier"
[0m20:06:31.043572 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_supplier: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_supplier"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_supplier`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m20:06:31.044086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:32.101257 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:64e92fa4-e810-42f8-88fe-1a6fdbfcde7d&page=queryresults
[0m20:06:32.936318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:32.938435 [info ] [Thread-1 (]: 25 of 33 OK created sql view model dbt_dataset.hub_supplier .................... [[32mCREATE VIEW (0 processed)[0m in 1.92s]
[0m20:06:32.939847 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_supplier
[0m20:06:32.940722 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory
[0m20:06:32.941678 [info ] [Thread-1 (]: 26 of 33 START sql view model dbt_dataset.link_inventory ....................... [RUN]
[0m20:06:32.942563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_supplier, now model.dbt_bq_sa.link_inventory)
[0m20:06:32.943181 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory
[0m20:06:32.952402 [info ] [Thread-1 (]: 20:06:32 + Loading trim-field-467501-p5.dbt_dataset.link_inventory from 1 source(s)
[0m20:06:32.957773 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory"
[0m20:06:32.958733 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory
[0m20:06:32.964586 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory"
[0m20:06:32.965394 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:32.965883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:34.043225 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:5f2b7336-f4b5-49a5-8304-a5a253cb2285&page=queryresults
[0m20:06:34.849331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:34.850974 [info ] [Thread-1 (]: 26 of 33 OK created sql view model dbt_dataset.link_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 1.91s]
[0m20:06:34.851945 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory
[0m20:06:34.852647 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_nation_region
[0m20:06:34.853564 [info ] [Thread-1 (]: 27 of 33 START sql view model dbt_dataset.link_nation_region ................... [RUN]
[0m20:06:34.854421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory, now model.dbt_bq_sa.link_nation_region)
[0m20:06:34.855055 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_nation_region
[0m20:06:34.868885 [info ] [Thread-1 (]: 20:06:34 + Loading trim-field-467501-p5.dbt_dataset.link_nation_region from 2 source(s)
[0m20:06:34.875238 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_nation_region"
[0m20:06:34.876096 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_nation_region
[0m20:06:34.880930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_nation_region"
[0m20:06:34.881940 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_nation_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_nation_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_nation_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m20:06:34.882478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:36.232075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:ff04a6d0-f615-4fd8-8b81-44330a832432&page=queryresults
[0m20:06:37.059125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:37.061113 [info ] [Thread-1 (]: 27 of 33 OK created sql view model dbt_dataset.link_nation_region .............. [[32mCREATE VIEW (0 processed)[0m in 2.20s]
[0m20:06:37.062653 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_nation_region
[0m20:06:37.063291 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_supplier_nation
[0m20:06:37.064124 [info ] [Thread-1 (]: 28 of 33 START sql view model dbt_dataset.link_supplier_nation ................. [RUN]
[0m20:06:37.064974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_nation_region, now model.dbt_bq_sa.link_supplier_nation)
[0m20:06:37.065598 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_supplier_nation
[0m20:06:37.079576 [info ] [Thread-1 (]: 20:06:37 + Loading trim-field-467501-p5.dbt_dataset.link_supplier_nation from 1 source(s)
[0m20:06:37.085168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_supplier_nation"
[0m20:06:37.086111 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_supplier_nation
[0m20:06:37.090743 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_supplier_nation"
[0m20:06:37.091683 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_supplier_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_supplier_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m20:06:37.092177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:38.270809 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:92ce8060-0622-4f94-82ca-3a23e7d48323&page=queryresults
[0m20:06:39.107433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:39.109280 [info ] [Thread-1 (]: 28 of 33 OK created sql view model dbt_dataset.link_supplier_nation ............ [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m20:06:39.110444 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_supplier_nation
[0m20:06:39.111096 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_inventory_details
[0m20:06:39.111984 [info ] [Thread-1 (]: 29 of 33 START sql view model dbt_dataset.sat_inv_inventory_details ............ [RUN]
[0m20:06:39.112809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_supplier_nation, now model.dbt_bq_sa.sat_inv_inventory_details)
[0m20:06:39.113425 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_inventory_details
[0m20:06:39.131114 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m20:06:39.132179 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_inventory_details
[0m20:06:39.137701 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m20:06:39.138527 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_inventory_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_inventory_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:39.139029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:40.187913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:20753a31-432e-4846-b20e-04b1a03556f1&page=queryresults
[0m20:06:41.131885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1421387f0>]}
[0m20:06:41.133490 [info ] [Thread-1 (]: 29 of 33 OK created sql view model dbt_dataset.sat_inv_inventory_details ....... [[32mCREATE VIEW (0 processed)[0m in 2.02s]
[0m20:06:41.134541 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_inventory_details
[0m20:06:41.135224 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_part_details
[0m20:06:41.136102 [info ] [Thread-1 (]: 30 of 33 START sql view model dbt_dataset.sat_inv_part_details ................. [RUN]
[0m20:06:41.136832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_inventory_details, now model.dbt_bq_sa.sat_inv_part_details)
[0m20:06:41.137405 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_part_details
[0m20:06:41.157045 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_part_details"
[0m20:06:41.158355 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_part_details
[0m20:06:41.162812 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_part_details"
[0m20:06:41.163950 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_part_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_part_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:41.164425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:42.299630 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:27d22f24-3db8-4600-83d2-89b5e35da421&page=queryresults
[0m20:06:43.127319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1404c2080>]}
[0m20:06:43.129296 [info ] [Thread-1 (]: 30 of 33 OK created sql view model dbt_dataset.sat_inv_part_details ............ [[32mCREATE VIEW (0 processed)[0m in 1.99s]
[0m20:06:43.130242 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_part_details
[0m20:06:43.130899 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m20:06:43.131760 [info ] [Thread-1 (]: 31 of 33 START sql view model dbt_dataset.sat_inv_supp_nation_details .......... [RUN]
[0m20:06:43.132631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_part_details, now model.dbt_bq_sa.sat_inv_supp_nation_details)
[0m20:06:43.133240 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m20:06:43.151215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m20:06:43.152497 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m20:06:43.156784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m20:06:43.157562 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:43.158052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:44.517693 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:45d1ff90-52c4-4954-8af2-e16aedfb8cd6&page=queryresults
[0m20:06:45.370799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1421387f0>]}
[0m20:06:45.372625 [info ] [Thread-1 (]: 31 of 33 OK created sql view model dbt_dataset.sat_inv_supp_nation_details ..... [[32mCREATE VIEW (0 processed)[0m in 2.24s]
[0m20:06:45.373600 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m20:06:45.374232 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m20:06:45.375138 [info ] [Thread-1 (]: 32 of 33 START sql view model dbt_dataset.sat_inv_supp_region_details .......... [RUN]
[0m20:06:45.375957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_nation_details, now model.dbt_bq_sa.sat_inv_supp_region_details)
[0m20:06:45.376582 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_region_details
[0m20:06:45.392713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m20:06:45.393868 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_region_details
[0m20:06:45.399562 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m20:06:45.400383 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:45.400876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:46.416212 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:5af62d83-aeca-4718-9920-cd45d964c8ee&page=queryresults
[0m20:06:47.308109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1421387f0>]}
[0m20:06:47.309583 [info ] [Thread-1 (]: 32 of 33 OK created sql view model dbt_dataset.sat_inv_supp_region_details ..... [[32mCREATE VIEW (0 processed)[0m in 1.93s]
[0m20:06:47.310516 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m20:06:47.311157 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supplier_details
[0m20:06:47.312002 [info ] [Thread-1 (]: 33 of 33 START sql view model dbt_dataset.sat_inv_supplier_details ............. [RUN]
[0m20:06:47.312820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_region_details, now model.dbt_bq_sa.sat_inv_supplier_details)
[0m20:06:47.313435 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supplier_details
[0m20:06:47.330633 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m20:06:47.331678 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supplier_details
[0m20:06:47.335918 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m20:06:47.336800 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supplier_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supplier_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m20:06:47.337279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:06:48.523976 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:007725e7-ae52-4ef0-ab0a-0a72aa0bb076&page=queryresults
[0m20:06:49.407949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cce3a638-4000-4c9d-84d5-e58106f17341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142400be0>]}
[0m20:06:49.409571 [info ] [Thread-1 (]: 33 of 33 OK created sql view model dbt_dataset.sat_inv_supplier_details ........ [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m20:06:49.410504 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supplier_details
[0m20:06:49.414450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:06:49.417220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:06:49.417627 [debug] [MainThread]: Connection 'model.dbt_bq_sa.sat_inv_supplier_details' was properly closed.
[0m20:06:49.418284 [info ] [MainThread]: 
[0m20:06:49.418739 [info ] [MainThread]: Finished running 33 view models in 0 hours 1 minutes and 15.74 seconds (75.74s).
[0m20:06:49.425187 [debug] [MainThread]: Command end result
[0m20:06:49.478030 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/manifest.json
[0m20:06:49.482432 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/semantic_manifest.json
[0m20:06:49.490609 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/run_results.json
[0m20:06:49.490947 [info ] [MainThread]: 
[0m20:06:49.491209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:06:49.491408 [info ] [MainThread]: 
[0m20:06:49.491852 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m20:06:49.496085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 78.65324, "process_in_blocks": "0", "process_kernel_time": 1.580839, "process_mem_max_rss": "344113152", "process_out_blocks": "0", "process_user_time": 7.166947}
[0m20:06:49.496732 [debug] [MainThread]: Command `dbt run` succeeded at 20:06:49.496674 after 78.65 seconds
[0m20:06:49.497032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056cf6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141bcab60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e50250>]}
[0m20:06:49.497272 [debug] [MainThread]: Flushing usage events
[0m20:06:50.902550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:09.792983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3304f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a330bb0>]}


============================== 14:07:09.795932 | 55b3768c-c396-48ce-a9e5-14699aec73ef ==============================
[0m14:07:09.795932 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:07:09.796249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m hub_customer', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:09.796519 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m14:07:09.796717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55b3768c-c396-48ce-a9e5-14699aec73ef', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a5300>]}
[0m14:07:14.115128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55b3768c-c396-48ce-a9e5-14699aec73ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc5d50>]}
[0m14:07:14.147067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55b3768c-c396-48ce-a9e5-14699aec73ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2a4940>]}
[0m14:07:14.147454 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m14:07:14.314848 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:07:14.426095 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 1 files changed.
[0m14:07:14.426494 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/eqqui_hub_customer.sql
[0m14:07:14.426678 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/stage/equi_v_stg_transaction.sql
[0m14:07:14.426838 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/equi_link_customer_nation.sql
[0m14:07:14.426978 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/stage/v_stg_inventory1.sql
[0m14:07:14.427114 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/stage/v_stg_inventory2.sql
[0m14:07:14.427298 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/hub_customer.sql
[0m14:07:14.590406 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.eqqui_hub_customer' (models/raw_vault/hubs/eqqui_hub_customer.sql) depends on a source named 'raw.v_stg_orders' which was not found
[0m14:07:14.591381 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:07:14.622001 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.876288, "process_in_blocks": "0", "process_kernel_time": 1.064067, "process_mem_max_rss": "337723392", "process_out_blocks": "0", "process_user_time": 3.160642}
[0m14:07:14.622451 [debug] [MainThread]: Command `dbt run` failed at 14:07:14.622380 after 4.88 seconds
[0m14:07:14.622741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16e0043d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16de81fc0>]}
[0m14:07:14.623061 [debug] [MainThread]: Flushing usage events
[0m14:07:15.823558 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:49.133427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10419f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fbfa0>]}


============================== 14:07:49.136352 | 89cf7d90-2e75-45d3-81d7-67b05477cedd ==============================
[0m14:07:49.136352 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:07:49.136665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:51.334319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89cf7d90-2e75-45d3-81d7-67b05477cedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102975d50>]}
[0m14:07:51.394098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89cf7d90-2e75-45d3-81d7-67b05477cedd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105267a90>]}
[0m14:07:51.394612 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m14:07:51.571664 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:07:51.677373 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 3 files added, 1 files changed.
[0m14:07:51.677809 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/stage/equi_v_stg_transaction.sql
[0m14:07:51.678018 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/eqqui_hub_customer.sql
[0m14:07:51.678189 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/equi_link_customer_nation.sql
[0m14:07:51.678338 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/stage/v_stg_inventory2.sql
[0m14:07:51.678477 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/stage/v_stg_inventory1.sql
[0m14:07:51.678664 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/hub_customer.sql
[0m14:07:51.860262 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.equi_v_stg_transaction' (models/stage/equi_v_stg_transaction.sql) depends on a source named 'raw.raw_transactions' which was not found
[0m14:07:51.862164 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7683115, "process_in_blocks": "0", "process_kernel_time": 0.964485, "process_mem_max_rss": "312737792", "process_out_blocks": "0", "process_user_time": 3.516051}
[0m14:07:51.862508 [debug] [MainThread]: Command `dbt run` failed at 14:07:51.862438 after 2.77 seconds
[0m14:07:51.862773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10419f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042fe350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f9ef610>]}
[0m14:07:51.863010 [debug] [MainThread]: Flushing usage events
[0m14:07:52.770922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:09.641155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119344c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111937f10>]}


============================== 14:10:09.644437 | 4d59c97c-e077-4225-a65d-6a8890fe6bae ==============================
[0m14:10:09.644437 [info ] [MainThread]: Running with dbt=1.10.7
[0m14:10:09.644770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:11.533568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633a050>]}
[0m14:10:11.565876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153df01c0>]}
[0m14:10:11.566269 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m14:10:11.695536 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m14:10:11.802212 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 1 files changed.
[0m14:10:11.802558 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/stage/v_stg_inventory2.sql
[0m14:10:11.802718 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/stage/v_stg_inventory1.sql
[0m14:10:11.802944 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/hub_customer.sql
[0m14:10:11.972163 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 7 unused configuration paths:
- models.raw_stage
- models.raw_vault.links
- models.raw_vault.sats
- models.raw_vault.t_links
- models.raw_vault.hubs
- models.raw_vault
- models.stage
[0m14:10:11.982241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1559cd7b0>]}
[0m14:10:12.040848 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/manifest.json
[0m14:10:12.043250 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/semantic_manifest.json
[0m14:10:12.055476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153eed000>]}
[0m14:10:12.055774 [info ] [MainThread]: Found 31 models, 8 sources, 854 macros
[0m14:10:12.055957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153eed5d0>]}
[0m14:10:12.057316 [info ] [MainThread]: 
[0m14:10:12.057541 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:10:12.057693 [info ] [MainThread]: 
[0m14:10:12.057998 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:10:12.062187 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_trim-field-467501-p5'
[0m14:10:12.062485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:12.895140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5, now list_trim-field-467501-p5_dbt_dataset)
[0m14:10:12.896216 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:13.828956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153d96a10>]}
[0m14:10:13.829995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:13.837469 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_orders
[0m14:10:13.838264 [info ] [Thread-1 (]: 1 of 31 START sql view model dbt_dataset.raw_orders ............................ [RUN]
[0m14:10:13.838914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_trim-field-467501-p5_dbt_dataset, now model.dbt_bq_sa.raw_orders)
[0m14:10:13.839526 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_orders
[0m14:10:13.855749 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_orders"
[0m14:10:13.856879 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_orders
[0m14:10:13.883334 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_orders"
[0m14:10:13.884170 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
  OPTIONS()
  as SELECT
    a.L_ORDERKEY AS ORDERKEY,
    a.L_PARTKEY AS PARTKEY,
    a.L_SUPPKEY AS SUPPLIERKEY,
    a.L_LINENUMBER AS LINENUMBER,
    a.L_QUANTITY AS QUANTITY,
    a.L_EXTENDEDPRICE AS EXTENDEDPRICE,
    a.L_DISCOUNT AS DISCOUNT,
    a.L_TAX AS TAX,
    a.L_RETURNFLAG AS RETURNFLAG,
    a.L_LINESTATUS AS LINESTATUS,
    a.L_SHIPDATE AS SHIPDATE,
    a.L_COMMITDATE AS COMMITDATE,
    a.L_RECEIPTDATE AS RECEIPTDATE,
    a.L_SHIPINSTRUCT AS SHIPINSTRUCT,
    a.L_SHIPMODE AS SHIPMODE,
    a.L_COMMENT AS LINE_COMMENT,
    b.O_CUSTKEY AS CUSTOMERKEY,
    b.O_ORDERSTATUS AS ORDERSTATUS,
    b.O_TOTALPRICE AS TOTALPRICE,
    b.O_ORDERDATE AS ORDERDATE,
    b.O_ORDERPRIORITY AS ORDERPRIORITY,
    b.O_CLERK AS CLERK,
    b.O_SHIPPRIORITY AS SHIPPRIORITY,
    b.O_COMMENT AS ORDER_COMMENT,
    c.C_NAME AS CUSTOMER_NAME,
    c.C_ADDRESS AS CUSTOMER_ADDRESS,
    c.C_NATIONKEY AS CUSTOMER_NATION_KEY,
    c.C_PHONE AS CUSTOMER_PHONE,
    c.C_ACCTBAL AS CUSTOMER_ACCBAL,
    c.C_MKTSEGMENT AS CUSTOMER_MKTSEGMENT,
    c.C_COMMENT AS CUSTOMER_COMMENT,
    d.N_NAME AS CUSTOMER_NATION_NAME,
    d.N_REGIONKEY AS CUSTOMER_REGION_KEY,
    d.N_COMMENT AS CUSTOMER_NATION_COMMENT,
    e.R_NAME AS CUSTOMER_REGION_NAME,
    e.R_COMMENT AS CUSTOMER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`lineitem` AS a
    ON a.L_ORDERKEY = b.O_ORDERKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON c.C_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS g
    ON a.L_PARTKEY = g.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS h
    ON a.L_SUPPKEY = h.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS j
    ON h.S_NATIONKEY = j.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS k
    ON j.N_REGIONKEY = k.R_REGIONKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m14:10:13.884578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:15.248133 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:314edebb-6e66-4a87-9405-1974a4f64b37&page=queryresults
[0m14:10:16.432877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154c13df0>]}
[0m14:10:16.433480 [info ] [Thread-1 (]: 1 of 31 OK created sql view model dbt_dataset.raw_orders ....................... [[32mCREATE VIEW (0 processed)[0m in 2.59s]
[0m14:10:16.433797 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_orders
[0m14:10:16.434016 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_transactions
[0m14:10:16.434361 [info ] [Thread-1 (]: 2 of 31 START sql view model dbt_dataset.raw_transactions ...................... [RUN]
[0m14:10:16.434589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_orders, now model.dbt_bq_sa.raw_transactions)
[0m14:10:16.434775 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_transactions
[0m14:10:16.436998 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_transactions"
[0m14:10:16.437359 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_transactions
[0m14:10:16.439290 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_transactions"
[0m14:10:16.439912 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
  OPTIONS()
  as SELECT
    b.O_ORDERKEY AS ORDER_ID,
    b.O_CUSTKEY AS CUSTOMER_ID,
    b.O_ORDERDATE AS ORDER_DATE,
    DATE_ADD(b.O_ORDERDATE, INTERVAL 20 DAY) AS TRANSACTION_DATE,
    CAST(RPAD(CONCAT(CAST(b.O_ORDERKEY AS STRING), CAST(b.O_CUSTKEY AS STRING), FORMAT_DATE('%Y%m%d', b.O_ORDERDATE)), 24, '0') AS INT64) AS TRANSACTION_NUMBER,
    b.O_TOTALPRICE AS AMOUNT,
    CAST(
        CASE FLOOR(RAND() * 2) + 1
            WHEN 1 THEN 'DR'
            WHEN 2 THEN 'CR'
        END AS STRING) AS TYPE
FROM `trim-field-467501-p5`.`dbt_dataset`.`orders` AS b
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`customer` AS c
    ON b.O_CUSTKEY = c.C_CUSTKEY
WHERE b.O_ORDERDATE = PARSE_DATE('%Y-%m-%d', '1992-01-08');


[0m14:10:16.440157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:17.428099 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:d31d0f5f-37ff-4383-b2d2-951904a8e025&page=queryresults
[0m14:10:18.335279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110115000>]}
[0m14:10:18.337011 [info ] [Thread-1 (]: 2 of 31 OK created sql view model dbt_dataset.raw_transactions ................. [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m14:10:18.337938 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_transactions
[0m14:10:18.338604 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_inventory
[0m14:10:18.339498 [info ] [Thread-1 (]: 3 of 31 START sql view model dbt_dataset.raw_inventory ......................... [RUN]
[0m14:10:18.340461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_transactions, now model.dbt_bq_sa.raw_inventory)
[0m14:10:18.341398 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_inventory
[0m14:10:18.352463 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_inventory"
[0m14:10:18.353651 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_inventory
[0m14:10:18.361368 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_inventory"
[0m14:10:18.362584 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
  OPTIONS()
  as SELECT
    a.PS_PARTKEY AS PARTKEY,
    a.PS_SUPPKEY AS SUPPLIERKEY,
    a.PS_AVAILQTY AS AVAILQTY,
    a.PS_SUPPLYCOST AS SUPPLYCOST,
    a.PS_COMMENT AS PART_SUPPLY_COMMENT,
    b.S_NAME AS SUPPLIER_NAME,
    b.S_ADDRESS AS SUPPLIER_ADDRESS,
    b.S_NATIONKEY AS SUPPLIER_NATION_KEY,
    b.S_PHONE AS SUPPLIER_PHONE,
    b.S_ACCTBAL AS SUPPLIER_ACCTBAL,
    b.S_COMMENT AS SUPPLIER_COMMENT,
    c.P_NAME AS PART_NAME,
    c.P_MFGR AS PART_MFGR,
    c.P_BRAND AS PART_BRAND,
    c.P_TYPE AS PART_TYPE,
    c.P_SIZE AS PART_SIZE,
    c.P_CONTAINER AS PART_CONTAINER,
    c.P_RETAILPRICE AS PART_RETAILPRICE,
    c.P_COMMENT AS PART_COMMENT,
    d.N_NAME AS SUPPLIER_NATION_NAME,
    d.N_COMMENT AS SUPPLIER_NATION_COMMENT,
    d.N_REGIONKEY AS SUPPLIER_REGION_KEY,
    e.R_NAME AS SUPPLIER_REGION_NAME,
    e.R_COMMENT AS SUPPLIER_REGION_COMMENT
FROM `trim-field-467501-p5`.`dbt_dataset`.`partsupp` AS a
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`supplier` AS b
    ON a.PS_SUPPKEY = b.S_SUPPKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`part` AS c
    ON a.PS_PARTKEY = c.P_PARTKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`nation` AS d
    ON b.S_NATIONKEY = d.N_NATIONKEY
LEFT JOIN `trim-field-467501-p5`.`dbt_dataset`.`region` AS e
    ON d.N_REGIONKEY = e.R_REGIONKEY
JOIN `trim-field-467501-p5`.`dbt_dataset`.`raw_orders` AS f
    ON a.PS_PARTKEY = f.PARTKEY AND a.PS_SUPPKEY=f.SUPPLIERKEY
ORDER BY a.PS_PARTKEY, a.PS_SUPPKEY;


[0m14:10:18.363234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:19.835339 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:aa80c2ac-0ec2-446f-9865-3f5a5191788b&page=queryresults
[0m14:10:20.673494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110115000>]}
[0m14:10:20.675423 [info ] [Thread-1 (]: 3 of 31 OK created sql view model dbt_dataset.raw_inventory .................... [[32mCREATE VIEW (0 processed)[0m in 2.33s]
[0m14:10:20.676722 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_inventory
[0m14:10:20.677394 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_orders
[0m14:10:20.678295 [info ] [Thread-1 (]: 4 of 31 START sql view model dbt_dataset.v_stg_orders .......................... [RUN]
[0m14:10:20.679322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_inventory, now model.dbt_bq_sa.v_stg_orders)
[0m14:10:20.679910 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_orders
[0m14:10:20.719913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:22.307881 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_orders"
[0m14:10:22.309648 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_orders
[0m14:10:22.312627 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_orders"
[0m14:10:22.313976 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_orders: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_orders"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_orders`
),

derived_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMERKEY AS CUSTOMER_KEY,
    CUSTOMER_NATION_KEY AS NATION_KEY,
    CUSTOMER_REGION_KEY AS REGION_KEY,
    'TPCH-ORDERS' AS RECORD_SOURCE,
    ORDERDATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS CUSTOMER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), '')))) AS STRING) AS ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS ORDER_CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINEITEM_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS LINK_LINEITEM_ORDER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^||^^')))) AS STRING) AS INVENTORY_ALLOCATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ACCBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_MKTSEGMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_PHONE AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS CUSTOMER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(COMMITDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(DISCOUNT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(EXTENDEDPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINE_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINENUMBER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(LINESTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(QUANTITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RECEIPTDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(RETURNFLAG AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPINSTRUCT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPMODE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TAX AS STRING))), ''), '^^')
    )))) AS STRING) AS LINEITEM_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CLERK AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERDATE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(ORDERSTATUS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SHIPPRIORITY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TOTALPRICE AS STRING))), ''), '^^')
    )))) AS STRING) AS ORDER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDERKEY,
    PARTKEY,
    SUPPLIERKEY,
    LINENUMBER,
    QUANTITY,
    EXTENDEDPRICE,
    DISCOUNT,
    TAX,
    RETURNFLAG,
    LINESTATUS,
    SHIPDATE,
    COMMITDATE,
    RECEIPTDATE,
    SHIPINSTRUCT,
    SHIPMODE,
    LINE_COMMENT,
    CUSTOMERKEY,
    ORDERSTATUS,
    TOTALPRICE,
    ORDERDATE,
    ORDERPRIORITY,
    CLERK,
    SHIPPRIORITY,
    ORDER_COMMENT,
    CUSTOMER_NAME,
    CUSTOMER_ADDRESS,
    CUSTOMER_NATION_KEY,
    CUSTOMER_PHONE,
    CUSTOMER_ACCBAL,
    CUSTOMER_MKTSEGMENT,
    CUSTOMER_COMMENT,
    CUSTOMER_NATION_NAME,
    CUSTOMER_REGION_KEY,
    CUSTOMER_NATION_COMMENT,
    CUSTOMER_REGION_NAME,
    CUSTOMER_REGION_COMMENT,
    CUSTOMER_KEY,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    EFFECTIVE_FROM,
    CUSTOMER_PK,
    LINK_CUSTOMER_NATION_PK,
    CUSTOMER_NATION_PK,
    CUSTOMER_REGION_PK,
    NATION_PK,
    REGION_PK,
    NATION_REGION_PK,
    ORDER_PK,
    ORDER_CUSTOMER_PK,
    LINEITEM_PK,
    LINK_LINEITEM_ORDER_PK,
    PART_PK,
    SUPPLIER_PK,
    INVENTORY_PK,
    INVENTORY_ALLOCATION_PK,
    CUSTOMER_HASHDIFF,
    CUSTOMER_NATION_HASHDIFF,
    CUSTOMER_REGION_HASHDIFF,
    LINEITEM_HASHDIFF,
    ORDER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT * ,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE
FROM staging;


[0m14:10:23.344351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a8feca10-eec5-473b-abd6-0c8f8d41c658&page=queryresults
[0m14:10:24.319901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:24.327437 [info ] [Thread-1 (]: 4 of 31 OK created sql view model dbt_dataset.v_stg_orders ..................... [[32mCREATE VIEW (0 processed)[0m in 3.64s]
[0m14:10:24.328805 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_orders
[0m14:10:24.329329 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_transactions
[0m14:10:24.331111 [info ] [Thread-1 (]: 5 of 31 START sql view model dbt_dataset.v_stg_transactions .................... [RUN]
[0m14:10:24.333540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_orders, now model.dbt_bq_sa.v_stg_transactions)
[0m14:10:24.334430 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_transactions
[0m14:10:24.351003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:25.894801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_transactions"
[0m14:10:25.898043 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_transactions
[0m14:10:25.905051 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_transactions"
[0m14:10:25.906033 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
  OPTIONS()
  as 







-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_transactions`
),

derived_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    'RAW_TRANSACTIONS' AS RECORD_SOURCE,
    DATE_ADD(TRANSACTION_DATE, INTERVAL 1 DAY) AS LOAD_DATE,
    TRANSACTION_DATE AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(TRANSACTION_NUMBER AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS TRANSACTION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(CUSTOMER_ID AS STRING))), '')))) AS STRING) AS CUSTOMER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(ORDER_ID AS STRING))), '')))) AS STRING) AS ORDER_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    ORDER_ID,
    CUSTOMER_ID,
    ORDER_DATE,
    TRANSACTION_DATE,
    TRANSACTION_NUMBER,
    AMOUNT,
    TYPE,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRANSACTION_PK,
    CUSTOMER_PK,
    ORDER_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m14:10:26.614868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:9036ef0b-3a01-4880-8692-d53e9580ccf3&page=queryresults
[0m14:10:27.467511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153f3e4a0>]}
[0m14:10:27.468353 [info ] [Thread-1 (]: 5 of 31 OK created sql view model dbt_dataset.v_stg_transactions ............... [[32mCREATE VIEW (0 processed)[0m in 3.14s]
[0m14:10:27.468798 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_transactions
[0m14:10:27.469101 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.v_stg_inventory
[0m14:10:27.469424 [info ] [Thread-1 (]: 6 of 31 START sql view model dbt_dataset.v_stg_inventory ....................... [RUN]
[0m14:10:27.470125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_transactions, now model.dbt_bq_sa.v_stg_inventory)
[0m14:10:27.470599 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.v_stg_inventory
[0m14:10:27.476981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:28.871953 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.v_stg_inventory"
[0m14:10:28.884869 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.v_stg_inventory
[0m14:10:28.921441 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.v_stg_inventory"
[0m14:10:28.923022 [debug] [Thread-1 (]: On model.dbt_bq_sa.v_stg_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.v_stg_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory`
  OPTIONS()
  as 








WITH staging AS (
-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT

    FROM `trim-field-467501-p5`.`dbt_dataset`.`raw_inventory`
),

derived_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    SUPPLIER_NATION_KEY AS NATION_KEY,
    SUPPLIER_REGION_KEY AS REGION_KEY,
    'TPCH-INVENTORY' AS RECORD_SOURCE

    FROM source_data
),

hashed_columns AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), '')))) AS STRING) AS SUPPLIER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS SUPPLIER_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), '')))) AS STRING) AS REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), '')))) AS STRING) AS NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS NATION_REGION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_SUPPLIER_NATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), '')))) AS STRING) AS PART_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS INVENTORY_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ACCTBAL AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_ADDRESS AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_PHONE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_BRAND AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_CONTAINER AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_MFGR AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_NAME AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_RETAILPRICE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SIZE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_TYPE AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^')
    )))) AS STRING) AS PART_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_REGION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_REGION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_KEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIER_NATION_NAME AS STRING))), ''), '^^')
    )))) AS STRING) AS SUPPLIER_NATION_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(AVAILQTY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PART_SUPPLY_COMMENT AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(PARTKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLIERKEY AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(SUPPLYCOST AS STRING))), ''), '^^')
    )))) AS STRING) AS INVENTORY_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    PARTKEY,
    SUPPLIERKEY,
    AVAILQTY,
    SUPPLYCOST,
    PART_SUPPLY_COMMENT,
    SUPPLIER_NAME,
    SUPPLIER_ADDRESS,
    SUPPLIER_NATION_KEY,
    SUPPLIER_PHONE,
    SUPPLIER_ACCTBAL,
    SUPPLIER_COMMENT,
    PART_NAME,
    PART_MFGR,
    PART_BRAND,
    PART_TYPE,
    PART_SIZE,
    PART_CONTAINER,
    PART_RETAILPRICE,
    PART_COMMENT,
    SUPPLIER_NATION_NAME,
    SUPPLIER_NATION_COMMENT,
    SUPPLIER_REGION_KEY,
    SUPPLIER_REGION_NAME,
    SUPPLIER_REGION_COMMENT,
    NATION_KEY,
    REGION_KEY,
    RECORD_SOURCE,
    SUPPLIER_PK,
    SUPPLIER_NATION_PK,
    SUPPLIER_REGION_PK,
    REGION_PK,
    NATION_PK,
    NATION_REGION_PK,
    LINK_SUPPLIER_NATION_PK,
    PART_PK,
    INVENTORY_PK,
    SUPPLIER_HASHDIFF,
    PART_HASHDIFF,
    SUPPLIER_REGION_HASHDIFF,
    SUPPLIER_NATION_HASHDIFF,
    INVENTORY_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select
)

SELECT *, 
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS LOAD_DATE,
       PARSE_DATE('%Y-%m-%d', '1992-01-08') AS EFFECTIVE_FROM
FROM staging;


[0m14:10:29.917428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:1570c1ce-ba6e-44fd-b4e9-4e6449f39c7f&page=queryresults
[0m14:10:30.966087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:30.967418 [info ] [Thread-1 (]: 6 of 31 OK created sql view model dbt_dataset.v_stg_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 3.50s]
[0m14:10:30.968179 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.v_stg_inventory
[0m14:10:30.968895 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_customer
[0m14:10:30.971316 [info ] [Thread-1 (]: 7 of 31 START sql incremental model dbt_dataset.hub_customer ................... [RUN]
[0m14:10:30.972122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.v_stg_inventory, now model.dbt_bq_sa.hub_customer)
[0m14:10:30.972914 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_customer
[0m14:10:31.000251 [info ] [Thread-1 (]: 14:10:30 + Loading trim-field-467501-p5.dbt_dataset.hub_customer from 1 source(s)
[0m14:10:31.003706 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_customer"
[0m14:10:31.006041 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_customer
[0m14:10:31.034583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:31.864145 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_customer"
[0m14:10:31.866623 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_customer: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_customer"} */

  
    

    create or replace table `trim-field-467501-p5`.`dbt_dataset`.`hub_customer`
      
    
    

    
    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.CUSTOMER_PK, rr.CUSTOMERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.CUSTOMER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m14:10:32.854983 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:50fca26e-9dca-404c-bf2b-b4b379c25f4a&page=queryresults
[0m14:10:38.899996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1559b4fd0>]}
[0m14:10:38.902268 [info ] [Thread-1 (]: 7 of 31 OK created sql incremental model dbt_dataset.hub_customer .............. [[32mCREATE TABLE (0.0 rows, 224.0 Bytes processed)[0m in 7.93s]
[0m14:10:38.902927 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_customer
[0m14:10:38.904078 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_lineitem
[0m14:10:38.906569 [info ] [Thread-1 (]: 8 of 31 START sql view model dbt_dataset.hub_lineitem .......................... [RUN]
[0m14:10:38.909203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_customer, now model.dbt_bq_sa.hub_lineitem)
[0m14:10:38.909995 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_lineitem
[0m14:10:38.924206 [info ] [Thread-1 (]: 14:10:38 + Loading trim-field-467501-p5.dbt_dataset.hub_lineitem from 1 source(s)
[0m14:10:38.928067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_lineitem"
[0m14:10:38.928854 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_lineitem
[0m14:10:38.935101 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_lineitem"
[0m14:10:38.936013 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINEITEM_PK, rr.LINENUMBER, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINEITEM_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.LINEITEM_PK, a.LINENUMBER, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:10:38.936385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:40.132563 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:a661997a-e083-4382-a714-bf6566b7d872&page=queryresults
[0m14:10:41.049961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:41.051573 [info ] [Thread-1 (]: 8 of 31 OK created sql view model dbt_dataset.hub_lineitem ..................... [[32mCREATE VIEW (0 processed)[0m in 2.14s]
[0m14:10:41.052295 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_lineitem
[0m14:10:41.053887 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_order
[0m14:10:41.055312 [info ] [Thread-1 (]: 9 of 31 START sql view model dbt_dataset.hub_order ............................. [RUN]
[0m14:10:41.056062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_lineitem, now model.dbt_bq_sa.hub_order)
[0m14:10:41.056597 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_order
[0m14:10:41.062741 [info ] [Thread-1 (]: 14:10:41 + Loading trim-field-467501-p5.dbt_dataset.hub_order from 1 source(s)
[0m14:10:41.065887 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_order"
[0m14:10:41.067810 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_order
[0m14:10:41.072780 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_order"
[0m14:10:41.073851 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_PK, rr.ORDERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),


records_to_insert AS (
    SELECT a.ORDER_PK, a.ORDERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:10:41.074400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:42.198306 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:89e97041-3a43-468a-b733-8fa5cd83ac60&page=queryresults
[0m14:10:42.998051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:42.999527 [info ] [Thread-1 (]: 9 of 31 OK created sql view model dbt_dataset.hub_order ........................ [[32mCREATE VIEW (0 processed)[0m in 1.94s]
[0m14:10:43.000425 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_order
[0m14:10:43.001109 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_nation
[0m14:10:43.003988 [info ] [Thread-1 (]: 10 of 31 START sql view model dbt_dataset.link_customer_nation ................. [RUN]
[0m14:10:43.004733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_order, now model.dbt_bq_sa.link_customer_nation)
[0m14:10:43.005483 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_nation
[0m14:10:43.032495 [info ] [Thread-1 (]: 14:10:43 + Loading trim-field-467501-p5.dbt_dataset.link_customer_nation from 1 source(s)
[0m14:10:43.059005 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_nation"
[0m14:10:43.059859 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_nation
[0m14:10:43.070217 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_nation"
[0m14:10:43.071559 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_CUSTOMER_NATION_PK, rr.CUSTOMER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_CUSTOMER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_CUSTOMER_NATION_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_CUSTOMER_NATION_PK, a.CUSTOMER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:10:43.071940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:44.260336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:d3e9c9f2-eaf6-4ffa-a8a0-90b1b3185d7b&page=queryresults
[0m14:10:45.151567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f4f8e0>]}
[0m14:10:45.153010 [info ] [Thread-1 (]: 10 of 31 OK created sql view model dbt_dataset.link_customer_nation ............ [[32mCREATE VIEW (0 processed)[0m in 2.15s]
[0m14:10:45.153555 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_nation
[0m14:10:45.153876 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_customer_order
[0m14:10:45.154654 [info ] [Thread-1 (]: 11 of 31 START sql view model dbt_dataset.link_customer_order .................. [RUN]
[0m14:10:45.155371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_nation, now model.dbt_bq_sa.link_customer_order)
[0m14:10:45.155690 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_customer_order
[0m14:10:45.160849 [info ] [Thread-1 (]: 14:10:45 + Loading trim-field-467501-p5.dbt_dataset.link_customer_order from 1 source(s)
[0m14:10:45.164762 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_customer_order"
[0m14:10:45.165499 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_customer_order
[0m14:10:45.168465 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_customer_order"
[0m14:10:45.169168 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_customer_order: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_customer_order"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_customer_order`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.ORDER_CUSTOMER_PK, rr.CUSTOMER_PK, rr.ORDER_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.ORDER_CUSTOMER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.ORDER_CUSTOMER_PK IS NOT NULL
    AND rr.CUSTOMER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.ORDER_CUSTOMER_PK, a.CUSTOMER_PK, a.ORDER_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:10:45.169481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:46.383055 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f1aef74c-b437-4eca-861f-aca441ba694e&page=queryresults
[0m14:10:47.230282 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:47.231237 [info ] [Thread-1 (]: 11 of 31 OK created sql view model dbt_dataset.link_customer_order ............. [[32mCREATE VIEW (0 processed)[0m in 2.07s]
[0m14:10:47.231696 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_customer_order
[0m14:10:47.232074 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory_allocation
[0m14:10:47.232690 [info ] [Thread-1 (]: 12 of 31 START sql view model dbt_dataset.link_inventory_allocation ............ [RUN]
[0m14:10:47.233169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_customer_order, now model.dbt_bq_sa.link_inventory_allocation)
[0m14:10:47.233581 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory_allocation
[0m14:10:47.245861 [info ] [Thread-1 (]: 14:10:47 + Loading trim-field-467501-p5.dbt_dataset.link_inventory_allocation from 1 source(s)
[0m14:10:47.251379 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory_allocation"
[0m14:10:47.252571 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory_allocation
[0m14:10:47.256173 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory_allocation"
[0m14:10:47.257300 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory_allocation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory_allocation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory_allocation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_ALLOCATION_PK, rr.PART_PK, rr.SUPPLIER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_ALLOCATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.INVENTORY_ALLOCATION_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_ALLOCATION_PK, a.PART_PK, a.SUPPLIER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:10:47.257996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:48.336406 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:c2a8293d-6398-40fb-93fb-56523ca3cfc6&page=queryresults
[0m14:10:49.236150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:49.237237 [info ] [Thread-1 (]: 12 of 31 OK created sql view model dbt_dataset.link_inventory_allocation ....... [[32mCREATE VIEW (0 processed)[0m in 2.00s]
[0m14:10:49.237772 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory_allocation
[0m14:10:49.238097 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_order_lineitem
[0m14:10:49.238417 [info ] [Thread-1 (]: 13 of 31 START sql view model dbt_dataset.link_order_lineitem .................. [RUN]
[0m14:10:49.238755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory_allocation, now model.dbt_bq_sa.link_order_lineitem)
[0m14:10:49.239090 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_order_lineitem
[0m14:10:49.243196 [info ] [Thread-1 (]: 14:10:49 + Loading trim-field-467501-p5.dbt_dataset.link_order_lineitem from 1 source(s)
[0m14:10:49.245782 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_order_lineitem"
[0m14:10:49.247630 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_order_lineitem
[0m14:10:49.252121 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_order_lineitem"
[0m14:10:49.252858 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_order_lineitem: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_order_lineitem"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_order_lineitem`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_LINEITEM_ORDER_PK, rr.ORDER_PK, rr.LINEITEM_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_LINEITEM_ORDER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.LINK_LINEITEM_ORDER_PK IS NOT NULL
    AND rr.ORDER_PK IS NOT NULL
    AND rr.LINEITEM_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_LINEITEM_ORDER_PK, a.ORDER_PK, a.LINEITEM_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:10:49.254024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:50.423704 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:2be49f0f-dedc-48a4-b69a-c6f4a301f9dd&page=queryresults
[0m14:10:51.282750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f355d0>]}
[0m14:10:51.283830 [info ] [Thread-1 (]: 13 of 31 OK created sql view model dbt_dataset.link_order_lineitem ............. [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m14:10:51.284345 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_order_lineitem
[0m14:10:51.284744 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m14:10:51.285509 [info ] [Thread-1 (]: 14 of 31 START sql view model dbt_dataset.sat_order_cust_nation_details ........ [RUN]
[0m14:10:51.286047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_order_lineitem, now model.dbt_bq_sa.sat_order_cust_nation_details)
[0m14:10:51.286387 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_nation_details
[0m14:10:51.329313 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m14:10:51.330183 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_nation_details
[0m14:10:51.332822 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_nation_details"
[0m14:10:51.333335 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_NATION_HASHDIFF, a.CUSTOMER_NATION_NAME, a.CUSTOMER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_NATION_HASHDIFF, stage.CUSTOMER_NATION_NAME, stage.CUSTOMER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:10:51.333793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:52.822757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:40efbf2d-1809-4aa4-8ffb-db62ab8df793&page=queryresults
[0m14:10:53.622082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:53.623353 [info ] [Thread-1 (]: 14 of 31 OK created sql view model dbt_dataset.sat_order_cust_nation_details ... [[32mCREATE VIEW (0 processed)[0m in 2.34s]
[0m14:10:53.624171 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_nation_details
[0m14:10:53.624539 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_cust_region_details
[0m14:10:53.625032 [info ] [Thread-1 (]: 15 of 31 START sql view model dbt_dataset.sat_order_cust_region_details ........ [RUN]
[0m14:10:53.625433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_nation_details, now model.dbt_bq_sa.sat_order_cust_region_details)
[0m14:10:53.625711 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_cust_region_details
[0m14:10:53.634206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m14:10:53.635141 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_cust_region_details
[0m14:10:53.640900 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_cust_region_details"
[0m14:10:53.642591 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_cust_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_cust_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_cust_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_REGION_HASHDIFF, a.CUSTOMER_REGION_NAME, a.CUSTOMER_REGION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_REGION_HASHDIFF, stage.CUSTOMER_REGION_NAME, stage.CUSTOMER_REGION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:10:53.643018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:54.741848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:5d509d1b-6eb3-48e6-86d4-11f155f6713a&page=queryresults
[0m14:10:55.594266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f3d810>]}
[0m14:10:55.595571 [info ] [Thread-1 (]: 15 of 31 OK created sql view model dbt_dataset.sat_order_cust_region_details ... [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m14:10:55.597162 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_cust_region_details
[0m14:10:55.599008 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_customer_details
[0m14:10:55.600074 [info ] [Thread-1 (]: 16 of 31 START sql view model dbt_dataset.sat_order_customer_details ........... [RUN]
[0m14:10:55.600673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_cust_region_details, now model.dbt_bq_sa.sat_order_customer_details)
[0m14:10:55.601050 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_customer_details
[0m14:10:55.615034 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_customer_details"
[0m14:10:55.616668 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_customer_details
[0m14:10:55.620728 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_customer_details"
[0m14:10:55.621621 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_customer_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_customer_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_customer_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.CUSTOMER_PK, a.CUSTOMER_HASHDIFF, a.CUSTOMER_NAME, a.CUSTOMER_ADDRESS, a.CUSTOMER_PHONE, a.CUSTOMER_ACCBAL, a.CUSTOMER_MKTSEGMENT, a.CUSTOMER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.CUSTOMER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.CUSTOMER_PK, stage.CUSTOMER_HASHDIFF, stage.CUSTOMER_NAME, stage.CUSTOMER_ADDRESS, stage.CUSTOMER_PHONE, stage.CUSTOMER_ACCBAL, stage.CUSTOMER_MKTSEGMENT, stage.CUSTOMER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:10:55.622049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:56.694838 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4a929187-6438-4904-8153-bed15529e588&page=queryresults
[0m14:10:57.548522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155f3c070>]}
[0m14:10:57.555429 [info ] [Thread-1 (]: 16 of 31 OK created sql view model dbt_dataset.sat_order_customer_details ...... [[32mCREATE VIEW (0 processed)[0m in 1.95s]
[0m14:10:57.556435 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_customer_details
[0m14:10:57.557011 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_lineitem_details
[0m14:10:57.557876 [info ] [Thread-1 (]: 17 of 31 START sql view model dbt_dataset.sat_order_lineitem_details ........... [RUN]
[0m14:10:57.558416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_customer_details, now model.dbt_bq_sa.sat_order_lineitem_details)
[0m14:10:57.558792 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_lineitem_details
[0m14:10:57.584014 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m14:10:57.585313 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_lineitem_details
[0m14:10:57.589518 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_lineitem_details"
[0m14:10:57.590403 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_lineitem_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_lineitem_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_lineitem_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.LINEITEM_PK, a.LINEITEM_HASHDIFF, a.COMMITDATE, a.DISCOUNT, a.EXTENDEDPRICE, a.LINE_COMMENT, a.QUANTITY, a.RECEIPTDATE, a.RETURNFLAG, a.SHIPDATE, a.SHIPINSTRUCT, a.SHIPMODE, a.TAX, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.LINEITEM_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.LINEITEM_PK, stage.LINEITEM_HASHDIFF, stage.COMMITDATE, stage.DISCOUNT, stage.EXTENDEDPRICE, stage.LINE_COMMENT, stage.QUANTITY, stage.RECEIPTDATE, stage.RETURNFLAG, stage.SHIPDATE, stage.SHIPINSTRUCT, stage.SHIPMODE, stage.TAX, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:10:57.590807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:10:58.740913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:3719a9ec-14cb-4143-bd8f-e7cce2189cfc&page=queryresults
[0m14:10:59.928684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:10:59.930221 [info ] [Thread-1 (]: 17 of 31 OK created sql view model dbt_dataset.sat_order_lineitem_details ...... [[32mCREATE VIEW (0 processed)[0m in 2.37s]
[0m14:10:59.936141 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_lineitem_details
[0m14:10:59.937358 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_order_order_details
[0m14:10:59.938281 [info ] [Thread-1 (]: 18 of 31 START sql view model dbt_dataset.sat_order_order_details .............. [RUN]
[0m14:10:59.939203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_lineitem_details, now model.dbt_bq_sa.sat_order_order_details)
[0m14:10:59.939820 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_order_order_details
[0m14:10:59.950852 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_order_order_details"
[0m14:10:59.951655 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_order_order_details
[0m14:10:59.954170 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_order_order_details"
[0m14:10:59.954928 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_order_order_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_order_order_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_order_order_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.ORDER_PK, a.ORDER_HASHDIFF, a.ORDERSTATUS, a.TOTALPRICE, a.ORDERDATE, a.ORDERPRIORITY, a.CLERK, a.SHIPPRIORITY, a.ORDER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS a
    WHERE a.ORDER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.ORDER_PK, stage.ORDER_HASHDIFF, stage.ORDERSTATUS, stage.TOTALPRICE, stage.ORDERDATE, stage.ORDERPRIORITY, stage.CLERK, stage.SHIPPRIORITY, stage.ORDER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:10:59.955221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:01.044132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:46b6b12a-12c8-4d81-907a-7ce274c4b9ac&page=queryresults
[0m14:11:01.875095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155fa4dc0>]}
[0m14:11:01.876910 [info ] [Thread-1 (]: 18 of 31 OK created sql view model dbt_dataset.sat_order_order_details ......... [[32mCREATE VIEW (0 processed)[0m in 1.93s]
[0m14:11:01.877387 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_order_order_details
[0m14:11:01.877752 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.t_link_transactions
[0m14:11:01.878334 [info ] [Thread-1 (]: 19 of 31 START sql view model dbt_dataset.t_link_transactions .................. [RUN]
[0m14:11:01.878847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_order_order_details, now model.dbt_bq_sa.t_link_transactions)
[0m14:11:01.879173 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.t_link_transactions
[0m14:11:01.907866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.t_link_transactions"
[0m14:11:01.908855 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.t_link_transactions
[0m14:11:01.911589 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.t_link_transactions"
[0m14:11:01.912074 [debug] [Thread-1 (]: On model.dbt_bq_sa.t_link_transactions: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.t_link_transactions"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`t_link_transactions`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH stage AS (
    SELECT TRANSACTION_PK, CUSTOMER_PK, ORDER_PK, TRANSACTION_NUMBER, TRANSACTION_DATE, TYPE, AMOUNT, EFFECTIVE_FROM, LOAD_DATE, RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_transactions`
    WHERE TRANSACTION_PK IS NOT NULL
    AND CUSTOMER_PK IS NOT NULL
    AND ORDER_PK IS NOT NULL
),
records_to_insert AS (
    SELECT DISTINCT stg.TRANSACTION_PK, stg.CUSTOMER_PK, stg.ORDER_PK, stg.TRANSACTION_NUMBER, stg.TRANSACTION_DATE, stg.TYPE, stg.AMOUNT, stg.EFFECTIVE_FROM, stg.LOAD_DATE, stg.RECORD_SOURCE
    FROM stage AS stg
    
)

SELECT * FROM records_to_insert;


[0m14:11:01.912353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:03.034865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:606cf555-d693-4963-909e-39b166944b08&page=queryresults
[0m14:11:03.844173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:11:03.845453 [info ] [Thread-1 (]: 19 of 31 OK created sql view model dbt_dataset.t_link_transactions ............. [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m14:11:03.845942 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.t_link_transactions
[0m14:11:03.846412 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_nation
[0m14:11:03.847134 [info ] [Thread-1 (]: 20 of 31 START sql view model dbt_dataset.hub_nation ........................... [RUN]
[0m14:11:03.847600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.t_link_transactions, now model.dbt_bq_sa.hub_nation)
[0m14:11:03.847897 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_nation
[0m14:11:03.862238 [info ] [Thread-1 (]: 14:11:03 + Loading trim-field-467501-p5.dbt_dataset.hub_nation from 2 source(s)
[0m14:11:03.867341 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_nation"
[0m14:11:03.868163 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_nation
[0m14:11:03.875355 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_nation"
[0m14:11:03.876193 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_PK, rr.NATION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.NATION_PK, a.NATION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m14:11:03.876616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:04.988502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f853c7cc-2432-42f0-ad0d-cfae1f060f50&page=queryresults
[0m14:11:05.821094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3160>]}
[0m14:11:05.822335 [info ] [Thread-1 (]: 20 of 31 OK created sql view model dbt_dataset.hub_nation ...................... [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m14:11:05.823174 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_nation
[0m14:11:05.823881 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_part
[0m14:11:05.824676 [info ] [Thread-1 (]: 21 of 31 START sql view model dbt_dataset.hub_part ............................. [RUN]
[0m14:11:05.825191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_nation, now model.dbt_bq_sa.hub_part)
[0m14:11:05.825575 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_part
[0m14:11:05.830422 [info ] [Thread-1 (]: 14:11:05 + Loading trim-field-467501-p5.dbt_dataset.hub_part from 2 source(s)
[0m14:11:05.842173 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_part"
[0m14:11:05.842777 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_part
[0m14:11:05.845497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_part"
[0m14:11:05.846015 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_part: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_part"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_part`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.PART_PK, rr.PARTKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.PART_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.PART_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.PART_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.PART_PK, a.PARTKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m14:11:05.846343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:06.988895 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:197cf831-f459-4457-963e-2f582b356313&page=queryresults
[0m14:11:07.832614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e83760>]}
[0m14:11:07.834121 [info ] [Thread-1 (]: 21 of 31 OK created sql view model dbt_dataset.hub_part ........................ [[32mCREATE VIEW (0 processed)[0m in 2.01s]
[0m14:11:07.835296 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_part
[0m14:11:07.835935 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_region
[0m14:11:07.836429 [info ] [Thread-1 (]: 22 of 31 START sql view model dbt_dataset.hub_region ........................... [RUN]
[0m14:11:07.836830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_part, now model.dbt_bq_sa.hub_region)
[0m14:11:07.837085 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_region
[0m14:11:07.841410 [info ] [Thread-1 (]: 14:11:07 + Loading trim-field-467501-p5.dbt_dataset.hub_region from 2 source(s)
[0m14:11:07.844557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_region"
[0m14:11:07.845808 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_region
[0m14:11:07.848621 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_region"
[0m14:11:07.849460 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.REGION_PK, rr.REGION_KEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.REGION_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.REGION_PK, a.REGION_KEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m14:11:07.849806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:08.995697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:30b7a3bf-7916-4e1a-b291-d4b18f66beaa&page=queryresults
[0m14:11:09.895284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155e86f20>]}
[0m14:11:09.897424 [info ] [Thread-1 (]: 22 of 31 OK created sql view model dbt_dataset.hub_region ...................... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m14:11:09.898256 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_region
[0m14:11:09.898662 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_supplier
[0m14:11:09.899211 [info ] [Thread-1 (]: 23 of 31 START sql view model dbt_dataset.hub_supplier ......................... [RUN]
[0m14:11:09.899768 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_region, now model.dbt_bq_sa.hub_supplier)
[0m14:11:09.900143 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_supplier
[0m14:11:09.906000 [info ] [Thread-1 (]: 14:11:09 + Loading trim-field-467501-p5.dbt_dataset.hub_supplier from 2 source(s)
[0m14:11:09.911476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_supplier"
[0m14:11:09.912325 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_supplier
[0m14:11:09.916009 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_supplier"
[0m14:11:09.916918 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_supplier: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_supplier"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`hub_supplier`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.SUPPLIER_PK, rr.SUPPLIERKEY, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.SUPPLIER_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.SUPPLIER_PK IS NOT NULL
    QUALIFY row_number = 1
),


stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

    row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.SUPPLIER_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.SUPPLIER_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),


records_to_insert AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIERKEY, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m14:11:09.917467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:10.980560 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:9c47ae3f-6e81-49de-b792-0433716fe291&page=queryresults
[0m14:11:11.767366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155eabf40>]}
[0m14:11:13.079349 [debug] [Thread-1 (]: An error was encountered while trying to send an event
[0m14:11:13.087945 [info ] [Thread-1 (]: 23 of 31 OK created sql view model dbt_dataset.hub_supplier .................... [[32mCREATE VIEW (0 processed)[0m in 1.87s]
[0m14:11:13.090343 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_supplier
[0m14:11:13.091918 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_inventory
[0m14:11:13.093151 [info ] [Thread-1 (]: 24 of 31 START sql view model dbt_dataset.link_inventory ....................... [RUN]
[0m14:11:13.094579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_supplier, now model.dbt_bq_sa.link_inventory)
[0m14:11:13.096786 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_inventory
[0m14:11:13.128658 [info ] [Thread-1 (]: 14:11:13 + Loading trim-field-467501-p5.dbt_dataset.link_inventory from 1 source(s)
[0m14:11:13.139153 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_inventory"
[0m14:11:13.141408 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_inventory
[0m14:11:13.150835 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_inventory"
[0m14:11:13.151540 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_inventory: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_inventory"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_inventory`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.INVENTORY_PK, rr.SUPPLIER_PK, rr.PART_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.INVENTORY_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.INVENTORY_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.PART_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.INVENTORY_PK, a.SUPPLIER_PK, a.PART_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:11:13.151895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:14.337246 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:b0a4c65d-48b5-4d12-a09f-d25fb29759d7&page=queryresults
[0m14:11:15.128998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155eabf40>]}
[0m14:11:15.130106 [info ] [Thread-1 (]: 24 of 31 OK created sql view model dbt_dataset.link_inventory .................. [[32mCREATE VIEW (0 processed)[0m in 2.03s]
[0m14:11:15.130536 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_inventory
[0m14:11:15.130871 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_nation_region
[0m14:11:15.131566 [info ] [Thread-1 (]: 25 of 31 START sql view model dbt_dataset.link_nation_region ................... [RUN]
[0m14:11:15.131946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_inventory, now model.dbt_bq_sa.link_nation_region)
[0m14:11:15.132194 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_nation_region
[0m14:11:15.138515 [info ] [Thread-1 (]: 14:11:15 + Loading trim-field-467501-p5.dbt_dataset.link_nation_region from 2 source(s)
[0m14:11:15.142409 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_nation_region"
[0m14:11:15.143040 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_nation_region
[0m14:11:15.146373 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_nation_region"
[0m14:11:15.147210 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_nation_region: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_nation_region"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_nation_region`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_orders` AS rr
    QUALIFY row_number = 1
),

row_rank_2 AS (
    SELECT rr.NATION_REGION_PK, rr.NATION_PK, rr.REGION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.NATION_REGION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    QUALIFY row_number = 1
),

stage_union AS (
    SELECT * FROM row_rank_1
    UNION ALL
    SELECT * FROM row_rank_2
),

row_rank_union AS (
    SELECT ru.*,
           ROW_NUMBER() OVER(
               PARTITION BY ru.NATION_REGION_PK
               ORDER BY ru.LOAD_DATE, ru.RECORD_SOURCE ASC
           ) AS row_rank_number
    FROM stage_union AS ru
    WHERE ru.NATION_REGION_PK IS NOT NULL
    AND ru.NATION_PK IS NOT NULL
    AND ru.REGION_PK IS NOT NULL
    QUALIFY row_rank_number = 1
),

records_to_insert AS (
    SELECT a.NATION_REGION_PK, a.NATION_PK, a.REGION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_union AS a
)

SELECT * FROM records_to_insert;


[0m14:11:15.147907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:16.212237 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:dbd5b8fa-47d6-4cc4-99a9-d53bfee1dbb6&page=queryresults
[0m14:11:17.089407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156163f40>]}
[0m14:11:17.089990 [info ] [Thread-1 (]: 25 of 31 OK created sql view model dbt_dataset.link_nation_region .............. [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m14:11:17.090395 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_nation_region
[0m14:11:17.090668 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_supplier_nation
[0m14:11:17.090976 [info ] [Thread-1 (]: 26 of 31 START sql view model dbt_dataset.link_supplier_nation ................. [RUN]
[0m14:11:17.091264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_nation_region, now model.dbt_bq_sa.link_supplier_nation)
[0m14:11:17.091689 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_supplier_nation
[0m14:11:17.099532 [info ] [Thread-1 (]: 14:11:17 + Loading trim-field-467501-p5.dbt_dataset.link_supplier_nation from 1 source(s)
[0m14:11:17.102484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_supplier_nation"
[0m14:11:17.103070 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_supplier_nation
[0m14:11:17.105907 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_supplier_nation"
[0m14:11:17.106477 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_supplier_nation: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_supplier_nation"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`link_supplier_nation`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_SUPPLIER_NATION_PK, rr.SUPPLIER_PK, rr.NATION_PK, rr.LOAD_DATE, rr.RECORD_SOURCE,
           ROW_NUMBER() OVER(
               PARTITION BY rr.LINK_SUPPLIER_NATION_PK
               ORDER BY rr.LOAD_DATE
           ) AS row_number
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS rr
    WHERE rr.LINK_SUPPLIER_NATION_PK IS NOT NULL
    AND rr.SUPPLIER_PK IS NOT NULL
    AND rr.NATION_PK IS NOT NULL
    QUALIFY row_number = 1
),

records_to_insert AS (
    SELECT a.LINK_SUPPLIER_NATION_PK, a.SUPPLIER_PK, a.NATION_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert;


[0m14:11:17.106752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:18.222855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:4aa358e0-bce9-4f19-950e-b0982e365b3e&page=queryresults
[0m14:11:19.145021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155eb3730>]}
[0m14:11:19.146476 [info ] [Thread-1 (]: 26 of 31 OK created sql view model dbt_dataset.link_supplier_nation ............ [[32mCREATE VIEW (0 processed)[0m in 2.05s]
[0m14:11:19.147861 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_supplier_nation
[0m14:11:19.148323 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_inventory_details
[0m14:11:19.148815 [info ] [Thread-1 (]: 27 of 31 START sql view model dbt_dataset.sat_inv_inventory_details ............ [RUN]
[0m14:11:19.149198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_supplier_nation, now model.dbt_bq_sa.sat_inv_inventory_details)
[0m14:11:19.149451 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_inventory_details
[0m14:11:19.158497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m14:11:19.159194 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_inventory_details
[0m14:11:19.162850 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_inventory_details"
[0m14:11:19.163608 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_inventory_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_inventory_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_inventory_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.INVENTORY_PK, a.INVENTORY_HASHDIFF, a.AVAILQTY, a.SUPPLYCOST, a.PART_SUPPLY_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.INVENTORY_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.INVENTORY_PK, stage.INVENTORY_HASHDIFF, stage.AVAILQTY, stage.SUPPLYCOST, stage.PART_SUPPLY_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:11:19.163915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:20.196776 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:33d93cbf-00b0-4d3a-add5-3c7911fafeb7&page=queryresults
[0m14:11:21.189794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x156163f40>]}
[0m14:11:21.191155 [info ] [Thread-1 (]: 27 of 31 OK created sql view model dbt_dataset.sat_inv_inventory_details ....... [[32mCREATE VIEW (0 processed)[0m in 2.04s]
[0m14:11:21.191691 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_inventory_details
[0m14:11:21.191996 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_part_details
[0m14:11:21.192952 [info ] [Thread-1 (]: 28 of 31 START sql view model dbt_dataset.sat_inv_part_details ................. [RUN]
[0m14:11:21.193621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_inventory_details, now model.dbt_bq_sa.sat_inv_part_details)
[0m14:11:21.193946 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_part_details
[0m14:11:21.206629 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_part_details"
[0m14:11:21.207955 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_part_details
[0m14:11:21.214835 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_part_details"
[0m14:11:21.215473 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_part_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_part_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_part_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.PART_PK, a.PART_HASHDIFF, a.PART_NAME, a.PART_MFGR, a.PART_BRAND, a.PART_TYPE, a.PART_SIZE, a.PART_CONTAINER, a.PART_RETAILPRICE, a.PART_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.PART_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.PART_PK, stage.PART_HASHDIFF, stage.PART_NAME, stage.PART_MFGR, stage.PART_BRAND, stage.PART_TYPE, stage.PART_SIZE, stage.PART_CONTAINER, stage.PART_RETAILPRICE, stage.PART_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:11:21.215747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:22.324159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:6ca019ae-5945-41c4-a82f-0ea4b94ab27b&page=queryresults
[0m14:11:23.096115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1561b04f0>]}
[0m14:11:23.097897 [info ] [Thread-1 (]: 28 of 31 OK created sql view model dbt_dataset.sat_inv_part_details ............ [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m14:11:23.098802 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_part_details
[0m14:11:23.099483 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m14:11:23.100268 [info ] [Thread-1 (]: 29 of 31 START sql view model dbt_dataset.sat_inv_supp_nation_details .......... [RUN]
[0m14:11:23.100787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_part_details, now model.dbt_bq_sa.sat_inv_supp_nation_details)
[0m14:11:23.101088 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m14:11:23.110068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m14:11:23.111818 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m14:11:23.114553 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_nation_details"
[0m14:11:23.115078 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_nation_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_nation_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_nation_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:11:23.115383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:24.313799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:f0840e19-1be5-4fad-b834-15070ff3f443&page=queryresults
[0m14:11:25.484356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15619a920>]}
[0m14:11:25.486219 [info ] [Thread-1 (]: 29 of 31 OK created sql view model dbt_dataset.sat_inv_supp_nation_details ..... [[32mCREATE VIEW (0 processed)[0m in 2.38s]
[0m14:11:25.487336 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_nation_details
[0m14:11:25.488562 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m14:11:25.490151 [info ] [Thread-1 (]: 30 of 31 START sql view model dbt_dataset.sat_inv_supp_region_details .......... [RUN]
[0m14:11:25.491187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_nation_details, now model.dbt_bq_sa.sat_inv_supp_region_details)
[0m14:11:25.492033 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supp_region_details
[0m14:11:25.504111 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m14:11:25.505256 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supp_region_details
[0m14:11:25.507828 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supp_region_details"
[0m14:11:25.508825 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supp_region_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supp_region_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supp_region_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_NATION_HASHDIFF, a.SUPPLIER_NATION_NAME, a.SUPPLIER_NATION_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_NATION_HASHDIFF, stage.SUPPLIER_NATION_NAME, stage.SUPPLIER_NATION_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:11:25.509115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:26.772255 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:2c32a91a-971a-4624-a50b-c37f8fcd7060&page=queryresults
[0m14:11:27.691986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x155ecd7b0>]}
[0m14:11:27.694521 [info ] [Thread-1 (]: 30 of 31 OK created sql view model dbt_dataset.sat_inv_supp_region_details ..... [[32mCREATE VIEW (0 processed)[0m in 2.20s]
[0m14:11:27.695390 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supp_region_details
[0m14:11:27.695945 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_inv_supplier_details
[0m14:11:27.696545 [info ] [Thread-1 (]: 31 of 31 START sql view model dbt_dataset.sat_inv_supplier_details ............. [RUN]
[0m14:11:27.696930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_inv_supp_region_details, now model.dbt_bq_sa.sat_inv_supplier_details)
[0m14:11:27.697180 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_inv_supplier_details
[0m14:11:27.725560 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m14:11:27.733708 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_inv_supplier_details
[0m14:11:27.767132 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_inv_supplier_details"
[0m14:11:27.771502 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_inv_supplier_details: /* {"app": "dbt", "dbt_version": "1.10.7", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_inv_supplier_details"} */


  create or replace view `trim-field-467501-p5`.`dbt_dataset`.`sat_inv_supplier_details`
  OPTIONS()
  as -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.SUPPLIER_PK, a.SUPPLIER_HASHDIFF, a.SUPPLIER_ADDRESS, a.SUPPLIER_PHONE, a.SUPPLIER_ACCTBAL, a.SUPPLIER_NAME, a.SUPPLIER_COMMENT, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `trim-field-467501-p5`.`dbt_dataset`.`v_stg_inventory` AS a
    WHERE a.SUPPLIER_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT stage.SUPPLIER_PK, stage.SUPPLIER_HASHDIFF, stage.SUPPLIER_ADDRESS, stage.SUPPLIER_PHONE, stage.SUPPLIER_ACCTBAL, stage.SUPPLIER_NAME, stage.SUPPLIER_COMMENT, stage.EFFECTIVE_FROM, stage.LOAD_DATE, stage.RECORD_SOURCE
    FROM source_data AS stage
)

SELECT * FROM records_to_insert;


[0m14:11:27.776775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:28.905007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=trim-field-467501-p5&j=bq:US:e9d4427d-f2ff-4576-8357-7aca3089a665&page=queryresults
[0m14:11:29.785661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d59c97c-e077-4225-a65d-6a8890fe6bae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1561fabf0>]}
[0m14:11:29.786894 [info ] [Thread-1 (]: 31 of 31 OK created sql view model dbt_dataset.sat_inv_supplier_details ........ [[32mCREATE VIEW (0 processed)[0m in 2.09s]
[0m14:11:29.787809 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_inv_supplier_details
[0m14:11:29.792454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:29.794232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:29.794544 [debug] [MainThread]: Connection 'model.dbt_bq_sa.sat_inv_supplier_details' was properly closed.
[0m14:11:29.795296 [info ] [MainThread]: 
[0m14:11:29.795785 [info ] [MainThread]: Finished running 1 incremental model, 30 view models in 0 hours 1 minutes and 17.74 seconds (77.74s).
[0m14:11:29.798986 [debug] [MainThread]: Command end result
[0m14:11:29.835916 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/manifest.json
[0m14:11:29.844444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/semantic_manifest.json
[0m14:11:29.867074 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rishin/PycharmProjects/automate-dv-demo-5.4/target/run_results.json
[0m14:11:29.867385 [info ] [MainThread]: 
[0m14:11:29.867816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:29.868166 [info ] [MainThread]: 
[0m14:11:29.868373 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=31
[0m14:11:29.872933 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 80.27878, "process_in_blocks": "0", "process_kernel_time": 1.956144, "process_mem_max_rss": "343703552", "process_out_blocks": "0", "process_user_time": 6.313053}
[0m14:11:29.873896 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:29.873831 after 80.28 seconds
[0m14:11:29.874605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153df01c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154acbdf0>]}
[0m14:11:29.874825 [debug] [MainThread]: Flushing usage events
[0m14:11:30.784207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:35:27.343597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a0b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b301f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b308b0>]}


============================== 10:35:27.346676 | 618d1e9f-6969-4c41-b30f-3a3878fd45db ==============================
[0m10:35:27.346676 [info ] [MainThread]: Running with dbt=1.10.7
[0m10:35:27.346998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:35:27.428636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '618d1e9f-6969-4c41-b30f-3a3878fd45db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c42560>]}
[0m10:35:27.474919 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-yyfbi_tx'
[0m10:35:27.475197 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:35:27.581958 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:35:27.582605 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m10:35:28.091597 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m10:35:28.099646 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:35:28.164310 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:35:28.173500 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m10:35:28.701361 [info ] [MainThread]: Installed from version 0.9.7
[0m10:35:28.701838 [info ] [MainThread]: Updated version available: 0.11.2
[0m10:35:28.702201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '618d1e9f-6969-4c41-b30f-3a3878fd45db', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104305690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d03c40>]}
[0m10:35:28.702613 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:35:29.147458 [info ] [MainThread]: Installed from version 1.3.0
[0m10:35:29.147774 [info ] [MainThread]: Up to date!
[0m10:35:29.148021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '618d1e9f-6969-4c41-b30f-3a3878fd45db', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103380a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d03c40>]}
[0m10:35:29.148290 [info ] [MainThread]: 
[0m10:35:29.148489 [info ] [MainThread]: Updates available for packages: ['Datavault-UK/automate_dv']                 
Update your versions in packages.yml, then run dbt deps
[0m10:35:29.182590 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8849363, "process_in_blocks": "0", "process_kernel_time": 0.254441, "process_mem_max_rss": "109740032", "process_out_blocks": "0", "process_user_time": 0.873805}
[0m10:35:29.183068 [debug] [MainThread]: Command `dbt deps` succeeded at 10:35:29.182986 after 1.89 seconds
[0m10:35:29.183350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a0b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c407f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c405e0>]}
[0m10:35:29.183612 [debug] [MainThread]: Flushing usage events
[0m10:35:30.375009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:36:08.545974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fe76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105138850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051381c0>]}


============================== 10:36:08.549225 | f098c068-05eb-4492-9f36-356736e13a07 ==============================
[0m10:36:08.549225 [info ] [MainThread]: Running with dbt=1.10.7
[0m10:36:08.549552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models path:models/stage', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:36:08.549808 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m10:36:08.549987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f098c068-05eb-4492-9f36-356736e13a07', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104140c10>]}
[0m10:36:10.741931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f098c068-05eb-4492-9f36-356736e13a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028e9d50>]}
[0m10:36:10.773196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f098c068-05eb-4492-9f36-356736e13a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f8f1d50>]}
[0m10:36:10.773550 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m10:36:10.933234 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m10:36:10.992778 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:36:10.993099 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:36:10.993316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f098c068-05eb-4492-9f36-356736e13a07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a02c80>]}
[0m10:36:12.013150 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m10:36:12.013770 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:36:12.015327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.516037, "process_in_blocks": "0", "process_kernel_time": 1.22489, "process_mem_max_rss": "337625088", "process_out_blocks": "0", "process_user_time": 3.769034}
[0m10:36:12.015702 [debug] [MainThread]: Command `dbt run` failed at 10:36:12.015641 after 3.52 seconds
[0m10:36:12.015922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fe76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1412ab3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14140da50>]}
[0m10:36:12.016126 [debug] [MainThread]: Flushing usage events
[0m10:36:13.054885 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:39:09.759407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550ca90>]}


============================== 10:39:09.762404 | d0c03998-6836-4286-a26a-b20112852542 ==============================
[0m10:39:09.762404 [info ] [MainThread]: Running with dbt=1.10.7
[0m10:39:09.762754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m dbt_stg_trips', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:39:09.763009 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m10:39:09.763206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd0c03998-6836-4286-a26a-b20112852542', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547a3b0>]}
[0m10:39:11.522345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0c03998-6836-4286-a26a-b20112852542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158399030>]}
[0m10:39:11.553904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0c03998-6836-4286-a26a-b20112852542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158411630>]}
[0m10:39:11.554260 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m10:39:11.690002 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m10:39:11.746537 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:39:11.746853 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:39:11.747051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0c03998-6836-4286-a26a-b20112852542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dcfb20>]}
[0m10:39:12.824600 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m10:39:12.825224 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:39:12.827083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1085887, "process_in_blocks": "0", "process_kernel_time": 1.192384, "process_mem_max_rss": "337772544", "process_out_blocks": "0", "process_user_time": 3.698072}
[0m10:39:12.827598 [debug] [MainThread]: Command `dbt run` failed at 10:39:12.827532 after 3.11 seconds
[0m10:39:12.827863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1588446d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158d0d0c0>]}
[0m10:39:12.830068 [debug] [MainThread]: Flushing usage events
[0m10:39:13.914870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:41:40.161009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066343d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106634a90>]}


============================== 10:41:40.163917 | 7e5b66ca-86c1-421f-8668-d293d235e227 ==============================
[0m10:41:40.163917 [info ] [MainThread]: Running with dbt=1.10.7
[0m10:41:40.164236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select path:models/stage', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:41:42.041621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e5b66ca-86c1-421f-8668-d293d235e227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102821d50>]}
[0m10:41:42.072984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e5b66ca-86c1-421f-8668-d293d235e227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105683100>]}
[0m10:41:42.073369 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m10:41:42.198972 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m10:41:42.255487 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:41:42.255829 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:41:42.256032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7e5b66ca-86c1-421f-8668-d293d235e227', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055fbb20>]}
[0m10:41:43.273616 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m10:41:43.275210 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.156394, "process_in_blocks": "0", "process_kernel_time": 1.392145, "process_mem_max_rss": "338034688", "process_out_blocks": "0", "process_user_time": 3.652967}
[0m10:41:43.275590 [debug] [MainThread]: Command `dbt run` failed at 10:41:43.275526 after 3.16 seconds
[0m10:41:43.275822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f1b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x168539570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16930d990>]}
[0m10:41:43.276030 [debug] [MainThread]: Flushing usage events
[0m10:41:44.214922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:03.831966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084876a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dc580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dfd60>]}


============================== 10:44:03.835038 | 7f8c2ee4-4e94-447f-b1e0-9d8bd1de55ca ==============================
[0m10:44:03.835038 [info ] [MainThread]: Running with dbt=1.10.7
[0m10:44:03.835377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:44:03.918529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f8c2ee4-4e94-447f-b1e0-9d8bd1de55ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dd9c0>]}
[0m10:44:03.929694 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-0k3kwp0v'
[0m10:44:03.929966 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:44:04.037635 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:44:04.038291 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m10:44:04.382587 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m10:44:04.394047 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:44:04.486659 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:44:04.507577 [info ] [MainThread]: Updating lock file in file path: /Users/rishin/PycharmProjects/automate-dv-demo-5.4/package-lock.yml
[0m10:44:04.550440 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-0drzfb94'
[0m10:44:04.554522 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m10:44:04.974081 [info ] [MainThread]: Installed from version 0.11.2
[0m10:44:04.974522 [info ] [MainThread]: Up to date!
[0m10:44:04.974837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7f8c2ee4-4e94-447f-b1e0-9d8bd1de55ca', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109847190>]}
[0m10:44:04.975192 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:44:05.449827 [info ] [MainThread]: Installed from version 1.3.0
[0m10:44:05.450248 [info ] [MainThread]: Up to date!
[0m10:44:05.450509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7f8c2ee4-4e94-447f-b1e0-9d8bd1de55ca', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d16c0>]}
[0m10:44:05.452308 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.6619674, "process_in_blocks": "0", "process_kernel_time": 0.216322, "process_mem_max_rss": "109920256", "process_out_blocks": "0", "process_user_time": 0.852134}
[0m10:44:05.452674 [debug] [MainThread]: Command `dbt deps` succeeded at 10:44:05.452600 after 1.66 seconds
[0m10:44:05.452921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084876a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dd9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097a7880>]}
[0m10:44:05.453157 [debug] [MainThread]: Flushing usage events
[0m10:44:06.579821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:44:32.063502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079307c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079301f0>]}


============================== 10:44:32.066401 | f4af6494-1c90-4e69-bb87-5c49752c8151 ==============================
[0m10:44:32.066401 [info ] [MainThread]: Running with dbt=1.10.7
[0m10:44:32.066729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select path:models/stage', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:44:33.954420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4af6494-1c90-4e69-bb87-5c49752c8151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106129a20>]}
[0m10:44:33.986111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4af6494-1c90-4e69-bb87-5c49752c8151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a4a90>]}
[0m10:44:33.986487 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m10:44:34.121515 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m10:44:34.176808 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:44:34.177153 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:44:34.177315 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:44:34.177488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f4af6494-1c90-4e69-bb87-5c49752c8151', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fbb20>]}
[0m10:44:35.193988 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m10:44:35.195418 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1719587, "process_in_blocks": "0", "process_kernel_time": 1.13718, "process_mem_max_rss": "337608704", "process_out_blocks": "0", "process_user_time": 3.825295}
[0m10:44:35.195793 [debug] [MainThread]: Command `dbt run` failed at 10:44:35.195733 after 3.17 seconds
[0m10:44:35.196008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cc76a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1629a5b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162d23340>]}
[0m10:44:35.196206 [debug] [MainThread]: Flushing usage events
[0m10:44:36.273800 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:39.666959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11119b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f343a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f34a60>]}


============================== 17:08:39.670041 | 467ee1f4-179d-47a9-bf38-036b2eff4728 ==============================
[0m17:08:39.670041 [info ] [MainThread]: Running with dbt=1.10.7
[0m17:08:39.670372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:08:41.755129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '467ee1f4-179d-47a9-bf38-036b2eff4728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f71d50>]}
[0m17:08:41.798788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '467ee1f4-179d-47a9-bf38-036b2eff4728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e83100>]}
[0m17:08:41.799363 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:08:41.984846 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m17:08:42.043155 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:08:42.043498 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:08:42.043671 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:08:42.043862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '467ee1f4-179d-47a9-bf38-036b2eff4728', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dfbb20>]}
[0m17:08:43.121760 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m17:08:43.152686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5376863, "process_in_blocks": "0", "process_kernel_time": 1.546918, "process_mem_max_rss": "328908800", "process_out_blocks": "0", "process_user_time": 3.664986}
[0m17:08:43.153210 [debug] [MainThread]: Command `dbt run` failed at 17:08:43.153134 after 3.54 seconds
[0m17:08:43.153509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11119b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ce7c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15d8231f0>]}
[0m17:08:43.153844 [debug] [MainThread]: Flushing usage events
[0m17:08:44.160061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:17.249882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10565c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10565d8a0>]}


============================== 17:10:17.253383 | ffeb3e18-51ca-4b86-b400-ecbac17f2b0d ==============================
[0m17:10:17.253383 [info ] [MainThread]: Running with dbt=1.10.7
[0m17:10:17.253733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:10:17.338451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffeb3e18-51ca-4b86-b400-ecbac17f2b0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10565e590>]}
[0m17:10:17.374884 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-378p44l8'
[0m17:10:17.375172 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:10:17.444213 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:10:17.444769 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m17:10:17.742043 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m17:10:17.743933 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:10:17.772070 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:10:17.776377 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m17:10:18.196243 [info ] [MainThread]: Installed from version 0.11.2
[0m17:10:18.196700 [info ] [MainThread]: Up to date!
[0m17:10:18.197050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ffeb3e18-51ca-4b86-b400-ecbac17f2b0d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104837fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105833fa0>]}
[0m17:10:18.197427 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:10:18.646645 [info ] [MainThread]: Installed from version 1.3.0
[0m17:10:18.647025 [info ] [MainThread]: Up to date!
[0m17:10:18.647323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ffeb3e18-51ca-4b86-b400-ecbac17f2b0d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104837fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105833850>]}
[0m17:10:18.649314 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4462969, "process_in_blocks": "0", "process_kernel_time": 0.187258, "process_mem_max_rss": "107200512", "process_out_blocks": "0", "process_user_time": 0.805007}
[0m17:10:18.649721 [debug] [MainThread]: Command `dbt deps` succeeded at 17:10:18.649636 after 1.45 seconds
[0m17:10:18.650007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10565fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10466ebf0>]}
[0m17:10:18.650271 [debug] [MainThread]: Flushing usage events
[0m17:10:19.566863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:36.117531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dcb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f24730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f27d30>]}


============================== 17:10:36.120424 | 7275e8ab-c088-4018-894e-be6fd594a35e ==============================
[0m17:10:36.120424 [info ] [MainThread]: Running with dbt=1.10.7
[0m17:10:36.120774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -m dbt_stg_users', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:10:36.121029 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m17:10:36.121211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7275e8ab-c088-4018-894e-be6fd594a35e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5fd00>]}
[0m17:10:37.914339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7275e8ab-c088-4018-894e-be6fd594a35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10268dd50>]}
[0m17:10:37.945399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7275e8ab-c088-4018-894e-be6fd594a35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f2de10>]}
[0m17:10:37.945788 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:10:38.068405 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m17:10:38.128971 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:10:38.129275 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:10:38.129434 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:10:38.129607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7275e8ab-c088-4018-894e-be6fd594a35e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f2c640>]}
[0m17:10:39.170330 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m17:10:39.170803 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:10:39.172277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.0957656, "process_in_blocks": "0", "process_kernel_time": 1.096579, "process_mem_max_rss": "339460096", "process_out_blocks": "0", "process_user_time": 3.798784}
[0m17:10:39.172638 [debug] [MainThread]: Command `dbt run` failed at 17:10:39.172579 after 3.10 seconds
[0m17:10:39.172852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dcb700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10333e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146c23040>]}
[0m17:10:39.173050 [debug] [MainThread]: Flushing usage events
[0m17:10:40.105535 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:11:41.829021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062bf700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107410730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107410070>]}


============================== 17:11:41.832246 | baa51747-c57d-46e1-99e9-51e176912598 ==============================
[0m17:11:41.832246 [info ] [MainThread]: Running with dbt=1.10.7
[0m17:11:41.832641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:11:44.205484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baa51747-c57d-46e1-99e9-51e176912598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc1d50>]}
[0m17:11:44.240731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baa51747-c57d-46e1-99e9-51e176912598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d61330>]}
[0m17:11:44.241230 [info ] [MainThread]: Registered adapter: bigquery=1.10.1
[0m17:11:44.398228 [debug] [MainThread]: checksum: 44f4b502e2ddc67beed4db71ce39b63f2d3b7fc0b96e49a69b096c8f6cc370bc, vars: {}, profile: , target: , version: 1.10.7
[0m17:11:44.460561 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:11:44.460945 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:11:44.461122 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:11:44.461322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'baa51747-c57d-46e1-99e9-51e176912598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641c640>]}
[0m17:11:45.521594 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m17:11:45.525780 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 3.7389297, "process_in_blocks": "0", "process_kernel_time": 1.211007, "process_mem_max_rss": "317145088", "process_out_blocks": "0", "process_user_time": 3.958983}
[0m17:11:45.526654 [debug] [MainThread]: Command `dbt compile` failed at 17:11:45.526337 after 3.74 seconds
[0m17:11:45.527095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062bf700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16a83aec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16b823160>]}
[0m17:11:45.527494 [debug] [MainThread]: Flushing usage events
[0m17:11:46.457316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:07.820667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122e3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122e2f80>]}


============================== 17:15:07.823747 | a24dc40c-ad93-4f31-8cb0-83874ffedf27 ==============================
[0m17:15:07.823747 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:15:07.824069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:15:08.624510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a24dc40c-ad93-4f31-8cb0-83874ffedf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122e2e90>]}
[0m17:15:08.654471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a24dc40c-ad93-4f31-8cb0-83874ffedf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122e1330>]}
[0m17:15:08.655002 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:15:08.672040 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:15:08.683650 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:15:08.683976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a24dc40c-ad93-4f31-8cb0-83874ffedf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16081f730>]}
[0m17:15:09.950945 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m17:15:09.952897 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.1676438, "process_user_time": 3.424189, "process_kernel_time": 1.312254, "process_mem_max_rss": "196444160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:15:09.953437 [debug] [MainThread]: Command `dbt compile` failed at 17:15:09.953304 after 2.17 seconds
[0m17:15:09.953711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1609a5120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1609a5210>]}
[0m17:15:09.953946 [debug] [MainThread]: Flushing usage events
[0m17:17:24.951202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1ef50>]}


============================== 17:17:24.954384 | aec6dc96-b905-45a3-9a3c-95c28c2639d2 ==============================
[0m17:17:24.954384 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:17:24.954725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:17:25.971969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aec6dc96-b905-45a3-9a3c-95c28c2639d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1ee60>]}
[0m17:17:26.002483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aec6dc96-b905-45a3-9a3c-95c28c2639d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c7b940>]}
[0m17:17:26.003106 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:17:26.027832 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:17:26.040935 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:17:26.041297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aec6dc96-b905-45a3-9a3c-95c28c2639d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d93da20>]}
[0m17:17:27.286027 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m17:17:27.287610 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.3780866, "process_user_time": 3.525806, "process_kernel_time": 1.07648, "process_mem_max_rss": "193118208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:17:27.288070 [debug] [MainThread]: Command `dbt compile` failed at 17:17:27.287990 after 2.38 seconds
[0m17:17:27.288324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14db990c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14db991b0>]}
[0m17:17:27.288563 [debug] [MainThread]: Flushing usage events
[0m17:18:02.040363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10379f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075dffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075def80>]}


============================== 17:18:02.043431 | 4b4e7aa8-b755-4c92-9dfd-85b254f7828a ==============================
[0m17:18:02.043431 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:18:02.043751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:18:02.094222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b4e7aa8-b755-4c92-9dfd-85b254f7828a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107681480>]}
[0m17:18:02.095382 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-0kamqyau'
[0m17:18:02.095662 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:18:02.195595 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:18:02.196298 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m17:18:02.502692 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m17:18:02.509158 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:18:02.586028 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:18:02.602308 [info ] [MainThread]: Updating lock file in file path: /Users/rishin/PycharmProjects/automate-dv-demo-5.4/package-lock.yml
[0m17:18:02.638978 [debug] [MainThread]: Set downloads directory='/var/folders/8l/ntf_rgvx30x04x54cqz4z2x80000gn/T/dbt-downloads-m65_wpvo'
[0m17:18:02.643908 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m17:18:03.052884 [info ] [MainThread]: Installed from version 0.11.0
[0m17:18:03.053442 [info ] [MainThread]: Updated version available: 0.11.2
[0m17:18:03.053889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4b4e7aa8-b755-4c92-9dfd-85b254f7828a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b5f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b6aa0>]}
[0m17:18:03.054269 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:18:03.511181 [info ] [MainThread]: Installed from version 1.3.0
[0m17:18:03.511661 [info ] [MainThread]: Up to date!
[0m17:18:03.512006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4b4e7aa8-b755-4c92-9dfd-85b254f7828a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b76a0>]}
[0m17:18:03.512363 [info ] [MainThread]: 
[0m17:18:03.512729 [info ] [MainThread]: Updates available for packages: ['Datavault-UK/automate_dv']                 
Update your versions in packages.yml, then run dbt deps
[0m17:18:03.515003 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.5085565, "process_user_time": 1.144451, "process_kernel_time": 0.201264, "process_mem_max_rss": "109248512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:18:03.515459 [debug] [MainThread]: Command `dbt deps` succeeded at 17:18:03.515351 after 1.51 seconds
[0m17:18:03.515781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10379f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075dce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076815d0>]}
[0m17:18:03.516100 [debug] [MainThread]: Flushing usage events
[0m17:18:10.610400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10399f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e2f80>]}


============================== 17:18:10.613276 | d39fef04-ff24-4b52-86a7-14fe826f76b9 ==============================
[0m17:18:10.613276 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:18:10.613591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:18:11.409053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd39fef04-ff24-4b52-86a7-14fe826f76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e2e90>]}
[0m17:18:11.438786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd39fef04-ff24-4b52-86a7-14fe826f76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e1330>]}
[0m17:18:11.439308 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:18:11.462198 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:18:11.474192 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:18:11.474534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd39fef04-ff24-4b52-86a7-14fe826f76b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14691c310>]}
[0m17:18:12.640598 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m17:18:12.642031 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.0643606, "process_user_time": 3.418263, "process_kernel_time": 1.199255, "process_mem_max_rss": "201310208", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:18:12.642420 [debug] [MainThread]: Command `dbt compile` failed at 17:18:12.642340 after 2.06 seconds
[0m17:18:12.642657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10399f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146b95150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146b95240>]}
[0m17:18:12.642871 [debug] [MainThread]: Flushing usage events
[0m17:19:25.490853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881ef80>]}


============================== 17:19:25.495440 | aa4f0016-a716-464a-a70c-e826bb693951 ==============================
[0m17:19:25.495440 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:19:25.495799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:19:26.500744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa4f0016-a716-464a-a70c-e826bb693951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881ee90>]}
[0m17:19:26.531972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa4f0016-a716-464a-a70c-e826bb693951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877b880>]}
[0m17:19:26.532557 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:19:26.557122 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:19:26.571880 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:19:26.572239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aa4f0016-a716-464a-a70c-e826bb693951', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa40370>]}
[0m17:19:27.829438 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m17:19:27.831137 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.3769257, "process_user_time": 3.331464, "process_kernel_time": 1.417639, "process_mem_max_rss": "189628416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:19:27.831501 [debug] [MainThread]: Command `dbt compile` failed at 17:19:27.831427 after 2.38 seconds
[0m17:19:27.831720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc850f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fc851e0>]}
[0m17:19:27.831925 [debug] [MainThread]: Flushing usage events
[0m17:22:25.292182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a632e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae2f80>]}


============================== 17:22:25.296033 | 8ac0f153-0875-4092-a786-cbe263de4b20 ==============================
[0m17:22:25.296033 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:22:25.296356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m17:22:26.147221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ac0f153-0875-4092-a786-cbe263de4b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ae2e90>]}
[0m17:22:26.177091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ac0f153-0875-4092-a786-cbe263de4b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a438b0>]}
[0m17:22:26.177638 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:22:26.196920 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:22:26.210364 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:22:26.210772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ac0f153-0875-4092-a786-cbe263de4b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134f41a20>]}
[0m17:22:27.523657 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m17:22:27.525088 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.272935, "process_user_time": 3.606979, "process_kernel_time": 1.12726, "process_mem_max_rss": "196919296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:22:27.525500 [debug] [MainThread]: Command `dbt compile` failed at 17:22:27.525418 after 2.27 seconds
[0m17:22:27.525750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a632e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379990c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1379991b0>]}
[0m17:22:27.525989 [debug] [MainThread]: Flushing usage events
[0m17:22:57.906075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b81f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b81ef80>]}


============================== 17:22:57.923071 | 40cfabec-cfb1-4438-aca2-3813b3377cf6 ==============================
[0m17:22:57.923071 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:22:57.923614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:22:58.843157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40cfabec-cfb1-4438-aca2-3813b3377cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b81ee90>]}
[0m17:22:58.872726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40cfabec-cfb1-4438-aca2-3813b3377cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7c9930>]}
[0m17:22:58.873222 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:22:58.895509 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:22:58.909120 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:22:58.909571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40cfabec-cfb1-4438-aca2-3813b3377cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158e8b9d0>]}
[0m17:23:00.155180 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_stations (models/stage/dbt_stg_stations.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_stations (models/stage/dbt_stg_stations.sql)
[0m17:23:00.156749 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.284598, "process_user_time": 3.334597, "process_kernel_time": 1.349241, "process_mem_max_rss": "194150400", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:23:00.157068 [debug] [MainThread]: Command `dbt compile` failed at 17:23:00.156981 after 2.28 seconds
[0m17:23:00.157314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a000cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a003430>]}
[0m17:23:00.157536 [debug] [MainThread]: Flushing usage events
[0m17:24:00.476678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104debe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e97fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e96f80>]}


============================== 17:24:00.479939 | b2bbe2f1-bad7-4897-b982-a8a50bb8e73a ==============================
[0m17:24:00.479939 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:24:00.480277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:24:01.349725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2bbe2f1-bad7-4897-b982-a8a50bb8e73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e96e90>]}
[0m17:24:01.379296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2bbe2f1-bad7-4897-b982-a8a50bb8e73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e40a00>]}
[0m17:24:01.379800 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:24:01.407744 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:24:01.421039 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:24:01.421412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b2bbe2f1-bad7-4897-b982-a8a50bb8e73a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e21e830>]}
[0m17:24:02.688412 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_users (models/stage/dbt_stg_users.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_users (models/stage/dbt_stg_users.sql)
[0m17:24:02.689904 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.2532697, "process_user_time": 3.414033, "process_kernel_time": 1.296298, "process_mem_max_rss": "199819264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:24:02.690208 [debug] [MainThread]: Command `dbt compile` failed at 17:24:02.690133 after 2.25 seconds
[0m17:24:02.690442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104debe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e81c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e81ee60>]}
[0m17:24:02.690660 [debug] [MainThread]: Flushing usage events
[0m17:24:52.342742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bf32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11381f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11381ef80>]}


============================== 17:24:52.345819 | 41d510e7-c0d3-4b5b-8f25-f63c2e7db9c5 ==============================
[0m17:24:52.345819 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:24:52.346151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:24:53.235767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41d510e7-c0d3-4b5b-8f25-f63c2e7db9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11381ee90>]}
[0m17:24:53.285230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41d510e7-c0d3-4b5b-8f25-f63c2e7db9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137c58d0>]}
[0m17:24:53.285944 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:24:53.305004 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:24:53.316561 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:24:53.316895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '41d510e7-c0d3-4b5b-8f25-f63c2e7db9c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137745de0>]}
[0m17:24:54.617766 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_bikes (models/stage/dbt_stg_bikes.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_bikes (models/stage/dbt_stg_bikes.sql)
[0m17:24:54.619210 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.3114667, "process_user_time": 3.439025, "process_kernel_time": 1.139735, "process_mem_max_rss": "199278592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:24:54.619499 [debug] [MainThread]: Command `dbt compile` failed at 17:24:54.619423 after 2.31 seconds
[0m17:24:54.619718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bf32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a62aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a62a950>]}
[0m17:24:54.619923 [debug] [MainThread]: Flushing usage events
[0m17:25:33.783873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149e3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149e2f80>]}


============================== 17:25:33.786937 | f5e4fccc-5453-4ca4-933f-0fe46ecdeedb ==============================
[0m17:25:33.786937 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:25:33.787305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m17:25:34.642013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5e4fccc-5453-4ca4-933f-0fe46ecdeedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149e2e90>]}
[0m17:25:34.671949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5e4fccc-5453-4ca4-933f-0fe46ecdeedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11498cfa0>]}
[0m17:25:34.672443 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:25:34.692586 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:25:34.706869 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:25:34.707219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5e4fccc-5453-4ca4-933f-0fe46ecdeedb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14871fac0>]}
[0m17:25:36.051078 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.dbt_stg_trips' (models/stage/dbt_stg_trips.sql) depends on a node named 'src_sql_trips' which was not found
[0m17:25:36.053613 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.3041694, "process_user_time": 3.455143, "process_kernel_time": 1.2558, "process_mem_max_rss": "205832192", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:25:36.053909 [debug] [MainThread]: Command `dbt compile` failed at 17:25:36.053827 after 2.30 seconds
[0m17:25:36.054135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f6e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148df4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148c4a620>]}
[0m17:25:36.054332 [debug] [MainThread]: Flushing usage events
[0m17:40:23.411264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ff25c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506af80>]}


============================== 17:40:23.420917 | d96c359d-6944-4060-9e02-d62ca60ecb21 ==============================
[0m17:40:23.420917 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:40:23.421577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:40:24.824485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd96c359d-6944-4060-9e02-d62ca60ecb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10506ae90>]}
[0m17:40:24.857821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd96c359d-6944-4060-9e02-d62ca60ecb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105010b50>]}
[0m17:40:24.858441 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m17:40:24.884926 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:40:24.907792 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:40:24.908161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd96c359d-6944-4060-9e02-d62ca60ecb21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13858fb80>]}
[0m17:40:26.916672 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.dbt_stg_trips' (models/stage/dbt_stg_trips.sql) depends on a node named 'src_sql_trips' which was not found
[0m17:40:26.918834 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6431909, "process_user_time": 4.255829, "process_kernel_time": 0.59297, "process_mem_max_rss": "190087168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:40:26.919153 [debug] [MainThread]: Command `dbt run` failed at 17:40:26.919072 after 3.64 seconds
[0m17:40:26.919436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ff25c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138568160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c6075e0>]}
[0m17:40:26.919715 [debug] [MainThread]: Flushing usage events
[0m18:07:01.858052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae9d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbe3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbe2f80>]}


============================== 18:07:01.861081 | f5c8a484-786c-4608-8af9-9464dda2b8f0 ==============================
[0m18:07:01.861081 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:07:01.861406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m18:07:02.966137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5c8a484-786c-4608-8af9-9464dda2b8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbe2e90>]}
[0m18:07:02.998346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5c8a484-786c-4608-8af9-9464dda2b8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dbe1330>]}
[0m18:07:02.998978 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m18:07:03.026486 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m18:07:03.038502 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:07:03.038827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5c8a484-786c-4608-8af9-9464dda2b8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149f1d780>]}
[0m18:07:04.482468 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.dbt_stg_trips' (models/stage/dbt_stg_trips.sql) depends on a node named 'source('citibike_source_sql', 'src_sql_trips')' which was not found
[0m18:07:04.484302 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.6941278, "process_user_time": 3.580028, "process_kernel_time": 1.281431, "process_mem_max_rss": "196919296", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:07:04.484588 [debug] [MainThread]: Command `dbt compile` failed at 18:07:04.484513 after 2.69 seconds
[0m18:07:04.484821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ae9d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149f5ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b0f9210>]}
[0m18:07:04.485043 [debug] [MainThread]: Flushing usage events
[0m18:07:34.468130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079af370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079aef80>]}


============================== 18:07:34.471327 | c56a9635-2cdb-4930-a8a7-0df56f7e0ac9 ==============================
[0m18:07:34.471327 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:07:34.471679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:07:35.297680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c56a9635-2cdb-4930-a8a7-0df56f7e0ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079aee90>]}
[0m18:07:35.329596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c56a9635-2cdb-4930-a8a7-0df56f7e0ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107954ac0>]}
[0m18:07:35.330155 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m18:07:35.350323 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m18:07:35.364571 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:07:35.364920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c56a9635-2cdb-4930-a8a7-0df56f7e0ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132740490>]}
[0m18:07:36.736339 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.dbt_stg_trips' (models/stage/dbt_stg_trips.sql) depends on a node named '`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`' which was not found
[0m18:07:36.738123 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.31071, "process_user_time": 3.835117, "process_kernel_time": 0.966529, "process_mem_max_rss": "198787072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:07:36.738443 [debug] [MainThread]: Command `dbt compile` failed at 18:07:36.738365 after 2.31 seconds
[0m18:07:36.738680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363cd600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363ce050>]}
[0m18:07:36.738904 [debug] [MainThread]: Flushing usage events
[0m18:11:34.705425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10569f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12251f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12251ef80>]}


============================== 18:11:34.708365 | 03dfd533-39b8-49d3-880c-8dd9eead2c35 ==============================
[0m18:11:34.708365 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:11:34.708698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:11:35.590860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03dfd533-39b8-49d3-880c-8dd9eead2c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12251ee90>]}
[0m18:11:35.621997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03dfd533-39b8-49d3-880c-8dd9eead2c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1224c8fa0>]}
[0m18:11:35.622639 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m18:11:35.643254 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m18:11:35.655384 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:11:35.655789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '03dfd533-39b8-49d3-880c-8dd9eead2c35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1528545e0>]}
[0m18:11:36.868393 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m18:11:36.869987 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.2013876, "process_user_time": 3.401097, "process_kernel_time": 1.240105, "process_mem_max_rss": "199639040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:11:36.870381 [debug] [MainThread]: Command `dbt compile` failed at 18:11:36.870297 after 2.20 seconds
[0m18:11:36.870605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10569f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152a94cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152a94f10>]}
[0m18:11:36.870815 [debug] [MainThread]: Flushing usage events
[0m18:19:20.633507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e57370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e56f80>]}


============================== 18:19:20.636522 | d3bad9d2-244a-477c-ba33-8edff00b4f31 ==============================
[0m18:19:20.636522 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:19:20.636832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:19:21.482857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3bad9d2-244a-477c-ba33-8edff00b4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e56e90>]}
[0m18:19:21.526617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3bad9d2-244a-477c-ba33-8edff00b4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e00bb0>]}
[0m18:19:21.527268 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m18:19:21.549013 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m18:19:21.561374 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:19:21.561848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd3bad9d2-244a-477c-ba33-8edff00b4f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127a8bb80>]}
[0m18:19:22.802081 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
  The object ("`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`") was used as a dictionary. This capability has been removed from objects of this type.
  
  > in macro default__stage (macros/staging/stage.sql)
  > called by macro stage (macros/staging/stage.sql)
  > called by model dbt_stg_trips (models/stage/dbt_stg_trips.sql)
[0m18:19:22.803455 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_wall_clock_time": 2.2072883, "process_user_time": 3.478113, "process_kernel_time": 1.119044, "process_mem_max_rss": "203833344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:19:22.803809 [debug] [MainThread]: Command `dbt compile` failed at 18:19:22.803739 after 2.21 seconds
[0m18:19:22.804027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd5360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b94f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127b95150>]}
[0m18:19:22.804230 [debug] [MainThread]: Flushing usage events
[0m18:22:06.611042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793af80>]}


============================== 18:22:06.614163 | b7081ef5-9358-4dcc-befc-ee358679bd55 ==============================
[0m18:22:06.614163 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:22:06.614506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m18:22:07.537865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7081ef5-9358-4dcc-befc-ee358679bd55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10793ae90>]}
[0m18:22:07.570026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7081ef5-9358-4dcc-befc-ee358679bd55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e6260>]}
[0m18:22:07.570587 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m18:22:07.591411 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m18:22:07.605115 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m18:22:07.605440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b7081ef5-9358-4dcc-befc-ee358679bd55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bb2dea0>]}
[0m18:22:09.020846 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stage
- models.business_vault
- models.raw_vault
[0m18:22:09.024135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7081ef5-9358-4dcc-befc-ee358679bd55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c4e4fa0>]}
[0m18:22:09.037682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7081ef5-9358-4dcc-befc-ee358679bd55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bc689d0>]}
[0m18:22:09.038069 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m18:22:09.038280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7081ef5-9358-4dcc-befc-ee358679bd55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c26e200>]}
[0m18:22:09.039436 [info ] [MainThread]: 
[0m18:22:09.039923 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:22:09.041163 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3_citibike_source_sql'
[0m18:22:09.041394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:09.595364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7081ef5-9358-4dcc-befc-ee358679bd55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12c4e5ab0>]}
[0m18:22:09.596988 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:22:09.597885 [info ] [MainThread]: 
[0m18:22:09.601332 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_bikes
[0m18:22:09.602830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.raw_sql_bikes)
[0m18:22:09.603476 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_bikes
[0m18:22:09.619052 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_bikes"
[0m18:22:09.620512 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (compile): 18:22:09.604163 => 18:22:09.620202
[0m18:22:09.620971 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_bikes
[0m18:22:09.621449 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (execute): 18:22:09.621218 => 18:22:09.621232
[0m18:22:09.622444 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_bikes
[0m18:22:09.622915 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_stations
[0m18:22:09.623763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_bikes, now model.dbt_bq_sa.raw_sql_stations)
[0m18:22:09.624150 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_stations
[0m18:22:09.628573 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_stations"
[0m18:22:09.629337 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (compile): 18:22:09.624393 => 18:22:09.629102
[0m18:22:09.629745 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_stations
[0m18:22:09.630202 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (execute): 18:22:09.629975 => 18:22:09.629986
[0m18:22:09.631073 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_stations
[0m18:22:09.631463 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_trips
[0m18:22:09.632235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_stations, now model.dbt_bq_sa.raw_sql_trips)
[0m18:22:09.632644 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_trips
[0m18:22:09.636627 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_trips"
[0m18:22:09.637385 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (compile): 18:22:09.632876 => 18:22:09.637169
[0m18:22:09.637737 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_trips
[0m18:22:09.638128 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (execute): 18:22:09.637939 => 18:22:09.637946
[0m18:22:09.638960 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_trips
[0m18:22:09.639338 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_users
[0m18:22:09.640026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_trips, now model.dbt_bq_sa.raw_sql_users)
[0m18:22:09.640480 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_users
[0m18:22:09.643759 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_users"
[0m18:22:09.644382 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (compile): 18:22:09.640682 => 18:22:09.644193
[0m18:22:09.644693 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_users
[0m18:22:09.645034 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (execute): 18:22:09.644873 => 18:22:09.644880
[0m18:22:09.645745 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_users
[0m18:22:09.646073 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m18:22:09.646660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_users, now model.dbt_bq_sa.dbt_stg_bikes)
[0m18:22:09.646947 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m18:22:09.651924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:10.185356 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/leafy-mountain-469410-k3/datasets/citibike_source_sql/tables/raw_sql_bikes?prettyPrint=false: Not found: Table leafy-mountain-469410-k3:citibike_source_sql.raw_sql_bikes
[0m18:22:10.333206 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/leafy-mountain-469410-k3/datasets/citibike_source_sql/tables/raw_sql_bikes?prettyPrint=false: Not found: Table leafy-mountain-469410-k3:citibike_source_sql.raw_sql_bikes
[0m18:22:10.346799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m18:22:10.347931 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 18:22:09.647174 => 18:22:10.347633
[0m18:22:10.348413 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m18:22:10.348945 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 18:22:10.348695 => 18:22:10.348708
[0m18:22:10.350056 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m18:22:10.350565 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m18:22:10.351531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m18:22:10.352096 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m18:22:10.360912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:10.957812 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/leafy-mountain-469410-k3/datasets/citibike_source_sql/tables/raw_sql_stations?prettyPrint=false: Not found: Table leafy-mountain-469410-k3:citibike_source_sql.raw_sql_stations
[0m18:22:11.085514 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/leafy-mountain-469410-k3/datasets/citibike_source_sql/tables/raw_sql_stations?prettyPrint=false: Not found: Table leafy-mountain-469410-k3:citibike_source_sql.raw_sql_stations
[0m18:22:11.111438 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m18:22:11.112885 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 18:22:10.352397 => 18:22:11.112480
[0m18:22:11.113473 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m18:22:11.114055 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 18:22:11.113778 => 18:22:11.113797
[0m18:22:11.115220 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m18:22:11.115754 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m18:22:11.116674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m18:22:11.117094 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m18:22:11.126582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:11.614368 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/leafy-mountain-469410-k3/datasets/citibike_source_sql/tables/raw_sql_trips?prettyPrint=false: Not found: Table leafy-mountain-469410-k3:citibike_source_sql.raw_sql_trips
[0m18:22:11.723357 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/leafy-mountain-469410-k3/datasets/citibike_source_sql/tables/raw_sql_trips?prettyPrint=false: Not found: Table leafy-mountain-469410-k3:citibike_source_sql.raw_sql_trips
[0m18:22:11.748550 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m18:22:11.749435 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 18:22:11.117331 => 18:22:11.749214
[0m18:22:11.749771 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m18:22:11.750127 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 18:22:11.749961 => 18:22:11.749970
[0m18:22:11.750890 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m18:22:11.751229 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m18:22:11.751823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m18:22:11.752185 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m18:22:11.757889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:12.286392 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/leafy-mountain-469410-k3/datasets/citibike_source_sql/tables/raw_sql_users?prettyPrint=false: Not found: Table leafy-mountain-469410-k3:citibike_source_sql.raw_sql_users
[0m18:22:12.403018 [debug] [Thread-1 (]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/leafy-mountain-469410-k3/datasets/citibike_source_sql/tables/raw_sql_users?prettyPrint=false: Not found: Table leafy-mountain-469410-k3:citibike_source_sql.raw_sql_users
[0m18:22:12.417157 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m18:22:12.417941 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 18:22:11.752386 => 18:22:12.417759
[0m18:22:12.418234 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m18:22:12.418551 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 18:22:12.418401 => 18:22:12.418409
[0m18:22:12.419209 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m18:22:12.420134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:12.420409 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_stg_users' was properly closed.
[0m18:22:12.421476 [debug] [MainThread]: Command end result
[0m18:22:12.439945 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 5.8670154, "process_user_time": 4.053879, "process_kernel_time": 1.386852, "process_mem_max_rss": "206831616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:22:12.440398 [debug] [MainThread]: Command `dbt compile` succeeded at 18:22:12.440305 after 5.87 seconds
[0m18:22:12.440761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bbf1420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bb467d0>]}
[0m18:22:12.441066 [debug] [MainThread]: Flushing usage events
[0m18:22:19.975977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103169360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c7370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c6f80>]}


============================== 18:22:19.979083 | 0ab6a340-7a04-4cc5-9029-d6fe3cc6a028 ==============================
[0m18:22:19.979083 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:22:19.979439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:22:20.644225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c6e90>]}
[0m18:22:20.673476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f645510>]}
[0m18:22:20.673961 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m18:22:20.693898 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m18:22:20.799375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:22:20.799659 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:22:20.800127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stage
- models.raw_vault
- models.business_vault
[0m18:22:20.803836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208240d0>]}
[0m18:22:20.817122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205a1a50>]}
[0m18:22:20.817485 [info ] [MainThread]: Found 8 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m18:22:20.817702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205a17e0>]}
[0m18:22:20.818997 [info ] [MainThread]: 
[0m18:22:20.819541 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:22:20.820491 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m18:22:20.820819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:21.598295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m18:22:21.601295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:22:22.429198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205a1bd0>]}
[0m18:22:22.431153 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:22:22.431600 [info ] [MainThread]: 
[0m18:22:22.443684 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_bikes
[0m18:22:22.444420 [info ] [Thread-1 (]: 1 of 8 START sql view model citibike_source_sql.raw_sql_bikes .................. [RUN]
[0m18:22:22.446574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.raw_sql_bikes)
[0m18:22:22.447186 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_bikes
[0m18:22:22.464879 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_bikes"
[0m18:22:22.465711 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (compile): 18:22:22.447385 => 18:22:22.465511
[0m18:22:22.466086 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_bikes
[0m18:22:22.486995 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_bikes"
[0m18:22:22.487721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:22.488710 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_bikes`;


[0m18:22:24.896605 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e711b099-32e9-437b-a710-6232d9659c61&page=queryresults
[0m18:22:25.538463 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (execute): 18:22:22.466246 => 18:22:25.538152
[0m18:22:25.539690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205a2560>]}
[0m18:22:25.540675 [info ] [Thread-1 (]: 1 of 8 OK created sql view model citibike_source_sql.raw_sql_bikes ............. [[32mCREATE VIEW (0 processed)[0m in 3.09s]
[0m18:22:25.541442 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_bikes
[0m18:22:25.541974 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_stations
[0m18:22:25.542775 [info ] [Thread-1 (]: 2 of 8 START sql view model citibike_source_sql.raw_sql_stations ............... [RUN]
[0m18:22:25.544049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_bikes, now model.dbt_bq_sa.raw_sql_stations)
[0m18:22:25.544711 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_stations
[0m18:22:25.551844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_stations"
[0m18:22:25.553413 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (compile): 18:22:25.545052 => 18:22:25.552993
[0m18:22:25.554620 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_stations
[0m18:22:25.561287 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_stations"
[0m18:22:25.562069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:25.563788 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_stations`;


[0m18:22:27.866059 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:337a8fcc-28d2-464d-9025-359c897cb756&page=queryresults
[0m18:22:28.129810 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (execute): 18:22:25.555144 => 18:22:28.129267
[0m18:22:28.130965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205a1bd0>]}
[0m18:22:28.131585 [info ] [Thread-1 (]: 2 of 8 OK created sql view model citibike_source_sql.raw_sql_stations .......... [[32mCREATE VIEW (0 processed)[0m in 2.59s]
[0m18:22:28.132125 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_stations
[0m18:22:28.132521 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_trips
[0m18:22:28.132843 [info ] [Thread-1 (]: 3 of 8 START sql view model citibike_source_sql.raw_sql_trips .................. [RUN]
[0m18:22:28.133800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_stations, now model.dbt_bq_sa.raw_sql_trips)
[0m18:22:28.134062 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_trips
[0m18:22:28.139132 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_trips"
[0m18:22:28.139818 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (compile): 18:22:28.134207 => 18:22:28.139662
[0m18:22:28.140191 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_trips
[0m18:22:28.143337 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_trips"
[0m18:22:28.143915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:28.145207 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_trips`;


[0m18:22:30.393813 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5b551695-09dd-427e-b631-9c3eed6c4701&page=queryresults
[0m18:22:30.953652 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (execute): 18:22:28.140348 => 18:22:30.953141
[0m18:22:30.954826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208f4cd0>]}
[0m18:22:30.955683 [info ] [Thread-1 (]: 3 of 8 OK created sql view model citibike_source_sql.raw_sql_trips ............. [[32mCREATE VIEW (0 processed)[0m in 2.82s]
[0m18:22:30.956386 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_trips
[0m18:22:30.956918 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_users
[0m18:22:30.957929 [info ] [Thread-1 (]: 4 of 8 START sql view model citibike_source_sql.raw_sql_users .................. [RUN]
[0m18:22:30.958891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_trips, now model.dbt_bq_sa.raw_sql_users)
[0m18:22:30.959332 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_users
[0m18:22:30.968814 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_users"
[0m18:22:30.971258 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (compile): 18:22:30.959601 => 18:22:30.970856
[0m18:22:30.971834 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_users
[0m18:22:30.979599 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_users"
[0m18:22:30.980674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:30.982988 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_users`;


[0m18:22:33.296735 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2d3898da-e2ce-4919-83ba-404c98de4a7a&page=queryresults
[0m18:22:33.823166 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (execute): 18:22:30.972185 => 18:22:33.822725
[0m18:22:33.825128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208a1cf0>]}
[0m18:22:33.826080 [info ] [Thread-1 (]: 4 of 8 OK created sql view model citibike_source_sql.raw_sql_users ............. [[32mCREATE VIEW (0 processed)[0m in 2.87s]
[0m18:22:33.826712 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_users
[0m18:22:33.827162 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m18:22:33.827849 [info ] [Thread-1 (]: 5 of 8 START sql view model citibike_source_sql.stg_sql_bikes .................. [RUN]
[0m18:22:33.828876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_users, now model.dbt_bq_sa.dbt_stg_bikes)
[0m18:22:33.829284 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m18:22:33.861868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:34.634040 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m18:22:34.634655 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 18:22:33.829512 => 18:22:34.634521
[0m18:22:34.634875 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m18:22:34.637386 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m18:22:34.638018 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_bikes`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    bike_type

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
),

derived_columns AS (

    SELECT

    bike_id,
    bike_type,
    'SRC_SQL_BIKES' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    BIKE_PK,
    BIKE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m18:22:36.968077 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c11fe36b-bbe1-4bc3-84f9-5a7a584d60d6&page=queryresults
[0m18:22:37.238183 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 18:22:34.634990 => 18:22:37.237766
[0m18:22:37.239689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120226290>]}
[0m18:22:37.240659 [info ] [Thread-1 (]: 5 of 8 OK created sql view model citibike_source_sql.stg_sql_bikes ............. [[32mCREATE VIEW (0 processed)[0m in 3.41s]
[0m18:22:37.241587 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m18:22:37.242256 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m18:22:37.243066 [info ] [Thread-1 (]: 6 of 8 START sql view model citibike_source_sql.stg_sql_stations ............... [RUN]
[0m18:22:37.244319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m18:22:37.244942 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m18:22:37.261485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:38.064283 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m18:22:38.065495 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 18:22:37.245296 => 18:22:38.065182
[0m18:22:38.066184 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m18:22:38.070482 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_stations"
[0m18:22:38.071259 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_stations`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
),

derived_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    'SRC_SQL_STATIONS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')
    )))) AS STRING) AS STATION_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    STATION_PK,
    STATION_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m18:22:40.160753 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d7b32f01-8be7-4bf0-b567-07818fa5454c&page=queryresults
[0m18:22:40.568812 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 18:22:38.066454 => 18:22:40.567968
[0m18:22:40.571813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207fcdc0>]}
[0m18:22:40.574828 [info ] [Thread-1 (]: 6 of 8 OK created sql view model citibike_source_sql.stg_sql_stations .......... [[32mCREATE VIEW (0 processed)[0m in 3.33s]
[0m18:22:40.576187 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m18:22:40.577161 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m18:22:40.578283 [info ] [Thread-1 (]: 7 of 8 START sql view model citibike_source_sql.stg_sql_trips .................. [RUN]
[0m18:22:40.579238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m18:22:40.579746 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m18:22:40.599621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:41.469086 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m18:22:41.469930 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 18:22:40.580041 => 18:22:41.469756
[0m18:22:41.470232 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m18:22:41.474407 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m18:22:41.475812 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m18:22:43.727713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:409073bb-f7da-4fe6-9b1c-750542b99333&page=queryresults
[0m18:22:44.365314 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 18:22:41.470402 => 18:22:44.364824
[0m18:22:44.379525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12090f0a0>]}
[0m18:22:44.396815 [info ] [Thread-1 (]: 7 of 8 OK created sql view model citibike_source_sql.stg_sql_trips ............. [[32mCREATE VIEW (0 processed)[0m in 3.80s]
[0m18:22:44.415388 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m18:22:44.415849 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m18:22:44.416351 [info ] [Thread-1 (]: 8 of 8 START sql view model citibike_source_sql.stg_sql_users .................. [RUN]
[0m18:22:44.417065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m18:22:44.417378 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m18:22:44.423899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:22:45.114916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m18:22:45.116452 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 18:22:44.417658 => 18:22:45.116093
[0m18:22:45.117026 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m18:22:45.124478 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_users"
[0m18:22:45.125389 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
),

derived_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    'SRC_SQL_USERS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    USER_PK,
    USER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m18:22:45.849694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:ce053011-ffab-49f9-9947-d0292749057a&page=queryresults
[0m18:22:46.289146 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 18:22:45.117327 => 18:22:46.288791
[0m18:22:46.290793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ab6a340-7a04-4cc5-9029-d6fe3cc6a028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1208a6fe0>]}
[0m18:22:46.291661 [info ] [Thread-1 (]: 8 of 8 OK created sql view model citibike_source_sql.stg_sql_users ............. [[32mCREATE VIEW (0 processed)[0m in 1.87s]
[0m18:22:46.292332 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m18:22:46.294161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:46.294495 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_stg_users' was properly closed.
[0m18:22:46.294814 [info ] [MainThread]: 
[0m18:22:46.295152 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 25.48 seconds (25.48s).
[0m18:22:46.296469 [debug] [MainThread]: Command end result
[0m18:22:46.316119 [info ] [MainThread]: 
[0m18:22:46.316580 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:22:46.316871 [info ] [MainThread]: 
[0m18:22:46.317237 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:22:46.319607 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.3851, "process_user_time": 3.428613, "process_kernel_time": 1.227347, "process_mem_max_rss": "195248128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:22:46.320145 [debug] [MainThread]: Command `dbt run` succeeded at 18:22:46.320033 after 26.39 seconds
[0m18:22:46.320587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103169360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207fd1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1207fd630>]}
[0m18:22:46.320928 [debug] [MainThread]: Flushing usage events
[0m18:42:17.605152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11261b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11261af80>]}


============================== 18:42:17.608122 | c514155a-515e-48cf-b755-d33976c2a27b ==============================
[0m18:42:17.608122 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:42:17.608441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:42:18.518094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c514155a-515e-48cf-b755-d33976c2a27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11261ae90>]}
[0m18:42:18.550265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c514155a-515e-48cf-b755-d33976c2a27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112619330>]}
[0m18:42:18.550920 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m18:42:18.571580 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m18:42:18.692738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m18:42:18.693221 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_trips.sql
[0m18:42:18.693436 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_users.sql
[0m18:42:18.693622 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_bikes.sql
[0m18:42:18.693855 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_stations.sql
[0m18:42:18.772209 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_sql_trips (models/raw_vault/hubs/hub_sql_trips.sql)
  macro 'dbt_macro__hub' takes no keyword argument 'src'
[0m18:42:18.774184 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2080411, "process_user_time": 2.425009, "process_kernel_time": 1.096915, "process_mem_max_rss": "192331776", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:42:18.774968 [debug] [MainThread]: Command `dbt run` failed at 18:42:18.774857 after 1.21 seconds
[0m18:42:18.775259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137da7cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148828340>]}
[0m18:42:18.775599 [debug] [MainThread]: Flushing usage events
[0m18:47:59.704374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037432e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ef370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057eef80>]}


============================== 18:47:59.707304 | 08cd6975-2eec-41c1-bda6-b64ed5aa1eb5 ==============================
[0m18:47:59.707304 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:47:59.707633 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:48:00.688794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057eee90>]}
[0m18:48:00.718920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fa6d510>]}
[0m18:48:00.719495 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m18:48:00.747550 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m18:48:00.805348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m18:48:00.805799 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_users.sql
[0m18:48:00.806004 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_bikes.sql
[0m18:48:00.806191 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_stations.sql
[0m18:48:00.806369 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_trips.sql
[0m18:48:00.941174 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.raw_vault
- models.stage
- models.business_vault
[0m18:48:00.944767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120cd80a0>]}
[0m18:48:01.008146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d08a00>]}
[0m18:48:01.008471 [info ] [MainThread]: Found 12 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m18:48:01.008673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d09480>]}
[0m18:48:01.009814 [info ] [MainThread]: 
[0m18:48:01.010309 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:48:01.011188 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m18:48:01.011403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:03.305853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m18:48:03.306895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:04.274638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d09870>]}
[0m18:48:04.276223 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:48:04.276736 [info ] [MainThread]: 
[0m18:48:04.280038 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_bikes
[0m18:48:04.281036 [info ] [Thread-1 (]: 1 of 12 START sql view model citibike_source_sql.raw_sql_bikes ................. [RUN]
[0m18:48:04.282183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.raw_sql_bikes)
[0m18:48:04.282695 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_bikes
[0m18:48:04.300293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_bikes"
[0m18:48:04.301936 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (compile): 18:48:04.284224 => 18:48:04.301502
[0m18:48:04.302631 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_bikes
[0m18:48:04.333846 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_bikes"
[0m18:48:04.335116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:04.336378 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_bikes`;


[0m18:48:05.322442 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:07ec0912-5882-446d-bb07-50bbdd4c9017&page=queryresults
[0m18:48:06.011575 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (execute): 18:48:04.302982 => 18:48:06.011272
[0m18:48:06.012743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120da43a0>]}
[0m18:48:06.013676 [info ] [Thread-1 (]: 1 of 12 OK created sql view model citibike_source_sql.raw_sql_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m18:48:06.015020 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_bikes
[0m18:48:06.015647 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_stations
[0m18:48:06.018061 [info ] [Thread-1 (]: 2 of 12 START sql view model citibike_source_sql.raw_sql_stations .............. [RUN]
[0m18:48:06.019131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_bikes, now model.dbt_bq_sa.raw_sql_stations)
[0m18:48:06.019864 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_stations
[0m18:48:06.030101 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_stations"
[0m18:48:06.031739 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (compile): 18:48:06.020359 => 18:48:06.031390
[0m18:48:06.032168 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_stations
[0m18:48:06.037887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_stations"
[0m18:48:06.039132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:06.041066 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_stations`;


[0m18:48:07.458821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:498f4dbf-4a7c-4037-90cb-5e03af638b33&page=queryresults
[0m18:48:08.064302 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (execute): 18:48:06.032525 => 18:48:08.063914
[0m18:48:08.065798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c26260>]}
[0m18:48:08.066770 [info ] [Thread-1 (]: 2 of 12 OK created sql view model citibike_source_sql.raw_sql_stations ......... [[32mCREATE VIEW (0 processed)[0m in 2.05s]
[0m18:48:08.067601 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_stations
[0m18:48:08.068131 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_trips
[0m18:48:08.068884 [info ] [Thread-1 (]: 3 of 12 START sql view model citibike_source_sql.raw_sql_trips ................. [RUN]
[0m18:48:08.069756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_stations, now model.dbt_bq_sa.raw_sql_trips)
[0m18:48:08.070202 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_trips
[0m18:48:08.079483 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_trips"
[0m18:48:08.081331 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (compile): 18:48:08.070468 => 18:48:08.080496
[0m18:48:08.081803 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_trips
[0m18:48:08.086372 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_trips"
[0m18:48:08.087077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:08.088639 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_trips`;


[0m18:48:09.895021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4ca09000-622d-4310-87fc-a0924ff3c93f&page=queryresults
[0m18:48:10.740745 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (execute): 18:48:08.082050 => 18:48:10.740487
[0m18:48:10.742053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c149a0>]}
[0m18:48:10.742860 [info ] [Thread-1 (]: 3 of 12 OK created sql view model citibike_source_sql.raw_sql_trips ............ [[32mCREATE VIEW (0 processed)[0m in 2.67s]
[0m18:48:10.743421 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_trips
[0m18:48:10.743846 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_users
[0m18:48:10.744418 [info ] [Thread-1 (]: 4 of 12 START sql view model citibike_source_sql.raw_sql_users ................. [RUN]
[0m18:48:10.745331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_trips, now model.dbt_bq_sa.raw_sql_users)
[0m18:48:10.745609 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_users
[0m18:48:10.758729 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_users"
[0m18:48:10.760268 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (compile): 18:48:10.745770 => 18:48:10.760017
[0m18:48:10.760557 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_users
[0m18:48:10.764868 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_users"
[0m18:48:10.765495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:10.771104 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_users`;


[0m18:48:12.204057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:cf725e52-2143-4d6f-a92e-88ec6c0a26d5&page=queryresults
[0m18:48:12.790227 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (execute): 18:48:10.760823 => 18:48:12.789915
[0m18:48:12.791440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c24ac0>]}
[0m18:48:12.792255 [info ] [Thread-1 (]: 4 of 12 OK created sql view model citibike_source_sql.raw_sql_users ............ [[32mCREATE VIEW (0 processed)[0m in 2.05s]
[0m18:48:12.793388 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_users
[0m18:48:12.794255 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m18:48:12.797805 [info ] [Thread-1 (]: 5 of 12 START sql view model citibike_source_sql.stg_sql_bikes ................. [RUN]
[0m18:48:12.800897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_users, now model.dbt_bq_sa.dbt_stg_bikes)
[0m18:48:12.801285 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m18:48:12.833179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:14.497762 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m18:48:14.498592 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 18:48:12.801698 => 18:48:14.498410
[0m18:48:14.498899 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m18:48:14.502773 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m18:48:14.503504 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_bikes`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    bike_type

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
),

derived_columns AS (

    SELECT

    bike_id,
    bike_type,
    'SRC_SQL_BIKES' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    BIKE_PK,
    BIKE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m18:48:16.851605 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e294507d-573c-44dc-8eb8-3b7e83a286d8&page=queryresults
[0m18:48:17.333066 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 18:48:14.499069 => 18:48:17.329716
[0m18:48:17.334438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a97340>]}
[0m18:48:17.335185 [info ] [Thread-1 (]: 5 of 12 OK created sql view model citibike_source_sql.stg_sql_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 4.54s]
[0m18:48:17.335613 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m18:48:17.335936 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m18:48:17.336515 [info ] [Thread-1 (]: 6 of 12 START sql view model citibike_source_sql.stg_sql_stations .............. [RUN]
[0m18:48:17.337126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m18:48:17.337374 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m18:48:17.347224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:18.766259 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m18:48:18.767191 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 18:48:17.337533 => 18:48:18.767010
[0m18:48:18.767471 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m18:48:18.771142 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_stations"
[0m18:48:18.771752 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_stations`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
),

derived_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    'SRC_SQL_STATIONS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')
    )))) AS STRING) AS STATION_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    STATION_PK,
    STATION_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m18:48:19.463207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:aed9379a-c2c5-48bc-b1e5-2cf93186cdc4&page=queryresults
[0m18:48:20.061615 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 18:48:18.767620 => 18:48:20.061190
[0m18:48:20.063631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a82e90>]}
[0m18:48:20.064735 [info ] [Thread-1 (]: 6 of 12 OK created sql view model citibike_source_sql.stg_sql_stations ......... [[32mCREATE VIEW (0 processed)[0m in 2.73s]
[0m18:48:20.066036 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m18:48:20.066651 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m18:48:20.067559 [info ] [Thread-1 (]: 7 of 12 START sql view model citibike_source_sql.stg_sql_trips ................. [RUN]
[0m18:48:20.068638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m18:48:20.069137 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m18:48:20.078874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:21.985444 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m18:48:21.986200 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 18:48:20.069426 => 18:48:21.986019
[0m18:48:21.986490 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m18:48:21.990360 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m18:48:21.991052 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m18:48:22.665694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:53b988b0-f3fa-453a-8b13-d75a80f8c997&page=queryresults
[0m18:48:23.116021 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 18:48:21.986657 => 18:48:23.115305
[0m18:48:23.118307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b15a20>]}
[0m18:48:23.119963 [info ] [Thread-1 (]: 7 of 12 OK created sql view model citibike_source_sql.stg_sql_trips ............ [[32mCREATE VIEW (0 processed)[0m in 3.05s]
[0m18:48:23.120957 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m18:48:23.121617 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m18:48:23.123129 [info ] [Thread-1 (]: 8 of 12 START sql view model citibike_source_sql.stg_sql_users ................. [RUN]
[0m18:48:23.124161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m18:48:23.124633 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m18:48:23.138402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:24.241667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m18:48:24.242607 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 18:48:23.124919 => 18:48:24.242404
[0m18:48:24.243030 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m18:48:24.248044 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_users"
[0m18:48:24.249006 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
),

derived_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    'SRC_SQL_USERS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    USER_PK,
    USER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m18:48:25.251701 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:cde5507a-3850-4807-ae1c-0470ca20e274&page=queryresults
[0m18:48:25.723573 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 18:48:24.243258 => 18:48:25.723141
[0m18:48:25.725677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b77fa0>]}
[0m18:48:25.726852 [info ] [Thread-1 (]: 8 of 12 OK created sql view model citibike_source_sql.stg_sql_users ............ [[32mCREATE VIEW (0 processed)[0m in 2.60s]
[0m18:48:25.727817 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m18:48:25.728526 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_bikes
[0m18:48:25.729479 [info ] [Thread-1 (]: 9 of 12 START sql incremental model citibike_source_sql.hub_sql_bikes .......... [RUN]
[0m18:48:25.730878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_users, now model.dbt_bq_sa.hub_sql_bikes)
[0m18:48:25.731521 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_bikes
[0m18:48:25.751023 [info ] [Thread-1 (]: 18:48:25 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_bikes from 1 source(s)
[0m18:48:25.755179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_bikes"
[0m18:48:25.756332 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_bikes (compile): 18:48:25.731980 => 18:48:25.756046
[0m18:48:25.756787 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_bikes
[0m18:48:25.800407 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_bikes"
[0m18:48:25.800989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:25.801975 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m18:48:27.266808 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f6453e47-6ec2-4228-a8ae-0c0c60895527&page=queryresults
[0m18:48:29.327578 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_bikes (execute): 18:48:25.757039 => 18:48:29.327058
[0m18:48:29.329581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a82e90>]}
[0m18:48:29.330648 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model citibike_source_sql.hub_sql_bikes ..... [[32mCREATE TABLE (5.0 rows, 40.0 Bytes processed)[0m in 3.60s]
[0m18:48:29.331594 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_bikes
[0m18:48:29.332169 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_stations
[0m18:48:29.332899 [info ] [Thread-1 (]: 10 of 12 START sql incremental model citibike_source_sql.hub_sql_stations ...... [RUN]
[0m18:48:29.333950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_sql_bikes, now model.dbt_bq_sa.hub_sql_stations)
[0m18:48:29.334488 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_stations
[0m18:48:29.346290 [info ] [Thread-1 (]: 18:48:29 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_stations from 1 source(s)
[0m18:48:29.351047 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_stations"
[0m18:48:29.352088 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_stations (compile): 18:48:29.334795 => 18:48:29.351795
[0m18:48:29.352609 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_stations
[0m18:48:29.358397 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_stations"
[0m18:48:29.359321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:29.361823 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_stations`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m18:48:32.482365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:66463fd8-319f-4e72-a7b1-212203a88bcf&page=queryresults
[0m18:48:34.243233 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_stations (execute): 18:48:29.353018 => 18:48:34.242496
[0m18:48:34.246208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a82e90>]}
[0m18:48:34.247903 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model citibike_source_sql.hub_sql_stations . [[32mCREATE TABLE (10.0 rows, 80.0 Bytes processed)[0m in 4.91s]
[0m18:48:34.248973 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_stations
[0m18:48:34.249778 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_trips
[0m18:48:34.250831 [info ] [Thread-1 (]: 11 of 12 START sql incremental model citibike_source_sql.hub_sql_trips ......... [RUN]
[0m18:48:34.252138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_sql_stations, now model.dbt_bq_sa.hub_sql_trips)
[0m18:48:34.252750 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_trips
[0m18:48:34.274213 [info ] [Thread-1 (]: 18:48:34 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_trips from 1 source(s)
[0m18:48:34.277514 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_trips"
[0m18:48:34.278116 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_trips (compile): 18:48:34.253118 => 18:48:34.277956
[0m18:48:34.278379 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_trips
[0m18:48:34.283467 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_trips"
[0m18:48:34.284166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:34.286066 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_trips`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m18:48:35.876927 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:1ac2bd28-5816-4ba5-9eb2-f78835032853&page=queryresults
[0m18:48:37.806810 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_trips (execute): 18:48:34.278531 => 18:48:37.806451
[0m18:48:37.808172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a300a0>]}
[0m18:48:37.809473 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model citibike_source_sql.hub_sql_trips .... [[32mCREATE TABLE (20.0 rows, 800.0 Bytes processed)[0m in 3.56s]
[0m18:48:37.810633 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_trips
[0m18:48:37.811338 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_users
[0m18:48:37.812526 [info ] [Thread-1 (]: 12 of 12 START sql incremental model citibike_source_sql.hub_sql_users ......... [RUN]
[0m18:48:37.814021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_sql_trips, now model.dbt_bq_sa.hub_sql_users)
[0m18:48:37.814678 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_users
[0m18:48:37.824305 [info ] [Thread-1 (]: 18:48:37 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_users from 1 source(s)
[0m18:48:37.829785 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_users"
[0m18:48:37.831116 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_users (compile): 18:48:37.815033 => 18:48:37.830748
[0m18:48:37.831705 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_users
[0m18:48:37.837764 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_users"
[0m18:48:37.838784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:37.840340 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_users`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m18:48:39.539208 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:9f799e1a-55d8-4af3-90b3-1d43e683b54e&page=queryresults
[0m18:48:41.271353 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_users (execute): 18:48:37.832019 => 18:48:41.271066
[0m18:48:41.272707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08cd6975-2eec-41c1-bda6-b64ed5aa1eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a30ca0>]}
[0m18:48:41.273413 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model citibike_source_sql.hub_sql_users .... [[32mCREATE TABLE (10.0 rows, 80.0 Bytes processed)[0m in 3.46s]
[0m18:48:41.274574 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_users
[0m18:48:41.277284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:41.277733 [debug] [MainThread]: Connection 'model.dbt_bq_sa.hub_sql_users' was properly closed.
[0m18:48:41.278164 [info ] [MainThread]: 
[0m18:48:41.278530 [info ] [MainThread]: Finished running 8 view models, 4 incremental models in 0 hours 0 minutes and 40.27 seconds (40.27s).
[0m18:48:41.280515 [debug] [MainThread]: Command end result
[0m18:48:41.298800 [info ] [MainThread]: 
[0m18:48:41.299261 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:48:41.299926 [info ] [MainThread]: 
[0m18:48:41.300573 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m18:48:41.302938 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 41.637283, "process_user_time": 4.108047, "process_kernel_time": 1.420805, "process_mem_max_rss": "202981376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:48:41.303274 [debug] [MainThread]: Command `dbt run` succeeded at 18:48:41.303201 after 41.64 seconds
[0m18:48:41.303573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037432e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c07fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057eee90>]}
[0m18:48:41.303820 [debug] [MainThread]: Flushing usage events
[0m18:52:50.196317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d229b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e1f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e1ef50>]}


============================== 18:52:50.199372 | 869258ac-f0de-4d78-9613-e7428e36971e ==============================
[0m18:52:50.199372 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:52:50.199721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m hub_sql_bikes', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:52:51.087940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '869258ac-f0de-4d78-9613-e7428e36971e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e1ee60>]}
[0m18:52:51.117534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '869258ac-f0de-4d78-9613-e7428e36971e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d7b940>]}
[0m18:52:51.118374 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m18:52:51.136840 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m18:52:51.191256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:52:51.191672 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_bikes.sql
[0m18:52:51.253502 [error] [MainThread]: Encountered an error:
Compilation Error in model hub_sql_bikes (models/raw_vault/hubs/hub_sql_bikes.sql)
  unexpected char '#' at 106
    line 4
      unique_key='BIKE_PK',                 # required for MERGE
[0m18:52:51.254972 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0997647, "process_user_time": 2.373685, "process_kernel_time": 1.126796, "process_mem_max_rss": "198361088", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:52:51.255513 [debug] [MainThread]: Command `dbt run` failed at 18:52:51.255427 after 1.10 seconds
[0m18:52:51.255764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d229b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1501f4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1501f4d60>]}
[0m18:52:51.255993 [debug] [MainThread]: Flushing usage events
[0m18:53:17.003835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034469b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a6f50>]}


============================== 18:53:17.006890 | 9f78e0ed-bf81-4621-a629-59189d3d6e96 ==============================
[0m18:53:17.006890 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:53:17.007225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m hub_sql_bikes', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:53:17.951434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f78e0ed-bf81-4621-a629-59189d3d6e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a6e60>]}
[0m18:53:17.981683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f78e0ed-bf81-4621-a629-59189d3d6e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f5cd510>]}
[0m18:53:17.982304 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m18:53:18.002148 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m18:53:18.091029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:53:18.091468 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_bikes.sql
[0m18:53:18.205846 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.raw_vault
- models.stage
- models.business_vault
[0m18:53:18.209256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f78e0ed-bf81-4621-a629-59189d3d6e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120506080>]}
[0m18:53:18.223076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f78e0ed-bf81-4621-a629-59189d3d6e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202b81c0>]}
[0m18:53:18.223545 [info ] [MainThread]: Found 12 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m18:53:18.223810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f78e0ed-bf81-4621-a629-59189d3d6e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202b8340>]}
[0m18:53:18.225016 [info ] [MainThread]: 
[0m18:53:18.225502 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:53:18.226156 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m18:53:18.226376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:19.037217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m18:53:19.037797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:19.611610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f78e0ed-bf81-4621-a629-59189d3d6e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1202c65c0>]}
[0m18:53:19.612715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:19.613078 [info ] [MainThread]: 
[0m18:53:19.616132 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_bikes
[0m18:53:19.616626 [info ] [Thread-1 (]: 1 of 1 START sql incremental model citibike_source_sql.hub_sql_bikes ........... [RUN]
[0m18:53:19.617305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.hub_sql_bikes)
[0m18:53:19.617709 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_bikes
[0m18:53:19.640173 [info ] [Thread-1 (]: 18:53:19 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_bikes from 1 source(s)
[0m18:53:19.701580 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_bikes"
[0m18:53:19.702938 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_bikes (compile): 18:53:19.618000 => 18:53:19.702787
[0m18:53:19.703196 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_bikes
[0m18:53:19.738371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:19.739430 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes` AS d
    ON a.BIKE_PK = d.BIKE_PK
    WHERE d.BIKE_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m18:53:20.997916 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e9b63941-6aea-4813-a878-0215ba093fe1&page=queryresults
[0m18:53:23.083133 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:53:23.097960 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_bikes"
[0m18:53:23.098664 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
            )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m18:53:23.553741 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:374c43d4-ebed-4f2e-a493-c33a93e9d757&page=queryresults
[0m18:53:24.833804 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_bikes (execute): 18:53:19.703346 => 18:53:24.833543
[0m18:53:24.834593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f78e0ed-bf81-4621-a629-59189d3d6e96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a5d80>]}
[0m18:53:24.835137 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model citibike_source_sql.hub_sql_bikes ...... [[32mMERGE (0.0 rows, 325.0 Bytes processed)[0m in 5.22s]
[0m18:53:24.835510 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_bikes
[0m18:53:24.837161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:24.837454 [debug] [MainThread]: Connection 'model.dbt_bq_sa.hub_sql_bikes' was properly closed.
[0m18:53:24.837758 [info ] [MainThread]: 
[0m18:53:24.839558 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m18:53:24.841815 [debug] [MainThread]: Command end result
[0m18:53:24.865636 [info ] [MainThread]: 
[0m18:53:24.865944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:24.866125 [info ] [MainThread]: 
[0m18:53:24.866329 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:53:24.867968 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9006553, "process_user_time": 2.829905, "process_kernel_time": 1.115473, "process_mem_max_rss": "205176832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:53:24.868322 [debug] [MainThread]: Command `dbt run` succeeded at 18:53:24.868253 after 7.90 seconds
[0m18:53:24.868597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034469b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e37130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f53b100>]}
[0m18:53:24.868809 [debug] [MainThread]: Flushing usage events
[0m19:04:37.559245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bf37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c6f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c6ef50>]}


============================== 19:04:37.562200 | 1dbae5cb-fb2c-46be-a6eb-99212886e767 ==============================
[0m19:04:37.562200 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:04:37.562555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models path:models/raw_vault/hubs', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:04:38.475009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dbae5cb-fb2c-46be-a6eb-99212886e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c6ee60>]}
[0m19:04:38.504678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dbae5cb-fb2c-46be-a6eb-99212886e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c14880>]}
[0m19:04:38.505194 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m19:04:38.525426 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m19:04:38.581253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m19:04:38.581717 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_bikes.sql
[0m19:04:38.581932 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_users.sql
[0m19:04:38.582130 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_trips.sql
[0m19:04:38.582322 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_stations.sql
[0m19:04:38.711500 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stage
- models.raw_vault
- models.business_vault
[0m19:04:38.714940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dbae5cb-fb2c-46be-a6eb-99212886e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ba96680>]}
[0m19:04:38.776976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dbae5cb-fb2c-46be-a6eb-99212886e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12baca2f0>]}
[0m19:04:38.777288 [info ] [MainThread]: Found 12 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m19:04:38.777481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbae5cb-fb2c-46be-a6eb-99212886e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bac9270>]}
[0m19:04:38.778469 [info ] [MainThread]: 
[0m19:04:38.778888 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:04:38.779542 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m19:04:38.779777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:04:39.681942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m19:04:39.682980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:04:40.413466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbae5cb-fb2c-46be-a6eb-99212886e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bacbeb0>]}
[0m19:04:40.415108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:04:40.415662 [info ] [MainThread]: 
[0m19:04:40.419201 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_bikes
[0m19:04:40.419835 [info ] [Thread-1 (]: 1 of 4 START sql incremental model citibike_source_sql.hub_sql_bikes ........... [RUN]
[0m19:04:40.420702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.hub_sql_bikes)
[0m19:04:40.421183 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_bikes
[0m19:04:40.445839 [info ] [Thread-1 (]: 19:04:40 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_bikes from 1 source(s)
[0m19:04:40.452272 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_bikes"
[0m19:04:40.453449 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_bikes (compile): 19:04:40.421471 => 19:04:40.453168
[0m19:04:40.453870 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_bikes
[0m19:04:40.496395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:40.497477 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes` AS d
    ON a.BIKE_PK = d.BIKE_PK
    WHERE d.BIKE_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m19:04:41.999122 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:9eea0843-de4e-4e4b-83bc-0b9e17fdc5f5&page=queryresults
[0m19:04:44.111685 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:04:44.140444 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_bikes"
[0m19:04:44.142307 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
            )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m19:04:44.766625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:9d0dcf9c-6a52-4219-9ea8-7804b5810ecc&page=queryresults
[0m19:04:46.101210 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_bikes (execute): 19:04:40.454082 => 19:04:46.100881
[0m19:04:46.102408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbae5cb-fb2c-46be-a6eb-99212886e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b8cc070>]}
[0m19:04:46.103224 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model citibike_source_sql.hub_sql_bikes ...... [[32mMERGE (0.0 rows, 325.0 Bytes processed)[0m in 5.68s]
[0m19:04:46.103991 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_bikes
[0m19:04:46.104509 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_stations
[0m19:04:46.105145 [info ] [Thread-1 (]: 2 of 4 START sql incremental model citibike_source_sql.hub_sql_stations ........ [RUN]
[0m19:04:46.105988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_sql_bikes, now model.dbt_bq_sa.hub_sql_stations)
[0m19:04:46.106424 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_stations
[0m19:04:46.115823 [info ] [Thread-1 (]: 19:04:46 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_stations from 1 source(s)
[0m19:04:46.120757 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_stations"
[0m19:04:46.122014 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_stations (compile): 19:04:46.106678 => 19:04:46.121765
[0m19:04:46.122401 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_stations
[0m19:04:46.127217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:46.128724 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_stations__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_stations` AS d
    ON a.STATION_PK = d.STATION_PK
    WHERE d.STATION_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m19:04:47.313654 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5aa6533b-60b3-4dd9-aea1-7b3c7c4b9e63&page=queryresults
[0m19:04:49.487440 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:04:49.491805 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_stations"
[0m19:04:49.493666 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
            )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`station_id` = DBT_INTERNAL_SOURCE.`station_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m19:04:49.885772 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:bc6609c4-e723-4f91-bf78-8309fd7951c4&page=queryresults
[0m19:04:51.568908 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_stations (execute): 19:04:46.122613 => 19:04:51.558586
[0m19:04:51.598950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbae5cb-fb2c-46be-a6eb-99212886e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bb08cd0>]}
[0m19:04:51.616251 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model citibike_source_sql.hub_sql_stations ... [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.49s]
[0m19:04:51.624928 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_stations
[0m19:04:51.629383 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_trips
[0m19:04:51.639174 [info ] [Thread-1 (]: 3 of 4 START sql incremental model citibike_source_sql.hub_sql_trips ........... [RUN]
[0m19:04:51.649879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_sql_stations, now model.dbt_bq_sa.hub_sql_trips)
[0m19:04:51.655487 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_trips
[0m19:04:51.752182 [info ] [Thread-1 (]: 19:04:51 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_trips from 1 source(s)
[0m19:04:51.768463 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_trips"
[0m19:04:51.770398 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_trips (compile): 19:04:51.661791 => 19:04:51.769655
[0m19:04:51.771189 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_trips
[0m19:04:51.784888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:51.789013 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_trips` AS d
    ON a.TRIP_PK = d.TRIP_PK
    WHERE d.TRIP_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m19:04:53.270649 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:3ea939c8-ad36-4773-8676-67fd9cfea1ed&page=queryresults
[0m19:04:55.274726 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:04:55.278083 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_trips"
[0m19:04:55.281313 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
            )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`start_station_id` = DBT_INTERNAL_SOURCE.`start_station_id`,`end_station_id` = DBT_INTERNAL_SOURCE.`end_station_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m19:04:55.704882 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4ab7afba-c2ba-431a-b2e8-fffd6e0a3867&page=queryresults
[0m19:04:57.171878 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_trips (execute): 19:04:51.771377 => 19:04:57.171190
[0m19:04:57.174022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbae5cb-fb2c-46be-a6eb-99212886e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bc93b50>]}
[0m19:04:57.175362 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model citibike_source_sql.hub_sql_trips ...... [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 5.53s]
[0m19:04:57.176362 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_trips
[0m19:04:57.177147 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_users
[0m19:04:57.178250 [info ] [Thread-1 (]: 4 of 4 START sql incremental model citibike_source_sql.hub_sql_users ........... [RUN]
[0m19:04:57.179418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_sql_trips, now model.dbt_bq_sa.hub_sql_users)
[0m19:04:57.180017 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_users
[0m19:04:57.200123 [info ] [Thread-1 (]: 19:04:57 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_users from 1 source(s)
[0m19:04:57.212584 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_users"
[0m19:04:57.213652 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_users (compile): 19:04:57.180363 => 19:04:57.213385
[0m19:04:57.214086 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_users
[0m19:04:57.225138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:04:57.228249 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_users__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_users` AS d
    ON a.USER_PK = d.USER_PK
    WHERE d.USER_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m19:04:58.576568 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:3c38c0b7-2346-4830-9fa7-0faa68ba94aa&page=queryresults
[0m19:05:00.783175 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m19:05:00.803465 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_users"
[0m19:05:00.805245 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
            )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m19:05:01.263870 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:993cb32c-1ab3-4a2b-a016-badefa910144&page=queryresults
[0m19:05:02.709011 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_users (execute): 19:04:57.214336 => 19:05:02.708376
[0m19:05:02.711141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbae5cb-fb2c-46be-a6eb-99212886e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bcbf7f0>]}
[0m19:05:02.713047 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model citibike_source_sql.hub_sql_users ...... [[32mMERGE (0.0 rows, 650.0 Bytes processed)[0m in 5.53s]
[0m19:05:02.714056 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_users
[0m19:05:02.717918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:02.718567 [debug] [MainThread]: Connection 'model.dbt_bq_sa.hub_sql_users' was properly closed.
[0m19:05:02.719077 [info ] [MainThread]: 
[0m19:05:02.719510 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 23.94 seconds (23.94s).
[0m19:05:02.720958 [debug] [MainThread]: Command end result
[0m19:05:02.745750 [info ] [MainThread]: 
[0m19:05:02.746271 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:02.746565 [info ] [MainThread]: 
[0m19:05:02.746850 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m19:05:02.749714 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.226162, "process_user_time": 3.371171, "process_kernel_time": 1.355647, "process_mem_max_rss": "204062720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:05:02.750309 [debug] [MainThread]: Command `dbt run` succeeded at 19:05:02.750205 after 25.23 seconds
[0m19:05:02.750721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bf37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c14880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12bcbfcd0>]}
[0m19:05:02.751029 [debug] [MainThread]: Flushing usage events
[0m23:09:43.875534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871af50>]}


============================== 23:09:43.878642 | 7fd54077-844b-4905-88f5-0a451b956d9c ==============================
[0m23:09:43.878642 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:09:43.879044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models path:models/raw_vault/links', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:09:44.806342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fd54077-844b-4905-88f5-0a451b956d9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871ae60>]}
[0m23:09:44.835723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fd54077-844b-4905-88f5-0a451b956d9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a9454b0>]}
[0m23:09:44.836207 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m23:09:44.854462 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:09:44.915601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m23:09:44.915976 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/link_sql_bikes_trips.sql
[0m23:09:44.916165 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/link_sql_users_bikes.sql
[0m23:09:44.916357 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/link_sql_users_trips.sql
[0m23:09:44.986418 [error] [MainThread]: Encountered an error:
Compilation Error in model link_sql_bikes_trips (models/raw_vault/links/link_sql_bikes_trips.sql)
  macro 'dbt_macro__link' takes no keyword argument 'src'
[0m23:09:44.987819 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1552597, "process_user_time": 2.129043, "process_kernel_time": 1.409378, "process_mem_max_rss": "201080832", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:09:44.988343 [debug] [MainThread]: Command `dbt run` failed at 23:09:44.988258 after 1.16 seconds
[0m23:09:44.988583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13852d570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13852d6c0>]}
[0m23:09:44.988816 [debug] [MainThread]: Flushing usage events
[0m23:21:28.449481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103567ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611bf10>]}


============================== 23:21:28.452770 | d9dd300e-177c-4119-b643-5c0c620e9d0a ==============================
[0m23:21:28.452770 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:21:28.453117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models path:models/stage', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:21:29.242234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9dd300e-177c-4119-b643-5c0c620e9d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f96f0>]}
[0m23:21:29.271510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9dd300e-177c-4119-b643-5c0c620e9d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c0040>]}
[0m23:21:29.272087 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m23:21:29.292430 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:21:29.347336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 7 files added, 1 files changed.
[0m23:21:29.347883 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/sats/sat_sql_bikes.sql
[0m23:21:29.348144 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/link_sql_users_trips.sql
[0m23:21:29.348342 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/link_sql_bikes_trips.sql
[0m23:21:29.348515 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/sats/sat_sql_users.sql
[0m23:21:29.348685 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/sats/sat_sql_trips.sql
[0m23:21:29.348849 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/link_sql_users_bikes.sql
[0m23:21:29.349009 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/sats/sat_sql_stations.sql
[0m23:21:29.349201 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m23:21:29.614974 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.business_vault
- models.raw_vault
- models.stage
[0m23:21:29.618761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9dd300e-177c-4119-b643-5c0c620e9d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eb1a740>]}
[0m23:21:29.630372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9dd300e-177c-4119-b643-5c0c620e9d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e688460>]}
[0m23:21:29.630698 [info ] [MainThread]: Found 19 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m23:21:29.630966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9dd300e-177c-4119-b643-5c0c620e9d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e6886a0>]}
[0m23:21:29.632651 [info ] [MainThread]: 
[0m23:21:29.633558 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:21:29.634367 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m23:21:29.634609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:21:30.662062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m23:21:30.662940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:21:31.272722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9dd300e-177c-4119-b643-5c0c620e9d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e3f0490>]}
[0m23:21:31.274330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:21:31.274892 [info ] [MainThread]: 
[0m23:21:31.279312 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m23:21:31.280271 [info ] [Thread-1 (]: 1 of 4 START sql view model citibike_source_sql.stg_sql_bikes .................. [RUN]
[0m23:21:31.281469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.dbt_stg_bikes)
[0m23:21:31.282103 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m23:21:31.297063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:32.069165 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m23:21:32.071568 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 23:21:31.282423 => 23:21:32.071259
[0m23:21:32.072075 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m23:21:32.105578 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m23:21:32.106783 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_bikes`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    bike_type

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
),

derived_columns AS (

    SELECT

    bike_id,
    bike_type,
    'SRC_SQL_BIKES' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    BIKE_PK,
    BIKE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m23:21:33.013012 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:63245e19-5807-4c46-8c2d-9b801ecb2cea&page=queryresults
[0m23:21:33.574236 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 23:21:32.072376 => 23:21:33.573924
[0m23:21:33.575418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9dd300e-177c-4119-b643-5c0c620e9d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ea2f4f0>]}
[0m23:21:33.576221 [info ] [Thread-1 (]: 1 of 4 OK created sql view model citibike_source_sql.stg_sql_bikes ............. [[32mCREATE VIEW (0 processed)[0m in 2.29s]
[0m23:21:33.577008 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m23:21:33.577510 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m23:21:33.578125 [info ] [Thread-1 (]: 2 of 4 START sql view model citibike_source_sql.stg_sql_stations ............... [RUN]
[0m23:21:33.578969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m23:21:33.579394 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m23:21:33.586339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:34.400099 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m23:21:34.402856 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 23:21:33.579640 => 23:21:34.402553
[0m23:21:34.403334 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m23:21:34.408243 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_stations"
[0m23:21:34.409863 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_stations`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
),

derived_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    'SRC_SQL_STATIONS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')
    )))) AS STRING) AS STATION_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    STATION_PK,
    STATION_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m23:21:35.306672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:914cd57a-d31c-49fd-a85d-4d38c87e14b6&page=queryresults
[0m23:21:35.758238 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 23:21:34.403592 => 23:21:35.757880
[0m23:21:35.759358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9dd300e-177c-4119-b643-5c0c620e9d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e48fa00>]}
[0m23:21:35.760145 [info ] [Thread-1 (]: 2 of 4 OK created sql view model citibike_source_sql.stg_sql_stations .......... [[32mCREATE VIEW (0 processed)[0m in 2.18s]
[0m23:21:35.760882 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m23:21:35.761421 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m23:21:35.762125 [info ] [Thread-1 (]: 3 of 4 START sql view model citibike_source_sql.stg_sql_trips .................. [RUN]
[0m23:21:35.763432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m23:21:35.764041 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m23:21:35.772308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:36.467343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m23:21:36.468397 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 23:21:35.764354 => 23:21:36.468235
[0m23:21:36.468638 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m23:21:36.471287 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m23:21:36.472298 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_USERS_BIKES_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_BIKES_TRIPS_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_USERS_TRIPS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF,
    LINK_USERS_BIKES_PK,
    LINK_BIKES_TRIPS_PK,
    LINK_USERS_TRIPS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m23:21:37.418343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:59742a42-26b4-4ece-9a52-f65e6c723580&page=queryresults
[0m23:21:37.962009 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 23:21:36.468769 => 23:21:37.961555
[0m23:21:37.964305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9dd300e-177c-4119-b643-5c0c620e9d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e48fa00>]}
[0m23:21:37.965815 [info ] [Thread-1 (]: 3 of 4 OK created sql view model citibike_source_sql.stg_sql_trips ............. [[32mCREATE VIEW (0 processed)[0m in 2.20s]
[0m23:21:37.966819 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m23:21:37.967551 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m23:21:37.968518 [info ] [Thread-1 (]: 4 of 4 START sql view model citibike_source_sql.stg_sql_users .................. [RUN]
[0m23:21:37.969807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m23:21:37.970457 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m23:21:37.983728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:21:38.669712 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m23:21:38.672351 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 23:21:37.970833 => 23:21:38.672001
[0m23:21:38.672910 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m23:21:38.678743 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_users"
[0m23:21:38.680292 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
),

derived_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    'SRC_SQL_USERS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    USER_PK,
    USER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m23:21:39.664657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:261bf8c4-ef07-4a78-9bf5-7d8bca61634d&page=queryresults
[0m23:21:39.917739 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 23:21:38.673244 => 23:21:39.917285
[0m23:21:39.919589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9dd300e-177c-4119-b643-5c0c620e9d0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13e7e93c0>]}
[0m23:21:39.921208 [info ] [Thread-1 (]: 4 of 4 OK created sql view model citibike_source_sql.stg_sql_users ............. [[32mCREATE VIEW (0 processed)[0m in 1.95s]
[0m23:21:39.922294 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m23:21:39.925329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:21:39.925847 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_stg_users' was properly closed.
[0m23:21:39.926375 [info ] [MainThread]: 
[0m23:21:39.926934 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.29 seconds (10.29s).
[0m23:21:39.928557 [debug] [MainThread]: Command end result
[0m23:21:39.954524 [info ] [MainThread]: 
[0m23:21:39.955051 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:21:39.955417 [info ] [MainThread]: 
[0m23:21:39.955820 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:21:39.958462 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.546293, "process_user_time": 3.392803, "process_kernel_time": 1.142113, "process_mem_max_rss": "214335488", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:21:39.958979 [debug] [MainThread]: Command `dbt run` succeeded at 23:21:39.958869 after 11.55 seconds
[0m23:21:39.959400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103567ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ee583d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c0040>]}
[0m23:21:39.959762 [debug] [MainThread]: Flushing usage events
[0m23:22:00.237921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075437c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109617340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109616f50>]}


============================== 23:22:00.241338 | a76d0367-2325-40f1-91eb-863630a7b7d1 ==============================
[0m23:22:00.241338 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:22:00.241669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models path:models/raw_vault/hubs', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:22:01.127670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a76d0367-2325-40f1-91eb-863630a7b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109616e60>]}
[0m23:22:01.156983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a76d0367-2325-40f1-91eb-863630a7b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095bc340>]}
[0m23:22:01.157443 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m23:22:01.179913 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:22:01.232188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:22:01.232519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:22:01.233236 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stage
- models.business_vault
- models.raw_vault
[0m23:22:01.237316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a76d0367-2325-40f1-91eb-863630a7b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138649de0>]}
[0m23:22:01.250545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a76d0367-2325-40f1-91eb-863630a7b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13840d7e0>]}
[0m23:22:01.250860 [info ] [MainThread]: Found 19 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m23:22:01.251065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a76d0367-2325-40f1-91eb-863630a7b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13840caf0>]}
[0m23:22:01.252284 [info ] [MainThread]: 
[0m23:22:01.252780 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:22:01.253486 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m23:22:01.253707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:02.043458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m23:22:02.044461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:22:02.622186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a76d0367-2325-40f1-91eb-863630a7b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13840d360>]}
[0m23:22:02.623850 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:22:02.624392 [info ] [MainThread]: 
[0m23:22:02.628318 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_bikes
[0m23:22:02.629194 [info ] [Thread-1 (]: 1 of 4 START sql incremental model citibike_source_sql.hub_sql_bikes ........... [RUN]
[0m23:22:02.630371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.hub_sql_bikes)
[0m23:22:02.630970 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_bikes
[0m23:22:02.669730 [info ] [Thread-1 (]: 23:22:02 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_bikes from 1 source(s)
[0m23:22:02.709839 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_bikes"
[0m23:22:02.710660 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_bikes (compile): 23:22:02.631292 => 23:22:02.710481
[0m23:22:02.710919 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_bikes
[0m23:22:02.744792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:02.745806 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes` AS d
    ON a.BIKE_PK = d.BIKE_PK
    WHERE d.BIKE_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m23:22:03.749879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f12ee24b-3edd-41ec-bc62-0b7c3935bb42&page=queryresults
[0m23:22:05.852757 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:22:05.881989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_bikes"
[0m23:22:05.883383 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
            )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m23:22:06.559016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:fc11ef93-f4cc-41e9-af6c-44ae39939bb1&page=queryresults
[0m23:22:07.694837 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_bikes (execute): 23:22:02.711058 => 23:22:07.694496
[0m23:22:07.696454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a76d0367-2325-40f1-91eb-863630a7b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1385fb760>]}
[0m23:22:07.697284 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model citibike_source_sql.hub_sql_bikes ...... [[32mMERGE (0.0 rows, 325.0 Bytes processed)[0m in 5.07s]
[0m23:22:07.698053 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_bikes
[0m23:22:07.698544 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_stations
[0m23:22:07.699193 [info ] [Thread-1 (]: 2 of 4 START sql incremental model citibike_source_sql.hub_sql_stations ........ [RUN]
[0m23:22:07.700092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_sql_bikes, now model.dbt_bq_sa.hub_sql_stations)
[0m23:22:07.700530 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_stations
[0m23:22:07.709790 [info ] [Thread-1 (]: 23:22:07 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_stations from 1 source(s)
[0m23:22:07.714790 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_stations"
[0m23:22:07.715866 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_stations (compile): 23:22:07.701017 => 23:22:07.715595
[0m23:22:07.716271 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_stations
[0m23:22:07.720781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:07.722588 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_stations__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_stations` AS d
    ON a.STATION_PK = d.STATION_PK
    WHERE d.STATION_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m23:22:08.846797 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:594b6092-f9d2-4523-b4f4-d152e3557149&page=queryresults
[0m23:22:10.885603 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:22:10.892371 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_stations"
[0m23:22:10.893754 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
            )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`station_id` = DBT_INTERNAL_SOURCE.`station_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m23:22:11.294536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:40da5a73-c738-4026-9f43-b829b4b430d7&page=queryresults
[0m23:22:12.450396 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_stations (execute): 23:22:07.716502 => 23:22:12.449932
[0m23:22:12.452600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a76d0367-2325-40f1-91eb-863630a7b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1385fbcd0>]}
[0m23:22:12.453928 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model citibike_source_sql.hub_sql_stations ... [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 4.75s]
[0m23:22:12.454887 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_stations
[0m23:22:12.455599 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_trips
[0m23:22:12.456504 [info ] [Thread-1 (]: 3 of 4 START sql incremental model citibike_source_sql.hub_sql_trips ........... [RUN]
[0m23:22:12.457669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_sql_stations, now model.dbt_bq_sa.hub_sql_trips)
[0m23:22:12.458268 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_trips
[0m23:22:12.471840 [info ] [Thread-1 (]: 23:22:12 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_trips from 1 source(s)
[0m23:22:12.479302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_trips"
[0m23:22:12.480926 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_trips (compile): 23:22:12.458609 => 23:22:12.480562
[0m23:22:12.481424 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_trips
[0m23:22:12.576745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:12.577891 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_trips` AS d
    ON a.TRIP_PK = d.TRIP_PK
    WHERE d.TRIP_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m23:22:13.754989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b31c9f96-0917-4abf-8af2-f40bba61e7ea&page=queryresults
[0m23:22:15.870717 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:22:15.874781 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_trips"
[0m23:22:15.877263 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
            )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`start_station_id` = DBT_INTERNAL_SOURCE.`start_station_id`,`end_station_id` = DBT_INTERNAL_SOURCE.`end_station_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m23:22:16.194690 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:73d6682d-dd8b-4344-977e-241bcbc45a9d&page=queryresults
[0m23:22:17.507190 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_trips (execute): 23:22:12.481685 => 23:22:17.506226
[0m23:22:17.509541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a76d0367-2325-40f1-91eb-863630a7b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ff48e50>]}
[0m23:22:17.510942 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model citibike_source_sql.hub_sql_trips ...... [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 5.05s]
[0m23:22:17.511996 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_trips
[0m23:22:17.512684 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.hub_sql_users
[0m23:22:17.513802 [info ] [Thread-1 (]: 4 of 4 START sql incremental model citibike_source_sql.hub_sql_users ........... [RUN]
[0m23:22:17.515453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.hub_sql_trips, now model.dbt_bq_sa.hub_sql_users)
[0m23:22:17.516155 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.hub_sql_users
[0m23:22:17.528826 [info ] [Thread-1 (]: 23:22:17 + Loading leafy-mountain-469410-k3.citibike_source_sql.hub_sql_users from 1 source(s)
[0m23:22:17.541378 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.hub_sql_users"
[0m23:22:17.542883 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_users (compile): 23:22:17.516644 => 23:22:17.542576
[0m23:22:17.543297 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.hub_sql_users
[0m23:22:17.548532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:17.550437 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_users__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_users` AS d
    ON a.USER_PK = d.USER_PK
    WHERE d.USER_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m23:22:18.638185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f67a337c-7d6f-414d-b477-f76ab426e14b&page=queryresults
[0m23:22:20.702015 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m23:22:20.707007 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.hub_sql_users"
[0m23:22:20.708410 [debug] [Thread-1 (]: On model.dbt_bq_sa.hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.hub_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`hub_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
            )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m23:22:22.791860 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:999674b0-e7e7-4185-a5f1-f9375a9bd7dc&page=queryresults
[0m23:22:23.889777 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.hub_sql_users (execute): 23:22:17.543522 => 23:22:23.889173
[0m23:22:23.893063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a76d0367-2325-40f1-91eb-863630a7b7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138976e00>]}
[0m23:22:23.894452 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model citibike_source_sql.hub_sql_users ...... [[32mMERGE (0.0 rows, 650.0 Bytes processed)[0m in 6.38s]
[0m23:22:23.895446 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.hub_sql_users
[0m23:22:23.898533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:22:23.899123 [debug] [MainThread]: Connection 'model.dbt_bq_sa.hub_sql_users' was properly closed.
[0m23:22:23.899690 [info ] [MainThread]: 
[0m23:22:23.900264 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 22.65 seconds (22.65s).
[0m23:22:23.901993 [debug] [MainThread]: Command end result
[0m23:22:23.928364 [info ] [MainThread]: 
[0m23:22:23.928951 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:22:23.929302 [info ] [MainThread]: 
[0m23:22:23.929709 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:22:23.932674 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.734444, "process_user_time": 3.308516, "process_kernel_time": 1.170346, "process_mem_max_rss": "199753728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:22:23.933219 [debug] [MainThread]: Command `dbt run` succeeded at 23:22:23.933111 after 23.74 seconds
[0m23:22:23.933636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075437c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe7d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1386b5f90>]}
[0m23:22:23.933996 [debug] [MainThread]: Flushing usage events
[0m23:22:38.355914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054772e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10754b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10754af80>]}


============================== 23:22:38.358804 | 775721a5-c814-4929-8cf0-399dca44e2c8 ==============================
[0m23:22:38.358804 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:22:38.359133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models path:models/raw_vault/links', 'send_anonymous_usage_stats': 'True'}
[0m23:22:39.217748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '775721a5-c814-4929-8cf0-399dca44e2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10754ae90>]}
[0m23:22:39.248255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '775721a5-c814-4929-8cf0-399dca44e2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f7f5510>]}
[0m23:22:39.248800 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m23:22:39.267821 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:22:39.322447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:22:39.322726 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:22:39.323354 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.business_vault
- models.stage
- models.raw_vault
[0m23:22:39.327567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '775721a5-c814-4929-8cf0-399dca44e2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e041f90>]}
[0m23:22:39.340816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '775721a5-c814-4929-8cf0-399dca44e2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12de61960>]}
[0m23:22:39.341131 [info ] [MainThread]: Found 19 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m23:22:39.341329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '775721a5-c814-4929-8cf0-399dca44e2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12de60c70>]}
[0m23:22:39.342428 [info ] [MainThread]: 
[0m23:22:39.342928 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:22:39.343678 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m23:22:39.344017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:22:40.154485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m23:22:40.155618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:22:40.708965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '775721a5-c814-4929-8cf0-399dca44e2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12de619f0>]}
[0m23:22:40.710406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:22:40.710866 [info ] [MainThread]: 
[0m23:22:40.713741 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_sql_bikes_trips
[0m23:22:40.714516 [info ] [Thread-1 (]: 1 of 3 START sql incremental model citibike_source_sql.link_sql_bikes_trips .... [RUN]
[0m23:22:40.715579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.link_sql_bikes_trips)
[0m23:22:40.716143 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_sql_bikes_trips
[0m23:22:40.755110 [info ] [Thread-1 (]: 23:22:40 + Loading leafy-mountain-469410-k3.citibike_source_sql.link_sql_bikes_trips from 1 source(s)
[0m23:22:40.796752 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_sql_bikes_trips"
[0m23:22:40.797713 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.link_sql_bikes_trips (compile): 23:22:40.716482 => 23:22:40.797549
[0m23:22:40.797947 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_sql_bikes_trips
[0m23:22:40.833101 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_sql_bikes_trips"
[0m23:22:40.833950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:40.834865 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_sql_bikes_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`link_sql_bikes_trips`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_BIKES_TRIPS_PK, rr.BIKE_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS rr
    WHERE rr.LINK_BIKES_TRIPS_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_BIKES_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_BIKES_TRIPS_PK, a.BIKE_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m23:22:41.930333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:cf2a383d-29f6-4eef-a406-ca03d2e84012&page=queryresults
[0m23:22:43.497929 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.link_sql_bikes_trips (execute): 23:22:40.798073 => 23:22:43.497637
[0m23:22:43.499284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775721a5-c814-4929-8cf0-399dca44e2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12dffb8e0>]}
[0m23:22:43.500165 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model citibike_source_sql.link_sql_bikes_trips  [[32mCREATE TABLE (20.0 rows, 800.0 Bytes processed)[0m in 2.78s]
[0m23:22:43.500877 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_sql_bikes_trips
[0m23:22:43.501376 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_sql_users_bikes
[0m23:22:43.502268 [info ] [Thread-1 (]: 2 of 3 START sql incremental model citibike_source_sql.link_sql_users_bikes .... [RUN]
[0m23:22:43.503172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_sql_bikes_trips, now model.dbt_bq_sa.link_sql_users_bikes)
[0m23:22:43.503599 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_sql_users_bikes
[0m23:22:43.511131 [info ] [Thread-1 (]: 23:22:43 + Loading leafy-mountain-469410-k3.citibike_source_sql.link_sql_users_bikes from 1 source(s)
[0m23:22:43.515696 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_sql_users_bikes"
[0m23:22:43.516473 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.link_sql_users_bikes (compile): 23:22:43.503844 => 23:22:43.516275
[0m23:22:43.516797 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_sql_users_bikes
[0m23:22:43.522606 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_sql_users_bikes"
[0m23:22:43.523474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:43.525111 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_sql_users_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`link_sql_users_bikes`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_BIKES_PK, rr.USER_PK, rr.BIKE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS rr
    WHERE rr.LINK_USERS_BIKES_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_BIKES_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_BIKES_PK, a.USER_PK, a.BIKE_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m23:22:44.698552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:bf582177-b1d4-4667-9322-983f42173bcd&page=queryresults
[0m23:22:46.273709 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.link_sql_users_bikes (execute): 23:22:43.516981 => 23:22:46.271657
[0m23:22:46.278835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775721a5-c814-4929-8cf0-399dca44e2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12db432e0>]}
[0m23:22:46.280410 [info ] [Thread-1 (]: 2 of 3 OK created sql incremental model citibike_source_sql.link_sql_users_bikes  [[32mCREATE TABLE (10.0 rows, 320.0 Bytes processed)[0m in 2.78s]
[0m23:22:46.281562 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_sql_users_bikes
[0m23:22:46.282487 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.link_sql_users_trips
[0m23:22:46.283702 [info ] [Thread-1 (]: 3 of 3 START sql incremental model citibike_source_sql.link_sql_users_trips .... [RUN]
[0m23:22:46.284936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.link_sql_users_bikes, now model.dbt_bq_sa.link_sql_users_trips)
[0m23:22:46.285547 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.link_sql_users_trips
[0m23:22:46.297244 [info ] [Thread-1 (]: 23:22:46 + Loading leafy-mountain-469410-k3.citibike_source_sql.link_sql_users_trips from 1 source(s)
[0m23:22:46.303076 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.link_sql_users_trips"
[0m23:22:46.304082 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.link_sql_users_trips (compile): 23:22:46.285854 => 23:22:46.303837
[0m23:22:46.304499 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.link_sql_users_trips
[0m23:22:46.309767 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.link_sql_users_trips"
[0m23:22:46.310626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:22:46.312715 [debug] [Thread-1 (]: On model.dbt_bq_sa.link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.link_sql_users_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`link_sql_users_trips`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_TRIPS_PK, rr.USER_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS rr
    WHERE rr.LINK_USERS_TRIPS_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_TRIPS_PK, a.USER_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m23:22:47.464736 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:6f75834a-55e6-48cd-907c-d244408fa3da&page=queryresults
[0m23:22:49.080487 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.link_sql_users_trips (execute): 23:22:46.304711 => 23:22:49.079949
[0m23:22:49.085368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '775721a5-c814-4929-8cf0-399dca44e2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12db432e0>]}
[0m23:22:49.086842 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model citibike_source_sql.link_sql_users_trips  [[32mCREATE TABLE (20.0 rows, 800.0 Bytes processed)[0m in 2.80s]
[0m23:22:49.087848 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.link_sql_users_trips
[0m23:22:49.091024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:22:49.091597 [debug] [MainThread]: Connection 'model.dbt_bq_sa.link_sql_users_trips' was properly closed.
[0m23:22:49.092178 [info ] [MainThread]: 
[0m23:22:49.092756 [info ] [MainThread]: Finished running 3 incremental models in 0 hours 0 minutes and 9.75 seconds (9.75s).
[0m23:22:49.094325 [debug] [MainThread]: Command end result
[0m23:22:49.196801 [info ] [MainThread]: 
[0m23:22:49.197088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:22:49.197264 [info ] [MainThread]: 
[0m23:22:49.197668 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m23:22:49.200916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.87952, "process_user_time": 2.970476, "process_kernel_time": 1.183365, "process_mem_max_rss": "201506816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:22:49.201173 [debug] [MainThread]: Command `dbt run` succeeded at 23:22:49.201109 after 10.88 seconds
[0m23:22:49.201406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054772e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12d8e4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e465930>]}
[0m23:22:49.201610 [debug] [MainThread]: Flushing usage events
[0m23:25:39.099685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e4fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa6f80>]}


============================== 23:25:39.102747 | a224ea35-9e8c-4c2b-b6c0-5b12637c6333 ==============================
[0m23:25:39.102747 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:25:39.103069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models path:models/raw_vault/sats', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:25:40.006029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a224ea35-9e8c-4c2b-b6c0-5b12637c6333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa6e90>]}
[0m23:25:40.035378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a224ea35-9e8c-4c2b-b6c0-5b12637c6333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f51360>]}
[0m23:25:40.035861 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m23:25:40.059741 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:25:40.115547 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m23:25:40.116035 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/sat_sql_trips.sql
[0m23:25:40.116269 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/sat_sql_stations.sql
[0m23:25:40.116464 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/sat_sql_users.sql
[0m23:25:40.116657 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/sat_sql_bikes.sql
[0m23:25:40.330417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stage
- models.raw_vault
- models.business_vault
[0m23:25:40.334088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a224ea35-9e8c-4c2b-b6c0-5b12637c6333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cb572b0>]}
[0m23:25:40.345351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a224ea35-9e8c-4c2b-b6c0-5b12637c6333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c809210>]}
[0m23:25:40.345671 [info ] [MainThread]: Found 19 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m23:25:40.345860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a224ea35-9e8c-4c2b-b6c0-5b12637c6333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c808520>]}
[0m23:25:40.346913 [info ] [MainThread]: 
[0m23:25:40.347328 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:25:40.347949 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m23:25:40.348155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:25:41.207805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m23:25:41.208952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:41.775555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a224ea35-9e8c-4c2b-b6c0-5b12637c6333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c808cd0>]}
[0m23:25:41.777004 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:25:41.777660 [info ] [MainThread]: 
[0m23:25:41.780363 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_sql_bikes
[0m23:25:41.781046 [info ] [Thread-1 (]: 1 of 4 START sql incremental model citibike_source_sql.sat_sql_bikes ........... [RUN]
[0m23:25:41.782008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.sat_sql_bikes)
[0m23:25:41.782663 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_sql_bikes
[0m23:25:41.809483 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_sql_bikes"
[0m23:25:41.810685 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.sat_sql_bikes (compile): 23:25:41.783082 => 23:25:41.810465
[0m23:25:41.811024 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_sql_bikes
[0m23:25:41.855469 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_sql_bikes"
[0m23:25:41.856399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:41.857346 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`sat_sql_bikes`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m23:25:42.976210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d553f46a-5ab8-469d-9ca2-995473155b78&page=queryresults
[0m23:25:44.767483 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.sat_sql_bikes (execute): 23:25:41.811217 => 23:25:44.767084
[0m23:25:44.770536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a224ea35-9e8c-4c2b-b6c0-5b12637c6333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c48d540>]}
[0m23:25:44.771199 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model citibike_source_sql.sat_sql_bikes ...... [[32mCREATE TABLE (5.0 rows, 87.0 Bytes processed)[0m in 2.99s]
[0m23:25:44.771591 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_sql_bikes
[0m23:25:44.771892 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_sql_stations
[0m23:25:44.772269 [info ] [Thread-1 (]: 2 of 4 START sql incremental model citibike_source_sql.sat_sql_stations ........ [RUN]
[0m23:25:44.772696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_sql_bikes, now model.dbt_bq_sa.sat_sql_stations)
[0m23:25:44.772911 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_sql_stations
[0m23:25:44.793149 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_sql_stations"
[0m23:25:44.793845 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.sat_sql_stations (compile): 23:25:44.773037 => 23:25:44.793695
[0m23:25:44.794091 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_sql_stations
[0m23:25:44.797405 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_sql_stations"
[0m23:25:44.798061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:44.799579 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`sat_sql_stations`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m23:25:45.913469 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:fb44a1db-9571-4e62-9128-7937ddfe6021&page=queryresults
[0m23:25:47.843788 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.sat_sql_stations (execute): 23:25:44.794225 => 23:25:47.843092
[0m23:25:47.846402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a224ea35-9e8c-4c2b-b6c0-5b12637c6333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c46ae00>]}
[0m23:25:47.847867 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model citibike_source_sql.sat_sql_stations ... [[32mCREATE TABLE (10.0 rows, 802.0 Bytes processed)[0m in 3.07s]
[0m23:25:47.848864 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_sql_stations
[0m23:25:47.849550 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_sql_trips
[0m23:25:47.850430 [info ] [Thread-1 (]: 3 of 4 START sql incremental model citibike_source_sql.sat_sql_trips ........... [RUN]
[0m23:25:47.851676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_sql_stations, now model.dbt_bq_sa.sat_sql_trips)
[0m23:25:47.852300 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_sql_trips
[0m23:25:47.878705 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_sql_trips"
[0m23:25:47.879673 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.sat_sql_trips (compile): 23:25:47.852654 => 23:25:47.879443
[0m23:25:47.880043 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_sql_trips
[0m23:25:47.886092 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_sql_trips"
[0m23:25:47.886933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:47.888524 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`sat_sql_trips`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m23:25:48.929445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4a686da8-30f5-43cd-b692-fb63d4652406&page=queryresults
[0m23:25:50.718348 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.sat_sql_trips (execute): 23:25:47.880248 => 23:25:50.718116
[0m23:25:50.719378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a224ea35-9e8c-4c2b-b6c0-5b12637c6333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c342dd0>]}
[0m23:25:50.720005 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model citibike_source_sql.sat_sql_trips ...... [[32mCREATE TABLE (20.0 rows, 1.1 KiB processed)[0m in 2.87s]
[0m23:25:50.720582 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_sql_trips
[0m23:25:50.720996 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.sat_sql_users
[0m23:25:50.721471 [info ] [Thread-1 (]: 4 of 4 START sql incremental model citibike_source_sql.sat_sql_users ........... [RUN]
[0m23:25:50.722098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.sat_sql_trips, now model.dbt_bq_sa.sat_sql_users)
[0m23:25:50.722435 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.sat_sql_users
[0m23:25:50.740205 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.sat_sql_users"
[0m23:25:50.740928 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.sat_sql_users (compile): 23:25:50.722636 => 23:25:50.740744
[0m23:25:50.741221 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.sat_sql_users
[0m23:25:50.746026 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.sat_sql_users"
[0m23:25:50.746585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:25:50.747812 [debug] [Thread-1 (]: On model.dbt_bq_sa.sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`sat_sql_users`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m23:25:52.114933 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:93481ef9-d802-4a13-8ab0-fb8092406c6f&page=queryresults
[0m23:25:53.930328 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.sat_sql_users (execute): 23:25:50.741392 => 23:25:53.929647
[0m23:25:53.932648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a224ea35-9e8c-4c2b-b6c0-5b12637c6333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c3413f0>]}
[0m23:25:53.934191 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model citibike_source_sql.sat_sql_users ...... [[32mCREATE TABLE (10.0 rows, 430.0 Bytes processed)[0m in 3.21s]
[0m23:25:53.935222 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.sat_sql_users
[0m23:25:53.943418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:25:53.944087 [debug] [MainThread]: Connection 'model.dbt_bq_sa.sat_sql_users' was properly closed.
[0m23:25:53.944696 [info ] [MainThread]: 
[0m23:25:53.945280 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 13.60 seconds (13.60s).
[0m23:25:53.947002 [debug] [MainThread]: Command end result
[0m23:25:53.978632 [info ] [MainThread]: 
[0m23:25:53.979161 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:25:53.979465 [info ] [MainThread]: 
[0m23:25:53.979809 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m23:25:53.982506 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.921716, "process_user_time": 3.117809, "process_kernel_time": 1.159722, "process_mem_max_rss": "209502208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:25:53.983027 [debug] [MainThread]: Command `dbt run` succeeded at 23:25:53.982907 after 14.92 seconds
[0m23:25:53.983531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e4fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c3413f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa6e90>]}
[0m23:25:53.983910 [debug] [MainThread]: Flushing usage events
[0m00:10:03.194438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123df3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123df2f80>]}


============================== 00:10:03.197721 | f0bbac3c-23e5-40f7-b353-59eaef0c54ff ==============================
[0m00:10:03.197721 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:10:03.198068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models path:models/raw_vault/sats', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:10:04.042431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123df2e90>]}
[0m00:10:04.073653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123d52cb0>]}
[0m00:10:04.074333 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:10:04.096959 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:10:04.158352 [debug] [MainThread]: Partial parsing enabled: 11 files deleted, 14 files added, 0 files changed.
[0m00:10:04.158823 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:10:04.159028 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_bikes.sql
[0m00:10:04.159211 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_trips.sql
[0m00:10:04.159385 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/sats/dbt_sat_sql_users.sql
[0m00:10:04.159555 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:10:04.159720 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_stations.sql
[0m00:10:04.159887 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/sats/dbt_sat_sql_bikes.sql
[0m00:10:04.160053 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/sats/dbt_sat_sql_stations.sql
[0m00:10:04.160217 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/sats/dbt_sat_sql_trips.sql
[0m00:10:04.160381 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:10:04.160545 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m00:10:04.160716 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:10:04.160879 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_bikes_trips.sql
[0m00:10:04.161042 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/raw_vault/sats/dbt_eff_sat_link_users_trips.sql
[0m00:10:04.161196 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/raw_vault/sats/sat_sql_trips.sql
[0m00:10:04.161343 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_stations.sql
[0m00:10:04.161488 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/raw_vault/links/link_sql_users_bikes.sql
[0m00:10:04.161632 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/raw_vault/links/link_sql_bikes_trips.sql
[0m00:10:04.161775 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/raw_vault/sats/sat_sql_bikes.sql
[0m00:10:04.161915 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_trips.sql
[0m00:10:04.162053 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/raw_vault/sats/sat_sql_stations.sql
[0m00:10:04.162198 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/raw_vault/links/link_sql_users_trips.sql
[0m00:10:04.162336 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_users.sql
[0m00:10:04.162473 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/raw_vault/hubs/hub_sql_bikes.sql
[0m00:10:04.162609 [debug] [MainThread]: Partial parsing: deleted file: dbt_bq_sa://models/raw_vault/sats/sat_sql_users.sql
[0m00:10:04.643245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.business_vault
- models.raw_vault
- models.stage
[0m00:10:04.651542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158c52a70>]}
[0m00:10:04.687600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158a8d150>]}
[0m00:10:04.688582 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m00:10:04.689116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158a8c460>]}
[0m00:10:04.693596 [info ] [MainThread]: 
[0m00:10:04.695900 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:10:04.701931 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m00:10:04.703405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:05.845049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m00:10:05.846223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:06.360392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158a0ff40>]}
[0m00:10:06.361835 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:10:06.362292 [info ] [MainThread]: 
[0m00:10:06.366000 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m00:10:06.368758 [info ] [Thread-1 (]: 1 of 7 START sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips ... [RUN]
[0m00:10:06.372559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.dbt_eff_sat_link_users_trips)
[0m00:10:06.374411 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m00:10:06.409399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m00:10:06.410575 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (compile): 00:10:06.375100 => 00:10:06.410343
[0m00:10:06.410893 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m00:10:06.457234 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m00:10:06.458028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:06.458967 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_eff_sat_link_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS a
    WHERE a.USER_PK IS NOT NULL
    AND a.BIKE_PK IS NOT NULL
),

records_to_insert AS (
    SELECT i.TRIP_PK, i.USER_PK, i.BIKE_PK, i.start_time, i.end_time, i.EFFECTIVE_FROM, i.LOAD_DATE, i.RECORD_SOURCE
    FROM source_data AS i
)

SELECT * FROM records_to_insert
    );
  
[0m00:10:07.647072 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8156e2bb-c6c8-4f78-832d-18c4ded8eee2&page=queryresults
[0m00:10:09.520799 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (execute): 00:10:06.411066 => 00:10:09.520464
[0m00:10:09.522230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158e58e50>]}
[0m00:10:09.523113 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips  [[32mCREATE TABLE (20.0 rows, 960.0 Bytes processed)[0m in 3.15s]
[0m00:10:09.523921 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m00:10:09.524527 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m00:10:09.525458 [info ] [Thread-1 (]: 2 of 7 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips . [RUN]
[0m00:10:09.526474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_eff_sat_link_users_trips, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m00:10:09.526928 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m00:10:09.543886 [info ] [Thread-1 (]: 00:10:09 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m00:10:09.546768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m00:10:09.547483 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 00:10:09.527186 => 00:10:09.547290
[0m00:10:09.547802 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m00:10:09.552329 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m00:10:09.553252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:09.555041 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_sat_sql_trips_from_dbt_stg_trips AS a
)

SELECT * FROM records_to_insert
    );
  
[0m00:10:10.721168 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:46049445-bb3f-4fc8-aae2-476e02e51048&page=queryresults
[0m00:10:10.827486 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name SAT_SQL_TRIPS not found inside s at [24:14]; reason: invalidQuery, location: query, message: Name SAT_SQL_TRIPS not found inside s at [24:14]')
[0m00:10:12.092208 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5554327c-45c2-4edc-8991-e46ebd28a21c&page=queryresults
[0m00:10:12.194554 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5554327c-45c2-4edc-8991-e46ebd28a21c&page=queryresults
[0m00:10:12.203333 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 00:10:09.547990 => 00:10:12.197409
[0m00:10:12.216920 [debug] [Thread-1 (]: Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:10:12.218138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1587a6cb0>]}
[0m00:10:12.222966 [error] [Thread-1 (]: 2 of 7 ERROR creating sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[31mERROR[0m in 2.69s]
[0m00:10:12.223907 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m00:10:12.224595 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m00:10:12.227408 [info ] [Thread-1 (]: 3 of 7 START sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [RUN]
[0m00:10:12.232590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_ext_track_sat_trips, now model.dbt_bq_sa.dbt_multi_active_sat_users_plans)
[0m00:10:12.233311 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m00:10:12.262942 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m00:10:12.263849 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (compile): 00:10:12.233642 => 00:10:12.263625
[0m00:10:12.264196 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m00:10:12.274787 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m00:10:12.275899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:12.277233 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    
WITH source_data AS (
    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users` AS s
    WHERE s.USER_PK IS NOT NULL
        AND s.customer_plan IS NOT NULL
),

records_to_insert AS (
    SELECT source_data.USER_PK, source_data.customer_plan, source_data.user_type, source_data.HASHDIFF, source_data.EFFECTIVE_FROM, source_data.LOAD_DATE, source_data.RECORD_SOURCE
    FROM source_data
)

SELECT * FROM records_to_insert
    );
  
[0m00:10:13.383863 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:6b64fa2f-6a2f-4de0-93b6-a44e7f737af9&page=queryresults
[0m00:10:13.492334 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name HASHDIFF not found inside s at [19:64]; reason: invalidQuery, location: query, message: Name HASHDIFF not found inside s at [19:64]')
[0m00:10:14.922794 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2a4a307b-d268-4fca-b1c6-99b176a5c899&page=queryresults
[0m00:10:15.017185 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2a4a307b-d268-4fca-b1c6-99b176a5c899&page=queryresults
[0m00:10:15.019060 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (execute): 00:10:12.264387 => 00:10:15.018491
[0m00:10:15.023814 [debug] [Thread-1 (]: Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m00:10:15.025267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1587a4430>]}
[0m00:10:15.026807 [error] [Thread-1 (]: 3 of 7 ERROR creating sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [[31mERROR[0m in 2.80s]
[0m00:10:15.028016 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m00:10:15.028783 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:10:15.029831 [info ] [Thread-1 (]: 4 of 7 START sql incremental model citibike_source_sql.dbt_sat_sql_bikes ....... [RUN]
[0m00:10:15.033001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_multi_active_sat_users_plans, now model.dbt_bq_sa.dbt_sat_sql_bikes)
[0m00:10:15.036306 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:10:15.061264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m00:10:15.062318 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (compile): 00:10:15.036758 => 00:10:15.062037
[0m00:10:15.062737 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:10:15.067635 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m00:10:15.068449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:15.070766 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:10:16.145970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b9538b69-6af4-4d90-9e3f-3cc68ec609b4&page=queryresults
[0m00:10:18.067235 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (execute): 00:10:15.062954 => 00:10:18.066671
[0m00:10:18.069391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159194280>]}
[0m00:10:18.070899 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model citibike_source_sql.dbt_sat_sql_bikes .. [[32mCREATE TABLE (5.0 rows, 87.0 Bytes processed)[0m in 3.04s]
[0m00:10:18.071917 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:10:18.072661 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:10:18.073595 [info ] [Thread-1 (]: 5 of 7 START sql incremental model citibike_source_sql.dbt_sat_sql_stations .... [RUN]
[0m00:10:18.074857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_bikes, now model.dbt_bq_sa.dbt_sat_sql_stations)
[0m00:10:18.075697 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:10:18.120009 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m00:10:18.121100 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (compile): 00:10:18.076069 => 00:10:18.120874
[0m00:10:18.121491 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:10:18.132433 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m00:10:18.133099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:18.134368 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`
      
    partition by timestamp_trunc(load_date, day)
    cluster by STATION_PK

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:10:19.346757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c1606f33-8653-40ba-872a-89de206133e0&page=queryresults
[0m00:10:21.264115 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (execute): 00:10:18.121726 => 00:10:21.263462
[0m00:10:21.278481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1587a76a0>]}
[0m00:10:21.297123 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model citibike_source_sql.dbt_sat_sql_stations  [[32mCREATE TABLE (10.0 rows, 802.0 Bytes processed)[0m in 3.20s]
[0m00:10:21.298560 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:10:21.299394 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m00:10:21.300151 [info ] [Thread-1 (]: 6 of 7 START sql incremental model citibike_source_sql.dbt_sat_sql_trips ....... [RUN]
[0m00:10:21.301986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_stations, now model.dbt_bq_sa.dbt_sat_sql_trips)
[0m00:10:21.304314 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_trips
[0m00:10:21.345185 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m00:10:21.346181 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (compile): 00:10:21.304744 => 00:10:21.345957
[0m00:10:21.346556 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_trips
[0m00:10:21.351543 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m00:10:21.352099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:21.353943 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`
      
    partition by timestamp_trunc(load_date, day)
    cluster by TRIP_PK

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:10:22.018340 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b693b0e0-1c21-4b51-b141-a494a648b813&page=queryresults
[0m00:10:24.106507 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (execute): 00:10:21.346787 => 00:10:24.105989
[0m00:10:24.109525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1590a96c0>]}
[0m00:10:24.110658 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model citibike_source_sql.dbt_sat_sql_trips .. [[32mCREATE TABLE (20.0 rows, 1.1 KiB processed)[0m in 2.81s]
[0m00:10:24.111690 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m00:10:24.112375 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_users
[0m00:10:24.113335 [info ] [Thread-1 (]: 7 of 7 START sql incremental model citibike_source_sql.dbt sat_sql_users ....... [RUN]
[0m00:10:24.114718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_trips, now model.dbt_bq_sa.dbt_sat_sql_users)
[0m00:10:24.115373 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_users
[0m00:10:24.141392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m00:10:24.142358 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (compile): 00:10:24.115748 => 00:10:24.142133
[0m00:10:24.142723 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_users
[0m00:10:24.149317 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m00:10:24.149994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:24.151447 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`
      
    partition by timestamp_trunc(load_date, day)
    cluster by USER_PK

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:10:25.209215 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0156b307-7b00-4317-ad65-3b714e2df6dc&page=queryresults
[0m00:10:27.152751 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (execute): 00:10:24.142931 => 00:10:27.152149
[0m00:10:27.154951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0bbac3c-23e5-40f7-b353-59eaef0c54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1587a6320>]}
[0m00:10:27.156287 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model citibike_source_sql.dbt sat_sql_users .. [[32mCREATE TABLE (10.0 rows, 430.0 Bytes processed)[0m in 3.04s]
[0m00:10:27.157340 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_users
[0m00:10:27.170947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:27.171637 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_sat_sql_users' was properly closed.
[0m00:10:27.172310 [info ] [MainThread]: 
[0m00:10:27.172955 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 22.48 seconds (22.48s).
[0m00:10:27.175482 [debug] [MainThread]: Command end result
[0m00:10:27.198267 [info ] [MainThread]: 
[0m00:10:27.198781 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:10:27.199232 [info ] [MainThread]: 
[0m00:10:27.199594 [error] [MainThread]:   Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:10:27.199906 [info ] [MainThread]: 
[0m00:10:27.200324 [error] [MainThread]:   Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m00:10:27.200644 [info ] [MainThread]: 
[0m00:10:27.201005 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m00:10:27.208459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 24.052214, "process_user_time": 3.679073, "process_kernel_time": 1.422365, "process_mem_max_rss": "204439552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:10:27.209174 [debug] [MainThread]: Command `dbt run` failed at 00:10:27.209040 after 24.05 seconds
[0m00:10:27.209684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158a0c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158533f10>]}
[0m00:10:27.210114 [debug] [MainThread]: Flushing usage events
[0m00:22:56.789554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123adfb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123adff10>]}


============================== 00:22:56.841195 | 8f6e132e-26b9-45c9-8f73-1888806464a8 ==============================
[0m00:22:56.841195 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:22:56.841978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models path:models/raw_vault/sats', 'send_anonymous_usage_stats': 'True'}
[0m00:23:00.011867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222af100>]}
[0m00:23:00.050084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123a3f0d0>]}
[0m00:23:00.051224 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:23:00.089514 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:23:00.191280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m00:23:00.192123 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:23:00.192450 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m00:23:00.386997 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.business_vault
- models.stage
- models.raw_vault
[0m00:23:00.397072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f9ec0d0>]}
[0m00:23:00.480988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f98c3a0>]}
[0m00:23:00.481326 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m00:23:00.481538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f98e6e0>]}
[0m00:23:00.482923 [info ] [MainThread]: 
[0m00:23:00.483435 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:23:00.484419 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m00:23:00.484645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:01.704837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m00:23:01.706046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:02.096416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f98d720>]}
[0m00:23:02.100314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:23:02.100579 [info ] [MainThread]: 
[0m00:23:02.106022 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m00:23:02.106402 [info ] [Thread-1 (]: 1 of 7 START sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips ... [RUN]
[0m00:23:02.106826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.dbt_eff_sat_link_users_trips)
[0m00:23:02.107291 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m00:23:02.164066 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m00:23:02.172167 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (compile): 00:23:02.107496 => 00:23:02.171871
[0m00:23:02.172496 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m00:23:02.194853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:02.694667 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m00:23:02.695634 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_eff_sat_link_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` as DBT_INTERNAL_DEST
        using (

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS a
    WHERE a.USER_PK IS NOT NULL
    AND a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT * FROM (
        SELECT b.TRIP_PK, b.USER_PK, b.BIKE_PK, b.start_time, b.end_time, b.EFFECTIVE_FROM, b.LOAD_DATE, b.RECORD_SOURCE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` AS b
        QUALIFY ROW_NUMBER() OVER (
            PARTITION BY b.TRIP_PK
            ORDER BY b.LOAD_DATE DESC
        ) = 1
        ) AS inner_select
    
),

latest_open AS (
    SELECT c.TRIP_PK, c.USER_PK, c.BIKE_PK, c.start_time, c.end_time, c.EFFECTIVE_FROM, c.LOAD_DATE, c.RECORD_SOURCE
    FROM latest_records AS c
    WHERE DATE(c.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

latest_closed AS (
    SELECT d.TRIP_PK, d.USER_PK, d.BIKE_PK, d.start_time, d.end_time, d.EFFECTIVE_FROM, d.LOAD_DATE, d.RECORD_SOURCE
    FROM latest_records AS d
    WHERE DATE(d.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

new_open_records AS (
    SELECT DISTINCT
        f.TRIP_PK, f.USER_PK, f.BIKE_PK,
        f.start_time AS start_time,
        f.end_time AS end_time,
        f.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        f.LOAD_DATE,
        f.RECORD_SOURCE
    FROM source_data AS f
    LEFT JOIN latest_records AS lr
    ON f.TRIP_PK = lr.TRIP_PK
    WHERE lr.TRIP_PK IS NULL
),

new_reopened_records AS (
    SELECT DISTINCT
        lc.TRIP_PK, lc.USER_PK, lc.BIKE_PK,
        g.start_time AS start_time,
        g.end_time AS end_time,
        g.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        g.LOAD_DATE,
        g.RECORD_SOURCE
    FROM source_data AS g
    INNER JOIN latest_closed AS lc
    ON g.TRIP_PK = lc.TRIP_PK
    WHERE DATE(g.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),



new_closed_records AS (
    SELECT DISTINCT
        lo.TRIP_PK, lo.USER_PK, lo.BIKE_PK,
        h.start_time AS start_time,
        h.end_time AS end_time,
        h.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        h.LOAD_DATE,
        lo.RECORD_SOURCE
    FROM source_data AS h
    LEFT JOIN latest_open AS lo
    ON lo.TRIP_PK = h.TRIP_PK
    LEFT JOIN latest_closed AS lc
    ON lc.TRIP_PK = h.TRIP_PK
    WHERE DATE(h.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
    AND lo.TRIP_PK IS NOT NULL
    AND lc.TRIP_PK IS NULL
),

records_to_insert AS (
    SELECT * FROM new_open_records
    UNION DISTINCT
    SELECT * FROM new_reopened_records
    UNION DISTINCT
    SELECT * FROM new_closed_records
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m00:23:03.635808 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d8bc04a8-8b34-436d-9a9b-992a5f6bfca7&page=queryresults
[0m00:23:05.323833 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (execute): 00:23:02.172634 => 00:23:05.322850
[0m00:23:05.325308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f908df0>]}
[0m00:23:05.325959 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips  [[32mMERGE (0.0 rows, 3.5 KiB processed)[0m in 3.22s]
[0m00:23:05.326432 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m00:23:05.326783 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m00:23:05.327344 [info ] [Thread-1 (]: 2 of 7 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips . [RUN]
[0m00:23:05.328013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_eff_sat_link_users_trips, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m00:23:05.328264 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m00:23:05.341856 [info ] [Thread-1 (]: 00:23:05 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m00:23:05.346754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m00:23:05.347986 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 00:23:05.328446 => 00:23:05.347703
[0m00:23:05.348294 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m00:23:05.377169 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m00:23:05.377826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:05.379423 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.DBT_SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS a
)

SELECT * FROM records_to_insert
    );
  
[0m00:23:06.608740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e9c9bdb5-9475-4fde-b706-a8950d2e1d22&page=queryresults
[0m00:23:06.788645 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]; reason: invalidQuery, location: query, message: Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]')
[0m00:23:08.554546 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:95d69a5f-46ef-45a8-869d-eb343652d3d9&page=queryresults
[0m00:23:08.727449 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:95d69a5f-46ef-45a8-869d-eb343652d3d9&page=queryresults
[0m00:23:08.738065 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 00:23:05.348459 => 00:23:08.735908
[0m00:23:08.759953 [debug] [Thread-1 (]: Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:23:08.762193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fabc880>]}
[0m00:23:08.764783 [error] [Thread-1 (]: 2 of 7 ERROR creating sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[31mERROR[0m in 3.43s]
[0m00:23:08.765799 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m00:23:08.766512 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m00:23:08.775306 [info ] [Thread-1 (]: 3 of 7 START sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [RUN]
[0m00:23:08.776121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_ext_track_sat_trips, now model.dbt_bq_sa.dbt_multi_active_sat_users_plans)
[0m00:23:08.776438 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m00:23:08.799989 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m00:23:08.800621 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (compile): 00:23:08.776588 => 00:23:08.800481
[0m00:23:08.800866 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m00:23:08.805906 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m00:23:08.806577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:08.809052 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    
WITH source_data AS (
    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users` AS s
    WHERE s.USER_PK IS NOT NULL
        AND s.customer_plan IS NOT NULL
),

records_to_insert AS (
    SELECT source_data.USER_PK, source_data.customer_plan, source_data.user_type, source_data.HASHDIFF, source_data.EFFECTIVE_FROM, source_data.LOAD_DATE, source_data.RECORD_SOURCE
    FROM source_data
)

SELECT * FROM records_to_insert
    );
  
[0m00:23:10.007023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:be59e37d-b670-4ce4-8e52-e9d8b468ff34&page=queryresults
[0m00:23:10.106916 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name HASHDIFF not found inside s at [19:64]; reason: invalidQuery, location: query, message: Name HASHDIFF not found inside s at [19:64]')
[0m00:23:11.185577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c37b7963-07e8-4bdb-82c1-17761ed61429&page=queryresults
[0m00:23:11.289333 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c37b7963-07e8-4bdb-82c1-17761ed61429&page=queryresults
[0m00:23:11.292230 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (execute): 00:23:08.800997 => 00:23:11.291315
[0m00:23:11.298665 [debug] [Thread-1 (]: Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m00:23:11.300305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f98d3c0>]}
[0m00:23:11.301994 [error] [Thread-1 (]: 3 of 7 ERROR creating sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [[31mERROR[0m in 2.52s]
[0m00:23:11.303329 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m00:23:11.304586 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:23:11.306266 [info ] [Thread-1 (]: 4 of 7 START sql incremental model citibike_source_sql.dbt_sat_sql_bikes ....... [RUN]
[0m00:23:11.307694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_multi_active_sat_users_plans, now model.dbt_bq_sa.dbt_sat_sql_bikes)
[0m00:23:11.308244 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:23:11.361614 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m00:23:11.362353 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (compile): 00:23:11.308560 => 00:23:11.362186
[0m00:23:11.362630 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:23:11.366286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:11.367871 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.BIKE_PK, current_records.BIKE_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` AS current_records
    JOIN (
        SELECT DISTINCT source_data.BIKE_PK
        FROM source_data
    ) AS source_records
        ON source_records.BIKE_PK = current_records.BIKE_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.BIKE_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.BIKE_PK = frin.BIKE_PK
        AND lr.BIKE_HASHDIFF = frin.BIKE_HASHDIFF
        WHERE lr.BIKE_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:23:12.540100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:11eee681-e9a8-4111-ab3e-6c6a50994449&page=queryresults
[0m00:23:14.688712 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:23:14.691780 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m00:23:14.692901 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
                ) and (
                    DBT_INTERNAL_SOURCE.BIKE_HASHDIFF = DBT_INTERNAL_DEST.BIKE_HASHDIFF
                )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`BIKE_HASHDIFF` = DBT_INTERNAL_SOURCE.`BIKE_HASHDIFF`,`bike_type` = DBT_INTERNAL_SOURCE.`bike_type`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m00:23:15.015999 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:39f7f7aa-1701-48de-ba9c-079aaa5a80a5&page=queryresults
[0m00:23:16.436286 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (execute): 00:23:11.362786 => 00:23:16.435815
[0m00:23:16.438319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f9ef4f0>]}
[0m00:23:16.439412 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model citibike_source_sql.dbt_sat_sql_bikes .. [[32mMERGE (0.0 rows, 502.0 Bytes processed)[0m in 5.13s]
[0m00:23:16.440430 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:23:16.441089 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:23:16.441952 [info ] [Thread-1 (]: 5 of 7 START sql incremental model citibike_source_sql.dbt_sat_sql_stations .... [RUN]
[0m00:23:16.443186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_bikes, now model.dbt_bq_sa.dbt_sat_sql_stations)
[0m00:23:16.443827 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:23:16.478233 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m00:23:16.479283 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (compile): 00:23:16.444193 => 00:23:16.479057
[0m00:23:16.479655 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:23:16.497179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:16.498946 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by STATION_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.STATION_PK, current_records.STATION_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` AS current_records
    JOIN (
        SELECT DISTINCT source_data.STATION_PK
        FROM source_data
    ) AS source_records
        ON source_records.STATION_PK = current_records.STATION_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.STATION_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.STATION_PK = frin.STATION_PK
        AND lr.STATION_HASHDIFF = frin.STATION_HASHDIFF
        WHERE lr.STATION_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:23:17.600636 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:04e8fe51-31ac-4f5f-81bb-b92382083f59&page=queryresults
[0m00:23:19.976909 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:23:19.979354 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m00:23:19.980149 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
                ) and (
                    DBT_INTERNAL_SOURCE.STATION_HASHDIFF = DBT_INTERNAL_DEST.STATION_HASHDIFF
                )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`STATION_HASHDIFF` = DBT_INTERNAL_SOURCE.`STATION_HASHDIFF`,`name` = DBT_INTERNAL_SOURCE.`name`,`short_name` = DBT_INTERNAL_SOURCE.`short_name`,`latitude` = DBT_INTERNAL_SOURCE.`latitude`,`longitude` = DBT_INTERNAL_SOURCE.`longitude`,`region_id` = DBT_INTERNAL_SOURCE.`region_id`,`rental_method` = DBT_INTERNAL_SOURCE.`rental_method`,`capacity` = DBT_INTERNAL_SOURCE.`capacity`,`last_reported` = DBT_INTERNAL_SOURCE.`last_reported`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m00:23:20.284829 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:116c3d9d-81f2-4804-9e43-0e598fd18c86&page=queryresults
[0m00:23:21.915929 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (execute): 00:23:16.479867 => 00:23:21.915317
[0m00:23:21.917877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fbd3400>]}
[0m00:23:21.918638 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model citibike_source_sql.dbt_sat_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.47s]
[0m00:23:21.919653 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:23:21.920246 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m00:23:21.920662 [info ] [Thread-1 (]: 6 of 7 START sql incremental model citibike_source_sql.dbt_sat_sql_trips ....... [RUN]
[0m00:23:21.921490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_stations, now model.dbt_bq_sa.dbt_sat_sql_trips)
[0m00:23:21.921781 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_trips
[0m00:23:21.942772 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m00:23:21.943764 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (compile): 00:23:21.921938 => 00:23:21.943516
[0m00:23:21.944075 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_trips
[0m00:23:21.948420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:21.950266 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by TRIP_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.TRIP_PK, current_records.TRIP_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` AS current_records
    JOIN (
        SELECT DISTINCT source_data.TRIP_PK
        FROM source_data
    ) AS source_records
        ON source_records.TRIP_PK = current_records.TRIP_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.TRIP_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.TRIP_PK = frin.TRIP_PK
        AND lr.TRIP_HASHDIFF = frin.TRIP_HASHDIFF
        WHERE lr.TRIP_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:23:23.009749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2dd5de95-1b35-41de-ba68-fd7ad3ccfb1d&page=queryresults
[0m00:23:25.494585 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:23:25.508849 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m00:23:25.526171 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.TRIP_HASHDIFF = DBT_INTERNAL_DEST.TRIP_HASHDIFF
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`TRIP_HASHDIFF` = DBT_INTERNAL_SOURCE.`TRIP_HASHDIFF`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`trip_duration` = DBT_INTERNAL_SOURCE.`trip_duration`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m00:23:25.839079 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:76355191-3949-4259-a47a-6becd8769355&page=queryresults
[0m00:23:27.562835 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (execute): 00:23:21.944236 => 00:23:27.551513
[0m00:23:27.569883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fbbfdc0>]}
[0m00:23:27.580228 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model citibike_source_sql.dbt_sat_sql_trips .. [[32mMERGE (0.0 rows, 1.3 KiB processed)[0m in 5.64s]
[0m00:23:27.581685 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m00:23:27.590695 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_users
[0m00:23:27.594151 [info ] [Thread-1 (]: 7 of 7 START sql incremental model citibike_source_sql.dbt sat_sql_users ....... [RUN]
[0m00:23:27.594761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_trips, now model.dbt_bq_sa.dbt_sat_sql_users)
[0m00:23:27.595539 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_users
[0m00:23:27.630369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m00:23:27.631344 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (compile): 00:23:27.595683 => 00:23:27.631025
[0m00:23:27.631778 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_users
[0m00:23:27.636983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:23:27.640100 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by USER_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.USER_PK, current_records.USER_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` AS current_records
    JOIN (
        SELECT DISTINCT source_data.USER_PK
        FROM source_data
    ) AS source_records
        ON source_records.USER_PK = current_records.USER_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.USER_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.USER_PK = frin.USER_PK
        AND lr.USER_HASHDIFF = frin.USER_HASHDIFF
        WHERE lr.USER_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:23:28.832513 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:bd909f69-fec7-4d92-a661-01cd0e0f6949&page=queryresults
[0m00:23:31.185721 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:23:31.192121 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m00:23:31.194267 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
                ) and (
                    DBT_INTERNAL_SOURCE.USER_HASHDIFF = DBT_INTERNAL_DEST.USER_HASHDIFF
                )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`USER_HASHDIFF` = DBT_INTERNAL_SOURCE.`USER_HASHDIFF`,`user_type` = DBT_INTERNAL_SOURCE.`user_type`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`birth_year` = DBT_INTERNAL_SOURCE.`birth_year`,`customer_plan` = DBT_INTERNAL_SOURCE.`customer_plan`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m00:23:31.527207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e88c8008-6285-41f0-aafd-4ec1b84ba1e9&page=queryresults
[0m00:23:33.168826 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (execute): 00:23:27.631949 => 00:23:33.167894
[0m00:23:33.170558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f6e132e-26b9-45c9-8f73-1888806464a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f8d0df0>]}
[0m00:23:33.171568 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model citibike_source_sql.dbt sat_sql_users .. [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.58s]
[0m00:23:33.172346 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_users
[0m00:23:33.180664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:33.181300 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_sat_sql_users' was properly closed.
[0m00:23:33.182125 [info ] [MainThread]: 
[0m00:23:33.183081 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 32.70 seconds (32.70s).
[0m00:23:33.186875 [debug] [MainThread]: Command end result
[0m00:23:33.245038 [info ] [MainThread]: 
[0m00:23:33.245434 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:23:33.245665 [info ] [MainThread]: 
[0m00:23:33.245899 [error] [MainThread]:   Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:23:33.246124 [info ] [MainThread]: 
[0m00:23:33.246332 [error] [MainThread]:   Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m00:23:33.246551 [info ] [MainThread]: 
[0m00:23:33.247256 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m00:23:33.266281 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 36.615673, "process_user_time": 4.23278, "process_kernel_time": 1.410542, "process_mem_max_rss": "190644224", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:23:33.268316 [debug] [MainThread]: Command `dbt run` failed at 00:23:33.268184 after 36.62 seconds
[0m00:23:33.269301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1222af100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f9b0550>]}
[0m00:23:33.269895 [debug] [MainThread]: Flushing usage events
[0m00:24:00.459857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ab340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071aaf50>]}


============================== 00:24:00.463174 | 6467ec06-2ad5-4f22-bd56-542758c6ea1d ==============================
[0m00:24:00.463174 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:24:00.463497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models path:models/raw_vault/sats', 'send_anonymous_usage_stats': 'True'}
[0m00:24:01.344985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071aae60>]}
[0m00:24:01.375466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12636a7d0>]}
[0m00:24:01.375983 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:24:01.395168 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:24:01.447607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:24:01.448109 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:24:01.558151 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stage
- models.business_vault
- models.raw_vault
[0m00:24:01.561853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1363e1210>]}
[0m00:24:01.582826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1276c6290>]}
[0m00:24:01.583137 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m00:24:01.583335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1276c55a0>]}
[0m00:24:01.584561 [info ] [MainThread]: 
[0m00:24:01.585010 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:24:01.585768 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m00:24:01.586018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:02.351283 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m00:24:02.352888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:02.806526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1276723e0>]}
[0m00:24:02.808290 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:24:02.808925 [info ] [MainThread]: 
[0m00:24:02.884737 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m00:24:02.885264 [info ] [Thread-1 (]: 1 of 7 START sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips ... [RUN]
[0m00:24:02.885911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.dbt_eff_sat_link_users_trips)
[0m00:24:02.886204 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m00:24:02.941651 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m00:24:02.942237 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (compile): 00:24:02.886359 => 00:24:02.942097
[0m00:24:02.942457 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m00:24:02.961436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:03.534127 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m00:24:03.535440 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_eff_sat_link_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` as DBT_INTERNAL_DEST
        using (

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS a
    WHERE a.USER_PK IS NOT NULL
    AND a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT * FROM (
        SELECT b.TRIP_PK, b.USER_PK, b.BIKE_PK, b.start_time, b.end_time, b.EFFECTIVE_FROM, b.LOAD_DATE, b.RECORD_SOURCE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` AS b
        QUALIFY ROW_NUMBER() OVER (
            PARTITION BY b.TRIP_PK
            ORDER BY b.LOAD_DATE DESC
        ) = 1
        ) AS inner_select
    
),

latest_open AS (
    SELECT c.TRIP_PK, c.USER_PK, c.BIKE_PK, c.start_time, c.end_time, c.EFFECTIVE_FROM, c.LOAD_DATE, c.RECORD_SOURCE
    FROM latest_records AS c
    WHERE DATE(c.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

latest_closed AS (
    SELECT d.TRIP_PK, d.USER_PK, d.BIKE_PK, d.start_time, d.end_time, d.EFFECTIVE_FROM, d.LOAD_DATE, d.RECORD_SOURCE
    FROM latest_records AS d
    WHERE DATE(d.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

new_open_records AS (
    SELECT DISTINCT
        f.TRIP_PK, f.USER_PK, f.BIKE_PK,
        f.start_time AS start_time,
        f.end_time AS end_time,
        f.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        f.LOAD_DATE,
        f.RECORD_SOURCE
    FROM source_data AS f
    LEFT JOIN latest_records AS lr
    ON f.TRIP_PK = lr.TRIP_PK
    WHERE lr.TRIP_PK IS NULL
),

new_reopened_records AS (
    SELECT DISTINCT
        lc.TRIP_PK, lc.USER_PK, lc.BIKE_PK,
        g.start_time AS start_time,
        g.end_time AS end_time,
        g.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        g.LOAD_DATE,
        g.RECORD_SOURCE
    FROM source_data AS g
    INNER JOIN latest_closed AS lc
    ON g.TRIP_PK = lc.TRIP_PK
    WHERE DATE(g.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),



new_closed_records AS (
    SELECT DISTINCT
        lo.TRIP_PK, lo.USER_PK, lo.BIKE_PK,
        h.start_time AS start_time,
        h.end_time AS end_time,
        h.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        h.LOAD_DATE,
        lo.RECORD_SOURCE
    FROM source_data AS h
    LEFT JOIN latest_open AS lo
    ON lo.TRIP_PK = h.TRIP_PK
    LEFT JOIN latest_closed AS lc
    ON lc.TRIP_PK = h.TRIP_PK
    WHERE DATE(h.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
    AND lo.TRIP_PK IS NOT NULL
    AND lc.TRIP_PK IS NULL
),

records_to_insert AS (
    SELECT * FROM new_open_records
    UNION DISTINCT
    SELECT * FROM new_reopened_records
    UNION DISTINCT
    SELECT * FROM new_closed_records
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m00:24:04.457066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f1f3752d-5d8e-4bc0-b9d4-6a7434c66cdf&page=queryresults
[0m00:24:05.915840 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (execute): 00:24:02.942587 => 00:24:05.915429
[0m00:24:05.917294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1361cf160>]}
[0m00:24:05.918094 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips  [[32mMERGE (0.0 rows, 3.5 KiB processed)[0m in 3.03s]
[0m00:24:05.918804 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m00:24:05.919342 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m00:24:05.920101 [info ] [Thread-1 (]: 2 of 7 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips . [RUN]
[0m00:24:05.920969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_eff_sat_link_users_trips, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m00:24:05.921425 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m00:24:05.942485 [info ] [Thread-1 (]: 00:24:05 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m00:24:05.946118 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m00:24:05.946974 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 00:24:05.921681 => 00:24:05.946756
[0m00:24:05.947318 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m00:24:05.974667 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m00:24:05.975328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:05.976796 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_sat_sql_trips_from_dbt_stg_trips AS a
)

SELECT * FROM records_to_insert
    );
  
[0m00:24:07.140512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:cf7e6791-035a-4416-a05c-df49e382b8a5&page=queryresults
[0m00:24:07.262487 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name SAT_SQL_TRIPS not found inside s at [24:14]; reason: invalidQuery, location: query, message: Name SAT_SQL_TRIPS not found inside s at [24:14]')
[0m00:24:08.143322 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8943d344-ab96-417c-a358-1962559ffc55&page=queryresults
[0m00:24:08.258602 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8943d344-ab96-417c-a358-1962559ffc55&page=queryresults
[0m00:24:08.259598 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 00:24:05.947509 => 00:24:08.259300
[0m00:24:08.266663 [debug] [Thread-1 (]: Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:24:08.267235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1361cde40>]}
[0m00:24:08.267940 [error] [Thread-1 (]: 2 of 7 ERROR creating sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[31mERROR[0m in 2.35s]
[0m00:24:08.268464 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m00:24:08.273024 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m00:24:08.277738 [info ] [Thread-1 (]: 3 of 7 START sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [RUN]
[0m00:24:08.278531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_ext_track_sat_trips, now model.dbt_bq_sa.dbt_multi_active_sat_users_plans)
[0m00:24:08.278909 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m00:24:08.317228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m00:24:08.317834 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (compile): 00:24:08.279177 => 00:24:08.317687
[0m00:24:08.318072 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m00:24:08.321125 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m00:24:08.321502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:08.322452 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    
WITH source_data AS (
    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users` AS s
    WHERE s.USER_PK IS NOT NULL
        AND s.customer_plan IS NOT NULL
),

records_to_insert AS (
    SELECT source_data.USER_PK, source_data.customer_plan, source_data.user_type, source_data.HASHDIFF, source_data.EFFECTIVE_FROM, source_data.LOAD_DATE, source_data.RECORD_SOURCE
    FROM source_data
)

SELECT * FROM records_to_insert
    );
  
[0m00:24:09.371172 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:553464bc-6013-4d0d-b9f7-956cd9b525fc&page=queryresults
[0m00:24:09.471345 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name HASHDIFF not found inside s at [19:64]; reason: invalidQuery, location: query, message: Name HASHDIFF not found inside s at [19:64]')
[0m00:24:10.397140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:01d6c470-4eb8-4078-a5fb-cc3fb5125a57&page=queryresults
[0m00:24:10.503075 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:01d6c470-4eb8-4078-a5fb-cc3fb5125a57&page=queryresults
[0m00:24:10.504707 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (execute): 00:24:08.318207 => 00:24:10.504345
[0m00:24:10.509691 [debug] [Thread-1 (]: Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m00:24:10.510844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262414b0>]}
[0m00:24:10.511990 [error] [Thread-1 (]: 3 of 7 ERROR creating sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [[31mERROR[0m in 2.23s]
[0m00:24:10.512534 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m00:24:10.512890 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:24:10.513941 [info ] [Thread-1 (]: 4 of 7 START sql incremental model citibike_source_sql.dbt_sat_sql_bikes ....... [RUN]
[0m00:24:10.514663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_multi_active_sat_users_plans, now model.dbt_bq_sa.dbt_sat_sql_bikes)
[0m00:24:10.514925 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:24:10.567312 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m00:24:10.567953 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (compile): 00:24:10.515214 => 00:24:10.567817
[0m00:24:10.568171 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:24:10.572041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:10.580007 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.BIKE_PK, current_records.BIKE_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` AS current_records
    JOIN (
        SELECT DISTINCT source_data.BIKE_PK
        FROM source_data
    ) AS source_records
        ON source_records.BIKE_PK = current_records.BIKE_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.BIKE_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.BIKE_PK = frin.BIKE_PK
        AND lr.BIKE_HASHDIFF = frin.BIKE_HASHDIFF
        WHERE lr.BIKE_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:24:11.741434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:ec6be253-5de7-491d-94b6-ca9605d2d74b&page=queryresults
[0m00:24:13.808631 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:24:13.810555 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m00:24:13.811616 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
                ) and (
                    DBT_INTERNAL_SOURCE.BIKE_HASHDIFF = DBT_INTERNAL_DEST.BIKE_HASHDIFF
                )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`BIKE_HASHDIFF` = DBT_INTERNAL_SOURCE.`BIKE_HASHDIFF`,`bike_type` = DBT_INTERNAL_SOURCE.`bike_type`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m00:24:14.135189 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:85f15041-5597-4894-b65a-2504ec3dbea3&page=queryresults
[0m00:24:15.588897 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (execute): 00:24:10.568295 => 00:24:15.587500
[0m00:24:15.593598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378ace50>]}
[0m00:24:15.595621 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model citibike_source_sql.dbt_sat_sql_bikes .. [[32mMERGE (0.0 rows, 502.0 Bytes processed)[0m in 5.08s]
[0m00:24:15.596604 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:24:15.597229 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:24:15.598140 [info ] [Thread-1 (]: 5 of 7 START sql incremental model citibike_source_sql.dbt_sat_sql_stations .... [RUN]
[0m00:24:15.599472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_bikes, now model.dbt_bq_sa.dbt_sat_sql_stations)
[0m00:24:15.600349 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:24:15.644003 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m00:24:15.645058 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (compile): 00:24:15.600780 => 00:24:15.644843
[0m00:24:15.645346 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:24:15.691836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:16.098618 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by STATION_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.STATION_PK, current_records.STATION_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` AS current_records
    JOIN (
        SELECT DISTINCT source_data.STATION_PK
        FROM source_data
    ) AS source_records
        ON source_records.STATION_PK = current_records.STATION_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.STATION_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.STATION_PK = frin.STATION_PK
        AND lr.STATION_HASHDIFF = frin.STATION_HASHDIFF
        WHERE lr.STATION_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:24:17.332054 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:ccbd471d-a276-49b8-b2cc-b51ff95c0ab6&page=queryresults
[0m00:24:19.693894 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:24:19.700444 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m00:24:19.702408 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
                ) and (
                    DBT_INTERNAL_SOURCE.STATION_HASHDIFF = DBT_INTERNAL_DEST.STATION_HASHDIFF
                )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`STATION_HASHDIFF` = DBT_INTERNAL_SOURCE.`STATION_HASHDIFF`,`name` = DBT_INTERNAL_SOURCE.`name`,`short_name` = DBT_INTERNAL_SOURCE.`short_name`,`latitude` = DBT_INTERNAL_SOURCE.`latitude`,`longitude` = DBT_INTERNAL_SOURCE.`longitude`,`region_id` = DBT_INTERNAL_SOURCE.`region_id`,`rental_method` = DBT_INTERNAL_SOURCE.`rental_method`,`capacity` = DBT_INTERNAL_SOURCE.`capacity`,`last_reported` = DBT_INTERNAL_SOURCE.`last_reported`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m00:24:20.046791 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:bd94ffe2-e583-4bbf-9176-bbe89af44fb5&page=queryresults
[0m00:24:21.724658 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (execute): 00:24:15.645476 => 00:24:21.720079
[0m00:24:21.726440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136176e30>]}
[0m00:24:21.727261 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model citibike_source_sql.dbt_sat_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 6.13s]
[0m00:24:21.727691 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:24:21.728001 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m00:24:21.728561 [info ] [Thread-1 (]: 6 of 7 START sql incremental model citibike_source_sql.dbt_sat_sql_trips ....... [RUN]
[0m00:24:21.729549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_stations, now model.dbt_bq_sa.dbt_sat_sql_trips)
[0m00:24:21.729879 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_trips
[0m00:24:21.870692 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m00:24:21.880907 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (compile): 00:24:21.730046 => 00:24:21.876716
[0m00:24:21.881340 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_trips
[0m00:24:21.914261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:21.926722 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by TRIP_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.TRIP_PK, current_records.TRIP_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` AS current_records
    JOIN (
        SELECT DISTINCT source_data.TRIP_PK
        FROM source_data
    ) AS source_records
        ON source_records.TRIP_PK = current_records.TRIP_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.TRIP_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.TRIP_PK = frin.TRIP_PK
        AND lr.TRIP_HASHDIFF = frin.TRIP_HASHDIFF
        WHERE lr.TRIP_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:24:23.098525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:58ba6ec8-5f5c-463c-a838-5bfaf6492f88&page=queryresults
[0m00:24:25.207462 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:24:25.212585 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m00:24:25.214053 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.TRIP_HASHDIFF = DBT_INTERNAL_DEST.TRIP_HASHDIFF
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`TRIP_HASHDIFF` = DBT_INTERNAL_SOURCE.`TRIP_HASHDIFF`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`trip_duration` = DBT_INTERNAL_SOURCE.`trip_duration`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m00:24:25.530759 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:3aecf3ee-371f-4f13-9d09-d812e760feba&page=queryresults
[0m00:24:26.933769 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (execute): 00:24:21.881488 => 00:24:26.932908
[0m00:24:26.935896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13612ceb0>]}
[0m00:24:26.942757 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model citibike_source_sql.dbt_sat_sql_trips .. [[32mMERGE (0.0 rows, 1.3 KiB processed)[0m in 5.21s]
[0m00:24:26.944254 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m00:24:26.945034 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_users
[0m00:24:26.946269 [info ] [Thread-1 (]: 7 of 7 START sql incremental model citibike_source_sql.dbt sat_sql_users ....... [RUN]
[0m00:24:26.947714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_trips, now model.dbt_bq_sa.dbt_sat_sql_users)
[0m00:24:26.948348 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_users
[0m00:24:26.998147 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m00:24:26.999467 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (compile): 00:24:26.948716 => 00:24:26.999189
[0m00:24:26.999906 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_users
[0m00:24:27.041525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:24:27.047959 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by USER_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`stg_sql_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.USER_PK, current_records.USER_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` AS current_records
    JOIN (
        SELECT DISTINCT source_data.USER_PK
        FROM source_data
    ) AS source_records
        ON source_records.USER_PK = current_records.USER_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.USER_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.USER_PK = frin.USER_PK
        AND lr.USER_HASHDIFF = frin.USER_HASHDIFF
        WHERE lr.USER_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:24:28.148474 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:cce8de94-8b91-4eca-8727-0c0c7dbc390a&page=queryresults
[0m00:24:30.524885 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:24:30.530889 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m00:24:30.532734 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
                ) and (
                    DBT_INTERNAL_SOURCE.USER_HASHDIFF = DBT_INTERNAL_DEST.USER_HASHDIFF
                )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`USER_HASHDIFF` = DBT_INTERNAL_SOURCE.`USER_HASHDIFF`,`user_type` = DBT_INTERNAL_SOURCE.`user_type`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`birth_year` = DBT_INTERNAL_SOURCE.`birth_year`,`customer_plan` = DBT_INTERNAL_SOURCE.`customer_plan`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m00:24:30.830456 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a544052c-777f-44a5-9509-f797709c6bf8&page=queryresults
[0m00:24:32.178486 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (execute): 00:24:27.000137 => 00:24:32.177738
[0m00:24:32.180639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6467ec06-2ad5-4f22-bd56-542758c6ea1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12636b7c0>]}
[0m00:24:32.182001 [info ] [Thread-1 (]: 7 of 7 OK created sql incremental model citibike_source_sql.dbt sat_sql_users .. [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.23s]
[0m00:24:32.183003 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_users
[0m00:24:32.188059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:32.188486 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_sat_sql_users' was properly closed.
[0m00:24:32.188957 [info ] [MainThread]: 
[0m00:24:32.189400 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 30.60 seconds (30.60s).
[0m00:24:32.191456 [debug] [MainThread]: Command end result
[0m00:24:32.216946 [info ] [MainThread]: 
[0m00:24:32.217522 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m00:24:32.217910 [info ] [MainThread]: 
[0m00:24:32.218243 [error] [MainThread]:   Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:24:32.218543 [info ] [MainThread]: 
[0m00:24:32.218831 [error] [MainThread]:   Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m00:24:32.219182 [info ] [MainThread]: 
[0m00:24:32.220909 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m00:24:32.260676 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 31.864212, "process_user_time": 3.66353, "process_kernel_time": 1.483881, "process_mem_max_rss": "202866688", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:24:32.262693 [debug] [MainThread]: Command `dbt run` failed at 00:24:32.262269 after 31.87 seconds
[0m00:24:32.264020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10512e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127757130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1378db3d0>]}
[0m00:24:32.264432 [debug] [MainThread]: Flushing usage events
[0m00:26:51.943455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a069b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a83340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a82f50>]}


============================== 00:26:51.946693 | b1da88eb-9b24-4ba7-a768-36a1e97685b9 ==============================
[0m00:26:51.946693 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:26:51.947014 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models path:models/raw_vault/sats', 'send_anonymous_usage_stats': 'True'}
[0m00:26:52.916894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1da88eb-9b24-4ba7-a768-36a1e97685b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a82e60>]}
[0m00:26:52.949053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1da88eb-9b24-4ba7-a768-36a1e97685b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a299c0>]}
[0m00:26:52.949982 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:26:52.978255 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:26:53.054361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:26:53.054919 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:26:53.141738 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  'dict object' has no attribute 'sat_name'
  
  > in macro bigquery__xts (macros/tables/bigquery/xts.sql)
  > called by macro xts (macros/tables/snowflake/xts.sql)
  > called by model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
[0m00:26:53.143326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2644113, "process_user_time": 2.378325, "process_kernel_time": 1.254322, "process_mem_max_rss": "192495616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:26:53.144301 [debug] [MainThread]: Command `dbt run` failed at 00:26:53.144008 after 1.27 seconds
[0m00:26:53.144666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a069b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148fabfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148fab970>]}
[0m00:26:53.145255 [debug] [MainThread]: Flushing usage events
[0m00:31:50.565740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761af80>]}


============================== 00:31:50.568700 | fa62adf6-dfc6-45d3-8bd4-61222a9fdc10 ==============================
[0m00:31:50.568700 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:31:50.569013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models path:models/raw_vault', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:31:52.815623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa62adf6-dfc6-45d3-8bd4-61222a9fdc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761ae90>]}
[0m00:31:52.846580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa62adf6-dfc6-45d3-8bd4-61222a9fdc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147c6e7d0>]}
[0m00:31:52.847836 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:31:52.879982 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:31:52.939192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:31:52.939659 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:31:52.939886 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:31:52.940099 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m00:31:52.940300 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:31:52.940491 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m00:31:52.940690 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:31:52.940886 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m00:31:52.941080 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m00:31:53.242733 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  'dict object' has no attribute 'sat_name'
  
  > in macro bigquery__xts (macros/tables/bigquery/xts.sql)
  > called by macro xts (macros/tables/snowflake/xts.sql)
  > called by model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
[0m00:31:53.244470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 2.73729, "process_user_time": 2.290509, "process_kernel_time": 0.877581, "process_mem_max_rss": "196034560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:31:53.244747 [debug] [MainThread]: Command `dbt run` failed at 00:31:53.244675 after 2.74 seconds
[0m00:31:53.244968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ab73d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147fba6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1480705e0>]}
[0m00:31:53.245187 [debug] [MainThread]: Flushing usage events
[0m00:34:33.690272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109887340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109886f50>]}


============================== 00:34:33.693385 | 2800392a-4e77-4e72-9eba-959390d83e0a ==============================
[0m00:34:33.693385 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:34:33.693698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models path:models/raw_vault', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:34:34.536956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2800392a-4e77-4e72-9eba-959390d83e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109886e60>]}
[0m00:34:34.565837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2800392a-4e77-4e72-9eba-959390d83e0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10982e350>]}
[0m00:34:34.566296 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:34:34.583949 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:34:34.641904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:34:34.642368 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:34:34.642603 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m00:34:34.642813 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m00:34:34.643011 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:34:34.643208 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m00:34:34.643400 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m00:34:34.643590 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:34:34.643779 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:34:34.861332 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  'str object' has no attribute 'values'
  
  > in macro bigquery__xts (macros/tables/bigquery/xts.sql)
  > called by macro xts (macros/tables/snowflake/xts.sql)
  > called by model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
[0m00:34:34.863179 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.208716, "process_user_time": 2.276419, "process_kernel_time": 1.30293, "process_mem_max_rss": "204177408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:34:34.863629 [debug] [MainThread]: Command `dbt run` failed at 00:34:34.863526 after 1.21 seconds
[0m00:34:34.863916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10780b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1256983d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125698610>]}
[0m00:34:34.864236 [debug] [MainThread]: Flushing usage events
[0m00:40:33.600651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051729b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ef370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071eef80>]}


============================== 00:40:33.603694 | b0d4f039-f96c-465c-a3bf-52d789790f4d ==============================
[0m00:40:33.603694 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:40:33.604017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:40:34.500774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0d4f039-f96c-465c-a3bf-52d789790f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071eee90>]}
[0m00:40:34.530427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0d4f039-f96c-465c-a3bf-52d789790f4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107198250>]}
[0m00:40:34.530899 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:40:34.554744 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:40:34.614972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:40:34.615433 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m00:40:34.615655 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:40:34.615863 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m00:40:34.616064 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:40:34.616262 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m00:40:34.616457 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m00:40:34.616645 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:40:34.616835 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:40:34.815637 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  'str object' has no attribute 'values'
  
  > in macro bigquery__xts (macros/tables/bigquery/xts.sql)
  > called by macro xts (macros/tables/snowflake/xts.sql)
  > called by model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
[0m00:40:34.817255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2514232, "process_user_time": 2.56135, "process_kernel_time": 1.018779, "process_mem_max_rss": "201113600", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:40:34.817559 [debug] [MainThread]: Command `dbt run` failed at 00:40:34.817487 after 1.25 seconds
[0m00:40:34.817810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051729b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1242feb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12455f9a0>]}
[0m00:40:34.818030 [debug] [MainThread]: Flushing usage events
[0m00:40:55.465507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10359f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561af80>]}


============================== 00:40:55.468777 | 50d99c46-afb9-4410-8859-ae9b357a1ee8 ==============================
[0m00:40:55.468777 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:40:55.469085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:40:56.316389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50d99c46-afb9-4410-8859-ae9b357a1ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561ae90>]}
[0m00:40:56.349445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50d99c46-afb9-4410-8859-ae9b357a1ee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10557f880>]}
[0m00:40:56.350057 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:40:56.375528 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:40:56.434661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:40:56.435138 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:40:56.435363 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m00:40:56.435568 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m00:40:56.435767 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m00:40:56.435968 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:40:56.436169 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:40:56.436359 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:40:56.436543 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m00:40:56.761938 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  'str object' has no attribute 'values'
  
  > in macro bigquery__xts (macros/tables/bigquery/xts.sql)
  > called by macro xts (macros/tables/snowflake/xts.sql)
  > called by model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
[0m00:40:56.763923 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3352975, "process_user_time": 2.466799, "process_kernel_time": 1.222563, "process_mem_max_rss": "202047488", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:40:56.764367 [debug] [MainThread]: Command `dbt run` failed at 00:40:56.764200 after 1.34 seconds
[0m00:40:56.764607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10359f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11058c7c0>]}
[0m00:40:56.764847 [debug] [MainThread]: Flushing usage events
[0m00:42:07.881562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b6f50>]}


============================== 00:42:07.884629 | f48510c4-153f-4f43-b24e-cc6e068f70a1 ==============================
[0m00:42:07.884629 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:42:07.884950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models path:models/raw_vault/hubs', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:42:08.691485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f48510c4-153f-4f43-b24e-cc6e068f70a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070b6e60>]}
[0m00:42:08.721271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f48510c4-153f-4f43-b24e-cc6e068f70a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10705c310>]}
[0m00:42:08.721793 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:42:08.738868 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:42:08.812684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:42:08.813169 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m00:42:08.813394 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m00:42:08.813602 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:42:08.813809 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:42:08.814016 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m00:42:08.814218 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m00:42:08.814411 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:42:08.814601 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:42:09.143389 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  'str object' has no attribute 'values'
  
  > in macro bigquery__xts (macros/tables/bigquery/xts.sql)
  > called by macro xts (macros/tables/snowflake/xts.sql)
  > called by model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
[0m00:42:09.144868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2964818, "process_user_time": 2.593626, "process_kernel_time": 1.196882, "process_mem_max_rss": "201523200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:42:09.145162 [debug] [MainThread]: Command `dbt run` failed at 00:42:09.145091 after 1.30 seconds
[0m00:42:09.145387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503a9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eda83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eda8610>]}
[0m00:42:09.145619 [debug] [MainThread]: Flushing usage events
[0m00:43:30.456437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038069b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b2f50>]}


============================== 00:43:30.459570 | 3f5b09ea-08c6-493b-99b6-beb88e75cfb8 ==============================
[0m00:43:30.459570 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:43:30.459899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models path:models/raw_vault/hubs', 'send_anonymous_usage_stats': 'True'}
[0m00:43:31.306698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f5b09ea-08c6-493b-99b6-beb88e75cfb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b2e60>]}
[0m00:43:31.336103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f5b09ea-08c6-493b-99b6-beb88e75cfb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585cb20>]}
[0m00:43:31.336577 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:43:31.362379 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:43:31.418672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:43:31.419173 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m00:43:31.419393 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:43:31.419604 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:43:31.419805 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:43:31.420003 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m00:43:31.420192 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m00:43:31.420382 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:43:31.420585 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m00:43:31.580958 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  'str object' has no attribute 'values'
  
  > in macro bigquery__xts (macros/tables/bigquery/xts.sql)
  > called by macro xts (macros/tables/snowflake/xts.sql)
  > called by model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
[0m00:43:31.582623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1643107, "process_user_time": 2.181511, "process_kernel_time": 1.401307, "process_mem_max_rss": "205078528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:43:31.582891 [debug] [MainThread]: Command `dbt run` failed at 00:43:31.582825 after 1.16 seconds
[0m00:43:31.583119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038069b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209843d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120984610>]}
[0m00:43:31.583333 [debug] [MainThread]: Flushing usage events
[0m00:43:47.211898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f7b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105027370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105026f80>]}


============================== 00:43:47.214783 | 08420fdf-0fa9-4e0a-8105-040552f40046 ==============================
[0m00:43:47.214783 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:43:47.215097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models path:models/raw_vault/hubs', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:43:48.014247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08420fdf-0fa9-4e0a-8105-040552f40046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105026e90>]}
[0m00:43:48.043333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08420fdf-0fa9-4e0a-8105-040552f40046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fccfa0>]}
[0m00:43:48.043772 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:43:48.067361 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:43:48.118030 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:43:48.118508 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m00:43:48.118733 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m00:43:48.118935 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:43:48.119134 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:43:48.119326 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m00:43:48.119516 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:43:48.119707 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:43:48.119894 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m00:43:48.328415 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  'str object' has no attribute 'values'
  
  > in macro bigquery__xts (macros/tables/bigquery/xts.sql)
  > called by macro xts (macros/tables/snowflake/xts.sql)
  > called by model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
[0m00:43:48.329997 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1517607, "process_user_time": 2.490952, "process_kernel_time": 1.177706, "process_mem_max_rss": "203407360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:43:48.330266 [debug] [MainThread]: Command `dbt run` failed at 00:43:48.330200 after 1.15 seconds
[0m00:43:48.330482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f7b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1237043d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123704610>]}
[0m00:43:48.330692 [debug] [MainThread]: Flushing usage events
[0m00:44:03.273949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122df370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122def80>]}


============================== 00:44:03.276942 | dd25e426-a46d-4d68-b751-4385f5862164 ==============================
[0m00:44:03.276942 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:44:03.277257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models path:models/raw_vault/hubs', 'send_anonymous_usage_stats': 'True'}
[0m00:44:04.083141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd25e426-a46d-4d68-b751-4385f5862164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122dee90>]}
[0m00:44:04.113327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd25e426-a46d-4d68-b751-4385f5862164', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112284e80>]}
[0m00:44:04.113885 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:44:04.135972 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:44:04.184751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:44:04.185299 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m00:44:04.185538 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m00:44:04.185745 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:44:04.185948 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:44:04.186149 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:44:04.186340 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m00:44:04.186524 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m00:44:04.186709 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:44:04.375368 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  'str object' has no attribute 'values'
  
  > in macro bigquery__xts (macros/tables/bigquery/xts.sql)
  > called by macro xts (macros/tables/snowflake/xts.sql)
  > called by model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
[0m00:44:04.377034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1363744, "process_user_time": 2.435418, "process_kernel_time": 1.182842, "process_mem_max_rss": "205340672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:44:04.377363 [debug] [MainThread]: Command `dbt run` failed at 00:44:04.377279 after 1.14 seconds
[0m00:44:04.377608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a38c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a38c610>]}
[0m00:44:04.377837 [debug] [MainThread]: Flushing usage events
[0m00:44:15.703080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140df340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140def50>]}


============================== 00:44:15.705881 | 0c4a0dd7-f7ff-477b-b4ba-0ab1a2d5a7da ==============================
[0m00:44:15.705881 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:44:15.706195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models path:models/raw_vault/hubs', 'send_anonymous_usage_stats': 'True'}
[0m00:44:16.511900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c4a0dd7-f7ff-477b-b4ba-0ab1a2d5a7da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140dee60>]}
[0m00:44:16.541506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c4a0dd7-f7ff-477b-b4ba-0ab1a2d5a7da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140855d0>]}
[0m00:44:16.541996 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:44:16.558846 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:44:16.608962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:44:16.609412 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:44:16.609630 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m00:44:16.609832 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m00:44:16.610032 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m00:44:16.610229 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:44:16.610425 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:44:16.610611 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m00:44:16.610799 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:44:16.876731 [error] [MainThread]: Encountered an error:
Compilation Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  'dict object' has no attribute 'sat_name'
  
  > in macro bigquery__xts (macros/tables/bigquery/xts.sql)
  > called by macro xts (macros/tables/snowflake/xts.sql)
  > called by model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
[0m00:44:16.878346 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2080997, "process_user_time": 2.477352, "process_kernel_time": 1.200375, "process_mem_max_rss": "204210176", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:44:16.878600 [debug] [MainThread]: Command `dbt run` failed at 00:44:16.878536 after 1.21 seconds
[0m00:44:16.878810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b9e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154c0c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154c0c610>]}
[0m00:44:16.879011 [debug] [MainThread]: Flushing usage events
[0m00:58:53.613923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119cdf430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119cdef80>]}


============================== 00:58:53.617107 | 23625018-67da-4754-8912-8580eb5faec8 ==============================
[0m00:58:53.617107 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:58:53.617415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models path:models/raw_vault/sats', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:58:54.619390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23625018-67da-4754-8912-8580eb5faec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119cdee90>]}
[0m00:58:54.652948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23625018-67da-4754-8912-8580eb5faec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1278c1510>]}
[0m00:58:54.653607 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:58:54.679794 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:58:54.737236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:58:54.737694 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:58:54.737921 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m00:58:54.738135 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m00:58:54.738344 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:58:54.738542 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:58:54.738736 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:58:54.738923 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m00:58:54.739116 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m00:58:55.150372 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.dbt_ext_track_sat_trips' (models/raw_vault/sats/dbt_ext_track_sat_trips.sql) depends on a node named 'dbt_stg_sql_trips' which was not found
[0m00:58:55.152387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.578211, "process_user_time": 2.925358, "process_kernel_time": 0.611208, "process_mem_max_rss": "198492160", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:58:55.152740 [debug] [MainThread]: Command `dbt run` failed at 00:58:55.152655 after 1.58 seconds
[0m00:58:55.152990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076a3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1576b6b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15772f0d0>]}
[0m00:58:55.153244 [debug] [MainThread]: Flushing usage events
[0m00:59:03.066086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f7370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f6f80>]}


============================== 00:59:03.068938 | d9e7f257-a3ff-421f-a3a1-158e84d211b4 ==============================
[0m00:59:03.068938 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:59:03.069252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:59:03.638035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9e7f257-a3ff-421f-a3a1-158e84d211b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f6e90>]}
[0m00:59:03.667592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9e7f257-a3ff-421f-a3a1-158e84d211b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fb6d630>]}
[0m00:59:03.668078 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:59:03.687534 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:59:03.741170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:59:03.741768 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:59:03.742044 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m00:59:03.742257 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m00:59:03.742464 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m00:59:03.742837 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:59:03.743346 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m00:59:03.745715 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:59:03.747009 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:59:04.071600 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.dbt_ext_track_sat_trips' (models/raw_vault/sats/dbt_ext_track_sat_trips.sql) depends on a node named 'dbt_stg_sql_trips' which was not found
[0m00:59:04.075668 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0419068, "process_user_time": 2.401963, "process_kernel_time": 1.335608, "process_mem_max_rss": "205242368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:59:04.075992 [debug] [MainThread]: Command `dbt run` failed at 00:59:04.075915 after 1.04 seconds
[0m00:59:04.076235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ff470a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148108610>]}
[0m00:59:04.076461 [debug] [MainThread]: Flushing usage events
[0m00:59:28.375183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036b69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062df370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062def80>]}


============================== 00:59:28.378099 | 68a8ab1e-988b-461c-9d03-69740505118a ==============================
[0m00:59:28.378099 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:59:28.378422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:59:29.179479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dee90>]}
[0m00:59:29.209239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106284fa0>]}
[0m00:59:29.209739 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m00:59:29.226880 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:59:29.283886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
[0m00:59:29.284346 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_trips.sql
[0m00:59:29.284570 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m00:59:29.284776 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m00:59:29.284975 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/hubs/dbt_hub_sql_users.sql
[0m00:59:29.285170 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m00:59:29.285363 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m00:59:29.285553 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m00:59:29.285744 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/links/dbt_link_sql_users_bikes.sql
[0m00:59:29.606321 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stage
- models.raw_vault
- models.business_vault
[0m00:59:29.609829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146ef10f0>]}
[0m00:59:29.620898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146912830>]}
[0m00:59:29.621230 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m00:59:29.621431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146911b40>]}
[0m00:59:29.622680 [info ] [MainThread]: 
[0m00:59:29.623101 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:59:29.624140 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m00:59:29.624359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:59:30.444729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m00:59:30.445607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:59:31.045577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146911f90>]}
[0m00:59:31.046949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:59:31.047484 [info ] [MainThread]: 
[0m00:59:31.050468 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_bikes
[0m00:59:31.051082 [info ] [Thread-1 (]: 1 of 22 START sql view model citibike_source_sql.raw_sql_bikes ................. [RUN]
[0m00:59:31.051927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.raw_sql_bikes)
[0m00:59:31.052395 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_bikes
[0m00:59:31.064605 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_bikes"
[0m00:59:31.066367 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (compile): 00:59:31.052688 => 00:59:31.066067
[0m00:59:31.066817 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_bikes
[0m00:59:31.095465 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_bikes"
[0m00:59:31.096139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:31.097360 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_bikes`;


[0m00:59:31.777803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d616ebfa-dd5f-4de6-9d19-ae9704c4034c&page=queryresults
[0m00:59:32.331782 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (execute): 00:59:31.067076 => 00:59:32.331637
[0m00:59:32.332347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f57e20>]}
[0m00:59:32.332710 [info ] [Thread-1 (]: 1 of 22 OK created sql view model citibike_source_sql.raw_sql_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m00:59:32.333044 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_bikes
[0m00:59:32.333280 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_stations
[0m00:59:32.333600 [info ] [Thread-1 (]: 2 of 22 START sql view model citibike_source_sql.raw_sql_stations .............. [RUN]
[0m00:59:32.333972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_bikes, now model.dbt_bq_sa.raw_sql_stations)
[0m00:59:32.334172 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_stations
[0m00:59:32.337130 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_stations"
[0m00:59:32.338033 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (compile): 00:59:32.334289 => 00:59:32.337898
[0m00:59:32.338255 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_stations
[0m00:59:32.341271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_stations"
[0m00:59:32.342364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:32.343263 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_stations`;


[0m00:59:33.099264 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:00bfa6ce-d81d-4746-afec-1403d1737cf5&page=queryresults
[0m00:59:33.489723 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (execute): 00:59:32.338381 => 00:59:33.489263
[0m00:59:33.490939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f6f250>]}
[0m00:59:33.492088 [info ] [Thread-1 (]: 2 of 22 OK created sql view model citibike_source_sql.raw_sql_stations ......... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m00:59:33.493031 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_stations
[0m00:59:33.493705 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_trips
[0m00:59:33.494622 [info ] [Thread-1 (]: 3 of 22 START sql view model citibike_source_sql.raw_sql_trips ................. [RUN]
[0m00:59:33.495941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_stations, now model.dbt_bq_sa.raw_sql_trips)
[0m00:59:33.496516 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_trips
[0m00:59:33.503414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_trips"
[0m00:59:33.504773 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (compile): 00:59:33.496857 => 00:59:33.504431
[0m00:59:33.505247 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_trips
[0m00:59:33.512875 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_trips"
[0m00:59:33.513951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:33.515792 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_trips`;


[0m00:59:34.219981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:9ed11b21-6d07-446b-a5b9-f403ccf2724f&page=queryresults
[0m00:59:34.688868 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (execute): 00:59:33.505519 => 00:59:34.688412
[0m00:59:34.691051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f7bac0>]}
[0m00:59:34.692252 [info ] [Thread-1 (]: 3 of 22 OK created sql view model citibike_source_sql.raw_sql_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m00:59:34.693170 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_trips
[0m00:59:34.693837 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_users
[0m00:59:34.694694 [info ] [Thread-1 (]: 4 of 22 START sql view model citibike_source_sql.raw_sql_users ................. [RUN]
[0m00:59:34.695976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_trips, now model.dbt_bq_sa.raw_sql_users)
[0m00:59:34.696533 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_users
[0m00:59:34.702783 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_users"
[0m00:59:34.703874 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (compile): 00:59:34.696857 => 00:59:34.703587
[0m00:59:34.704349 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_users
[0m00:59:34.711144 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_users"
[0m00:59:34.712667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:34.714941 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_users`;


[0m00:59:35.527625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f0029392-23b0-465a-b611-4a2d30e8a26a&page=queryresults
[0m00:59:35.878425 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (execute): 00:59:34.704626 => 00:59:35.877995
[0m00:59:35.880539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f66680>]}
[0m00:59:35.881842 [info ] [Thread-1 (]: 4 of 22 OK created sql view model citibike_source_sql.raw_sql_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m00:59:35.882794 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_users
[0m00:59:35.883472 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m00:59:35.884375 [info ] [Thread-1 (]: 5 of 22 START sql view model citibike_source_sql.dbt_stg_sql_bikes ............. [RUN]
[0m00:59:35.885482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_users, now model.dbt_bq_sa.dbt_stg_bikes)
[0m00:59:35.886044 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m00:59:35.896057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:36.536521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m00:59:36.537991 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 00:59:35.886390 => 00:59:36.537631
[0m00:59:36.538586 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m00:59:36.545154 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m00:59:36.546138 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_bikes`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    bike_type

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
),

derived_columns AS (

    SELECT

    bike_id,
    bike_type,
    'SRC_SQL_BIKES' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    BIKE_PK,
    BIKE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m00:59:37.172846 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:fdab0e8f-2d9a-4d78-bfe5-efe589a80a94&page=queryresults
[0m00:59:37.492571 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 00:59:36.538934 => 00:59:37.492134
[0m00:59:37.494709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146986fe0>]}
[0m00:59:37.496129 [info ] [Thread-1 (]: 5 of 22 OK created sql view model citibike_source_sql.dbt_stg_sql_bikes ........ [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m00:59:37.497165 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m00:59:37.497864 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m00:59:37.498869 [info ] [Thread-1 (]: 6 of 22 START sql view model citibike_source_sql.dbt_stg_sql_stations .......... [RUN]
[0m00:59:37.500394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m00:59:37.500999 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m00:59:37.512843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:38.164472 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m00:59:38.165916 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 00:59:37.501359 => 00:59:38.165593
[0m00:59:38.166445 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m00:59:38.171593 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_stations"
[0m00:59:38.172493 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_stations`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
),

derived_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    'SRC_SQL_STATIONS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')
    )))) AS STRING) AS STATION_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    STATION_PK,
    STATION_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m00:59:38.884920 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4655f3f1-184b-472d-b03e-7024868d10a9&page=queryresults
[0m00:59:39.296308 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 00:59:38.166732 => 00:59:39.295843
[0m00:59:39.298010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f678e0>]}
[0m00:59:39.299262 [info ] [Thread-1 (]: 6 of 22 OK created sql view model citibike_source_sql.dbt_stg_sql_stations ..... [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m00:59:39.300215 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m00:59:39.300936 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m00:59:39.302051 [info ] [Thread-1 (]: 7 of 22 START sql view model citibike_source_sql.dbt_stg_sql_trips ............. [RUN]
[0m00:59:39.303468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m00:59:39.304009 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m00:59:39.314629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:39.997842 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m00:59:39.998957 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 00:59:39.304326 => 00:59:39.998717
[0m00:59:39.999327 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m00:59:40.002820 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m00:59:40.003481 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_USERS_BIKES_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_BIKES_TRIPS_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_USERS_TRIPS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF,
    LINK_USERS_BIKES_PK,
    LINK_BIKES_TRIPS_PK,
    LINK_USERS_TRIPS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m00:59:40.666140 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:eff2b672-2946-4a8a-9db9-46bf3e3efc9f&page=queryresults
[0m00:59:40.964527 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 00:59:39.999521 => 00:59:40.964037
[0m00:59:40.966480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f66680>]}
[0m00:59:40.967790 [info ] [Thread-1 (]: 7 of 22 OK created sql view model citibike_source_sql.dbt_stg_sql_trips ........ [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m00:59:40.968955 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m00:59:40.969638 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m00:59:40.970528 [info ] [Thread-1 (]: 8 of 22 START sql view model citibike_source_sql.dbt_stg_sql_users ............. [RUN]
[0m00:59:40.971972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m00:59:40.972578 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m00:59:40.983622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:41.632758 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m00:59:41.634190 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 00:59:40.972914 => 00:59:41.633879
[0m00:59:41.634696 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m00:59:41.640414 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_users"
[0m00:59:41.641390 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_users`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
),

derived_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    'SRC_SQL_USERS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    USER_PK,
    USER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m00:59:42.493890 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:42dab380-764d-4a10-8755-14e4e47a01fb&page=queryresults
[0m00:59:42.701342 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 00:59:41.634988 => 00:59:42.700801
[0m00:59:42.702908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146f90e80>]}
[0m00:59:42.703853 [info ] [Thread-1 (]: 8 of 22 OK created sql view model citibike_source_sql.dbt_stg_sql_users ........ [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m00:59:42.704769 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m00:59:42.705419 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m00:59:42.706350 [info ] [Thread-1 (]: 9 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_bikes ...... [RUN]
[0m00:59:42.707773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_users, now model.dbt_bq_sa.dbt_hub_sql_bikes)
[0m00:59:42.708403 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m00:59:42.726943 [info ] [Thread-1 (]: 00:59:42 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_bikes from 1 source(s)
[0m00:59:42.731982 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m00:59:42.733435 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (compile): 00:59:42.708762 => 00:59:42.733114
[0m00:59:42.733853 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m00:59:42.781155 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m00:59:42.781894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:42.782932 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m00:59:43.805525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:1d30b1bb-afc0-4ed2-b86b-5081aa4c98ab&page=queryresults
[0m00:59:45.402393 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (execute): 00:59:42.734093 => 00:59:45.401757
[0m00:59:45.404417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1471b8880>]}
[0m00:59:45.405889 [info ] [Thread-1 (]: 9 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_bikes . [[32mCREATE TABLE (5.0 rows, 40.0 Bytes processed)[0m in 2.70s]
[0m00:59:45.407364 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m00:59:45.408098 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:59:45.408962 [info ] [Thread-1 (]: 10 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_bikes ..... [RUN]
[0m00:59:45.410217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_bikes, now model.dbt_bq_sa.dbt_sat_sql_bikes)
[0m00:59:45.410852 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:59:45.474826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m00:59:45.476284 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (compile): 00:59:45.411221 => 00:59:45.476109
[0m00:59:45.476557 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:59:45.479769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:45.480888 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.BIKE_PK, current_records.BIKE_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` AS current_records
    JOIN (
        SELECT DISTINCT source_data.BIKE_PK
        FROM source_data
    ) AS source_records
        ON source_records.BIKE_PK = current_records.BIKE_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.BIKE_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.BIKE_PK = frin.BIKE_PK
        AND lr.BIKE_HASHDIFF = frin.BIKE_HASHDIFF
        WHERE lr.BIKE_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:59:46.512279 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5ff9dc65-4a5d-4f41-93e0-6eabf59bf418&page=queryresults
[0m00:59:48.972946 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:59:49.001167 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m00:59:49.002047 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
                ) and (
                    DBT_INTERNAL_SOURCE.BIKE_HASHDIFF = DBT_INTERNAL_DEST.BIKE_HASHDIFF
                )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`BIKE_HASHDIFF` = DBT_INTERNAL_SOURCE.`BIKE_HASHDIFF`,`bike_type` = DBT_INTERNAL_SOURCE.`bike_type`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m00:59:49.463546 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8a75bfce-17f1-454e-a01a-40f2d1794976&page=queryresults
[0m00:59:50.940798 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (execute): 00:59:45.476704 => 00:59:50.932062
[0m00:59:51.036074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146fffd30>]}
[0m00:59:51.119671 [info ] [Thread-1 (]: 10 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_bikes  [[32mMERGE (0.0 rows, 502.0 Bytes processed)[0m in 5.61s]
[0m00:59:51.147115 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m00:59:51.161618 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m00:59:51.177066 [info ] [Thread-1 (]: 11 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_stations .. [RUN]
[0m00:59:51.218790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_bikes, now model.dbt_bq_sa.dbt_hub_sql_stations)
[0m00:59:51.242236 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_stations
[0m00:59:51.648122 [info ] [Thread-1 (]: 00:59:51 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_stations from 1 source(s)
[0m00:59:51.955255 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m00:59:51.978859 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (compile): 00:59:51.263494 => 00:59:51.970184
[0m00:59:51.985332 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_stations
[0m00:59:52.048424 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m00:59:52.050543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:52.061313 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m00:59:53.145713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:578897e3-aadb-4e1d-a28a-88f191f6174b&page=queryresults
[0m00:59:54.866939 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (execute): 00:59:51.986308 => 00:59:54.866147
[0m00:59:54.869543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146ffe9e0>]}
[0m00:59:54.870994 [info ] [Thread-1 (]: 11 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_stations  [[32mCREATE TABLE (10.0 rows, 80.0 Bytes processed)[0m in 3.68s]
[0m00:59:54.875221 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m00:59:54.876090 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:59:54.880819 [info ] [Thread-1 (]: 12 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_stations .. [RUN]
[0m00:59:54.882008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_stations, now model.dbt_bq_sa.dbt_sat_sql_stations)
[0m00:59:54.882475 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:59:54.917270 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m00:59:54.918633 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (compile): 00:59:54.882745 => 00:59:54.918439
[0m00:59:54.918930 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_stations
[0m00:59:54.929341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:54.934127 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by STATION_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.STATION_PK, current_records.STATION_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` AS current_records
    JOIN (
        SELECT DISTINCT source_data.STATION_PK
        FROM source_data
    ) AS source_records
        ON source_records.STATION_PK = current_records.STATION_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.STATION_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.STATION_PK = frin.STATION_PK
        AND lr.STATION_HASHDIFF = frin.STATION_HASHDIFF
        WHERE lr.STATION_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m00:59:56.021544 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8b5799c0-e9f2-452d-be71-041c7bc77fba&page=queryresults
[0m00:59:58.301096 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:59:58.305045 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m00:59:58.306026 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
                ) and (
                    DBT_INTERNAL_SOURCE.STATION_HASHDIFF = DBT_INTERNAL_DEST.STATION_HASHDIFF
                )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`STATION_HASHDIFF` = DBT_INTERNAL_SOURCE.`STATION_HASHDIFF`,`name` = DBT_INTERNAL_SOURCE.`name`,`short_name` = DBT_INTERNAL_SOURCE.`short_name`,`latitude` = DBT_INTERNAL_SOURCE.`latitude`,`longitude` = DBT_INTERNAL_SOURCE.`longitude`,`region_id` = DBT_INTERNAL_SOURCE.`region_id`,`rental_method` = DBT_INTERNAL_SOURCE.`rental_method`,`capacity` = DBT_INTERNAL_SOURCE.`capacity`,`last_reported` = DBT_INTERNAL_SOURCE.`last_reported`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m00:59:58.784655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f55784e1-5568-4d28-a9c8-d15971dbd59d&page=queryresults
[0m01:00:00.233324 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (execute): 00:59:54.919082 => 01:00:00.226700
[0m01:00:00.235984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14726a320>]}
[0m01:00:00.237195 [info ] [Thread-1 (]: 12 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.35s]
[0m01:00:00.237961 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:00:00.238632 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:00:00.240038 [info ] [Thread-1 (]: 13 of 22 START sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips . [RUN]
[0m01:00:00.241246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_stations, now model.dbt_bq_sa.dbt_eff_sat_link_users_trips)
[0m01:00:00.241608 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:00:00.333720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:00:00.334487 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (compile): 01:00:00.245987 => 01:00:00.334307
[0m01:00:00.334757 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:00:00.337801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:00.866652 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:00:00.868526 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_eff_sat_link_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` as DBT_INTERNAL_DEST
        using (

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS a
    WHERE a.USER_PK IS NOT NULL
    AND a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT * FROM (
        SELECT b.TRIP_PK, b.USER_PK, b.BIKE_PK, b.start_time, b.end_time, b.EFFECTIVE_FROM, b.LOAD_DATE, b.RECORD_SOURCE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` AS b
        QUALIFY ROW_NUMBER() OVER (
            PARTITION BY b.TRIP_PK
            ORDER BY b.LOAD_DATE DESC
        ) = 1
        ) AS inner_select
    
),

latest_open AS (
    SELECT c.TRIP_PK, c.USER_PK, c.BIKE_PK, c.start_time, c.end_time, c.EFFECTIVE_FROM, c.LOAD_DATE, c.RECORD_SOURCE
    FROM latest_records AS c
    WHERE DATE(c.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

latest_closed AS (
    SELECT d.TRIP_PK, d.USER_PK, d.BIKE_PK, d.start_time, d.end_time, d.EFFECTIVE_FROM, d.LOAD_DATE, d.RECORD_SOURCE
    FROM latest_records AS d
    WHERE DATE(d.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

new_open_records AS (
    SELECT DISTINCT
        f.TRIP_PK, f.USER_PK, f.BIKE_PK,
        f.start_time AS start_time,
        f.end_time AS end_time,
        f.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        f.LOAD_DATE,
        f.RECORD_SOURCE
    FROM source_data AS f
    LEFT JOIN latest_records AS lr
    ON f.TRIP_PK = lr.TRIP_PK
    WHERE lr.TRIP_PK IS NULL
),

new_reopened_records AS (
    SELECT DISTINCT
        lc.TRIP_PK, lc.USER_PK, lc.BIKE_PK,
        g.start_time AS start_time,
        g.end_time AS end_time,
        g.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        g.LOAD_DATE,
        g.RECORD_SOURCE
    FROM source_data AS g
    INNER JOIN latest_closed AS lc
    ON g.TRIP_PK = lc.TRIP_PK
    WHERE DATE(g.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),



new_closed_records AS (
    SELECT DISTINCT
        lo.TRIP_PK, lo.USER_PK, lo.BIKE_PK,
        h.start_time AS start_time,
        h.end_time AS end_time,
        h.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        h.LOAD_DATE,
        lo.RECORD_SOURCE
    FROM source_data AS h
    LEFT JOIN latest_open AS lo
    ON lo.TRIP_PK = h.TRIP_PK
    LEFT JOIN latest_closed AS lc
    ON lc.TRIP_PK = h.TRIP_PK
    WHERE DATE(h.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
    AND lo.TRIP_PK IS NOT NULL
    AND lc.TRIP_PK IS NULL
),

records_to_insert AS (
    SELECT * FROM new_open_records
    UNION DISTINCT
    SELECT * FROM new_reopened_records
    UNION DISTINCT
    SELECT * FROM new_closed_records
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:00:01.658675 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:34624725-adc7-4e47-ba51-864971023c92&page=queryresults
[0m01:00:03.015250 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (execute): 01:00:00.334902 => 01:00:03.014843
[0m01:00:03.017210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1471fc310>]}
[0m01:00:03.018536 [info ] [Thread-1 (]: 13 of 22 OK created sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips  [[32mMERGE (0.0 rows, 3.5 KiB processed)[0m in 2.78s]
[0m01:00:03.019547 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:00:03.020266 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:00:03.021193 [info ] [Thread-1 (]: 14 of 22 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [RUN]
[0m01:00:03.022479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_eff_sat_link_users_trips, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m01:00:03.023110 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:00:03.033889 [info ] [Thread-1 (]: 01:00:03 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m01:00:03.040544 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:00:03.041633 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 01:00:03.023475 => 01:00:03.041331
[0m01:00:03.042145 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:00:03.047812 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:00:03.048776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:03.050462 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.DBT_SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS a
)

SELECT * FROM records_to_insert
    );
  
[0m01:00:04.203343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:23b4517c-e161-4bb7-a839-f7b934597eaf&page=queryresults
[0m01:00:04.305774 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]; reason: invalidQuery, location: query, message: Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]')
[0m01:00:05.434106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:1ec6e5f6-8298-4527-ad7f-096186395a78&page=queryresults
[0m01:00:05.536890 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:1ec6e5f6-8298-4527-ad7f-096186395a78&page=queryresults
[0m01:00:05.539145 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 01:00:03.042434 => 01:00:05.538492
[0m01:00:05.551686 [debug] [Thread-1 (]: Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m01:00:05.552679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146fc9390>]}
[0m01:00:05.553708 [error] [Thread-1 (]: 14 of 22 ERROR creating sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[31mERROR[0m in 2.53s]
[0m01:00:05.554634 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:00:05.555273 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:00:05.557458 [info ] [Thread-1 (]: 15 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_trips ..... [RUN]
[0m01:00:05.558441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_ext_track_sat_trips, now model.dbt_bq_sa.dbt_hub_sql_trips)
[0m01:00:05.558945 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:00:05.569058 [info ] [Thread-1 (]: 01:00:05 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_trips from 1 source(s)
[0m01:00:05.574530 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:00:05.575359 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (compile): 01:00:05.559246 => 01:00:05.575146
[0m01:00:05.575715 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:00:05.580669 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:00:05.581501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:05.583161 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m01:00:06.766323 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e45c301c-7ab9-49a8-bc32-6639cd86b6d3&page=queryresults
[0m01:00:08.538076 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (execute): 01:00:05.575933 => 01:00:08.537452
[0m01:00:08.540877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147101690>]}
[0m01:00:08.542210 [info ] [Thread-1 (]: 15 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_trips  [[32mCREATE TABLE (20.0 rows, 800.0 Bytes processed)[0m in 2.98s]
[0m01:00:08.543216 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:00:08.543916 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:00:08.544773 [info ] [Thread-1 (]: 16 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [RUN]
[0m01:00:08.546009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_trips, now model.dbt_bq_sa.dbt_link_sql_bikes_trips)
[0m01:00:08.546652 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:00:08.558975 [info ] [Thread-1 (]: 01:00:08 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_bikes_trips from 1 source(s)
[0m01:00:08.565474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:00:08.566445 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (compile): 01:00:08.547006 => 01:00:08.566183
[0m01:00:08.566859 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:00:08.572998 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:00:08.574790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:08.576897 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_BIKES_TRIPS_PK, rr.BIKE_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS rr
    WHERE rr.LINK_BIKES_TRIPS_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_BIKES_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_BIKES_TRIPS_PK, a.BIKE_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m01:00:09.221726 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:302e2105-c4f7-4969-8c78-47ea6d57bfd8&page=queryresults
[0m01:00:10.726061 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (execute): 01:00:08.567091 => 01:00:10.725653
[0m01:00:10.727518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147403190>]}
[0m01:00:10.728504 [info ] [Thread-1 (]: 16 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [[32mCREATE TABLE (20.0 rows, 800.0 Bytes processed)[0m in 2.18s]
[0m01:00:10.729982 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:00:10.730641 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:00:10.731370 [info ] [Thread-1 (]: 17 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [RUN]
[0m01:00:10.732375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_bikes_trips, now model.dbt_bq_sa.dbt_link_sql_users_bikes)
[0m01:00:10.732887 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:00:10.741611 [info ] [Thread-1 (]: 01:00:10 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_bikes from 1 source(s)
[0m01:00:10.747832 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:00:10.748750 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (compile): 01:00:10.733183 => 01:00:10.748498
[0m01:00:10.749182 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:00:10.755484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:00:10.756294 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:10.757952 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_BIKES_PK, rr.USER_PK, rr.BIKE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS rr
    WHERE rr.LINK_USERS_BIKES_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_BIKES_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_BIKES_PK, a.USER_PK, a.BIKE_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m01:00:11.795855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e4fb927e-caa3-46bb-b9cf-9dbaf563e9eb&page=queryresults
[0m01:00:13.592346 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (execute): 01:00:10.749420 => 01:00:13.591666
[0m01:00:13.594338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147403190>]}
[0m01:00:13.599578 [info ] [Thread-1 (]: 17 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [[32mCREATE TABLE (10.0 rows, 320.0 Bytes processed)[0m in 2.86s]
[0m01:00:13.600917 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:00:13.603033 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:00:13.604423 [info ] [Thread-1 (]: 18 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [RUN]
[0m01:00:13.605551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_bikes, now model.dbt_bq_sa.dbt_link_sql_users_trips)
[0m01:00:13.606137 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:00:13.618679 [info ] [Thread-1 (]: 01:00:13 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_trips from 1 source(s)
[0m01:00:13.625889 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:00:13.627008 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (compile): 01:00:13.606488 => 01:00:13.626741
[0m01:00:13.627463 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:00:13.633426 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:00:13.634458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:13.636465 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_TRIPS_PK, rr.USER_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS rr
    WHERE rr.LINK_USERS_TRIPS_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_TRIPS_PK, a.USER_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m01:00:14.348009 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8ad37284-2480-418f-90a9-6b6dbc0ed029&page=queryresults
[0m01:00:15.839341 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (execute): 01:00:13.627708 => 01:00:15.838863
[0m01:00:15.841559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1472e9fc0>]}
[0m01:00:15.843194 [info ] [Thread-1 (]: 18 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [[32mCREATE TABLE (20.0 rows, 800.0 Bytes processed)[0m in 2.24s]
[0m01:00:15.844187 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:00:15.844900 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:00:15.845728 [info ] [Thread-1 (]: 19 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_trips ..... [RUN]
[0m01:00:15.846939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_trips, now model.dbt_bq_sa.dbt_sat_sql_trips)
[0m01:00:15.847575 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:00:15.879229 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:00:15.880220 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (compile): 01:00:15.847938 => 01:00:15.879985
[0m01:00:15.880587 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:00:15.885849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:15.887443 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by TRIP_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.TRIP_PK, current_records.TRIP_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` AS current_records
    JOIN (
        SELECT DISTINCT source_data.TRIP_PK
        FROM source_data
    ) AS source_records
        ON source_records.TRIP_PK = current_records.TRIP_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.TRIP_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.TRIP_PK = frin.TRIP_PK
        AND lr.TRIP_HASHDIFF = frin.TRIP_HASHDIFF
        WHERE lr.TRIP_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:00:17.020271 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b964843f-6e34-46b9-9e87-1bbc73ac17c5&page=queryresults
[0m01:00:19.373088 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:00:19.377309 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:00:19.378704 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.TRIP_HASHDIFF = DBT_INTERNAL_DEST.TRIP_HASHDIFF
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`TRIP_HASHDIFF` = DBT_INTERNAL_SOURCE.`TRIP_HASHDIFF`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`trip_duration` = DBT_INTERNAL_SOURCE.`trip_duration`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:00:19.766717 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e9923b48-9642-4df4-898c-25d1eeb03fa0&page=queryresults
[0m01:00:21.121293 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (execute): 01:00:15.880794 => 01:00:21.120489
[0m01:00:21.123511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1472eaf20>]}
[0m01:00:21.124787 [info ] [Thread-1 (]: 19 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_trips  [[32mMERGE (0.0 rows, 1.3 KiB processed)[0m in 5.28s]
[0m01:00:21.125810 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:00:21.126626 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:00:21.127928 [info ] [Thread-1 (]: 20 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_users ..... [RUN]
[0m01:00:21.129266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_trips, now model.dbt_bq_sa.dbt_hub_sql_users)
[0m01:00:21.129788 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:00:21.144272 [info ] [Thread-1 (]: 01:00:21 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_users from 1 source(s)
[0m01:00:21.149569 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:00:21.150866 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (compile): 01:00:21.130101 => 01:00:21.150506
[0m01:00:21.151282 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:00:21.156710 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:00:21.157566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:21.225414 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users`
      
    
    

    OPTIONS()
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
)

SELECT * FROM records_to_insert
    );
  
[0m01:00:22.328710 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:28cf1e30-2e74-4b84-857b-a41b304834e0&page=queryresults
[0m01:00:23.955509 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (execute): 01:00:21.151511 => 01:00:23.955010
[0m01:00:23.957877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147101600>]}
[0m01:00:23.959297 [info ] [Thread-1 (]: 20 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_users  [[32mCREATE TABLE (10.0 rows, 80.0 Bytes processed)[0m in 2.83s]
[0m01:00:23.960339 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:00:23.961090 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:00:23.962015 [info ] [Thread-1 (]: 21 of 22 START sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [RUN]
[0m01:00:23.963040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_users, now model.dbt_bq_sa.dbt_multi_active_sat_users_plans)
[0m01:00:23.963610 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:00:24.009965 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:00:24.010762 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (compile): 01:00:23.963928 => 01:00:24.010582
[0m01:00:24.011052 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:00:24.016020 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:00:24.016527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:24.017692 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    
WITH source_data AS (
    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_users` AS s
    WHERE s.USER_PK IS NOT NULL
        AND s.customer_plan IS NOT NULL
),

records_to_insert AS (
    SELECT source_data.USER_PK, source_data.customer_plan, source_data.user_type, source_data.HASHDIFF, source_data.EFFECTIVE_FROM, source_data.LOAD_DATE, source_data.RECORD_SOURCE
    FROM source_data
)

SELECT * FROM records_to_insert
    );
  
[0m01:00:25.117782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:253a55c5-3049-4a7b-b15c-9a070424d61b&page=queryresults
[0m01:00:25.221878 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name HASHDIFF not found inside s at [19:64]; reason: invalidQuery, location: query, message: Name HASHDIFF not found inside s at [19:64]')
[0m01:00:25.962185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d130793c-2543-44d0-a543-c942527d27f5&page=queryresults
[0m01:00:26.061164 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d130793c-2543-44d0-a543-c942527d27f5&page=queryresults
[0m01:00:26.062872 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (execute): 01:00:24.011216 => 01:00:26.062432
[0m01:00:26.066138 [debug] [Thread-1 (]: Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:00:26.066988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1471ceec0>]}
[0m01:00:26.067935 [error] [Thread-1 (]: 21 of 22 ERROR creating sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [[31mERROR[0m in 2.10s]
[0m01:00:26.068863 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:00:26.069522 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:00:26.070785 [info ] [Thread-1 (]: 22 of 22 START sql incremental model citibike_source_sql.dbt sat_sql_users ..... [RUN]
[0m01:00:26.072148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_multi_active_sat_users_plans, now model.dbt_bq_sa.dbt_sat_sql_users)
[0m01:00:26.072782 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:00:26.104130 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:00:26.105219 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (compile): 01:00:26.073140 => 01:00:26.104966
[0m01:00:26.105605 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:00:26.111577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:00:26.113516 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by USER_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.USER_PK, current_records.USER_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` AS current_records
    JOIN (
        SELECT DISTINCT source_data.USER_PK
        FROM source_data
    ) AS source_records
        ON source_records.USER_PK = current_records.USER_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.USER_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.USER_PK = frin.USER_PK
        AND lr.USER_HASHDIFF = frin.USER_HASHDIFF
        WHERE lr.USER_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:00:26.788683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:acfe2b4b-1120-4c4a-a910-4a434df9d1fc&page=queryresults
[0m01:00:29.161526 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:00:29.164202 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:00:29.165483 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
                ) and (
                    DBT_INTERNAL_SOURCE.USER_HASHDIFF = DBT_INTERNAL_DEST.USER_HASHDIFF
                )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`USER_HASHDIFF` = DBT_INTERNAL_SOURCE.`USER_HASHDIFF`,`user_type` = DBT_INTERNAL_SOURCE.`user_type`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`birth_year` = DBT_INTERNAL_SOURCE.`birth_year`,`customer_plan` = DBT_INTERNAL_SOURCE.`customer_plan`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:00:29.463365 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b5dd1869-db14-4e72-9d49-298669a646a1&page=queryresults
[0m01:00:31.122664 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (execute): 01:00:26.105824 => 01:00:31.121524
[0m01:00:31.125849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68a8ab1e-988b-461c-9d03-69740505118a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1471786d0>]}
[0m01:00:31.127372 [info ] [Thread-1 (]: 22 of 22 OK created sql incremental model citibike_source_sql.dbt sat_sql_users  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.05s]
[0m01:00:31.128316 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:00:31.133631 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:00:31.134159 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_sat_sql_users' was properly closed.
[0m01:00:31.134753 [info ] [MainThread]: 
[0m01:00:31.135273 [info ] [MainThread]: Finished running 8 view models, 14 incremental models in 0 hours 1 minutes and 1.51 seconds (61.51s).
[0m01:00:31.139604 [debug] [MainThread]: Command end result
[0m01:00:31.164037 [info ] [MainThread]: 
[0m01:00:31.164492 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:00:31.164747 [info ] [MainThread]: 
[0m01:00:31.165090 [error] [MainThread]:   Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m01:00:31.165356 [info ] [MainThread]: 
[0m01:00:31.165603 [error] [MainThread]:   Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:00:31.165858 [info ] [MainThread]: 
[0m01:00:31.166646 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=2 SKIP=0 TOTAL=22
[0m01:00:31.176380 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 62.83658, "process_user_time": 5.762014, "process_kernel_time": 1.591809, "process_mem_max_rss": "210485248", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:00:31.176916 [debug] [MainThread]: Command `dbt run` failed at 01:00:31.176813 after 62.84 seconds
[0m01:00:31.177301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036b69b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146526140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146913010>]}
[0m01:00:32.343289 [debug] [MainThread]: Flushing usage events
[0m01:03:53.311614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038637c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105937340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105936f50>]}


============================== 01:03:53.314763 | e5853ca6-42f4-435b-9026-6f6d1199c67a ==============================
[0m01:03:53.314763 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:03:53.315114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:03:55.353516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105936e60>]}
[0m01:03:55.397768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105935300>]}
[0m01:03:55.398356 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m01:03:55.422043 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:03:55.484417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:03:55.484736 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:03:55.485476 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.raw_vault
- models.stage
- models.business_vault
[0m01:03:55.490300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128c4c0d0>]}
[0m01:03:55.504537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a1ea70>]}
[0m01:03:55.504848 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m01:03:55.505045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a1dd80>]}
[0m01:03:55.506295 [info ] [MainThread]: 
[0m01:03:55.506725 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:03:55.507772 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m01:03:55.507991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:56.789080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m01:03:56.792874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:03:57.280690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128a1e1d0>]}
[0m01:03:57.282221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:03:57.282763 [info ] [MainThread]: 
[0m01:03:57.285729 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_bikes
[0m01:03:57.286425 [info ] [Thread-1 (]: 1 of 22 START sql view model citibike_source_sql.raw_sql_bikes ................. [RUN]
[0m01:03:57.287569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.raw_sql_bikes)
[0m01:03:57.288067 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_bikes
[0m01:03:57.300320 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_bikes"
[0m01:03:57.301844 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (compile): 01:03:57.288361 => 01:03:57.301562
[0m01:03:57.302282 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_bikes
[0m01:03:57.330883 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_bikes"
[0m01:03:57.331688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:57.332882 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_bikes`;


[0m01:03:57.958202 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:89508030-2061-4471-9cd4-0c6a68f8e97c&page=queryresults
[0m01:03:58.318196 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (execute): 01:03:57.302522 => 01:03:58.317896
[0m01:03:58.319150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f064a0>]}
[0m01:03:58.319809 [info ] [Thread-1 (]: 1 of 22 OK created sql view model citibike_source_sql.raw_sql_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m01:03:58.320445 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_bikes
[0m01:03:58.320900 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_stations
[0m01:03:58.321477 [info ] [Thread-1 (]: 2 of 22 START sql view model citibike_source_sql.raw_sql_stations .............. [RUN]
[0m01:03:58.322324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_bikes, now model.dbt_bq_sa.raw_sql_stations)
[0m01:03:58.322797 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_stations
[0m01:03:58.327353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_stations"
[0m01:03:58.328466 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (compile): 01:03:58.323062 => 01:03:58.328189
[0m01:03:58.328877 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_stations
[0m01:03:58.333360 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_stations"
[0m01:03:58.334442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:58.336064 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_stations`;


[0m01:03:58.929903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d486747e-3e1e-435a-ab7e-36182c37c784&page=queryresults
[0m01:03:59.264841 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (execute): 01:03:58.329101 => 01:03:59.264387
[0m01:03:59.266835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f052d0>]}
[0m01:03:59.267876 [info ] [Thread-1 (]: 2 of 22 OK created sql view model citibike_source_sql.raw_sql_stations ......... [[32mCREATE VIEW (0 processed)[0m in 0.94s]
[0m01:03:59.268784 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_stations
[0m01:03:59.269437 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_trips
[0m01:03:59.270306 [info ] [Thread-1 (]: 3 of 22 START sql view model citibike_source_sql.raw_sql_trips ................. [RUN]
[0m01:03:59.271377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_stations, now model.dbt_bq_sa.raw_sql_trips)
[0m01:03:59.271936 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_trips
[0m01:03:59.278645 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_trips"
[0m01:03:59.279735 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (compile): 01:03:59.272261 => 01:03:59.279453
[0m01:03:59.280207 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_trips
[0m01:03:59.287613 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_trips"
[0m01:03:59.288520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:59.290404 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_trips`;


[0m01:03:59.908315 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d7191db9-43fc-4262-a3e1-3cf871b4c894&page=queryresults
[0m01:04:00.238227 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (execute): 01:03:59.280484 => 01:04:00.237715
[0m01:04:00.239880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f2fdc0>]}
[0m01:04:00.240882 [info ] [Thread-1 (]: 3 of 22 OK created sql view model citibike_source_sql.raw_sql_trips ............ [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m01:04:00.241816 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_trips
[0m01:04:00.242488 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_users
[0m01:04:00.243408 [info ] [Thread-1 (]: 4 of 22 START sql view model citibike_source_sql.raw_sql_users ................. [RUN]
[0m01:04:00.244695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_trips, now model.dbt_bq_sa.raw_sql_users)
[0m01:04:00.245261 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_users
[0m01:04:00.252120 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_users"
[0m01:04:00.253156 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (compile): 01:04:00.245587 => 01:04:00.252884
[0m01:04:00.253626 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_users
[0m01:04:00.258940 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_users"
[0m01:04:00.259893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:00.261720 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_users`;


[0m01:04:00.953281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:19b702d4-a364-45ac-a70e-ef9d9610b8da&page=queryresults
[0m01:04:01.267619 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (execute): 01:04:00.253901 => 01:04:01.267090
[0m01:04:01.269482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f2f220>]}
[0m01:04:01.270640 [info ] [Thread-1 (]: 4 of 22 OK created sql view model citibike_source_sql.raw_sql_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m01:04:01.271528 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_users
[0m01:04:01.272179 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m01:04:01.275140 [info ] [Thread-1 (]: 5 of 22 START sql view model citibike_source_sql.dbt_stg_sql_bikes ............. [RUN]
[0m01:04:01.276504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_users, now model.dbt_bq_sa.dbt_stg_bikes)
[0m01:04:01.277176 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m01:04:01.314418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:02.115024 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m01:04:02.117460 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 01:04:01.277571 => 01:04:02.116748
[0m01:04:02.119158 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m01:04:02.127348 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m01:04:02.128991 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_bikes`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    bike_type

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
),

derived_columns AS (

    SELECT

    bike_id,
    bike_type,
    'SRC_SQL_BIKES' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    BIKE_PK,
    BIKE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:04:03.173624 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:7a416402-afd3-4c01-b37d-8a4a28d19255&page=queryresults
[0m01:04:03.501771 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 01:04:02.119599 => 01:04:03.501467
[0m01:04:03.502825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f75360>]}
[0m01:04:03.503509 [info ] [Thread-1 (]: 5 of 22 OK created sql view model citibike_source_sql.dbt_stg_sql_bikes ........ [[32mCREATE VIEW (0 processed)[0m in 2.23s]
[0m01:04:03.503914 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m01:04:03.504212 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m01:04:03.505029 [info ] [Thread-1 (]: 6 of 22 START sql view model citibike_source_sql.dbt_stg_sql_stations .......... [RUN]
[0m01:04:03.505544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m01:04:03.505832 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m01:04:03.512655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:04.166078 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m01:04:04.167100 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 01:04:03.505970 => 01:04:04.166865
[0m01:04:04.167484 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m01:04:04.172197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_stations"
[0m01:04:04.173239 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_stations`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
),

derived_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    'SRC_SQL_STATIONS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')
    )))) AS STRING) AS STATION_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    STATION_PK,
    STATION_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:04:04.873362 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:53d1f724-5247-4909-b6b2-deea689d90c2&page=queryresults
[0m01:04:05.205087 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 01:04:04.167704 => 01:04:05.204581
[0m01:04:05.207313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f2f220>]}
[0m01:04:05.208683 [info ] [Thread-1 (]: 6 of 22 OK created sql view model citibike_source_sql.dbt_stg_sql_stations ..... [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m01:04:05.209675 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m01:04:05.210371 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m01:04:05.211239 [info ] [Thread-1 (]: 7 of 22 START sql view model citibike_source_sql.dbt_stg_sql_trips ............. [RUN]
[0m01:04:05.212628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m01:04:05.213266 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m01:04:05.224596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:05.895098 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:04:05.895876 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 01:04:05.213625 => 01:04:05.895668
[0m01:04:05.896220 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m01:04:05.900246 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:04:05.900949 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_USERS_BIKES_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_BIKES_TRIPS_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_USERS_TRIPS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF,
    LINK_USERS_BIKES_PK,
    LINK_BIKES_TRIPS_PK,
    LINK_USERS_TRIPS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:04:06.558189 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:fc2f640f-1e4f-48be-9379-a44c86d493a9&page=queryresults
[0m01:04:06.904574 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 01:04:05.896409 => 01:04:06.904192
[0m01:04:06.905975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f2f490>]}
[0m01:04:06.906921 [info ] [Thread-1 (]: 7 of 22 OK created sql view model citibike_source_sql.dbt_stg_sql_trips ........ [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m01:04:06.907831 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m01:04:06.908469 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m01:04:06.909344 [info ] [Thread-1 (]: 8 of 22 START sql view model citibike_source_sql.dbt_stg_sql_users ............. [RUN]
[0m01:04:06.910770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m01:04:06.911419 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m01:04:06.920539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:07.558394 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m01:04:07.560638 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 01:04:06.911766 => 01:04:07.560323
[0m01:04:07.561142 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m01:04:07.567910 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_users"
[0m01:04:07.568733 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_users`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
),

derived_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    'SRC_SQL_USERS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    USER_PK,
    USER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:04:08.330980 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a44355dc-6496-49a2-8b42-509379e66a52&page=queryresults
[0m01:04:08.638881 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 01:04:07.561431 => 01:04:08.638409
[0m01:04:08.640838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f2c190>]}
[0m01:04:08.642155 [info ] [Thread-1 (]: 8 of 22 OK created sql view model citibike_source_sql.dbt_stg_sql_users ........ [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m01:04:08.643084 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m01:04:08.643733 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:04:08.644600 [info ] [Thread-1 (]: 9 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_bikes ...... [RUN]
[0m01:04:08.646013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_users, now model.dbt_bq_sa.dbt_hub_sql_bikes)
[0m01:04:08.646639 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:04:08.675705 [info ] [Thread-1 (]: 01:04:08 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_bikes from 1 source(s)
[0m01:04:08.721865 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:04:08.722717 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (compile): 01:04:08.647003 => 01:04:08.722557
[0m01:04:08.722960 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:04:08.755840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:08.772814 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` AS d
    ON a.BIKE_PK = d.BIKE_PK
    WHERE d.BIKE_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:04:09.816994 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d0b5b406-ab5c-4a03-b087-16a44ca00eb2&page=queryresults
[0m01:04:11.943909 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:04:11.974684 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:04:11.975679 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
            )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:04:12.298389 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:087a6072-a50b-48eb-a9ae-49788fd83373&page=queryresults
[0m01:04:13.438225 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (execute): 01:04:08.723093 => 01:04:13.437657
[0m01:04:13.440396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f4eb90>]}
[0m01:04:13.448617 [info ] [Thread-1 (]: 9 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_bikes . [[32mMERGE (0.0 rows, 325.0 Bytes processed)[0m in 4.79s]
[0m01:04:13.450199 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:04:13.459674 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:04:13.461084 [info ] [Thread-1 (]: 10 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_bikes ..... [RUN]
[0m01:04:13.462427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_bikes, now model.dbt_bq_sa.dbt_sat_sql_bikes)
[0m01:04:13.463288 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:04:13.550709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m01:04:13.555092 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (compile): 01:04:13.463755 => 01:04:13.554827
[0m01:04:13.555422 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:04:13.559230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:13.560547 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.BIKE_PK, current_records.BIKE_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` AS current_records
    JOIN (
        SELECT DISTINCT source_data.BIKE_PK
        FROM source_data
    ) AS source_records
        ON source_records.BIKE_PK = current_records.BIKE_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.BIKE_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.BIKE_PK = frin.BIKE_PK
        AND lr.BIKE_HASHDIFF = frin.BIKE_HASHDIFF
        WHERE lr.BIKE_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:04:14.678452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:ac87aa9e-22ad-4a7f-a55c-a4ea13536c39&page=queryresults
[0m01:04:16.826997 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:04:16.831566 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m01:04:16.833113 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
                ) and (
                    DBT_INTERNAL_SOURCE.BIKE_HASHDIFF = DBT_INTERNAL_DEST.BIKE_HASHDIFF
                )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`BIKE_HASHDIFF` = DBT_INTERNAL_SOURCE.`BIKE_HASHDIFF`,`bike_type` = DBT_INTERNAL_SOURCE.`bike_type`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:04:17.153040 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:87152aab-71a2-466a-a893-d2e6286b9b62&page=queryresults
[0m01:04:18.564630 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (execute): 01:04:13.555562 => 01:04:18.564154
[0m01:04:18.566443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f632e0>]}
[0m01:04:18.567408 [info ] [Thread-1 (]: 10 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_bikes  [[32mMERGE (0.0 rows, 502.0 Bytes processed)[0m in 5.10s]
[0m01:04:18.568370 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:04:18.569072 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:04:18.570009 [info ] [Thread-1 (]: 11 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_stations .. [RUN]
[0m01:04:18.571254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_bikes, now model.dbt_bq_sa.dbt_hub_sql_stations)
[0m01:04:18.571868 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:04:18.581859 [info ] [Thread-1 (]: 01:04:18 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_stations from 1 source(s)
[0m01:04:18.589553 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:04:18.590773 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (compile): 01:04:18.572214 => 01:04:18.590511
[0m01:04:18.591203 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:04:18.600095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:18.604657 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` AS d
    ON a.STATION_PK = d.STATION_PK
    WHERE d.STATION_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:04:19.702615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0b604673-2d6b-42fb-b81c-5910892d1185&page=queryresults
[0m01:04:21.673789 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:04:21.676750 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:04:21.678143 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
            )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`station_id` = DBT_INTERNAL_SOURCE.`station_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:04:22.009926 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:fe61e3a4-13e2-456b-a0af-d7cdcd48e5b4&page=queryresults
[0m01:04:23.381239 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (execute): 01:04:18.591447 => 01:04:23.380561
[0m01:04:23.383489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f07340>]}
[0m01:04:23.385514 [info ] [Thread-1 (]: 11 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 4.81s]
[0m01:04:23.386606 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:04:23.387428 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:04:23.388722 [info ] [Thread-1 (]: 12 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_stations .. [RUN]
[0m01:04:23.390233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_stations, now model.dbt_bq_sa.dbt_sat_sql_stations)
[0m01:04:23.392688 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:04:23.437846 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m01:04:23.439517 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (compile): 01:04:23.393228 => 01:04:23.439222
[0m01:04:23.439893 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:04:23.452615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:23.454454 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by STATION_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.STATION_PK, current_records.STATION_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` AS current_records
    JOIN (
        SELECT DISTINCT source_data.STATION_PK
        FROM source_data
    ) AS source_records
        ON source_records.STATION_PK = current_records.STATION_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.STATION_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.STATION_PK = frin.STATION_PK
        AND lr.STATION_HASHDIFF = frin.STATION_HASHDIFF
        WHERE lr.STATION_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:04:24.501578 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:cbfd0348-ec6c-4ecd-80a6-14ec56526801&page=queryresults
[0m01:04:26.840288 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:04:26.845006 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m01:04:26.847574 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
                ) and (
                    DBT_INTERNAL_SOURCE.STATION_HASHDIFF = DBT_INTERNAL_DEST.STATION_HASHDIFF
                )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`STATION_HASHDIFF` = DBT_INTERNAL_SOURCE.`STATION_HASHDIFF`,`name` = DBT_INTERNAL_SOURCE.`name`,`short_name` = DBT_INTERNAL_SOURCE.`short_name`,`latitude` = DBT_INTERNAL_SOURCE.`latitude`,`longitude` = DBT_INTERNAL_SOURCE.`longitude`,`region_id` = DBT_INTERNAL_SOURCE.`region_id`,`rental_method` = DBT_INTERNAL_SOURCE.`rental_method`,`capacity` = DBT_INTERNAL_SOURCE.`capacity`,`last_reported` = DBT_INTERNAL_SOURCE.`last_reported`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:04:27.258930 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f0fa2b8d-4d43-47f5-a8e9-76e4c9575c92&page=queryresults
[0m01:04:28.909971 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (execute): 01:04:23.440096 => 01:04:28.909379
[0m01:04:28.912144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1287e8100>]}
[0m01:04:28.913318 [info ] [Thread-1 (]: 12 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.52s]
[0m01:04:28.914287 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:04:28.915014 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:04:28.915824 [info ] [Thread-1 (]: 13 of 22 START sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips . [RUN]
[0m01:04:28.916890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_stations, now model.dbt_bq_sa.dbt_eff_sat_link_users_trips)
[0m01:04:28.917458 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:04:28.988110 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:04:28.988759 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (compile): 01:04:28.917786 => 01:04:28.988611
[0m01:04:28.988998 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:04:28.991552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:29.441184 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:04:29.443321 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_eff_sat_link_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` as DBT_INTERNAL_DEST
        using (

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS a
    WHERE a.USER_PK IS NOT NULL
    AND a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT * FROM (
        SELECT b.TRIP_PK, b.USER_PK, b.BIKE_PK, b.start_time, b.end_time, b.EFFECTIVE_FROM, b.LOAD_DATE, b.RECORD_SOURCE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` AS b
        QUALIFY ROW_NUMBER() OVER (
            PARTITION BY b.TRIP_PK
            ORDER BY b.LOAD_DATE DESC
        ) = 1
        ) AS inner_select
    
),

latest_open AS (
    SELECT c.TRIP_PK, c.USER_PK, c.BIKE_PK, c.start_time, c.end_time, c.EFFECTIVE_FROM, c.LOAD_DATE, c.RECORD_SOURCE
    FROM latest_records AS c
    WHERE DATE(c.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

latest_closed AS (
    SELECT d.TRIP_PK, d.USER_PK, d.BIKE_PK, d.start_time, d.end_time, d.EFFECTIVE_FROM, d.LOAD_DATE, d.RECORD_SOURCE
    FROM latest_records AS d
    WHERE DATE(d.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

new_open_records AS (
    SELECT DISTINCT
        f.TRIP_PK, f.USER_PK, f.BIKE_PK,
        f.start_time AS start_time,
        f.end_time AS end_time,
        f.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        f.LOAD_DATE,
        f.RECORD_SOURCE
    FROM source_data AS f
    LEFT JOIN latest_records AS lr
    ON f.TRIP_PK = lr.TRIP_PK
    WHERE lr.TRIP_PK IS NULL
),

new_reopened_records AS (
    SELECT DISTINCT
        lc.TRIP_PK, lc.USER_PK, lc.BIKE_PK,
        g.start_time AS start_time,
        g.end_time AS end_time,
        g.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        g.LOAD_DATE,
        g.RECORD_SOURCE
    FROM source_data AS g
    INNER JOIN latest_closed AS lc
    ON g.TRIP_PK = lc.TRIP_PK
    WHERE DATE(g.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),



new_closed_records AS (
    SELECT DISTINCT
        lo.TRIP_PK, lo.USER_PK, lo.BIKE_PK,
        h.start_time AS start_time,
        h.end_time AS end_time,
        h.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        h.LOAD_DATE,
        lo.RECORD_SOURCE
    FROM source_data AS h
    LEFT JOIN latest_open AS lo
    ON lo.TRIP_PK = h.TRIP_PK
    LEFT JOIN latest_closed AS lc
    ON lc.TRIP_PK = h.TRIP_PK
    WHERE DATE(h.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
    AND lo.TRIP_PK IS NOT NULL
    AND lc.TRIP_PK IS NULL
),

records_to_insert AS (
    SELECT * FROM new_open_records
    UNION DISTINCT
    SELECT * FROM new_reopened_records
    UNION DISTINCT
    SELECT * FROM new_closed_records
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:04:30.136898 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b463d92e-a016-456c-96d1-ecc1c9a4c220&page=queryresults
[0m01:04:31.579832 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (execute): 01:04:28.989132 => 01:04:31.579393
[0m01:04:31.581402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128fac370>]}
[0m01:04:31.582391 [info ] [Thread-1 (]: 13 of 22 OK created sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips  [[32mMERGE (0.0 rows, 3.5 KiB processed)[0m in 2.66s]
[0m01:04:31.583337 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:04:31.584009 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:04:31.584922 [info ] [Thread-1 (]: 14 of 22 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [RUN]
[0m01:04:31.586188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_eff_sat_link_users_trips, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m01:04:31.586814 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:04:31.618087 [info ] [Thread-1 (]: 01:04:31 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m01:04:31.621248 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:04:31.621914 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 01:04:31.587176 => 01:04:31.621725
[0m01:04:31.622245 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:04:31.628159 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:04:31.628908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:31.630363 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.DBT_SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS a
)

SELECT * FROM records_to_insert
    );
  
[0m01:04:32.696329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d993de1d-a1ba-4f46-a6dd-00ee481ff8db&page=queryresults
[0m01:04:32.797964 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]; reason: invalidQuery, location: query, message: Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]')
[0m01:04:34.281528 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:9fee861d-9c73-4fd3-9311-dfeadee6bd52&page=queryresults
[0m01:04:34.379500 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:9fee861d-9c73-4fd3-9311-dfeadee6bd52&page=queryresults
[0m01:04:34.380602 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 01:04:31.622431 => 01:04:34.380310
[0m01:04:34.387550 [debug] [Thread-1 (]: Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m01:04:34.388216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f2f490>]}
[0m01:04:34.389016 [error] [Thread-1 (]: 14 of 22 ERROR creating sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[31mERROR[0m in 2.80s]
[0m01:04:34.389390 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:04:34.389671 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:04:34.392901 [info ] [Thread-1 (]: 15 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_trips ..... [RUN]
[0m01:04:34.393582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_ext_track_sat_trips, now model.dbt_bq_sa.dbt_hub_sql_trips)
[0m01:04:34.393849 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:04:34.400832 [info ] [Thread-1 (]: 01:04:34 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_trips from 1 source(s)
[0m01:04:34.404806 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:04:34.405802 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (compile): 01:04:34.393990 => 01:04:34.405646
[0m01:04:34.406033 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:04:34.409417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:34.410964 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` AS d
    ON a.TRIP_PK = d.TRIP_PK
    WHERE d.TRIP_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:04:35.570873 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:7cdf7c8a-2678-484c-b563-c8bd626f5fd6&page=queryresults
[0m01:04:37.770415 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:04:37.773585 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:04:37.774732 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
            )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`start_station_id` = DBT_INTERNAL_SOURCE.`start_station_id`,`end_station_id` = DBT_INTERNAL_SOURCE.`end_station_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:04:38.169059 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4e6b97fd-1389-4d6f-8931-bc0fb931d181&page=queryresults
[0m01:04:39.687461 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (execute): 01:04:34.406161 => 01:04:39.684524
[0m01:04:39.692517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128fb1660>]}
[0m01:04:39.701672 [info ] [Thread-1 (]: 15 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_trips  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 5.30s]
[0m01:04:39.703678 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:04:39.707218 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:04:39.709229 [info ] [Thread-1 (]: 16 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [RUN]
[0m01:04:39.768976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_trips, now model.dbt_bq_sa.dbt_link_sql_bikes_trips)
[0m01:04:39.777257 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:04:39.900349 [info ] [Thread-1 (]: 01:04:39 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_bikes_trips from 1 source(s)
[0m01:04:39.944968 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:04:39.950153 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (compile): 01:04:39.777903 => 01:04:39.949477
[0m01:04:39.950645 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:04:39.962395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:39.964960 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_BIKES_TRIPS_PK, rr.BIKE_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS rr
    WHERE rr.LINK_BIKES_TRIPS_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_BIKES_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_BIKES_TRIPS_PK, a.BIKE_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` AS d
    ON a.LINK_BIKES_TRIPS_PK = d.LINK_BIKES_TRIPS_PK
    WHERE d.LINK_BIKES_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:04:41.170022 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0a51281e-c247-4176-a459-2b618425b1e3&page=queryresults
[0m01:04:43.002857 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:04:43.034382 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:04:43.043364 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_BIKES_TRIPS_PK = DBT_INTERNAL_DEST.LINK_BIKES_TRIPS_PK
            )

    
    when matched then update set
        `LINK_BIKES_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_BIKES_TRIPS_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:04:43.363989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:956b311d-fe34-49d4-ba34-bda57113137b&page=queryresults
[0m01:04:44.882752 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (execute): 01:04:39.950809 => 01:04:44.875729
[0m01:04:44.903499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1292be440>]}
[0m01:04:44.916459 [info ] [Thread-1 (]: 16 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 5.17s]
[0m01:04:44.919312 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:04:44.919674 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:04:44.925273 [info ] [Thread-1 (]: 17 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [RUN]
[0m01:04:44.926257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_bikes_trips, now model.dbt_bq_sa.dbt_link_sql_users_bikes)
[0m01:04:44.927080 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:04:44.984293 [info ] [Thread-1 (]: 01:04:44 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_bikes from 1 source(s)
[0m01:04:45.005609 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:04:45.011225 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (compile): 01:04:44.927310 => 01:04:45.010592
[0m01:04:45.012039 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:04:45.032140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:45.041696 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_BIKES_PK, rr.USER_PK, rr.BIKE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS rr
    WHERE rr.LINK_USERS_BIKES_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_BIKES_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_BIKES_PK, a.USER_PK, a.BIKE_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` AS d
    ON a.LINK_USERS_BIKES_PK = d.LINK_USERS_BIKES_PK
    WHERE d.LINK_USERS_BIKES_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:04:46.342931 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5fd6607c-cdcc-4a1d-9730-d84ed2bd76fe&page=queryresults
[0m01:04:48.488375 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:04:48.527737 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:04:48.529374 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_BIKES_PK = DBT_INTERNAL_DEST.LINK_USERS_BIKES_PK
            )

    
    when matched then update set
        `LINK_USERS_BIKES_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_BIKES_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:04:48.873601 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:875a24d1-acd7-4c30-a396-c6ec724e5d48&page=queryresults
[0m01:04:50.257709 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (execute): 01:04:45.012289 => 01:04:50.254332
[0m01:04:50.265724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x129069420>]}
[0m01:04:50.266706 [info ] [Thread-1 (]: 17 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [[32mMERGE (0.0 rows, 1.2 KiB processed)[0m in 5.34s]
[0m01:04:50.267146 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:04:50.267536 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:04:50.268383 [info ] [Thread-1 (]: 18 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [RUN]
[0m01:04:50.270275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_bikes, now model.dbt_bq_sa.dbt_link_sql_users_trips)
[0m01:04:50.273228 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:04:50.337446 [info ] [Thread-1 (]: 01:04:50 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_trips from 1 source(s)
[0m01:04:50.355003 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:04:50.355967 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (compile): 01:04:50.273791 => 01:04:50.355806
[0m01:04:50.356301 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:04:50.387134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:50.406123 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_TRIPS_PK, rr.USER_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS rr
    WHERE rr.LINK_USERS_TRIPS_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_TRIPS_PK, a.USER_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` AS d
    ON a.LINK_USERS_TRIPS_PK = d.LINK_USERS_TRIPS_PK
    WHERE d.LINK_USERS_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:04:51.057966 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:3a6cfc71-6932-4c16-b755-2cead10c21bc&page=queryresults
[0m01:04:53.203870 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:04:53.210428 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:04:53.212778 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_TRIPS_PK = DBT_INTERNAL_DEST.LINK_USERS_TRIPS_PK
            )

    
    when matched then update set
        `LINK_USERS_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_TRIPS_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:04:53.543034 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f230f54c-cb9b-4f94-a5f8-b48f2a6a2fbb&page=queryresults
[0m01:04:54.955211 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (execute): 01:04:50.356666 => 01:04:54.954839
[0m01:04:54.956731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128f75360>]}
[0m01:04:54.957363 [info ] [Thread-1 (]: 18 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 4.69s]
[0m01:04:54.957741 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:04:54.958103 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:04:54.958375 [info ] [Thread-1 (]: 19 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_trips ..... [RUN]
[0m01:04:54.958790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_trips, now model.dbt_bq_sa.dbt_sat_sql_trips)
[0m01:04:54.959000 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:04:54.999756 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:04:55.006418 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (compile): 01:04:54.959122 => 01:04:55.006204
[0m01:04:55.006671 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:04:55.045103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:55.184136 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by TRIP_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.TRIP_PK, current_records.TRIP_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` AS current_records
    JOIN (
        SELECT DISTINCT source_data.TRIP_PK
        FROM source_data
    ) AS source_records
        ON source_records.TRIP_PK = current_records.TRIP_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.TRIP_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.TRIP_PK = frin.TRIP_PK
        AND lr.TRIP_HASHDIFF = frin.TRIP_HASHDIFF
        WHERE lr.TRIP_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:04:56.311419 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:27e606fb-0c3a-4418-847f-20d017247fde&page=queryresults
[0m01:04:58.715219 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:04:58.721859 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:04:58.722697 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.TRIP_HASHDIFF = DBT_INTERNAL_DEST.TRIP_HASHDIFF
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`TRIP_HASHDIFF` = DBT_INTERNAL_SOURCE.`TRIP_HASHDIFF`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`trip_duration` = DBT_INTERNAL_SOURCE.`trip_duration`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:04:59.043765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:435e44fb-3fc0-413a-a5a4-b2f7c453ea4b&page=queryresults
[0m01:05:00.720076 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (execute): 01:04:55.006790 => 01:05:00.718975
[0m01:05:00.723772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1287e8100>]}
[0m01:05:00.725263 [info ] [Thread-1 (]: 19 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_trips  [[32mMERGE (0.0 rows, 1.3 KiB processed)[0m in 5.76s]
[0m01:05:00.727290 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:05:00.728587 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:05:00.730073 [info ] [Thread-1 (]: 20 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_users ..... [RUN]
[0m01:05:00.731018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_trips, now model.dbt_bq_sa.dbt_hub_sql_users)
[0m01:05:00.731321 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:05:00.746975 [info ] [Thread-1 (]: 01:05:00 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_users from 1 source(s)
[0m01:05:00.755902 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:05:00.756862 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (compile): 01:05:00.731479 => 01:05:00.756666
[0m01:05:00.757632 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:05:00.765567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:00.768171 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` AS d
    ON a.USER_PK = d.USER_PK
    WHERE d.USER_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:05:01.815526 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:cea897a0-3b86-4cb6-9ffd-01c81f808edd&page=queryresults
[0m01:05:03.836335 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:05:03.841229 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:05:03.842545 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
            )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:05:04.171070 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2ac15805-1889-4084-ad9d-6872e8ae2cfe&page=queryresults
[0m01:05:05.684105 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (execute): 01:05:00.757845 => 01:05:05.683746
[0m01:05:05.685241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128ebf040>]}
[0m01:05:05.685959 [info ] [Thread-1 (]: 20 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_users  [[32mMERGE (0.0 rows, 650.0 Bytes processed)[0m in 4.95s]
[0m01:05:05.686371 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:05:05.686690 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:05:05.686953 [info ] [Thread-1 (]: 21 of 22 START sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [RUN]
[0m01:05:05.687688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_users, now model.dbt_bq_sa.dbt_multi_active_sat_users_plans)
[0m01:05:05.688122 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:05:05.736095 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:05:05.737257 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (compile): 01:05:05.688735 => 01:05:05.737061
[0m01:05:05.737534 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:05:05.740843 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:05:05.741451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:05.742868 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    
WITH source_data AS (
    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_users` AS s
    WHERE s.USER_PK IS NOT NULL
        AND s.customer_plan IS NOT NULL
),

records_to_insert AS (
    SELECT source_data.USER_PK, source_data.customer_plan, source_data.user_type, source_data.HASHDIFF, source_data.EFFECTIVE_FROM, source_data.LOAD_DATE, source_data.RECORD_SOURCE
    FROM source_data
)

SELECT * FROM records_to_insert
    );
  
[0m01:05:06.693316 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:327e20da-6f0b-4e4b-90b1-1b258b513d05&page=queryresults
[0m01:05:06.799261 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name HASHDIFF not found inside s at [19:64]; reason: invalidQuery, location: query, message: Name HASHDIFF not found inside s at [19:64]')
[0m01:05:08.434179 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a151b5e7-f99b-4e35-9e78-3077ae063632&page=queryresults
[0m01:05:08.525666 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a151b5e7-f99b-4e35-9e78-3077ae063632&page=queryresults
[0m01:05:08.529478 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (execute): 01:05:05.737670 => 01:05:08.528510
[0m01:05:08.535402 [debug] [Thread-1 (]: Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:05:08.536382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128ebf520>]}
[0m01:05:08.538911 [error] [Thread-1 (]: 21 of 22 ERROR creating sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [[31mERROR[0m in 2.85s]
[0m01:05:08.539807 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:05:08.540249 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:05:08.544073 [info ] [Thread-1 (]: 22 of 22 START sql incremental model citibike_source_sql.dbt sat_sql_users ..... [RUN]
[0m01:05:08.544865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_multi_active_sat_users_plans, now model.dbt_bq_sa.dbt_sat_sql_users)
[0m01:05:08.545153 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:05:08.569507 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:05:08.570427 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (compile): 01:05:08.545294 => 01:05:08.570278
[0m01:05:08.570651 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:05:08.576625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:08.578123 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by USER_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.USER_PK, current_records.USER_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` AS current_records
    JOIN (
        SELECT DISTINCT source_data.USER_PK
        FROM source_data
    ) AS source_records
        ON source_records.USER_PK = current_records.USER_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.USER_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.USER_PK = frin.USER_PK
        AND lr.USER_HASHDIFF = frin.USER_HASHDIFF
        WHERE lr.USER_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:05:09.234931 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8230f56a-ed79-4755-aefc-cb09b85f77ae&page=queryresults
[0m01:05:11.523994 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:05:11.529949 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:05:11.530837 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
                ) and (
                    DBT_INTERNAL_SOURCE.USER_HASHDIFF = DBT_INTERNAL_DEST.USER_HASHDIFF
                )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`USER_HASHDIFF` = DBT_INTERNAL_SOURCE.`USER_HASHDIFF`,`user_type` = DBT_INTERNAL_SOURCE.`user_type`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`birth_year` = DBT_INTERNAL_SOURCE.`birth_year`,`customer_plan` = DBT_INTERNAL_SOURCE.`customer_plan`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:05:11.912525 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:62615531-3b2d-4804-b2b9-b61aa0ce192e&page=queryresults
[0m01:05:13.296732 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (execute): 01:05:08.570771 => 01:05:13.296244
[0m01:05:13.298381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5853ca6-42f4-435b-9026-6f6d1199c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x128fed750>]}
[0m01:05:13.299141 [info ] [Thread-1 (]: 22 of 22 OK created sql incremental model citibike_source_sql.dbt sat_sql_users  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 4.75s]
[0m01:05:13.299545 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:05:13.380039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:05:13.380394 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_sat_sql_users' was properly closed.
[0m01:05:13.382327 [info ] [MainThread]: 
[0m01:05:13.388314 [info ] [MainThread]: Finished running 8 view models, 14 incremental models in 0 hours 1 minutes and 17.87 seconds (77.87s).
[0m01:05:13.413586 [debug] [MainThread]: Command end result
[0m01:05:13.673241 [info ] [MainThread]: 
[0m01:05:13.673594 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:05:13.673781 [info ] [MainThread]: 
[0m01:05:13.674851 [error] [MainThread]:   Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m01:05:13.675103 [info ] [MainThread]: 
[0m01:05:13.675290 [error] [MainThread]:   Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:05:13.675485 [info ] [MainThread]: 
[0m01:05:13.681395 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=2 SKIP=0 TOTAL=22
[0m01:05:13.771244 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 80.49438, "process_user_time": 5.745823, "process_kernel_time": 1.629419, "process_mem_max_rss": "193413120", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:05:13.777684 [debug] [MainThread]: Command `dbt run` failed at 01:05:13.777042 after 80.50 seconds
[0m01:05:13.780025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038637c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105936e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12873d540>]}
[0m01:05:15.177082 [debug] [MainThread]: Flushing usage events
[0m01:05:29.247573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a25c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133df370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133def80>]}


============================== 01:05:29.250881 | d06db3c2-caee-43f5-a087-f2197e7adb3e ==============================
[0m01:05:29.250881 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:05:29.251213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models path:models/raw_vault/hubs', 'send_anonymous_usage_stats': 'True'}
[0m01:05:30.131997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd06db3c2-caee-43f5-a087-f2197e7adb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133dee90>]}
[0m01:05:30.162893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd06db3c2-caee-43f5-a087-f2197e7adb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113388f70>]}
[0m01:05:30.163795 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m01:05:30.193480 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:05:30.249652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:05:30.249974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:05:30.250689 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.raw_vault
- models.business_vault
- models.stage
[0m01:05:30.255050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd06db3c2-caee-43f5-a087-f2197e7adb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d4e980>]}
[0m01:05:30.273269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd06db3c2-caee-43f5-a087-f2197e7adb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b6e380>]}
[0m01:05:30.273594 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m01:05:30.273813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd06db3c2-caee-43f5-a087-f2197e7adb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b6d690>]}
[0m01:05:30.274995 [info ] [MainThread]: 
[0m01:05:30.275434 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:05:30.276155 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m01:05:30.276382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:05:30.979177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m01:05:30.980107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:05:31.451325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd06db3c2-caee-43f5-a087-f2197e7adb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b829b0>]}
[0m01:05:31.452788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:05:31.453330 [info ] [MainThread]: 
[0m01:05:31.457012 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:05:31.457736 [info ] [Thread-1 (]: 1 of 4 START sql incremental model citibike_source_sql.dbt_hub_sql_bikes ....... [RUN]
[0m01:05:31.458680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.dbt_hub_sql_bikes)
[0m01:05:31.459170 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:05:31.493860 [info ] [Thread-1 (]: 01:05:31 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_bikes from 1 source(s)
[0m01:05:31.533271 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:05:31.538830 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (compile): 01:05:31.459452 => 01:05:31.538670
[0m01:05:31.539073 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:05:31.574570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:31.575777 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` AS d
    ON a.BIKE_PK = d.BIKE_PK
    WHERE d.BIKE_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:05:32.708969 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:6be4131c-c04c-4124-801d-a505d64208ac&page=queryresults
[0m01:05:34.533275 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:05:34.561163 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:05:34.562193 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
            )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:05:34.907073 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e54c8df7-cc17-4d11-b473-5eaae8790c63&page=queryresults
[0m01:05:36.285200 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (execute): 01:05:31.539209 => 01:05:36.284931
[0m01:05:36.285938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06db3c2-caee-43f5-a087-f2197e7adb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d078e0>]}
[0m01:05:36.286455 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model citibike_source_sql.dbt_hub_sql_bikes .. [[32mMERGE (0.0 rows, 325.0 Bytes processed)[0m in 4.83s]
[0m01:05:36.286846 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:05:36.287147 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:05:36.287603 [info ] [Thread-1 (]: 2 of 4 START sql incremental model citibike_source_sql.dbt_hub_sql_stations .... [RUN]
[0m01:05:36.288073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_bikes, now model.dbt_bq_sa.dbt_hub_sql_stations)
[0m01:05:36.288300 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:05:36.293386 [info ] [Thread-1 (]: 01:05:36 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_stations from 1 source(s)
[0m01:05:36.296948 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:05:36.297496 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (compile): 01:05:36.288424 => 01:05:36.297356
[0m01:05:36.297723 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:05:36.300889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:36.302540 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` AS d
    ON a.STATION_PK = d.STATION_PK
    WHERE d.STATION_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:05:37.294753 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c5b7a3ee-0138-4c89-81e6-10e5c53e6041&page=queryresults
[0m01:05:39.333432 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:05:39.337670 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:05:39.339370 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
            )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`station_id` = DBT_INTERNAL_SOURCE.`station_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:05:39.690979 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2f5670c0-cfa0-4129-bfdb-3ebdcec6681d&page=queryresults
[0m01:05:41.082504 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (execute): 01:05:36.297848 => 01:05:41.081635
[0m01:05:41.084717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06db3c2-caee-43f5-a087-f2197e7adb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137d07970>]}
[0m01:05:41.088358 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model citibike_source_sql.dbt_hub_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 4.80s]
[0m01:05:41.091295 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:05:41.092962 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:05:41.094833 [info ] [Thread-1 (]: 3 of 4 START sql incremental model citibike_source_sql.dbt_hub_sql_trips ....... [RUN]
[0m01:05:41.096065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_stations, now model.dbt_bq_sa.dbt_hub_sql_trips)
[0m01:05:41.096699 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:05:41.110042 [info ] [Thread-1 (]: 01:05:41 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_trips from 1 source(s)
[0m01:05:41.117621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:05:41.118602 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (compile): 01:05:41.097092 => 01:05:41.118341
[0m01:05:41.119043 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:05:41.209693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:41.210742 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` AS d
    ON a.TRIP_PK = d.TRIP_PK
    WHERE d.TRIP_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:05:42.231047 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:797d07dc-dcad-4256-8a32-c7e49144e6d9&page=queryresults
[0m01:05:44.036633 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:05:44.040544 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:05:44.041629 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
            )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`start_station_id` = DBT_INTERNAL_SOURCE.`start_station_id`,`end_station_id` = DBT_INTERNAL_SOURCE.`end_station_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:05:44.395731 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:7c48a79e-d1a2-40d1-ab9b-3e9ce7549ffc&page=queryresults
[0m01:05:45.752083 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (execute): 01:05:41.119291 => 01:05:45.751612
[0m01:05:45.753500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06db3c2-caee-43f5-a087-f2197e7adb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b829b0>]}
[0m01:05:45.754487 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model citibike_source_sql.dbt_hub_sql_trips .. [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 4.66s]
[0m01:05:45.755398 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:05:45.756056 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:05:45.756872 [info ] [Thread-1 (]: 4 of 4 START sql incremental model citibike_source_sql.dbt_hub_sql_users ....... [RUN]
[0m01:05:45.758113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_trips, now model.dbt_bq_sa.dbt_hub_sql_users)
[0m01:05:45.758739 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:05:45.768091 [info ] [Thread-1 (]: 01:05:45 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_users from 1 source(s)
[0m01:05:45.775563 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:05:45.776850 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (compile): 01:05:45.759104 => 01:05:45.776571
[0m01:05:45.777303 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:05:45.782922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:45.784850 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_sql_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` AS d
    ON a.USER_PK = d.USER_PK
    WHERE d.USER_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:05:46.799428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:305b8005-c3d5-46d0-a346-808b6c90c34f&page=queryresults
[0m01:05:48.579516 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:05:48.582690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:05:48.583976 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
            )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:05:48.899321 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:aab9f836-b149-4b06-b18c-e1ed0a1bf670&page=queryresults
[0m01:05:50.319786 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (execute): 01:05:45.777561 => 01:05:50.319514
[0m01:05:50.320929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd06db3c2-caee-43f5-a087-f2197e7adb3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15206d270>]}
[0m01:05:50.321442 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model citibike_source_sql.dbt_hub_sql_users .. [[32mMERGE (0.0 rows, 650.0 Bytes processed)[0m in 4.56s]
[0m01:05:50.321836 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:05:50.324124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:05:50.324487 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_hub_sql_users' was properly closed.
[0m01:05:50.324704 [info ] [MainThread]: 
[0m01:05:50.324974 [info ] [MainThread]: Finished running 4 incremental models in 0 hours 0 minutes and 20.05 seconds (20.05s).
[0m01:05:50.325760 [debug] [MainThread]: Command end result
[0m01:05:50.341577 [info ] [MainThread]: 
[0m01:05:50.342017 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:05:50.342254 [info ] [MainThread]: 
[0m01:05:50.342511 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:05:50.344809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.146498, "process_user_time": 3.183592, "process_kernel_time": 1.291472, "process_mem_max_rss": "201719808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:05:50.345447 [debug] [MainThread]: Command `dbt run` succeeded at 01:05:50.345364 after 21.15 seconds
[0m01:05:50.345753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a25c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137461660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1520d7cd0>]}
[0m01:05:50.346081 [debug] [MainThread]: Flushing usage events
[0m01:08:45.325247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049377c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f1b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f1af50>]}


============================== 01:08:45.328315 | c45ba94c-828e-4184-9ef0-a3dc6e78af0d ==============================
[0m01:08:45.328315 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:08:45.328626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:08:46.231946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f1ae60>]}
[0m01:08:46.261534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec2320>]}
[0m01:08:46.261989 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m01:08:46.289839 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:08:46.342984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m01:08:46.343434 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m01:08:46.343654 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_bikes.sql
[0m01:08:46.343863 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m01:08:46.344076 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_stations.sql
[0m01:08:46.588833 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.raw_vault
- models.business_vault
- models.stage
[0m01:08:46.592288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f996b60>]}
[0m01:08:46.606148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eb665c0>]}
[0m01:08:46.606453 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m01:08:46.606642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eb658d0>]}
[0m01:08:46.607819 [info ] [MainThread]: 
[0m01:08:46.608254 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:08:46.609276 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m01:08:46.609484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:08:47.579155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m01:08:47.580264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:08:48.104044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eb65c90>]}
[0m01:08:48.105355 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:08:48.105771 [info ] [MainThread]: 
[0m01:08:48.109049 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_bikes
[0m01:08:48.109672 [info ] [Thread-1 (]: 1 of 22 START sql view model citibike_source_sql.raw_sql_bikes ................. [RUN]
[0m01:08:48.110492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.raw_sql_bikes)
[0m01:08:48.110906 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_bikes
[0m01:08:48.121803 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_bikes"
[0m01:08:48.123073 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (compile): 01:08:48.111146 => 01:08:48.122826
[0m01:08:48.123455 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_bikes
[0m01:08:48.146890 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_bikes"
[0m01:08:48.147744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:48.148896 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_bikes`;


[0m01:08:48.795538 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4032527c-5a52-4d11-bb04-a9604b8d0b73&page=queryresults
[0m01:08:49.144479 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (execute): 01:08:48.123667 => 01:08:49.144129
[0m01:08:49.145739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f9967a0>]}
[0m01:08:49.146483 [info ] [Thread-1 (]: 1 of 22 OK created sql view model citibike_source_sql.raw_sql_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.04s]
[0m01:08:49.147178 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_bikes
[0m01:08:49.147667 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_stations
[0m01:08:49.148417 [info ] [Thread-1 (]: 2 of 22 START sql view model citibike_source_sql.raw_sql_stations .............. [RUN]
[0m01:08:49.149314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_bikes, now model.dbt_bq_sa.raw_sql_stations)
[0m01:08:49.149808 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_stations
[0m01:08:49.154393 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_stations"
[0m01:08:49.155382 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (compile): 01:08:49.150064 => 01:08:49.155112
[0m01:08:49.155824 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_stations
[0m01:08:49.162009 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_stations"
[0m01:08:49.162830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:49.164327 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_stations`;


[0m01:08:49.821057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5a0923d3-77e1-49b9-8cb6-aa0a3e8bae36&page=queryresults
[0m01:08:50.129603 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (execute): 01:08:49.156064 => 01:08:50.129458
[0m01:08:50.130175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031cd900>]}
[0m01:08:50.130550 [info ] [Thread-1 (]: 2 of 22 OK created sql view model citibike_source_sql.raw_sql_stations ......... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m01:08:50.130882 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_stations
[0m01:08:50.131122 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_trips
[0m01:08:50.131482 [info ] [Thread-1 (]: 3 of 22 START sql view model citibike_source_sql.raw_sql_trips ................. [RUN]
[0m01:08:50.131857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_stations, now model.dbt_bq_sa.raw_sql_trips)
[0m01:08:50.132061 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_trips
[0m01:08:50.134890 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_trips"
[0m01:08:50.135899 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (compile): 01:08:50.132175 => 01:08:50.135767
[0m01:08:50.136112 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_trips
[0m01:08:50.138434 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_trips"
[0m01:08:50.138891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:50.139897 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_trips`;


[0m01:08:50.926542 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0edee87e-6d12-438b-8d90-8caedbea82d8&page=queryresults
[0m01:08:51.451321 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (execute): 01:08:50.136232 => 01:08:51.448221
[0m01:08:51.460561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fb76e60>]}
[0m01:08:51.514186 [info ] [Thread-1 (]: 3 of 22 OK created sql view model citibike_source_sql.raw_sql_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m01:08:51.517267 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_trips
[0m01:08:51.518169 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_users
[0m01:08:51.524185 [info ] [Thread-1 (]: 4 of 22 START sql view model citibike_source_sql.raw_sql_users ................. [RUN]
[0m01:08:51.527575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_trips, now model.dbt_bq_sa.raw_sql_users)
[0m01:08:51.528518 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_users
[0m01:08:51.547069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_users"
[0m01:08:51.548139 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (compile): 01:08:51.528897 => 01:08:51.547973
[0m01:08:51.548391 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_users
[0m01:08:51.554657 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_users"
[0m01:08:51.555251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:51.557097 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_users`;


[0m01:08:52.217412 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c711809d-720e-4518-ac95-0350978f7973&page=queryresults
[0m01:08:52.547594 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (execute): 01:08:51.548525 => 01:08:52.547338
[0m01:08:52.553326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fbc6f20>]}
[0m01:08:52.557359 [info ] [Thread-1 (]: 4 of 22 OK created sql view model citibike_source_sql.raw_sql_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m01:08:52.557819 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_users
[0m01:08:52.558132 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m01:08:52.559065 [info ] [Thread-1 (]: 5 of 22 START sql view model citibike_source_sql.dbt_stg_bikes ................. [RUN]
[0m01:08:52.559600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_users, now model.dbt_bq_sa.dbt_stg_bikes)
[0m01:08:52.559824 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m01:08:52.571214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:53.260069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m01:08:53.266050 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 01:08:52.559956 => 01:08:53.265707
[0m01:08:53.266454 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m01:08:53.276911 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m01:08:53.277511 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    bike_type

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
),

derived_columns AS (

    SELECT

    bike_id,
    bike_type,
    'SRC_SQL_BIKES' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    BIKE_PK,
    BIKE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:08:54.086334 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:10fb19c0-0eb3-45bb-9f19-30113ce9a91d&page=queryresults
[0m01:08:54.365753 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 01:08:53.266592 => 01:08:54.360203
[0m01:08:54.371112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fbc6c50>]}
[0m01:08:54.371983 [info ] [Thread-1 (]: 5 of 22 OK created sql view model citibike_source_sql.dbt_stg_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.81s]
[0m01:08:54.374224 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m01:08:54.375985 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m01:08:54.378528 [info ] [Thread-1 (]: 6 of 22 START sql view model citibike_source_sql.dbt_stg_stations .............. [RUN]
[0m01:08:54.381776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m01:08:54.383190 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m01:08:54.414056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:55.124251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m01:08:55.127126 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 01:08:54.383444 => 01:08:55.126297
[0m01:08:55.130257 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m01:08:55.146250 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_stations"
[0m01:08:55.148930 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
),

derived_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    'SRC_SQL_STATIONS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')
    )))) AS STRING) AS STATION_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    STATION_PK,
    STATION_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:08:55.858066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:aa6a8080-3ca4-4e77-a4c5-550ed9eacb9c&page=queryresults
[0m01:08:56.158794 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 01:08:55.130871 => 01:08:56.157435
[0m01:08:56.160804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa3b6d0>]}
[0m01:08:56.163121 [info ] [Thread-1 (]: 6 of 22 OK created sql view model citibike_source_sql.dbt_stg_stations ......... [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m01:08:56.165942 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m01:08:56.167413 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m01:08:56.168631 [info ] [Thread-1 (]: 7 of 22 START sql view model citibike_source_sql.dbt_stg_trips ................. [RUN]
[0m01:08:56.169661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m01:08:56.170821 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m01:08:56.194048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:56.906177 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:08:56.907508 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 01:08:56.171450 => 01:08:56.907176
[0m01:08:56.907978 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m01:08:56.918240 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:08:56.919009 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_USERS_BIKES_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_BIKES_TRIPS_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_USERS_TRIPS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF,
    LINK_USERS_BIKES_PK,
    LINK_BIKES_TRIPS_PK,
    LINK_USERS_TRIPS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:08:57.667032 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:50299045-2d2f-42bd-b7b1-1ce0e860d320&page=queryresults
[0m01:08:57.981812 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 01:08:56.908136 => 01:08:57.981000
[0m01:08:57.983995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fb829b0>]}
[0m01:08:57.985400 [info ] [Thread-1 (]: 7 of 22 OK created sql view model citibike_source_sql.dbt_stg_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.81s]
[0m01:08:57.986370 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m01:08:57.987074 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m01:08:57.988471 [info ] [Thread-1 (]: 8 of 22 START sql view model citibike_source_sql.dbt_stg_users ................. [RUN]
[0m01:08:57.990083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m01:08:57.990643 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m01:08:58.004349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:08:58.634709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m01:08:58.635771 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 01:08:57.990985 => 01:08:58.635555
[0m01:08:58.636079 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m01:08:58.643445 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_users"
[0m01:08:58.644186 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
),

derived_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    'SRC_SQL_USERS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    USER_PK,
    USER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:08:59.369820 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b6f9c4d9-b56f-4a9e-9a73-b981cdb6e299&page=queryresults
[0m01:08:59.952528 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 01:08:58.636209 => 01:08:59.952153
[0m01:08:59.954169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fb81fc0>]}
[0m01:08:59.954807 [info ] [Thread-1 (]: 8 of 22 OK created sql view model citibike_source_sql.dbt_stg_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m01:08:59.955228 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m01:08:59.955726 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:08:59.956456 [info ] [Thread-1 (]: 9 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_bikes ...... [RUN]
[0m01:08:59.959785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_users, now model.dbt_bq_sa.dbt_hub_sql_bikes)
[0m01:08:59.960259 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:09:00.002317 [info ] [Thread-1 (]: 01:09:00 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_bikes from 1 source(s)
[0m01:09:00.045276 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:09:00.046539 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (compile): 01:08:59.960755 => 01:09:00.046253
[0m01:09:00.047224 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:09:00.084944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:00.088911 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` AS d
    ON a.BIKE_PK = d.BIKE_PK
    WHERE d.BIKE_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:09:01.101775 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:91ad5de9-98f9-43ad-8bf9-670bf2040d94&page=queryresults
[0m01:09:02.909415 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:09:02.925811 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:09:02.926693 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
            )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:09:03.265868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:06f553ce-ec4d-46ab-898b-4f3a28ab9a95&page=queryresults
[0m01:09:04.353990 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (execute): 01:09:00.047441 => 01:09:04.353401
[0m01:09:04.355750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa3b6d0>]}
[0m01:09:04.356802 [info ] [Thread-1 (]: 9 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_bikes . [[32mMERGE (0.0 rows, 325.0 Bytes processed)[0m in 4.40s]
[0m01:09:04.357303 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:09:04.357623 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:09:04.357903 [info ] [Thread-1 (]: 10 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_bikes ..... [RUN]
[0m01:09:04.358611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_bikes, now model.dbt_bq_sa.dbt_sat_sql_bikes)
[0m01:09:04.358842 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:09:04.421834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m01:09:04.423680 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (compile): 01:09:04.358974 => 01:09:04.423453
[0m01:09:04.424031 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:09:04.428267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:04.437415 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.BIKE_PK, current_records.BIKE_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` AS current_records
    JOIN (
        SELECT DISTINCT source_data.BIKE_PK
        FROM source_data
    ) AS source_records
        ON source_records.BIKE_PK = current_records.BIKE_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.BIKE_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.BIKE_PK = frin.BIKE_PK
        AND lr.BIKE_HASHDIFF = frin.BIKE_HASHDIFF
        WHERE lr.BIKE_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:09:05.492984 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:99956bff-4515-4068-8aab-e626eb70f5b4&page=queryresults
[0m01:09:07.789850 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:09:07.792836 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m01:09:07.794259 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
                ) and (
                    DBT_INTERNAL_SOURCE.BIKE_HASHDIFF = DBT_INTERNAL_DEST.BIKE_HASHDIFF
                )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`BIKE_HASHDIFF` = DBT_INTERNAL_SOURCE.`BIKE_HASHDIFF`,`bike_type` = DBT_INTERNAL_SOURCE.`bike_type`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:09:08.129799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e746e0b5-9682-4038-92ee-39ad1650d6d2&page=queryresults
[0m01:09:11.252492 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (execute): 01:09:04.424223 => 01:09:11.251729
[0m01:09:11.254894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa3b6d0>]}
[0m01:09:11.255948 [info ] [Thread-1 (]: 10 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_bikes  [[32mMERGE (0.0 rows, 502.0 Bytes processed)[0m in 6.90s]
[0m01:09:11.257765 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:09:11.258329 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:09:11.259386 [info ] [Thread-1 (]: 11 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_stations .. [RUN]
[0m01:09:11.260373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_bikes, now model.dbt_bq_sa.dbt_hub_sql_stations)
[0m01:09:11.260830 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:09:11.270227 [info ] [Thread-1 (]: 01:09:11 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_stations from 1 source(s)
[0m01:09:11.279360 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:09:11.280182 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (compile): 01:09:11.261074 => 01:09:11.280004
[0m01:09:11.280469 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:09:11.286109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:11.288247 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` AS d
    ON a.STATION_PK = d.STATION_PK
    WHERE d.STATION_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:09:12.352259 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e24be382-7460-462c-91ba-36bff4e88d50&page=queryresults
[0m01:09:14.469280 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:09:14.472216 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:09:14.473333 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
            )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`station_id` = DBT_INTERNAL_SOURCE.`station_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:09:14.772968 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:1bf70a6b-865f-42c8-a0b2-9a310b5f152b&page=queryresults
[0m01:09:16.137870 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (execute): 01:09:11.280626 => 01:09:16.137290
[0m01:09:16.139638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031cd900>]}
[0m01:09:16.140740 [info ] [Thread-1 (]: 11 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 4.88s]
[0m01:09:16.141594 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:09:16.142074 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:09:16.142694 [info ] [Thread-1 (]: 12 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_stations .. [RUN]
[0m01:09:16.143547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_stations, now model.dbt_bq_sa.dbt_sat_sql_stations)
[0m01:09:16.143954 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:09:16.183795 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m01:09:16.185036 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (compile): 01:09:16.144196 => 01:09:16.184807
[0m01:09:16.185407 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:09:16.209850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:16.211452 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by STATION_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.STATION_PK, current_records.STATION_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` AS current_records
    JOIN (
        SELECT DISTINCT source_data.STATION_PK
        FROM source_data
    ) AS source_records
        ON source_records.STATION_PK = current_records.STATION_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.STATION_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.STATION_PK = frin.STATION_PK
        AND lr.STATION_HASHDIFF = frin.STATION_HASHDIFF
        WHERE lr.STATION_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:09:17.193798 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:dcf4530d-ecd9-4961-85d5-e4b08639d159&page=queryresults
[0m01:09:19.632432 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:09:19.636744 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m01:09:19.638388 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
                ) and (
                    DBT_INTERNAL_SOURCE.STATION_HASHDIFF = DBT_INTERNAL_DEST.STATION_HASHDIFF
                )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`STATION_HASHDIFF` = DBT_INTERNAL_SOURCE.`STATION_HASHDIFF`,`name` = DBT_INTERNAL_SOURCE.`name`,`short_name` = DBT_INTERNAL_SOURCE.`short_name`,`latitude` = DBT_INTERNAL_SOURCE.`latitude`,`longitude` = DBT_INTERNAL_SOURCE.`longitude`,`region_id` = DBT_INTERNAL_SOURCE.`region_id`,`rental_method` = DBT_INTERNAL_SOURCE.`rental_method`,`capacity` = DBT_INTERNAL_SOURCE.`capacity`,`last_reported` = DBT_INTERNAL_SOURCE.`last_reported`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:09:19.953970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d8f6eb9d-0df7-45e4-8056-2077161f8e97&page=queryresults
[0m01:09:21.582710 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (execute): 01:09:16.185617 => 01:09:21.582177
[0m01:09:21.596345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa54b50>]}
[0m01:09:21.612938 [info ] [Thread-1 (]: 12 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.45s]
[0m01:09:21.614210 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:09:21.615038 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:09:21.615992 [info ] [Thread-1 (]: 13 of 22 START sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips . [RUN]
[0m01:09:21.617337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_stations, now model.dbt_bq_sa.dbt_eff_sat_link_users_trips)
[0m01:09:21.617963 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:09:21.701359 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:09:21.702367 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (compile): 01:09:21.618625 => 01:09:21.702216
[0m01:09:21.702608 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:09:21.705419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:22.229975 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:09:22.232438 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_eff_sat_link_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` as DBT_INTERNAL_DEST
        using (

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.USER_PK IS NOT NULL
    AND a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT * FROM (
        SELECT b.TRIP_PK, b.USER_PK, b.BIKE_PK, b.start_time, b.end_time, b.EFFECTIVE_FROM, b.LOAD_DATE, b.RECORD_SOURCE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` AS b
        QUALIFY ROW_NUMBER() OVER (
            PARTITION BY b.TRIP_PK
            ORDER BY b.LOAD_DATE DESC
        ) = 1
        ) AS inner_select
    
),

latest_open AS (
    SELECT c.TRIP_PK, c.USER_PK, c.BIKE_PK, c.start_time, c.end_time, c.EFFECTIVE_FROM, c.LOAD_DATE, c.RECORD_SOURCE
    FROM latest_records AS c
    WHERE DATE(c.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

latest_closed AS (
    SELECT d.TRIP_PK, d.USER_PK, d.BIKE_PK, d.start_time, d.end_time, d.EFFECTIVE_FROM, d.LOAD_DATE, d.RECORD_SOURCE
    FROM latest_records AS d
    WHERE DATE(d.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

new_open_records AS (
    SELECT DISTINCT
        f.TRIP_PK, f.USER_PK, f.BIKE_PK,
        f.start_time AS start_time,
        f.end_time AS end_time,
        f.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        f.LOAD_DATE,
        f.RECORD_SOURCE
    FROM source_data AS f
    LEFT JOIN latest_records AS lr
    ON f.TRIP_PK = lr.TRIP_PK
    WHERE lr.TRIP_PK IS NULL
),

new_reopened_records AS (
    SELECT DISTINCT
        lc.TRIP_PK, lc.USER_PK, lc.BIKE_PK,
        g.start_time AS start_time,
        g.end_time AS end_time,
        g.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        g.LOAD_DATE,
        g.RECORD_SOURCE
    FROM source_data AS g
    INNER JOIN latest_closed AS lc
    ON g.TRIP_PK = lc.TRIP_PK
    WHERE DATE(g.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),



new_closed_records AS (
    SELECT DISTINCT
        lo.TRIP_PK, lo.USER_PK, lo.BIKE_PK,
        h.start_time AS start_time,
        h.end_time AS end_time,
        h.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        h.LOAD_DATE,
        lo.RECORD_SOURCE
    FROM source_data AS h
    LEFT JOIN latest_open AS lo
    ON lo.TRIP_PK = h.TRIP_PK
    LEFT JOIN latest_closed AS lc
    ON lc.TRIP_PK = h.TRIP_PK
    WHERE DATE(h.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
    AND lo.TRIP_PK IS NOT NULL
    AND lc.TRIP_PK IS NULL
),

records_to_insert AS (
    SELECT * FROM new_open_records
    UNION DISTINCT
    SELECT * FROM new_reopened_records
    UNION DISTINCT
    SELECT * FROM new_closed_records
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:09:23.107125 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:ab80b9f0-ad3b-497c-901d-b3345366f0e4&page=queryresults
[0m01:09:24.900644 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (execute): 01:09:21.702748 => 01:09:24.899995
[0m01:09:24.902359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fb39c00>]}
[0m01:09:24.903287 [info ] [Thread-1 (]: 13 of 22 OK created sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips  [[32mMERGE (0.0 rows, 3.5 KiB processed)[0m in 3.29s]
[0m01:09:24.903792 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:09:24.904165 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:09:24.904464 [info ] [Thread-1 (]: 14 of 22 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [RUN]
[0m01:09:24.905303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_eff_sat_link_users_trips, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m01:09:24.905558 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:09:24.937561 [info ] [Thread-1 (]: 01:09:24 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m01:09:24.940555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:09:24.942987 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 01:09:24.905710 => 01:09:24.942503
[0m01:09:24.943921 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:09:24.952172 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:09:24.952768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:24.954457 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.DBT_SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS a
)

SELECT * FROM records_to_insert
    );
  
[0m01:09:26.001007 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:73162e8d-7731-46e2-846f-c5b41d880e25&page=queryresults
[0m01:09:26.104707 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]; reason: invalidQuery, location: query, message: Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]')
[0m01:09:27.492607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e36b4ba5-3159-4dab-a784-0c23936896d2&page=queryresults
[0m01:09:27.594258 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e36b4ba5-3159-4dab-a784-0c23936896d2&page=queryresults
[0m01:09:27.596010 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 01:09:24.944256 => 01:09:27.595543
[0m01:09:27.610614 [debug] [Thread-1 (]: Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m01:09:27.611548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe9c6a0>]}
[0m01:09:27.612401 [error] [Thread-1 (]: 14 of 22 ERROR creating sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[31mERROR[0m in 2.71s]
[0m01:09:27.613148 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:09:27.613705 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:09:27.617377 [info ] [Thread-1 (]: 15 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_trips ..... [RUN]
[0m01:09:27.618447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_ext_track_sat_trips, now model.dbt_bq_sa.dbt_hub_sql_trips)
[0m01:09:27.618968 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:09:27.627962 [info ] [Thread-1 (]: 01:09:27 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_trips from 1 source(s)
[0m01:09:27.635081 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:09:27.636184 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (compile): 01:09:27.619266 => 01:09:27.635946
[0m01:09:27.636554 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:09:27.642130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:27.644013 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` AS d
    ON a.TRIP_PK = d.TRIP_PK
    WHERE d.TRIP_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:09:28.695585 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2f75bef8-3081-4975-8d88-d6c80ad00789&page=queryresults
[0m01:09:30.712714 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:09:30.716076 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:09:30.717010 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
            )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`start_station_id` = DBT_INTERNAL_SOURCE.`start_station_id`,`end_station_id` = DBT_INTERNAL_SOURCE.`end_station_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:09:31.055626 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e3136716-38e8-4a17-a0e2-a8ed6adc46c9&page=queryresults
[0m01:09:32.410047 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (execute): 01:09:27.636766 => 01:09:32.409546
[0m01:09:32.414663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa55300>]}
[0m01:09:32.415856 [info ] [Thread-1 (]: 15 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_trips  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 4.80s]
[0m01:09:32.416911 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:09:32.417641 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:09:32.418299 [info ] [Thread-1 (]: 16 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [RUN]
[0m01:09:32.418944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_trips, now model.dbt_bq_sa.dbt_link_sql_bikes_trips)
[0m01:09:32.419212 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:09:32.430499 [info ] [Thread-1 (]: 01:09:32 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_bikes_trips from 1 source(s)
[0m01:09:32.447588 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:09:32.448278 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (compile): 01:09:32.419372 => 01:09:32.448115
[0m01:09:32.448536 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:09:32.452236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:32.458295 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_BIKES_TRIPS_PK, rr.BIKE_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_BIKES_TRIPS_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_BIKES_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_BIKES_TRIPS_PK, a.BIKE_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` AS d
    ON a.LINK_BIKES_TRIPS_PK = d.LINK_BIKES_TRIPS_PK
    WHERE d.LINK_BIKES_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:09:33.551165 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:1088e03a-cc41-4c14-8d05-fe0a8c815797&page=queryresults
[0m01:09:35.574751 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:09:35.578749 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:09:35.579932 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_BIKES_TRIPS_PK = DBT_INTERNAL_DEST.LINK_BIKES_TRIPS_PK
            )

    
    when matched then update set
        `LINK_BIKES_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_BIKES_TRIPS_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:09:35.883403 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:63dd6327-6606-4d4e-8947-5ebd0494dc84&page=queryresults
[0m01:09:37.251950 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (execute): 01:09:32.448678 => 01:09:37.251478
[0m01:09:37.253464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa54700>]}
[0m01:09:37.254554 [info ] [Thread-1 (]: 16 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 4.83s]
[0m01:09:37.255313 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:09:37.255745 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:09:37.256282 [info ] [Thread-1 (]: 17 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [RUN]
[0m01:09:37.256938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_bikes_trips, now model.dbt_bq_sa.dbt_link_sql_users_bikes)
[0m01:09:37.257245 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:09:37.263396 [info ] [Thread-1 (]: 01:09:37 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_bikes from 1 source(s)
[0m01:09:37.269380 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:09:37.270274 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (compile): 01:09:37.257421 => 01:09:37.270068
[0m01:09:37.270608 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:09:37.280796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:37.282676 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_BIKES_PK, rr.USER_PK, rr.BIKE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_BIKES_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_BIKES_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_BIKES_PK, a.USER_PK, a.BIKE_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` AS d
    ON a.LINK_USERS_BIKES_PK = d.LINK_USERS_BIKES_PK
    WHERE d.LINK_USERS_BIKES_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:09:38.453330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:12898143-df73-4b89-8612-7a07df441cd7&page=queryresults
[0m01:09:40.325672 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:09:40.331708 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:09:40.333422 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_BIKES_PK = DBT_INTERNAL_DEST.LINK_USERS_BIKES_PK
            )

    
    when matched then update set
        `LINK_USERS_BIKES_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_BIKES_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:09:40.720932 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b4ac542e-024c-4c08-97b0-0159841a5a5b&page=queryresults
[0m01:09:42.329612 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (execute): 01:09:37.270800 => 01:09:42.328940
[0m01:09:42.331493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa3cf10>]}
[0m01:09:42.335764 [info ] [Thread-1 (]: 17 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [[32mMERGE (0.0 rows, 1.2 KiB processed)[0m in 5.07s]
[0m01:09:42.336855 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:09:42.337268 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:09:42.337888 [info ] [Thread-1 (]: 18 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [RUN]
[0m01:09:42.338414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_bikes, now model.dbt_bq_sa.dbt_link_sql_users_trips)
[0m01:09:42.338653 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:09:42.350104 [info ] [Thread-1 (]: 01:09:42 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_trips from 1 source(s)
[0m01:09:42.358207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:09:42.358941 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (compile): 01:09:42.338782 => 01:09:42.358768
[0m01:09:42.359239 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:09:42.366486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:42.371864 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_TRIPS_PK, rr.USER_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_TRIPS_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_TRIPS_PK, a.USER_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` AS d
    ON a.LINK_USERS_TRIPS_PK = d.LINK_USERS_TRIPS_PK
    WHERE d.LINK_USERS_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:09:43.411087 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:64287dee-1a6e-4dca-a047-ea79f6590a46&page=queryresults
[0m01:09:45.548183 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:09:45.551741 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:09:45.553572 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_TRIPS_PK = DBT_INTERNAL_DEST.LINK_USERS_TRIPS_PK
            )

    
    when matched then update set
        `LINK_USERS_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_TRIPS_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:09:45.869578 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:bf9432d3-6265-4681-929f-59adf8fb8b4e&page=queryresults
[0m01:09:47.384440 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (execute): 01:09:42.359426 => 01:09:47.383768
[0m01:09:47.386133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f995e10>]}
[0m01:09:47.386746 [info ] [Thread-1 (]: 18 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 5.05s]
[0m01:09:47.387143 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:09:47.387497 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:09:47.387750 [info ] [Thread-1 (]: 19 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_trips ..... [RUN]
[0m01:09:47.388393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_trips, now model.dbt_bq_sa.dbt_sat_sql_trips)
[0m01:09:47.388654 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:09:47.410950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:09:47.411984 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (compile): 01:09:47.388796 => 01:09:47.411769
[0m01:09:47.412391 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:09:47.419546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:47.421919 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by TRIP_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.TRIP_PK, current_records.TRIP_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` AS current_records
    JOIN (
        SELECT DISTINCT source_data.TRIP_PK
        FROM source_data
    ) AS source_records
        ON source_records.TRIP_PK = current_records.TRIP_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.TRIP_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.TRIP_PK = frin.TRIP_PK
        AND lr.TRIP_HASHDIFF = frin.TRIP_HASHDIFF
        WHERE lr.TRIP_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:09:48.612443 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:869c4b26-c7c3-4401-aa9c-3d1e5dafd36b&page=queryresults
[0m01:09:50.767712 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:09:50.794189 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:09:50.805265 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.TRIP_HASHDIFF = DBT_INTERNAL_DEST.TRIP_HASHDIFF
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`TRIP_HASHDIFF` = DBT_INTERNAL_SOURCE.`TRIP_HASHDIFF`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`trip_duration` = DBT_INTERNAL_SOURCE.`trip_duration`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:09:51.184881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c50eec32-c4d1-4c64-9aa0-9d6fced189bb&page=queryresults
[0m01:09:52.705374 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (execute): 01:09:47.412553 => 01:09:52.704875
[0m01:09:52.707635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148833fa0>]}
[0m01:09:52.708715 [info ] [Thread-1 (]: 19 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_trips  [[32mMERGE (0.0 rows, 1.3 KiB processed)[0m in 5.32s]
[0m01:09:52.709257 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:09:52.709668 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:09:52.710299 [info ] [Thread-1 (]: 20 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_users ..... [RUN]
[0m01:09:52.710925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_trips, now model.dbt_bq_sa.dbt_hub_sql_users)
[0m01:09:52.711206 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:09:52.761121 [info ] [Thread-1 (]: 01:09:52 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_users from 1 source(s)
[0m01:09:52.782944 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:09:52.792980 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (compile): 01:09:52.711365 => 01:09:52.792380
[0m01:09:52.793632 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:09:52.809580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:52.812322 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` AS d
    ON a.USER_PK = d.USER_PK
    WHERE d.USER_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:09:53.931809 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c0ddf896-589f-4c33-849a-d15846f0b21a&page=queryresults
[0m01:09:55.962001 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:09:55.968326 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:09:55.969230 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
            )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:09:56.386145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a1bb90e4-ab64-4da8-a9d9-0532c8e9a638&page=queryresults
[0m01:09:57.522101 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (execute): 01:09:52.793944 => 01:09:57.521724
[0m01:09:57.523214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f9962f0>]}
[0m01:09:57.523746 [info ] [Thread-1 (]: 20 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_users  [[32mMERGE (0.0 rows, 650.0 Bytes processed)[0m in 4.81s]
[0m01:09:57.524115 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:09:57.524409 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:09:57.524951 [info ] [Thread-1 (]: 21 of 22 START sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [RUN]
[0m01:09:57.525454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_users, now model.dbt_bq_sa.dbt_multi_active_sat_users_plans)
[0m01:09:57.525688 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:09:57.590228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:09:57.594836 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (compile): 01:09:57.525826 => 01:09:57.594492
[0m01:09:57.595187 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:09:57.599174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:09:57.599810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:09:57.693307 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    
WITH source_data AS (
    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS s
    WHERE s.USER_PK IS NOT NULL
        AND s.customer_plan IS NOT NULL
),

records_to_insert AS (
    SELECT source_data.USER_PK, source_data.customer_plan, source_data.user_type, source_data.HASHDIFF, source_data.EFFECTIVE_FROM, source_data.LOAD_DATE, source_data.RECORD_SOURCE
    FROM source_data
)

SELECT * FROM records_to_insert
    );
  
[0m01:09:58.707504 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0b0a7b73-f846-4313-8fd2-b19b449120a8&page=queryresults
[0m01:09:58.881093 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name HASHDIFF not found inside s at [19:64]; reason: invalidQuery, location: query, message: Name HASHDIFF not found inside s at [19:64]')
[0m01:09:59.872616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e39aa7fb-19b2-481e-824e-108d131d4dc3&page=queryresults
[0m01:09:59.971583 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e39aa7fb-19b2-481e-824e-108d131d4dc3&page=queryresults
[0m01:09:59.974544 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (execute): 01:09:57.595328 => 01:09:59.973711
[0m01:09:59.982568 [debug] [Thread-1 (]: Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:09:59.983495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f996260>]}
[0m01:09:59.984540 [error] [Thread-1 (]: 21 of 22 ERROR creating sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [[31mERROR[0m in 2.46s]
[0m01:09:59.984973 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:09:59.985301 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:09:59.985581 [info ] [Thread-1 (]: 22 of 22 START sql incremental model citibike_source_sql.dbt sat_sql_users ..... [RUN]
[0m01:09:59.986703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_multi_active_sat_users_plans, now model.dbt_bq_sa.dbt_sat_sql_users)
[0m01:09:59.986983 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:10:00.008935 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:10:00.011041 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (compile): 01:09:59.987137 => 01:10:00.010906
[0m01:10:00.011255 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:10:00.015934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:00.017626 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by USER_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.USER_PK, current_records.USER_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` AS current_records
    JOIN (
        SELECT DISTINCT source_data.USER_PK
        FROM source_data
    ) AS source_records
        ON source_records.USER_PK = current_records.USER_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.USER_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.USER_PK = frin.USER_PK
        AND lr.USER_HASHDIFF = frin.USER_HASHDIFF
        WHERE lr.USER_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:10:01.104397 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:02e28b30-6e62-4b0d-be37-78cb53c16e79&page=queryresults
[0m01:10:03.531465 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:10:03.537416 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:10:03.538654 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
                ) and (
                    DBT_INTERNAL_SOURCE.USER_HASHDIFF = DBT_INTERNAL_DEST.USER_HASHDIFF
                )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`USER_HASHDIFF` = DBT_INTERNAL_SOURCE.`USER_HASHDIFF`,`user_type` = DBT_INTERNAL_SOURCE.`user_type`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`birth_year` = DBT_INTERNAL_SOURCE.`birth_year`,`customer_plan` = DBT_INTERNAL_SOURCE.`customer_plan`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:10:03.863824 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:506ba918-002e-4015-84b6-3907bac98567&page=queryresults
[0m01:10:05.228397 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (execute): 01:10:00.011374 => 01:10:05.227852
[0m01:10:05.229847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c45ba94c-828e-4184-9ef0-a3dc6e78af0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ff84be0>]}
[0m01:10:05.230617 [info ] [Thread-1 (]: 22 of 22 OK created sql incremental model citibike_source_sql.dbt sat_sql_users  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.24s]
[0m01:10:05.231332 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:10:05.240176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:05.240660 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_sat_sql_users' was properly closed.
[0m01:10:05.240956 [info ] [MainThread]: 
[0m01:10:05.241700 [info ] [MainThread]: Finished running 8 view models, 14 incremental models in 0 hours 1 minutes and 18.63 seconds (78.63s).
[0m01:10:05.246552 [debug] [MainThread]: Command end result
[0m01:10:05.314029 [info ] [MainThread]: 
[0m01:10:05.314417 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:10:05.314611 [info ] [MainThread]: 
[0m01:10:05.314985 [error] [MainThread]:   Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m01:10:05.315169 [info ] [MainThread]: 
[0m01:10:05.315399 [error] [MainThread]:   Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:10:05.315605 [info ] [MainThread]: 
[0m01:10:05.316514 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=2 SKIP=0 TOTAL=22
[0m01:10:05.329979 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 80.04574, "process_user_time": 5.306498, "process_kernel_time": 1.929355, "process_mem_max_rss": "208470016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:10:05.332019 [debug] [MainThread]: Command `dbt run` failed at 01:10:05.331870 after 80.05 seconds
[0m01:10:05.333047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049377c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13feb21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e81bf10>]}
[0m01:10:06.556647 [debug] [MainThread]: Flushing usage events
[0m01:10:15.163116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba25c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961af80>]}


============================== 01:10:15.166194 | 4bf91585-e53f-42c3-8b1e-f433f8b36ebf ==============================
[0m01:10:15.166194 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:10:15.166506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:10:15.998529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10961ae90>]}
[0m01:10:16.028239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c1b40>]}
[0m01:10:16.028794 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m01:10:16.046503 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:10:16.113692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:10:16.114012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:10:16.114742 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.business_vault
- models.stage
- models.raw_vault
[0m01:10:16.118963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151f480d0>]}
[0m01:10:16.137134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151d5e800>]}
[0m01:10:16.137566 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m01:10:16.137855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151d5db10>]}
[0m01:10:16.139884 [info ] [MainThread]: 
[0m01:10:16.140549 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:10:16.141985 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m01:10:16.142263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:16.861563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m01:10:16.862862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:17.333579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151d5df60>]}
[0m01:10:17.334887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:10:17.335328 [info ] [MainThread]: 
[0m01:10:17.338096 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_bikes
[0m01:10:17.338713 [info ] [Thread-1 (]: 1 of 22 START sql view model citibike_source_sql.raw_sql_bikes ................. [RUN]
[0m01:10:17.339590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.raw_sql_bikes)
[0m01:10:17.340057 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_bikes
[0m01:10:17.354677 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_bikes"
[0m01:10:17.355855 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (compile): 01:10:17.340341 => 01:10:17.355600
[0m01:10:17.356215 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_bikes
[0m01:10:17.380230 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_bikes"
[0m01:10:17.381025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:17.382194 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_bikes`;


[0m01:10:17.964567 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d0c68355-eb7c-4a94-b21c-525c9429b7e4&page=queryresults
[0m01:10:18.309508 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (execute): 01:10:17.356413 => 01:10:18.309144
[0m01:10:18.310815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151a410f0>]}
[0m01:10:18.311705 [info ] [Thread-1 (]: 1 of 22 OK created sql view model citibike_source_sql.raw_sql_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m01:10:18.312390 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_bikes
[0m01:10:18.312890 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_stations
[0m01:10:18.313869 [info ] [Thread-1 (]: 2 of 22 START sql view model citibike_source_sql.raw_sql_stations .............. [RUN]
[0m01:10:18.314763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_bikes, now model.dbt_bq_sa.raw_sql_stations)
[0m01:10:18.315260 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_stations
[0m01:10:18.325919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_stations"
[0m01:10:18.326820 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (compile): 01:10:18.315530 => 01:10:18.326602
[0m01:10:18.327236 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_stations
[0m01:10:18.332649 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_stations"
[0m01:10:18.333450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:18.335409 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_stations`;


[0m01:10:18.922992 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:39446364-741c-40a3-980c-3c22482cc720&page=queryresults
[0m01:10:19.245090 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (execute): 01:10:18.327587 => 01:10:19.244594
[0m01:10:19.246752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151fe4730>]}
[0m01:10:19.247762 [info ] [Thread-1 (]: 2 of 22 OK created sql view model citibike_source_sql.raw_sql_stations ......... [[32mCREATE VIEW (0 processed)[0m in 0.93s]
[0m01:10:19.248816 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_stations
[0m01:10:19.249668 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_trips
[0m01:10:19.250550 [info ] [Thread-1 (]: 3 of 22 START sql view model citibike_source_sql.raw_sql_trips ................. [RUN]
[0m01:10:19.251425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_stations, now model.dbt_bq_sa.raw_sql_trips)
[0m01:10:19.251891 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_trips
[0m01:10:19.258534 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_trips"
[0m01:10:19.259612 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (compile): 01:10:19.252174 => 01:10:19.259321
[0m01:10:19.260097 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_trips
[0m01:10:19.267522 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_trips"
[0m01:10:19.268350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:19.270237 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_trips`;


[0m01:10:19.872008 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8dd43ad0-027e-44e9-bc06-a8582f68f8cc&page=queryresults
[0m01:10:20.200411 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (execute): 01:10:19.260378 => 01:10:20.200009
[0m01:10:20.202223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152231480>]}
[0m01:10:20.203445 [info ] [Thread-1 (]: 3 of 22 OK created sql view model citibike_source_sql.raw_sql_trips ............ [[32mCREATE VIEW (0 processed)[0m in 0.95s]
[0m01:10:20.204369 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_trips
[0m01:10:20.205022 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_users
[0m01:10:20.205858 [info ] [Thread-1 (]: 4 of 22 START sql view model citibike_source_sql.raw_sql_users ................. [RUN]
[0m01:10:20.207102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_trips, now model.dbt_bq_sa.raw_sql_users)
[0m01:10:20.207667 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_users
[0m01:10:20.213554 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_users"
[0m01:10:20.215033 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (compile): 01:10:20.207999 => 01:10:20.214756
[0m01:10:20.215486 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_users
[0m01:10:20.220716 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_users"
[0m01:10:20.221829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:20.223787 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_users`;


[0m01:10:20.864570 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:148b76c9-f0b3-48c8-9589-ea42c9e0832f&page=queryresults
[0m01:10:21.172377 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (execute): 01:10:20.215749 => 01:10:21.172030
[0m01:10:21.173725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152230880>]}
[0m01:10:21.174656 [info ] [Thread-1 (]: 4 of 22 OK created sql view model citibike_source_sql.raw_sql_users ............ [[32mCREATE VIEW (0 processed)[0m in 0.97s]
[0m01:10:21.175425 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_users
[0m01:10:21.175962 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m01:10:21.176689 [info ] [Thread-1 (]: 5 of 22 START sql view model citibike_source_sql.dbt_stg_bikes ................. [RUN]
[0m01:10:21.177730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_users, now model.dbt_bq_sa.dbt_stg_bikes)
[0m01:10:21.178147 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m01:10:21.222722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:22.046572 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m01:10:22.047413 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 01:10:21.178382 => 01:10:22.047229
[0m01:10:22.047693 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m01:10:22.050624 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m01:10:22.051572 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    bike_type

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
),

derived_columns AS (

    SELECT

    bike_id,
    bike_type,
    'SRC_SQL_BIKES' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    BIKE_PK,
    BIKE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:10:22.771193 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:7b27ebde-906d-4d9b-a330-49581c293fdf&page=queryresults
[0m01:10:23.075770 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 01:10:22.047840 => 01:10:23.075370
[0m01:10:23.077369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15229f550>]}
[0m01:10:23.078286 [info ] [Thread-1 (]: 5 of 22 OK created sql view model citibike_source_sql.dbt_stg_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m01:10:23.079165 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m01:10:23.079890 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m01:10:23.081064 [info ] [Thread-1 (]: 6 of 22 START sql view model citibike_source_sql.dbt_stg_stations .............. [RUN]
[0m01:10:23.082362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m01:10:23.083002 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m01:10:23.093381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:23.734924 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m01:10:23.736324 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 01:10:23.083357 => 01:10:23.736015
[0m01:10:23.736782 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m01:10:23.741679 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_stations"
[0m01:10:23.742712 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
),

derived_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    'SRC_SQL_STATIONS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')
    )))) AS STRING) AS STATION_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    STATION_PK,
    STATION_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:10:24.456498 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:db6dbc83-b269-4ada-acb4-b1273224c9d5&page=queryresults
[0m01:10:24.788803 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 01:10:23.737034 => 01:10:24.788321
[0m01:10:24.791121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15229e920>]}
[0m01:10:24.792462 [info ] [Thread-1 (]: 6 of 22 OK created sql view model citibike_source_sql.dbt_stg_stations ......... [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m01:10:24.793441 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m01:10:24.794135 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m01:10:24.795032 [info ] [Thread-1 (]: 7 of 22 START sql view model citibike_source_sql.dbt_stg_trips ................. [RUN]
[0m01:10:24.796300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m01:10:24.797070 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m01:10:24.808901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:25.458236 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:10:25.459075 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 01:10:24.797505 => 01:10:25.458871
[0m01:10:25.459406 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m01:10:25.463681 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:10:25.464350 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_USERS_BIKES_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_BIKES_TRIPS_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_USERS_TRIPS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF,
    LINK_USERS_BIKES_PK,
    LINK_BIKES_TRIPS_PK,
    LINK_USERS_TRIPS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:10:26.170603 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:681dffc2-c749-46f9-98d9-2fee60f4751f&page=queryresults
[0m01:10:26.497830 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 01:10:25.459594 => 01:10:26.497375
[0m01:10:26.513719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151a410f0>]}
[0m01:10:26.519927 [info ] [Thread-1 (]: 7 of 22 OK created sql view model citibike_source_sql.dbt_stg_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m01:10:26.521392 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m01:10:26.522398 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m01:10:26.523912 [info ] [Thread-1 (]: 8 of 22 START sql view model citibike_source_sql.dbt_stg_users ................. [RUN]
[0m01:10:26.525326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m01:10:26.526077 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m01:10:26.533591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:27.083317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m01:10:27.084715 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 01:10:26.526536 => 01:10:27.084407
[0m01:10:27.085216 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m01:10:27.092054 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_users"
[0m01:10:27.092923 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
),

derived_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    'SRC_SQL_USERS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    USER_PK,
    USER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:10:27.768030 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d73d54df-9a98-4573-a2dd-0073d2a961d9&page=queryresults
[0m01:10:28.075923 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 01:10:27.085499 => 01:10:28.075442
[0m01:10:28.077732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15229f010>]}
[0m01:10:28.078860 [info ] [Thread-1 (]: 8 of 22 OK created sql view model citibike_source_sql.dbt_stg_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.55s]
[0m01:10:28.079751 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m01:10:28.080452 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:10:28.081322 [info ] [Thread-1 (]: 9 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_bikes ...... [RUN]
[0m01:10:28.082644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_users, now model.dbt_bq_sa.dbt_hub_sql_bikes)
[0m01:10:28.083205 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:10:28.112460 [info ] [Thread-1 (]: 01:10:28 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_bikes from 1 source(s)
[0m01:10:28.155655 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:10:28.156295 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (compile): 01:10:28.083538 => 01:10:28.156151
[0m01:10:28.156540 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:10:28.190092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:28.191157 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` AS d
    ON a.BIKE_PK = d.BIKE_PK
    WHERE d.BIKE_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:10:29.199587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:804cd93a-69ef-4481-a5f6-c5d9b7a4331d&page=queryresults
[0m01:10:31.252976 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:10:31.281997 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:10:31.283010 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
            )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:10:31.588893 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:ed7f8382-7213-47f7-9923-293cb4d430a6&page=queryresults
[0m01:10:32.971067 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (execute): 01:10:28.156672 => 01:10:32.970561
[0m01:10:32.972513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15229c130>]}
[0m01:10:32.973372 [info ] [Thread-1 (]: 9 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_bikes . [[32mMERGE (0.0 rows, 325.0 Bytes processed)[0m in 4.89s]
[0m01:10:32.973903 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:10:32.974266 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:10:32.974801 [info ] [Thread-1 (]: 10 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_bikes ..... [RUN]
[0m01:10:32.975333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_bikes, now model.dbt_bq_sa.dbt_sat_sql_bikes)
[0m01:10:32.975560 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:10:33.016813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m01:10:33.017659 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (compile): 01:10:32.975689 => 01:10:33.017523
[0m01:10:33.017877 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:10:33.021099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:33.023044 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.BIKE_PK, current_records.BIKE_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` AS current_records
    JOIN (
        SELECT DISTINCT source_data.BIKE_PK
        FROM source_data
    ) AS source_records
        ON source_records.BIKE_PK = current_records.BIKE_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.BIKE_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.BIKE_PK = frin.BIKE_PK
        AND lr.BIKE_HASHDIFF = frin.BIKE_HASHDIFF
        WHERE lr.BIKE_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:10:34.086667 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:bbe3ca8e-b00e-490f-96ec-7200eb90e994&page=queryresults
[0m01:10:36.082336 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:10:36.086934 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m01:10:36.088375 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
                ) and (
                    DBT_INTERNAL_SOURCE.BIKE_HASHDIFF = DBT_INTERNAL_DEST.BIKE_HASHDIFF
                )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`BIKE_HASHDIFF` = DBT_INTERNAL_SOURCE.`BIKE_HASHDIFF`,`bike_type` = DBT_INTERNAL_SOURCE.`bike_type`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:10:36.536539 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:6306f2f9-290a-4627-a0f3-9676c36756b8&page=queryresults
[0m01:10:37.618077 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (execute): 01:10:33.018005 => 01:10:37.617609
[0m01:10:37.619702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15201bf70>]}
[0m01:10:37.620699 [info ] [Thread-1 (]: 10 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_bikes  [[32mMERGE (0.0 rows, 502.0 Bytes processed)[0m in 4.64s]
[0m01:10:37.621665 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:10:37.622117 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:10:37.622418 [info ] [Thread-1 (]: 11 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_stations .. [RUN]
[0m01:10:37.623010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_bikes, now model.dbt_bq_sa.dbt_hub_sql_stations)
[0m01:10:37.623256 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:10:37.627678 [info ] [Thread-1 (]: 01:10:37 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_stations from 1 source(s)
[0m01:10:37.631194 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:10:37.631657 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (compile): 01:10:37.623385 => 01:10:37.631523
[0m01:10:37.631869 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:10:37.635920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:37.638398 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` AS d
    ON a.STATION_PK = d.STATION_PK
    WHERE d.STATION_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:10:38.710281 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:372bcbef-a68b-4623-854f-501c440eecf1&page=queryresults
[0m01:10:40.428270 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:10:40.432416 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:10:40.433887 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
            )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`station_id` = DBT_INTERNAL_SOURCE.`station_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:10:40.829871 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:21231f5e-bcad-4f7e-b22f-379c5608f029&page=queryresults
[0m01:10:42.215762 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (execute): 01:10:37.631992 => 01:10:42.215074
[0m01:10:42.218124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151fe4160>]}
[0m01:10:42.219574 [info ] [Thread-1 (]: 11 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 4.59s]
[0m01:10:42.220613 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:10:42.221373 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:10:42.222545 [info ] [Thread-1 (]: 12 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_stations .. [RUN]
[0m01:10:42.223836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_stations, now model.dbt_bq_sa.dbt_sat_sql_stations)
[0m01:10:42.224469 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:10:42.271871 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m01:10:42.272994 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (compile): 01:10:42.224840 => 01:10:42.272751
[0m01:10:42.273359 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:10:42.289388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:42.291264 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by STATION_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.STATION_PK, current_records.STATION_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` AS current_records
    JOIN (
        SELECT DISTINCT source_data.STATION_PK
        FROM source_data
    ) AS source_records
        ON source_records.STATION_PK = current_records.STATION_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.STATION_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.STATION_PK = frin.STATION_PK
        AND lr.STATION_HASHDIFF = frin.STATION_HASHDIFF
        WHERE lr.STATION_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:10:43.294722 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a45b6dfc-4088-4fe9-b7f4-d213839dac27&page=queryresults
[0m01:10:45.617458 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:10:45.621065 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m01:10:45.622484 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
                ) and (
                    DBT_INTERNAL_SOURCE.STATION_HASHDIFF = DBT_INTERNAL_DEST.STATION_HASHDIFF
                )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`STATION_HASHDIFF` = DBT_INTERNAL_SOURCE.`STATION_HASHDIFF`,`name` = DBT_INTERNAL_SOURCE.`name`,`short_name` = DBT_INTERNAL_SOURCE.`short_name`,`latitude` = DBT_INTERNAL_SOURCE.`latitude`,`longitude` = DBT_INTERNAL_SOURCE.`longitude`,`region_id` = DBT_INTERNAL_SOURCE.`region_id`,`rental_method` = DBT_INTERNAL_SOURCE.`rental_method`,`capacity` = DBT_INTERNAL_SOURCE.`capacity`,`last_reported` = DBT_INTERNAL_SOURCE.`last_reported`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:10:46.052143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c11601fe-ac2e-4352-97ce-e85d32c3bf21&page=queryresults
[0m01:10:47.489604 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (execute): 01:10:42.273559 => 01:10:47.489159
[0m01:10:47.491794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151af37f0>]}
[0m01:10:47.492847 [info ] [Thread-1 (]: 12 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.27s]
[0m01:10:47.493784 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:10:47.494459 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:10:47.495286 [info ] [Thread-1 (]: 13 of 22 START sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips . [RUN]
[0m01:10:47.496436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_stations, now model.dbt_bq_sa.dbt_eff_sat_link_users_trips)
[0m01:10:47.497074 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:10:47.566839 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:10:47.567452 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (compile): 01:10:47.497437 => 01:10:47.567304
[0m01:10:47.567688 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:10:47.570221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:48.031978 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:10:48.035292 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_eff_sat_link_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` as DBT_INTERNAL_DEST
        using (

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.USER_PK IS NOT NULL
    AND a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT * FROM (
        SELECT b.TRIP_PK, b.USER_PK, b.BIKE_PK, b.start_time, b.end_time, b.EFFECTIVE_FROM, b.LOAD_DATE, b.RECORD_SOURCE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` AS b
        QUALIFY ROW_NUMBER() OVER (
            PARTITION BY b.TRIP_PK
            ORDER BY b.LOAD_DATE DESC
        ) = 1
        ) AS inner_select
    
),

latest_open AS (
    SELECT c.TRIP_PK, c.USER_PK, c.BIKE_PK, c.start_time, c.end_time, c.EFFECTIVE_FROM, c.LOAD_DATE, c.RECORD_SOURCE
    FROM latest_records AS c
    WHERE DATE(c.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

latest_closed AS (
    SELECT d.TRIP_PK, d.USER_PK, d.BIKE_PK, d.start_time, d.end_time, d.EFFECTIVE_FROM, d.LOAD_DATE, d.RECORD_SOURCE
    FROM latest_records AS d
    WHERE DATE(d.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

new_open_records AS (
    SELECT DISTINCT
        f.TRIP_PK, f.USER_PK, f.BIKE_PK,
        f.start_time AS start_time,
        f.end_time AS end_time,
        f.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        f.LOAD_DATE,
        f.RECORD_SOURCE
    FROM source_data AS f
    LEFT JOIN latest_records AS lr
    ON f.TRIP_PK = lr.TRIP_PK
    WHERE lr.TRIP_PK IS NULL
),

new_reopened_records AS (
    SELECT DISTINCT
        lc.TRIP_PK, lc.USER_PK, lc.BIKE_PK,
        g.start_time AS start_time,
        g.end_time AS end_time,
        g.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        g.LOAD_DATE,
        g.RECORD_SOURCE
    FROM source_data AS g
    INNER JOIN latest_closed AS lc
    ON g.TRIP_PK = lc.TRIP_PK
    WHERE DATE(g.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),



new_closed_records AS (
    SELECT DISTINCT
        lo.TRIP_PK, lo.USER_PK, lo.BIKE_PK,
        h.start_time AS start_time,
        h.end_time AS end_time,
        h.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        h.LOAD_DATE,
        lo.RECORD_SOURCE
    FROM source_data AS h
    LEFT JOIN latest_open AS lo
    ON lo.TRIP_PK = h.TRIP_PK
    LEFT JOIN latest_closed AS lc
    ON lc.TRIP_PK = h.TRIP_PK
    WHERE DATE(h.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
    AND lo.TRIP_PK IS NOT NULL
    AND lc.TRIP_PK IS NULL
),

records_to_insert AS (
    SELECT * FROM new_open_records
    UNION DISTINCT
    SELECT * FROM new_reopened_records
    UNION DISTINCT
    SELECT * FROM new_closed_records
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:10:48.825256 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f004a068-a535-4e77-9b54-59ec1eac448c&page=queryresults
[0m01:10:50.207651 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (execute): 01:10:47.567817 => 01:10:50.207133
[0m01:10:50.209157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1523bff40>]}
[0m01:10:50.210095 [info ] [Thread-1 (]: 13 of 22 OK created sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips  [[32mMERGE (0.0 rows, 3.5 KiB processed)[0m in 2.71s]
[0m01:10:50.211004 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:10:50.211661 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:10:50.212509 [info ] [Thread-1 (]: 14 of 22 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [RUN]
[0m01:10:50.213697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_eff_sat_link_users_trips, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m01:10:50.214318 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:10:50.246121 [info ] [Thread-1 (]: 01:10:50 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m01:10:50.249573 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:10:50.250352 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 01:10:50.214679 => 01:10:50.250131
[0m01:10:50.250717 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:10:50.256718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:10:50.257389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:50.258814 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.DBT_SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS a
)

SELECT * FROM records_to_insert
    );
  
[0m01:10:51.330510 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:73504ee2-fc41-4181-a5c9-dc3abbfaea8a&page=queryresults
[0m01:10:51.471240 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]; reason: invalidQuery, location: query, message: Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]')
[0m01:10:52.402528 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:ed8d9195-88e0-470f-ad70-2e410352909d&page=queryresults
[0m01:10:52.493393 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:ed8d9195-88e0-470f-ad70-2e410352909d&page=queryresults
[0m01:10:52.495980 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 01:10:50.250947 => 01:10:52.495223
[0m01:10:52.507266 [debug] [Thread-1 (]: Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m01:10:52.508161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152230a00>]}
[0m01:10:52.509118 [error] [Thread-1 (]: 14 of 22 ERROR creating sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[31mERROR[0m in 2.29s]
[0m01:10:52.509532 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:10:52.509890 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:10:52.510164 [info ] [Thread-1 (]: 15 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_trips ..... [RUN]
[0m01:10:52.512001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_ext_track_sat_trips, now model.dbt_bq_sa.dbt_hub_sql_trips)
[0m01:10:52.512268 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:10:52.519671 [info ] [Thread-1 (]: 01:10:52 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_trips from 1 source(s)
[0m01:10:52.523684 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:10:52.524499 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (compile): 01:10:52.512416 => 01:10:52.524351
[0m01:10:52.524724 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:10:52.528433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:52.530180 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` AS d
    ON a.TRIP_PK = d.TRIP_PK
    WHERE d.TRIP_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:10:53.198465 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:33f34507-db0c-4a74-932b-b04060ad44de&page=queryresults
[0m01:10:55.237211 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:10:55.242274 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:10:55.243937 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
            )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`start_station_id` = DBT_INTERNAL_SOURCE.`start_station_id`,`end_station_id` = DBT_INTERNAL_SOURCE.`end_station_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:10:55.574581 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e3df7c6a-5269-4fa1-b8be-604512da17aa&page=queryresults
[0m01:10:57.011115 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (execute): 01:10:52.524846 => 01:10:57.010692
[0m01:10:57.012558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151ff2290>]}
[0m01:10:57.013520 [info ] [Thread-1 (]: 15 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_trips  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 4.50s]
[0m01:10:57.014418 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:10:57.015060 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:10:57.015891 [info ] [Thread-1 (]: 16 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [RUN]
[0m01:10:57.017109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_trips, now model.dbt_bq_sa.dbt_link_sql_bikes_trips)
[0m01:10:57.017764 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:10:57.034512 [info ] [Thread-1 (]: 01:10:57 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_bikes_trips from 1 source(s)
[0m01:10:57.056430 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:10:57.057191 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (compile): 01:10:57.018130 => 01:10:57.056991
[0m01:10:57.057511 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:10:57.061818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:10:57.063129 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_BIKES_TRIPS_PK, rr.BIKE_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_BIKES_TRIPS_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_BIKES_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_BIKES_TRIPS_PK, a.BIKE_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` AS d
    ON a.LINK_BIKES_TRIPS_PK = d.LINK_BIKES_TRIPS_PK
    WHERE d.LINK_BIKES_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:10:58.002399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5aafa012-66b0-4d9c-88b7-0ceaa901770a&page=queryresults
[0m01:11:00.018952 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:11:00.021800 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:11:00.022993 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_BIKES_TRIPS_PK = DBT_INTERNAL_DEST.LINK_BIKES_TRIPS_PK
            )

    
    when matched then update set
        `LINK_BIKES_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_BIKES_TRIPS_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:11:00.365306 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:1fffe6c2-042b-4f4c-a157-9cb4b544dfbe&page=queryresults
[0m01:11:01.881793 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (execute): 01:10:57.057696 => 01:11:01.878167
[0m01:11:01.925546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152317ee0>]}
[0m01:11:01.993923 [info ] [Thread-1 (]: 16 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 4.88s]
[0m01:11:02.012934 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:11:02.035970 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:11:02.056499 [info ] [Thread-1 (]: 17 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [RUN]
[0m01:11:02.177361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_bikes_trips, now model.dbt_bq_sa.dbt_link_sql_users_bikes)
[0m01:11:02.183307 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:11:02.855108 [info ] [Thread-1 (]: 01:11:02 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_bikes from 1 source(s)
[0m01:11:03.506803 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:11:03.555995 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (compile): 01:11:02.184060 => 01:11:03.530832
[0m01:11:03.616304 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:11:04.008000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:04.103769 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_BIKES_PK, rr.USER_PK, rr.BIKE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_BIKES_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_BIKES_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_BIKES_PK, a.USER_PK, a.BIKE_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` AS d
    ON a.LINK_USERS_BIKES_PK = d.LINK_USERS_BIKES_PK
    WHERE d.LINK_USERS_BIKES_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:11:05.441388 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:9656ba96-6dd4-4ee8-9389-117095028100&page=queryresults
[0m01:11:08.597961 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:11:08.616932 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:11:08.620993 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_BIKES_PK = DBT_INTERNAL_DEST.LINK_USERS_BIKES_PK
            )

    
    when matched then update set
        `LINK_USERS_BIKES_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_BIKES_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:11:08.939670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:868b6a96-f3f5-4964-b1bf-4374f88c4c4b&page=queryresults
[0m01:11:10.557901 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (execute): 01:11:03.761131 => 01:11:10.556945
[0m01:11:10.560758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151f49900>]}
[0m01:11:10.562432 [info ] [Thread-1 (]: 17 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [[32mMERGE (0.0 rows, 1.2 KiB processed)[0m in 8.47s]
[0m01:11:10.564716 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:11:10.565699 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:11:10.568909 [info ] [Thread-1 (]: 18 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [RUN]
[0m01:11:10.570425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_bikes, now model.dbt_bq_sa.dbt_link_sql_users_trips)
[0m01:11:10.571599 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:11:10.586518 [info ] [Thread-1 (]: 01:11:10 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_trips from 1 source(s)
[0m01:11:10.594429 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:11:10.595207 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (compile): 01:11:10.571846 => 01:11:10.595019
[0m01:11:10.595454 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:11:10.605834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:10.611195 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_TRIPS_PK, rr.USER_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_TRIPS_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_TRIPS_PK, a.USER_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` AS d
    ON a.LINK_USERS_TRIPS_PK = d.LINK_USERS_TRIPS_PK
    WHERE d.LINK_USERS_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:11:11.794782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:19286a69-2f2b-4dd5-9aa7-318d803b7026&page=queryresults
[0m01:11:13.548188 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:11:13.552393 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:11:13.553227 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_TRIPS_PK = DBT_INTERNAL_DEST.LINK_USERS_TRIPS_PK
            )

    
    when matched then update set
        `LINK_USERS_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_TRIPS_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:11:13.903324 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d3302710-3bd9-412e-9811-e1c7afe46ab9&page=queryresults
[0m01:11:15.288542 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (execute): 01:11:10.595735 => 01:11:15.287651
[0m01:11:15.289919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152547b50>]}
[0m01:11:15.290708 [info ] [Thread-1 (]: 18 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 4.72s]
[0m01:11:15.291124 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:11:15.291428 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:11:15.292812 [info ] [Thread-1 (]: 19 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_trips ..... [RUN]
[0m01:11:15.293408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_trips, now model.dbt_bq_sa.dbt_sat_sql_trips)
[0m01:11:15.293643 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:11:15.339684 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:11:15.341969 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (compile): 01:11:15.293777 => 01:11:15.340299
[0m01:11:15.342293 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:11:15.400194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:15.403010 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by TRIP_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.TRIP_PK, current_records.TRIP_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` AS current_records
    JOIN (
        SELECT DISTINCT source_data.TRIP_PK
        FROM source_data
    ) AS source_records
        ON source_records.TRIP_PK = current_records.TRIP_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.TRIP_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.TRIP_PK = frin.TRIP_PK
        AND lr.TRIP_HASHDIFF = frin.TRIP_HASHDIFF
        WHERE lr.TRIP_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:11:16.110783 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:79a5524f-211a-479e-8a4f-6754ec7f8efe&page=queryresults
[0m01:11:18.432090 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:11:18.439359 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:11:18.440806 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.TRIP_HASHDIFF = DBT_INTERNAL_DEST.TRIP_HASHDIFF
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`TRIP_HASHDIFF` = DBT_INTERNAL_SOURCE.`TRIP_HASHDIFF`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`trip_duration` = DBT_INTERNAL_SOURCE.`trip_duration`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:11:19.549492 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c02092c6-6313-4873-990c-e0c097625c21&page=queryresults
[0m01:11:20.377944 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (execute): 01:11:15.342525 => 01:11:20.377436
[0m01:11:20.379390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1524000d0>]}
[0m01:11:20.380185 [info ] [Thread-1 (]: 19 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_trips  [[32mMERGE (0.0 rows, 1.3 KiB processed)[0m in 5.09s]
[0m01:11:20.380628 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:11:20.380974 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:11:20.381499 [info ] [Thread-1 (]: 20 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_users ..... [RUN]
[0m01:11:20.381970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_trips, now model.dbt_bq_sa.dbt_hub_sql_users)
[0m01:11:20.382195 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:11:20.391846 [info ] [Thread-1 (]: 01:11:20 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_users from 1 source(s)
[0m01:11:20.397096 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:11:20.397952 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (compile): 01:11:20.382326 => 01:11:20.397809
[0m01:11:20.398176 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:11:20.401304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:20.402757 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` AS d
    ON a.USER_PK = d.USER_PK
    WHERE d.USER_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:11:21.404000 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c90c9859-a6d9-40dc-be17-6c1e322d6b57&page=queryresults
[0m01:11:23.453429 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:11:23.459683 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:11:23.461405 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
            )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:11:23.772769 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5857879e-0551-42ce-bf7e-e50a2f88e19d&page=queryresults
[0m01:11:25.168923 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (execute): 01:11:20.398299 => 01:11:25.168305
[0m01:11:25.170834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15256ff10>]}
[0m01:11:25.172143 [info ] [Thread-1 (]: 20 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_users  [[32mMERGE (0.0 rows, 650.0 Bytes processed)[0m in 4.79s]
[0m01:11:25.173213 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:11:25.177105 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:11:25.178458 [info ] [Thread-1 (]: 21 of 22 START sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [RUN]
[0m01:11:25.179792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_users, now model.dbt_bq_sa.dbt_multi_active_sat_users_plans)
[0m01:11:25.180410 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:11:25.238931 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:11:25.240003 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (compile): 01:11:25.180725 => 01:11:25.239810
[0m01:11:25.240304 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:11:25.243856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:11:25.244364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:25.245825 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    
WITH source_data AS (
    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS s
    WHERE s.USER_PK IS NOT NULL
        AND s.customer_plan IS NOT NULL
),

records_to_insert AS (
    SELECT source_data.USER_PK, source_data.customer_plan, source_data.user_type, source_data.HASHDIFF, source_data.EFFECTIVE_FROM, source_data.LOAD_DATE, source_data.RECORD_SOURCE
    FROM source_data
)

SELECT * FROM records_to_insert
    );
  
[0m01:11:26.302457 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:9488a65c-4d9e-4d37-8762-39a77f6da047&page=queryresults
[0m01:11:26.404986 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name HASHDIFF not found inside s at [19:64]; reason: invalidQuery, location: query, message: Name HASHDIFF not found inside s at [19:64]')
[0m01:11:27.319656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:6d5c07b7-c8ae-4e9e-8fbe-0d04e925c07e&page=queryresults
[0m01:11:27.423960 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:6d5c07b7-c8ae-4e9e-8fbe-0d04e925c07e&page=queryresults
[0m01:11:27.425238 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (execute): 01:11:25.240462 => 01:11:27.424836
[0m01:11:27.432188 [debug] [Thread-1 (]: Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:11:27.433043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1522ea830>]}
[0m01:11:27.433948 [error] [Thread-1 (]: 21 of 22 ERROR creating sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [[31mERROR[0m in 2.25s]
[0m01:11:27.434752 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:11:27.435326 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:11:27.439683 [info ] [Thread-1 (]: 22 of 22 START sql incremental model citibike_source_sql.dbt sat_sql_users ..... [RUN]
[0m01:11:27.440592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_multi_active_sat_users_plans, now model.dbt_bq_sa.dbt_sat_sql_users)
[0m01:11:27.441036 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:11:27.476295 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:11:27.477633 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (compile): 01:11:27.441287 => 01:11:27.477485
[0m01:11:27.477899 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:11:27.496118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:27.497815 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by USER_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.USER_PK, current_records.USER_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` AS current_records
    JOIN (
        SELECT DISTINCT source_data.USER_PK
        FROM source_data
    ) AS source_records
        ON source_records.USER_PK = current_records.USER_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.USER_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.USER_PK = frin.USER_PK
        AND lr.USER_HASHDIFF = frin.USER_HASHDIFF
        WHERE lr.USER_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:11:28.174319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a96ba682-64b5-4cdd-a0b8-8f0a9e72fa36&page=queryresults
[0m01:11:30.541538 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:11:30.546545 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:11:30.548110 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
                ) and (
                    DBT_INTERNAL_SOURCE.USER_HASHDIFF = DBT_INTERNAL_DEST.USER_HASHDIFF
                )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`USER_HASHDIFF` = DBT_INTERNAL_SOURCE.`USER_HASHDIFF`,`user_type` = DBT_INTERNAL_SOURCE.`user_type`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`birth_year` = DBT_INTERNAL_SOURCE.`birth_year`,`customer_plan` = DBT_INTERNAL_SOURCE.`customer_plan`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:11:30.854998 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f8ed533b-1494-4ecd-85b9-c6434d44a77b&page=queryresults
[0m01:11:32.230257 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (execute): 01:11:27.478041 => 01:11:32.229627
[0m01:11:32.232588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf91585-e53f-42c3-8b1e-f433f8b36ebf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152317f40>]}
[0m01:11:32.234303 [info ] [Thread-1 (]: 22 of 22 OK created sql incremental model citibike_source_sql.dbt sat_sql_users  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 4.79s]
[0m01:11:32.235194 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:11:32.246739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:32.247302 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_sat_sql_users' was properly closed.
[0m01:11:32.248107 [info ] [MainThread]: 
[0m01:11:32.249081 [info ] [MainThread]: Finished running 8 view models, 14 incremental models in 0 hours 1 minutes and 16.11 seconds (76.11s).
[0m01:11:32.254617 [debug] [MainThread]: Command end result
[0m01:11:32.293613 [info ] [MainThread]: 
[0m01:11:32.293968 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:11:32.294177 [info ] [MainThread]: 
[0m01:11:32.294599 [error] [MainThread]:   Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name DBT_SAT_SQL_TRIPS not found inside s at [24:14]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m01:11:32.294796 [info ] [MainThread]: 
[0m01:11:32.294982 [error] [MainThread]:   Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:11:32.295196 [info ] [MainThread]: 
[0m01:11:32.296412 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=2 SKIP=0 TOTAL=22
[0m01:11:32.319598 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 77.20102, "process_user_time": 5.557924, "process_kernel_time": 2.020068, "process_mem_max_rss": "201408512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:11:32.320690 [debug] [MainThread]: Command `dbt run` failed at 01:11:32.320612 after 77.20 seconds
[0m01:11:32.321913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba25c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c1b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151d5e680>]}
[0m01:11:33.567300 [debug] [MainThread]: Flushing usage events
[0m01:16:47.138062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10382f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105907340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105906f50>]}


============================== 01:16:47.141359 | 66983635-1783-42b1-ae73-8312933a1777 ==============================
[0m01:16:47.141359 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:16:47.141675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s dbt_stg_trips', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:16:47.956499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66983635-1783-42b1-ae73-8312933a1777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105906e60>]}
[0m01:16:47.989081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66983635-1783-42b1-ae73-8312933a1777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b9d4b0>]}
[0m01:16:47.989690 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m01:16:48.011975 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:16:48.147938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:16:48.149358 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_trips.sql
[0m01:16:48.392086 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.raw_vault
- models.business_vault
- models.stage
[0m01:16:48.396456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66983635-1783-42b1-ae73-8312933a1777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134bb8610>]}
[0m01:16:48.484601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66983635-1783-42b1-ae73-8312933a1777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1349aae90>]}
[0m01:16:48.485366 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m01:16:48.485637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66983635-1783-42b1-ae73-8312933a1777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1349a8400>]}
[0m01:16:48.486638 [info ] [MainThread]: 
[0m01:16:48.487683 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:16:48.488996 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m01:16:48.490045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:49.372396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m01:16:49.373407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:16:49.864982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66983635-1783-42b1-ae73-8312933a1777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134a59cf0>]}
[0m01:16:49.868795 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:16:49.870568 [info ] [MainThread]: 
[0m01:16:49.873828 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m01:16:49.890682 [info ] [Thread-1 (]: 1 of 1 START sql view model citibike_source_sql.dbt_stg_trips .................. [RUN]
[0m01:16:49.891881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.dbt_stg_trips)
[0m01:16:49.892403 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m01:16:49.908334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:16:50.595905 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:16:50.597058 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 01:16:49.892723 => 01:16:50.596855
[0m01:16:50.597388 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m01:16:50.619520 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:16:50.620552 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM,
    'DBT_SAT_SQL_TRIPS' AS DBT_SAT_SQL_TRIPS

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    DBT_SAT_SQL_TRIPS,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_USERS_BIKES_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_BIKES_TRIPS_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_USERS_TRIPS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    DBT_SAT_SQL_TRIPS,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF,
    LINK_USERS_BIKES_PK,
    LINK_BIKES_TRIPS_PK,
    LINK_USERS_TRIPS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:16:51.370856 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0fc5040e-2bb3-4ca1-bd6d-43ca5c229500&page=queryresults
[0m01:16:51.860079 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 01:16:50.597577 => 01:16:51.859811
[0m01:16:51.861564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66983635-1783-42b1-ae73-8312933a1777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13493a8c0>]}
[0m01:16:51.862188 [info ] [Thread-1 (]: 1 of 1 OK created sql view model citibike_source_sql.dbt_stg_trips ............. [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m01:16:51.862580 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m01:16:51.864181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:51.864370 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_stg_trips' was properly closed.
[0m01:16:51.864553 [info ] [MainThread]: 
[0m01:16:51.864762 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m01:16:51.865207 [debug] [MainThread]: Command end result
[0m01:16:51.882928 [info ] [MainThread]: 
[0m01:16:51.883308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:16:51.883485 [info ] [MainThread]: 
[0m01:16:51.883713 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:16:51.886105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7861056, "process_user_time": 2.806683, "process_kernel_time": 1.379584, "process_mem_max_rss": "204980224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:16:51.886499 [debug] [MainThread]: Command `dbt run` succeeded at 01:16:51.886430 after 4.79 seconds
[0m01:16:51.886850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10382f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10201d930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105906e60>]}
[0m01:16:51.887097 [debug] [MainThread]: Flushing usage events
[0m01:17:05.704953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae2f80>]}


============================== 01:17:05.708238 | 8abcbf07-bcfa-4b20-aa6c-f18d87ffeace ==============================
[0m01:17:05.708238 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:17:05.708548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s dbt_ext_track_sat_trips', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:17:06.511558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8abcbf07-bcfa-4b20-aa6c-f18d87ffeace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ae2e90>]}
[0m01:17:06.541614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8abcbf07-bcfa-4b20-aa6c-f18d87ffeace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a802e0>]}
[0m01:17:06.542096 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m01:17:06.559743 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:17:06.608646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:06.608959 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:06.609645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.raw_vault
- models.business_vault
- models.stage
[0m01:17:06.613769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8abcbf07-bcfa-4b20-aa6c-f18d87ffeace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a44c0d0>]}
[0m01:17:06.626293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8abcbf07-bcfa-4b20-aa6c-f18d87ffeace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a2766b0>]}
[0m01:17:06.626627 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m01:17:06.626830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8abcbf07-bcfa-4b20-aa6c-f18d87ffeace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a2759c0>]}
[0m01:17:06.627758 [info ] [MainThread]: 
[0m01:17:06.628217 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:17:06.628817 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m01:17:06.629030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:07.395537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m01:17:07.396687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:07.897950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8abcbf07-bcfa-4b20-aa6c-f18d87ffeace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a2753c0>]}
[0m01:17:07.899352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:17:07.899804 [info ] [MainThread]: 
[0m01:17:07.902162 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:17:07.902787 [info ] [Thread-1 (]: 1 of 1 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips . [RUN]
[0m01:17:07.903889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m01:17:07.904385 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:17:07.946094 [info ] [Thread-1 (]: 01:17:07 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m01:17:07.972690 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:17:07.973686 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 01:17:07.904663 => 01:17:07.973522
[0m01:17:07.973920 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:17:08.008942 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:17:08.009483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:08.010397 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.DBT_SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS a
)

SELECT * FROM records_to_insert
    );
  
[0m01:17:09.098390 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:31a1337a-3ebd-4130-ac1d-888ebdacdbeb&page=queryresults
[0m01:17:10.792973 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 01:17:07.974046 => 01:17:10.792650
[0m01:17:10.794156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8abcbf07-bcfa-4b20-aa6c-f18d87ffeace', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a44d900>]}
[0m01:17:10.794899 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[32mCREATE TABLE (20.0 rows, 1.1 KiB processed)[0m in 2.89s]
[0m01:17:10.795554 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:17:10.797475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:10.797875 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_ext_track_sat_trips' was properly closed.
[0m01:17:10.798233 [info ] [MainThread]: 
[0m01:17:10.798607 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.17 seconds (4.17s).
[0m01:17:10.799319 [debug] [MainThread]: Command end result
[0m01:17:10.821478 [info ] [MainThread]: 
[0m01:17:10.821993 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:17:10.822267 [info ] [MainThread]: 
[0m01:17:10.822595 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:17:10.824598 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1549416, "process_user_time": 2.51402, "process_kernel_time": 1.390631, "process_mem_max_rss": "204914688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:17:10.825063 [debug] [MainThread]: Command `dbt run` succeeded at 01:17:10.824960 after 5.16 seconds
[0m01:17:10.825429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df1360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149729480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14a4ce470>]}
[0m01:17:10.825748 [debug] [MainThread]: Flushing usage events
[0m01:17:35.706357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e1b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e1af80>]}


============================== 01:17:35.709373 | 01893372-dc72-41a9-bde9-63df2610965e ==============================
[0m01:17:35.709373 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:17:35.709686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:17:36.571212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e1ae90>]}
[0m01:17:36.601359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dc4e80>]}
[0m01:17:36.601911 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m01:17:36.619155 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:17:36.674443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:36.674746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:36.675486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.business_vault
- models.raw_vault
- models.stage
[0m01:17:36.679681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15294c0d0>]}
[0m01:17:36.691464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f5e620>]}
[0m01:17:36.691768 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m01:17:36.691972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f5d930>]}
[0m01:17:36.693567 [info ] [MainThread]: 
[0m01:17:36.694046 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:17:36.695409 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m01:17:36.695595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:37.412825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m01:17:37.415523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:37.828359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f5dd80>]}
[0m01:17:37.829774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:17:37.830229 [info ] [MainThread]: 
[0m01:17:37.833629 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_bikes
[0m01:17:37.834293 [info ] [Thread-1 (]: 1 of 22 START sql view model citibike_source_sql.raw_sql_bikes ................. [RUN]
[0m01:17:37.835196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.raw_sql_bikes)
[0m01:17:37.835664 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_bikes
[0m01:17:37.847688 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_bikes"
[0m01:17:37.849534 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (compile): 01:17:37.835945 => 01:17:37.849105
[0m01:17:37.850117 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_bikes
[0m01:17:37.878688 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_bikes"
[0m01:17:37.879509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:37.880707 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_bikes`;


[0m01:17:38.401698 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:31dd53ce-7f9c-48e6-9fd1-f31ae3e68732&page=queryresults
[0m01:17:38.841416 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (execute): 01:17:37.850399 => 01:17:38.841053
[0m01:17:38.842706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1528ff3d0>]}
[0m01:17:38.843524 [info ] [Thread-1 (]: 1 of 22 OK created sql view model citibike_source_sql.raw_sql_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.01s]
[0m01:17:38.844214 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_bikes
[0m01:17:38.844701 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_stations
[0m01:17:38.845207 [info ] [Thread-1 (]: 2 of 22 START sql view model citibike_source_sql.raw_sql_stations .............. [RUN]
[0m01:17:38.846163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_bikes, now model.dbt_bq_sa.raw_sql_stations)
[0m01:17:38.846571 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_stations
[0m01:17:38.851279 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_stations"
[0m01:17:38.852171 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (compile): 01:17:38.846822 => 01:17:38.851953
[0m01:17:38.852549 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_stations
[0m01:17:38.856727 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_stations"
[0m01:17:38.857666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:38.859256 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_stations`;


[0m01:17:39.506012 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:ae7d2726-0b71-4178-833d-396b5fa5b396&page=queryresults
[0m01:17:39.898759 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (execute): 01:17:38.852763 => 01:17:39.898391
[0m01:17:39.900333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1529e8dc0>]}
[0m01:17:39.901439 [info ] [Thread-1 (]: 2 of 22 OK created sql view model citibike_source_sql.raw_sql_stations ......... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m01:17:39.902419 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_stations
[0m01:17:39.903096 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_trips
[0m01:17:39.903969 [info ] [Thread-1 (]: 3 of 22 START sql view model citibike_source_sql.raw_sql_trips ................. [RUN]
[0m01:17:39.905281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_stations, now model.dbt_bq_sa.raw_sql_trips)
[0m01:17:39.905883 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_trips
[0m01:17:39.912901 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_trips"
[0m01:17:39.914044 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (compile): 01:17:39.906232 => 01:17:39.913753
[0m01:17:39.914510 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_trips
[0m01:17:39.922005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_trips"
[0m01:17:39.922911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:39.924706 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_trips`;


[0m01:17:40.676995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e9205060-0c9a-4dd4-af85-e205183a1aa2&page=queryresults
[0m01:17:40.924444 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (execute): 01:17:39.914796 => 01:17:40.923871
[0m01:17:40.926696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152b353f0>]}
[0m01:17:40.927796 [info ] [Thread-1 (]: 3 of 22 OK created sql view model citibike_source_sql.raw_sql_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m01:17:40.928760 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_trips
[0m01:17:40.929430 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_users
[0m01:17:40.930315 [info ] [Thread-1 (]: 4 of 22 START sql view model citibike_source_sql.raw_sql_users ................. [RUN]
[0m01:17:40.931649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_trips, now model.dbt_bq_sa.raw_sql_users)
[0m01:17:40.932211 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_users
[0m01:17:40.938463 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_users"
[0m01:17:40.939615 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (compile): 01:17:40.932553 => 01:17:40.939313
[0m01:17:40.940292 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_users
[0m01:17:40.946900 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_users"
[0m01:17:40.948066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:40.949894 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_users`;


[0m01:17:41.591768 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:30ae5511-c680-4e77-8d70-6d6b62d72dd4&page=queryresults
[0m01:17:42.004457 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (execute): 01:17:40.940758 => 01:17:42.004065
[0m01:17:42.005935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152b35120>]}
[0m01:17:42.006918 [info ] [Thread-1 (]: 4 of 22 OK created sql view model citibike_source_sql.raw_sql_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.07s]
[0m01:17:42.007926 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_users
[0m01:17:42.008655 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m01:17:42.009904 [info ] [Thread-1 (]: 5 of 22 START sql view model citibike_source_sql.dbt_stg_bikes ................. [RUN]
[0m01:17:42.011807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_users, now model.dbt_bq_sa.dbt_stg_bikes)
[0m01:17:42.012623 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m01:17:42.054437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:42.814545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m01:17:42.815476 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 01:17:42.013292 => 01:17:42.815304
[0m01:17:42.815730 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m01:17:42.818384 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m01:17:42.818807 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    bike_type

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
),

derived_columns AS (

    SELECT

    bike_id,
    bike_type,
    'SRC_SQL_BIKES' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    BIKE_PK,
    BIKE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:17:43.639519 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8d83b6b9-7267-45af-a63a-655fa4a57c7e&page=queryresults
[0m01:17:43.880114 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 01:17:42.815878 => 01:17:43.879622
[0m01:17:43.881717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152b52770>]}
[0m01:17:43.882705 [info ] [Thread-1 (]: 5 of 22 OK created sql view model citibike_source_sql.dbt_stg_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.87s]
[0m01:17:43.883640 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m01:17:43.884327 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m01:17:43.885271 [info ] [Thread-1 (]: 6 of 22 START sql view model citibike_source_sql.dbt_stg_stations .............. [RUN]
[0m01:17:43.886383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m01:17:43.886952 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m01:17:43.897951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:44.452260 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m01:17:44.454444 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 01:17:43.887297 => 01:17:44.454133
[0m01:17:44.454918 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m01:17:44.460179 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_stations"
[0m01:17:44.461247 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
),

derived_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    'SRC_SQL_STATIONS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')
    )))) AS STRING) AS STATION_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    STATION_PK,
    STATION_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:17:45.174059 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a27b98f1-4f71-4709-88dc-2683af487c40&page=queryresults
[0m01:17:45.506309 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 01:17:44.455193 => 01:17:45.505819
[0m01:17:45.508504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152b537c0>]}
[0m01:17:45.509775 [info ] [Thread-1 (]: 6 of 22 OK created sql view model citibike_source_sql.dbt_stg_stations ......... [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m01:17:45.510739 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m01:17:45.511416 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m01:17:45.512269 [info ] [Thread-1 (]: 7 of 22 START sql view model citibike_source_sql.dbt_stg_trips ................. [RUN]
[0m01:17:45.513567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m01:17:45.514169 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m01:17:45.525802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:46.091674 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:17:46.092507 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 01:17:45.514511 => 01:17:46.092310
[0m01:17:46.092849 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m01:17:46.097032 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:17:46.098167 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM,
    'DBT_SAT_SQL_TRIPS' AS DBT_SAT_SQL_TRIPS

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    DBT_SAT_SQL_TRIPS,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_USERS_BIKES_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_BIKES_TRIPS_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_USERS_TRIPS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    DBT_SAT_SQL_TRIPS,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF,
    LINK_USERS_BIKES_PK,
    LINK_BIKES_TRIPS_PK,
    LINK_USERS_TRIPS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:17:46.781749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:01894a00-732c-4a3c-90f9-bc5c719ac787&page=queryresults
[0m01:17:47.126329 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 01:17:46.093044 => 01:17:47.125544
[0m01:17:47.128225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f5dd80>]}
[0m01:17:47.129230 [info ] [Thread-1 (]: 7 of 22 OK created sql view model citibike_source_sql.dbt_stg_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m01:17:47.130153 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m01:17:47.130830 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m01:17:47.131726 [info ] [Thread-1 (]: 8 of 22 START sql view model citibike_source_sql.dbt_stg_users ................. [RUN]
[0m01:17:47.133256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m01:17:47.133872 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m01:17:47.143303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:47.768431 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m01:17:47.770254 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 01:17:47.134237 => 01:17:47.769880
[0m01:17:47.770824 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m01:17:47.778057 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_users"
[0m01:17:47.779199 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
),

derived_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    'SRC_SQL_USERS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    USER_PK,
    USER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:17:48.555116 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2aead91e-f21d-4c3e-ab4e-991d674a66f2&page=queryresults
[0m01:17:48.968099 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 01:17:47.771129 => 01:17:48.967478
[0m01:17:48.969860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152b537c0>]}
[0m01:17:48.970894 [info ] [Thread-1 (]: 8 of 22 OK created sql view model citibike_source_sql.dbt_stg_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.84s]
[0m01:17:48.971840 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m01:17:48.972513 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:17:48.973368 [info ] [Thread-1 (]: 9 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_bikes ...... [RUN]
[0m01:17:48.974797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_users, now model.dbt_bq_sa.dbt_hub_sql_bikes)
[0m01:17:48.975420 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:17:49.003716 [info ] [Thread-1 (]: 01:17:49 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_bikes from 1 source(s)
[0m01:17:49.046911 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:17:49.048229 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (compile): 01:17:48.975772 => 01:17:49.048068
[0m01:17:49.048476 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:17:49.078804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:49.079834 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` AS d
    ON a.BIKE_PK = d.BIKE_PK
    WHERE d.BIKE_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:17:50.210074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d960b171-4367-40b4-8398-6bbc92354cbf&page=queryresults
[0m01:17:52.031974 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:17:52.055785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:17:52.057312 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
            )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:17:52.359922 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:fc1bc3d9-647a-4d70-99b9-5919d92c6950&page=queryresults
[0m01:17:53.787368 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (execute): 01:17:49.048615 => 01:17:53.786669
[0m01:17:53.789056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1528ffee0>]}
[0m01:17:53.790061 [info ] [Thread-1 (]: 9 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_bikes . [[32mMERGE (0.0 rows, 325.0 Bytes processed)[0m in 4.81s]
[0m01:17:53.790815 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:17:53.791413 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:17:53.800506 [info ] [Thread-1 (]: 10 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_bikes ..... [RUN]
[0m01:17:53.801667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_bikes, now model.dbt_bq_sa.dbt_sat_sql_bikes)
[0m01:17:53.802093 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:17:53.862157 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m01:17:53.863517 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (compile): 01:17:53.802457 => 01:17:53.863371
[0m01:17:53.863757 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:17:53.866934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:53.868374 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.BIKE_PK, current_records.BIKE_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` AS current_records
    JOIN (
        SELECT DISTINCT source_data.BIKE_PK
        FROM source_data
    ) AS source_records
        ON source_records.BIKE_PK = current_records.BIKE_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.BIKE_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.BIKE_PK = frin.BIKE_PK
        AND lr.BIKE_HASHDIFF = frin.BIKE_HASHDIFF
        WHERE lr.BIKE_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:17:54.906298 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8a8f8997-d573-42d9-b635-1a9b55dffb4c&page=queryresults
[0m01:17:57.364285 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:17:57.368007 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m01:17:57.370689 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
                ) and (
                    DBT_INTERNAL_SOURCE.BIKE_HASHDIFF = DBT_INTERNAL_DEST.BIKE_HASHDIFF
                )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`BIKE_HASHDIFF` = DBT_INTERNAL_SOURCE.`BIKE_HASHDIFF`,`bike_type` = DBT_INTERNAL_SOURCE.`bike_type`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:17:57.771676 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f3b2736d-b94a-4212-97dc-3ff6eab2becd&page=queryresults
[0m01:17:58.886680 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (execute): 01:17:53.863892 => 01:17:58.886105
[0m01:17:58.888857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152b7be20>]}
[0m01:17:58.890121 [info ] [Thread-1 (]: 10 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_bikes  [[32mMERGE (0.0 rows, 502.0 Bytes processed)[0m in 5.09s]
[0m01:17:58.891144 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:17:58.891858 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:17:58.892730 [info ] [Thread-1 (]: 11 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_stations .. [RUN]
[0m01:17:58.893837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_bikes, now model.dbt_bq_sa.dbt_hub_sql_stations)
[0m01:17:58.894369 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:17:58.906763 [info ] [Thread-1 (]: 01:17:58 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_stations from 1 source(s)
[0m01:17:58.917294 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:17:58.918361 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (compile): 01:17:58.894672 => 01:17:58.918096
[0m01:17:58.918789 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:17:58.926505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:17:58.928224 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` AS d
    ON a.STATION_PK = d.STATION_PK
    WHERE d.STATION_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:18:00.022392 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0b70e0cb-b15a-47d8-bd42-373df48f365f&page=queryresults
[0m01:18:02.034272 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:18:02.037594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:18:02.038898 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
            )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`station_id` = DBT_INTERNAL_SOURCE.`station_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:18:02.481664 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f49a0eed-356a-4047-af41-08a27ef5fe8c&page=queryresults
[0m01:18:03.848347 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (execute): 01:17:58.919180 => 01:18:03.847749
[0m01:18:03.851089 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f5e290>]}
[0m01:18:03.852578 [info ] [Thread-1 (]: 11 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 4.96s]
[0m01:18:03.853645 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:18:03.854422 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:18:03.855554 [info ] [Thread-1 (]: 12 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_stations .. [RUN]
[0m01:18:03.856667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_stations, now model.dbt_bq_sa.dbt_sat_sql_stations)
[0m01:18:03.857256 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:18:03.900042 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m01:18:03.901252 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (compile): 01:18:03.857613 => 01:18:03.901007
[0m01:18:03.901659 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:18:03.916014 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:03.918003 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by STATION_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.STATION_PK, current_records.STATION_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` AS current_records
    JOIN (
        SELECT DISTINCT source_data.STATION_PK
        FROM source_data
    ) AS source_records
        ON source_records.STATION_PK = current_records.STATION_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.STATION_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.STATION_PK = frin.STATION_PK
        AND lr.STATION_HASHDIFF = frin.STATION_HASHDIFF
        WHERE lr.STATION_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:18:04.999774 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:37747793-e4f5-41f8-a8ab-52005e705d03&page=queryresults
[0m01:18:07.283416 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:18:07.287558 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m01:18:07.288722 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
                ) and (
                    DBT_INTERNAL_SOURCE.STATION_HASHDIFF = DBT_INTERNAL_DEST.STATION_HASHDIFF
                )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`STATION_HASHDIFF` = DBT_INTERNAL_SOURCE.`STATION_HASHDIFF`,`name` = DBT_INTERNAL_SOURCE.`name`,`short_name` = DBT_INTERNAL_SOURCE.`short_name`,`latitude` = DBT_INTERNAL_SOURCE.`latitude`,`longitude` = DBT_INTERNAL_SOURCE.`longitude`,`region_id` = DBT_INTERNAL_SOURCE.`region_id`,`rental_method` = DBT_INTERNAL_SOURCE.`rental_method`,`capacity` = DBT_INTERNAL_SOURCE.`capacity`,`last_reported` = DBT_INTERNAL_SOURCE.`last_reported`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:18:07.703934 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c6197fcb-1066-4a75-ae49-0ddd10f46132&page=queryresults
[0m01:18:09.337560 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (execute): 01:18:03.901878 => 01:18:09.336971
[0m01:18:09.339998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137b49db0>]}
[0m01:18:09.341645 [info ] [Thread-1 (]: 12 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.48s]
[0m01:18:09.342715 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:18:09.343449 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:18:09.344363 [info ] [Thread-1 (]: 13 of 22 START sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips . [RUN]
[0m01:18:09.345640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_stations, now model.dbt_bq_sa.dbt_eff_sat_link_users_trips)
[0m01:18:09.346274 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:18:09.422887 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:18:09.423570 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (compile): 01:18:09.346637 => 01:18:09.423421
[0m01:18:09.423813 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:18:09.426403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:09.876111 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:18:09.877473 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_eff_sat_link_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` as DBT_INTERNAL_DEST
        using (

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.USER_PK IS NOT NULL
    AND a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT * FROM (
        SELECT b.TRIP_PK, b.USER_PK, b.BIKE_PK, b.start_time, b.end_time, b.EFFECTIVE_FROM, b.LOAD_DATE, b.RECORD_SOURCE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` AS b
        QUALIFY ROW_NUMBER() OVER (
            PARTITION BY b.TRIP_PK
            ORDER BY b.LOAD_DATE DESC
        ) = 1
        ) AS inner_select
    
),

latest_open AS (
    SELECT c.TRIP_PK, c.USER_PK, c.BIKE_PK, c.start_time, c.end_time, c.EFFECTIVE_FROM, c.LOAD_DATE, c.RECORD_SOURCE
    FROM latest_records AS c
    WHERE DATE(c.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

latest_closed AS (
    SELECT d.TRIP_PK, d.USER_PK, d.BIKE_PK, d.start_time, d.end_time, d.EFFECTIVE_FROM, d.LOAD_DATE, d.RECORD_SOURCE
    FROM latest_records AS d
    WHERE DATE(d.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

new_open_records AS (
    SELECT DISTINCT
        f.TRIP_PK, f.USER_PK, f.BIKE_PK,
        f.start_time AS start_time,
        f.end_time AS end_time,
        f.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        f.LOAD_DATE,
        f.RECORD_SOURCE
    FROM source_data AS f
    LEFT JOIN latest_records AS lr
    ON f.TRIP_PK = lr.TRIP_PK
    WHERE lr.TRIP_PK IS NULL
),

new_reopened_records AS (
    SELECT DISTINCT
        lc.TRIP_PK, lc.USER_PK, lc.BIKE_PK,
        g.start_time AS start_time,
        g.end_time AS end_time,
        g.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        g.LOAD_DATE,
        g.RECORD_SOURCE
    FROM source_data AS g
    INNER JOIN latest_closed AS lc
    ON g.TRIP_PK = lc.TRIP_PK
    WHERE DATE(g.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),



new_closed_records AS (
    SELECT DISTINCT
        lo.TRIP_PK, lo.USER_PK, lo.BIKE_PK,
        h.start_time AS start_time,
        h.end_time AS end_time,
        h.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        h.LOAD_DATE,
        lo.RECORD_SOURCE
    FROM source_data AS h
    LEFT JOIN latest_open AS lo
    ON lo.TRIP_PK = h.TRIP_PK
    LEFT JOIN latest_closed AS lc
    ON lc.TRIP_PK = h.TRIP_PK
    WHERE DATE(h.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
    AND lo.TRIP_PK IS NOT NULL
    AND lc.TRIP_PK IS NULL
),

records_to_insert AS (
    SELECT * FROM new_open_records
    UNION DISTINCT
    SELECT * FROM new_reopened_records
    UNION DISTINCT
    SELECT * FROM new_closed_records
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:18:10.673820 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4ab8f4e0-038c-4300-b9ed-6b78e7ce61d3&page=queryresults
[0m01:18:12.078798 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (execute): 01:18:09.423947 => 01:18:12.078008
[0m01:18:12.080718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1529e8220>]}
[0m01:18:12.081985 [info ] [Thread-1 (]: 13 of 22 OK created sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips  [[32mMERGE (0.0 rows, 3.5 KiB processed)[0m in 2.74s]
[0m01:18:12.083005 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:18:12.083757 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:18:12.084848 [info ] [Thread-1 (]: 14 of 22 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [RUN]
[0m01:18:12.085940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_eff_sat_link_users_trips, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m01:18:12.086502 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:18:12.118879 [info ] [Thread-1 (]: 01:18:12 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m01:18:12.122314 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:18:12.122980 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 01:18:12.086849 => 01:18:12.122788
[0m01:18:12.123302 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:18:12.129005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:12.130903 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.DBT_SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips` AS d
        ON (
            a.HASHDIFF = d.HASHDIFF
            AND a.LOAD_DATE = d.LOAD_DATE
            AND a.SATELLITE_NAME = d.SATELLITE_NAME
        )
    WHERE d.HASHDIFF IS NULL
    AND d.LOAD_DATE IS NULL
    AND d.SATELLITE_NAME IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:18:13.112734 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:775dcc9e-4821-45e2-a715-4c30a494ab35&page=queryresults
[0m01:18:15.164634 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:18:15.169070 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:18:15.170550 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.EXT_TRACK_HASH_ID = DBT_INTERNAL_DEST.EXT_TRACK_HASH_ID
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`HASHDIFF` = DBT_INTERNAL_SOURCE.`HASHDIFF`,`SATELLITE_NAME` = DBT_INTERNAL_SOURCE.`SATELLITE_NAME`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `HASHDIFF`, `SATELLITE_NAME`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `HASHDIFF`, `SATELLITE_NAME`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:18:15.486398 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a519f2ef-f3c6-4da6-8383-08541800a3d6&page=queryresults
[0m01:18:15.591190 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name EXT_TRACK_HASH_ID not found inside DBT_INTERNAL_SOURCE at [21:41]; reason: invalidQuery, location: query, message: Name EXT_TRACK_HASH_ID not found inside DBT_INTERNAL_SOURCE at [21:41]')
[0m01:18:16.101301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:007a6c13-4b55-4027-b9a7-1d09307ef811&page=queryresults
[0m01:18:16.202553 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:007a6c13-4b55-4027-b9a7-1d09307ef811&page=queryresults
[0m01:18:16.204896 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 01:18:12.123482 => 01:18:16.204385
[0m01:18:16.215367 [debug] [Thread-1 (]: Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name EXT_TRACK_HASH_ID not found inside DBT_INTERNAL_SOURCE at [21:41]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m01:18:16.216313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152b53790>]}
[0m01:18:16.217386 [error] [Thread-1 (]: 14 of 22 ERROR creating sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[31mERROR[0m in 4.13s]
[0m01:18:16.218326 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:18:16.219507 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:18:16.223125 [info ] [Thread-1 (]: 15 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_trips ..... [RUN]
[0m01:18:16.224183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_ext_track_sat_trips, now model.dbt_bq_sa.dbt_hub_sql_trips)
[0m01:18:16.224659 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:18:16.234483 [info ] [Thread-1 (]: 01:18:16 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_trips from 1 source(s)
[0m01:18:16.241330 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:18:16.242191 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (compile): 01:18:16.224938 => 01:18:16.241966
[0m01:18:16.242564 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:18:16.247437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:16.249099 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` AS d
    ON a.TRIP_PK = d.TRIP_PK
    WHERE d.TRIP_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:18:17.302724 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b15c577c-84ec-4c4d-b2b1-e3b830c9cf6a&page=queryresults
[0m01:18:19.326960 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:18:19.332397 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:18:19.334689 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
            )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`start_station_id` = DBT_INTERNAL_SOURCE.`start_station_id`,`end_station_id` = DBT_INTERNAL_SOURCE.`end_station_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:18:19.685188 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d5e21568-e8e7-48d6-90bb-bae3cab8083a&page=queryresults
[0m01:18:21.023535 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (execute): 01:18:16.242778 => 01:18:21.022873
[0m01:18:21.024905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1529f7610>]}
[0m01:18:21.025843 [info ] [Thread-1 (]: 15 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_trips  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 4.80s]
[0m01:18:21.026641 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:18:21.027204 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:18:21.027937 [info ] [Thread-1 (]: 16 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [RUN]
[0m01:18:21.028977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_trips, now model.dbt_bq_sa.dbt_link_sql_bikes_trips)
[0m01:18:21.029477 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:18:21.044915 [info ] [Thread-1 (]: 01:18:21 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_bikes_trips from 1 source(s)
[0m01:18:21.065911 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:18:21.066719 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (compile): 01:18:21.029768 => 01:18:21.066535
[0m01:18:21.067014 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:18:21.070822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:21.072092 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_BIKES_TRIPS_PK, rr.BIKE_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_BIKES_TRIPS_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_BIKES_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_BIKES_TRIPS_PK, a.BIKE_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` AS d
    ON a.LINK_BIKES_TRIPS_PK = d.LINK_BIKES_TRIPS_PK
    WHERE d.LINK_BIKES_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:18:21.739735 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d053fae0-63f1-4514-ab1b-b63aab3bab51&page=queryresults
[0m01:18:23.627737 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:18:23.633518 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:18:23.635160 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_BIKES_TRIPS_PK = DBT_INTERNAL_DEST.LINK_BIKES_TRIPS_PK
            )

    
    when matched then update set
        `LINK_BIKES_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_BIKES_TRIPS_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:18:24.087868 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:692404df-3ff8-4e57-9fec-04960716c03f&page=queryresults
[0m01:18:25.277384 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (execute): 01:18:21.067188 => 01:18:25.277109
[0m01:18:25.278636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15294ceb0>]}
[0m01:18:25.279427 [info ] [Thread-1 (]: 16 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 4.25s]
[0m01:18:25.279887 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:18:25.280266 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:18:25.280931 [info ] [Thread-1 (]: 17 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [RUN]
[0m01:18:25.281687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_bikes_trips, now model.dbt_bq_sa.dbt_link_sql_users_bikes)
[0m01:18:25.281961 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:18:25.294510 [info ] [Thread-1 (]: 01:18:25 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_bikes from 1 source(s)
[0m01:18:25.301867 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:18:25.302565 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (compile): 01:18:25.282133 => 01:18:25.302409
[0m01:18:25.302823 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:18:25.309703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:25.371597 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_BIKES_PK, rr.USER_PK, rr.BIKE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_BIKES_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_BIKES_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_BIKES_PK, a.USER_PK, a.BIKE_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` AS d
    ON a.LINK_USERS_BIKES_PK = d.LINK_USERS_BIKES_PK
    WHERE d.LINK_USERS_BIKES_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:18:26.134432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c2f6fa18-cb97-4b3f-ad14-bbbb3f3b4953&page=queryresults
[0m01:18:27.968482 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:18:27.971913 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:18:27.973410 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_BIKES_PK = DBT_INTERNAL_DEST.LINK_USERS_BIKES_PK
            )

    
    when matched then update set
        `LINK_USERS_BIKES_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_BIKES_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:18:28.301792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:34a4c315-e038-40e6-b44a-d7637056a396&page=queryresults
[0m01:18:29.678396 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (execute): 01:18:25.302967 => 01:18:29.677862
[0m01:18:29.680147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137f5dd80>]}
[0m01:18:29.681259 [info ] [Thread-1 (]: 17 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [[32mMERGE (0.0 rows, 1.2 KiB processed)[0m in 4.40s]
[0m01:18:29.682131 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:18:29.682825 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:18:29.683904 [info ] [Thread-1 (]: 18 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [RUN]
[0m01:18:29.685074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_bikes, now model.dbt_bq_sa.dbt_link_sql_users_trips)
[0m01:18:29.685640 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:18:29.703578 [info ] [Thread-1 (]: 01:18:29 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_trips from 1 source(s)
[0m01:18:29.713176 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:18:29.714822 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (compile): 01:18:29.686363 => 01:18:29.714455
[0m01:18:29.715351 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:18:29.722463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:29.724538 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_TRIPS_PK, rr.USER_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_TRIPS_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_TRIPS_PK, a.USER_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` AS d
    ON a.LINK_USERS_TRIPS_PK = d.LINK_USERS_TRIPS_PK
    WHERE d.LINK_USERS_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:18:30.854139 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2aa20236-3729-4230-ad2f-a551a2b9e990&page=queryresults
[0m01:18:32.974598 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:18:32.980234 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:18:32.981903 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_TRIPS_PK = DBT_INTERNAL_DEST.LINK_USERS_TRIPS_PK
            )

    
    when matched then update set
        `LINK_USERS_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_TRIPS_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:18:33.291215 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8c3af9db-8060-42c6-b7ba-6ddf3d39f008&page=queryresults
[0m01:18:35.130851 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (execute): 01:18:29.715647 => 01:18:35.113888
[0m01:18:35.159535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152e43b80>]}
[0m01:18:35.166079 [info ] [Thread-1 (]: 18 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 5.47s]
[0m01:18:35.168447 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:18:35.169877 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:18:35.171250 [info ] [Thread-1 (]: 19 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_trips ..... [RUN]
[0m01:18:35.175466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_trips, now model.dbt_bq_sa.dbt_sat_sql_trips)
[0m01:18:35.176570 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:18:35.578233 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:18:35.580646 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (compile): 01:18:35.176897 => 01:18:35.579790
[0m01:18:35.582146 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:18:35.675220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:35.714008 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by TRIP_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.TRIP_PK, current_records.TRIP_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` AS current_records
    JOIN (
        SELECT DISTINCT source_data.TRIP_PK
        FROM source_data
    ) AS source_records
        ON source_records.TRIP_PK = current_records.TRIP_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.TRIP_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.TRIP_PK = frin.TRIP_PK
        AND lr.TRIP_HASHDIFF = frin.TRIP_HASHDIFF
        WHERE lr.TRIP_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:18:37.007001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:73cd935d-2a65-49c0-b825-91042b5a0b24&page=queryresults
[0m01:18:39.456298 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:18:39.463746 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:18:39.470312 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.TRIP_HASHDIFF = DBT_INTERNAL_DEST.TRIP_HASHDIFF
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`TRIP_HASHDIFF` = DBT_INTERNAL_SOURCE.`TRIP_HASHDIFF`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`trip_duration` = DBT_INTERNAL_SOURCE.`trip_duration`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:18:39.825929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a2dc73cd-472c-40b6-8074-57f58fa10eaa&page=queryresults
[0m01:18:41.546731 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (execute): 01:18:35.582917 => 01:18:41.542481
[0m01:18:41.551149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152e07ca0>]}
[0m01:18:41.552871 [info ] [Thread-1 (]: 19 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_trips  [[32mMERGE (0.0 rows, 1.3 KiB processed)[0m in 6.38s]
[0m01:18:41.554040 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:18:41.554393 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:18:41.554705 [info ] [Thread-1 (]: 20 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_users ..... [RUN]
[0m01:18:41.558543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_trips, now model.dbt_bq_sa.dbt_hub_sql_users)
[0m01:18:41.559872 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:18:41.596553 [info ] [Thread-1 (]: 01:18:41 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_users from 1 source(s)
[0m01:18:41.605767 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:18:41.607954 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (compile): 01:18:41.560110 => 01:18:41.607660
[0m01:18:41.608307 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:18:41.613433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:41.621122 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` AS d
    ON a.USER_PK = d.USER_PK
    WHERE d.USER_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:18:43.264452 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:51de49d1-09d8-4297-a1ce-84541f0be852&page=queryresults
[0m01:18:44.704915 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:18:44.710922 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:18:44.713187 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
            )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:18:45.056711 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:301495f9-2307-4e76-856b-06f9b2cf54e3&page=queryresults
[0m01:18:46.413795 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (execute): 01:18:41.608459 => 01:18:46.413509
[0m01:18:46.415224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152e77ca0>]}
[0m01:18:46.416119 [info ] [Thread-1 (]: 20 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_users  [[32mMERGE (0.0 rows, 650.0 Bytes processed)[0m in 4.86s]
[0m01:18:46.416542 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:18:46.416868 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:18:46.417486 [info ] [Thread-1 (]: 21 of 22 START sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [RUN]
[0m01:18:46.418072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_users, now model.dbt_bq_sa.dbt_multi_active_sat_users_plans)
[0m01:18:46.418306 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:18:46.462104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:18:46.462728 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (compile): 01:18:46.418443 => 01:18:46.462579
[0m01:18:46.462962 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:18:46.466609 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:18:46.467283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:46.469254 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    
WITH source_data AS (
    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS s
    WHERE s.USER_PK IS NOT NULL
        AND s.customer_plan IS NOT NULL
),

records_to_insert AS (
    SELECT source_data.USER_PK, source_data.customer_plan, source_data.user_type, source_data.HASHDIFF, source_data.EFFECTIVE_FROM, source_data.LOAD_DATE, source_data.RECORD_SOURCE
    FROM source_data
)

SELECT * FROM records_to_insert
    );
  
[0m01:18:47.479615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:59de41ca-0bf3-458c-aa90-69066a0137b4&page=queryresults
[0m01:18:47.579422 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name HASHDIFF not found inside s at [19:64]; reason: invalidQuery, location: query, message: Name HASHDIFF not found inside s at [19:64]')
[0m01:18:49.166106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5ce48266-312e-42c8-a027-0792acfe829f&page=queryresults
[0m01:18:49.256823 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5ce48266-312e-42c8-a027-0792acfe829f&page=queryresults
[0m01:18:49.264533 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (execute): 01:18:46.463091 => 01:18:49.263362
[0m01:18:49.279023 [debug] [Thread-1 (]: Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:18:49.280569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152cbc760>]}
[0m01:18:49.281822 [error] [Thread-1 (]: 21 of 22 ERROR creating sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [[31mERROR[0m in 2.86s]
[0m01:18:49.282360 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:18:49.282842 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:18:49.288943 [info ] [Thread-1 (]: 22 of 22 START sql incremental model citibike_source_sql.dbt sat_sql_users ..... [RUN]
[0m01:18:49.292738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_multi_active_sat_users_plans, now model.dbt_bq_sa.dbt_sat_sql_users)
[0m01:18:49.294093 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:18:49.396378 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:18:49.398182 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (compile): 01:18:49.295165 => 01:18:49.397999
[0m01:18:49.398427 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:18:49.415765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:49.422677 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by USER_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.USER_PK, current_records.USER_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` AS current_records
    JOIN (
        SELECT DISTINCT source_data.USER_PK
        FROM source_data
    ) AS source_records
        ON source_records.USER_PK = current_records.USER_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.USER_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.USER_PK = frin.USER_PK
        AND lr.USER_HASHDIFF = frin.USER_HASHDIFF
        WHERE lr.USER_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:18:50.153094 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d47000a8-b873-463f-96c0-91d7edce708e&page=queryresults
[0m01:18:53.185504 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:18:53.262602 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:18:54.232021 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
                ) and (
                    DBT_INTERNAL_SOURCE.USER_HASHDIFF = DBT_INTERNAL_DEST.USER_HASHDIFF
                )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`USER_HASHDIFF` = DBT_INTERNAL_SOURCE.`USER_HASHDIFF`,`user_type` = DBT_INTERNAL_SOURCE.`user_type`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`birth_year` = DBT_INTERNAL_SOURCE.`birth_year`,`customer_plan` = DBT_INTERNAL_SOURCE.`customer_plan`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:18:54.589690 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0fb5c545-5619-4d38-9d81-495230021d99&page=queryresults
[0m01:18:56.275721 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (execute): 01:18:49.398558 => 01:18:56.268736
[0m01:18:56.278815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01893372-dc72-41a9-bde9-63df2610965e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152bf1db0>]}
[0m01:18:56.281557 [info ] [Thread-1 (]: 22 of 22 OK created sql incremental model citibike_source_sql.dbt sat_sql_users  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 6.99s]
[0m01:18:56.284096 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:18:56.331147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:56.332750 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_sat_sql_users' was properly closed.
[0m01:18:56.333432 [info ] [MainThread]: 
[0m01:18:56.336019 [info ] [MainThread]: Finished running 8 view models, 14 incremental models in 0 hours 1 minutes and 19.64 seconds (79.64s).
[0m01:18:56.349642 [debug] [MainThread]: Command end result
[0m01:18:56.521569 [info ] [MainThread]: 
[0m01:18:56.524487 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:18:56.525053 [info ] [MainThread]: 
[0m01:18:56.526197 [error] [MainThread]:   Database Error in model dbt_ext_track_sat_trips (models/raw_vault/sats/dbt_ext_track_sat_trips.sql)
  Name EXT_TRACK_HASH_ID not found inside DBT_INTERNAL_SOURCE at [21:41]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m01:18:56.526579 [info ] [MainThread]: 
[0m01:18:56.527017 [error] [MainThread]:   Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:18:56.527683 [info ] [MainThread]: 
[0m01:18:56.533381 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=2 SKIP=0 TOTAL=22
[0m01:18:56.685124 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 81.00988, "process_user_time": 5.885376, "process_kernel_time": 1.852438, "process_mem_max_rss": "197672960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:18:56.690677 [debug] [MainThread]: Command `dbt run` failed at 01:18:56.690351 after 81.02 seconds
[0m01:18:56.692727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f29b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dc4e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x152eb2860>]}
[0m01:18:59.276097 [debug] [MainThread]: Flushing usage events
[0m01:24:22.518455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ddf370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ddef80>]}


============================== 01:24:22.521481 | c26c8fbc-9007-4ad4-8837-ff774306c701 ==============================
[0m01:24:22.521481 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:24:22.521797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:24:23.448232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ddee90>]}
[0m01:24:23.478117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d85990>]}
[0m01:24:23.478718 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m01:24:23.496105 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:24:23.558236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:24:23.558735 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_ext_track_sat_trips.sql
[0m01:24:23.674171 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.business_vault
- models.stage
- models.raw_vault
[0m01:24:23.677511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150dd9660>]}
[0m01:24:23.688751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15095e710>]}
[0m01:24:23.689046 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m01:24:23.689242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15095da20>]}
[0m01:24:23.690483 [info ] [MainThread]: 
[0m01:24:23.690911 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:24:23.691971 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m01:24:23.692189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:24:24.739351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m01:24:24.741963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:24:25.250815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15095de70>]}
[0m01:24:25.252171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:24:25.252636 [info ] [MainThread]: 
[0m01:24:25.324402 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_bikes
[0m01:24:25.324796 [info ] [Thread-1 (]: 1 of 22 START sql view model citibike_source_sql.raw_sql_bikes ................. [RUN]
[0m01:24:25.325254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.raw_sql_bikes)
[0m01:24:25.325471 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_bikes
[0m01:24:25.331094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_bikes"
[0m01:24:25.332629 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (compile): 01:24:25.325598 => 01:24:25.332464
[0m01:24:25.332860 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_bikes
[0m01:24:25.349321 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_bikes"
[0m01:24:25.349953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:25.350821 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_bikes`;


[0m01:24:26.271676 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:3ffe0447-f228-42a5-8e50-23f01e62350f&page=queryresults
[0m01:24:26.760314 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (execute): 01:24:25.332987 => 01:24:26.759882
[0m01:24:26.761802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c34af0>]}
[0m01:24:26.762786 [info ] [Thread-1 (]: 1 of 22 OK created sql view model citibike_source_sql.raw_sql_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m01:24:26.763603 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_bikes
[0m01:24:26.764067 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_stations
[0m01:24:26.764894 [info ] [Thread-1 (]: 2 of 22 START sql view model citibike_source_sql.raw_sql_stations .............. [RUN]
[0m01:24:26.765790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_bikes, now model.dbt_bq_sa.raw_sql_stations)
[0m01:24:26.766241 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_stations
[0m01:24:26.773477 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_stations"
[0m01:24:26.774357 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (compile): 01:24:26.766495 => 01:24:26.774150
[0m01:24:26.774705 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_stations
[0m01:24:26.778920 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_stations"
[0m01:24:26.779519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:26.781151 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_stations`;


[0m01:24:27.707845 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a489cc2e-6f6e-43eb-a7ff-5f187cf9712a&page=queryresults
[0m01:24:28.235703 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (execute): 01:24:26.774913 => 01:24:28.235240
[0m01:24:28.237843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150d0e740>]}
[0m01:24:28.239258 [info ] [Thread-1 (]: 2 of 22 OK created sql view model citibike_source_sql.raw_sql_stations ......... [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m01:24:28.240767 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_stations
[0m01:24:28.241464 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_trips
[0m01:24:28.242345 [info ] [Thread-1 (]: 3 of 22 START sql view model citibike_source_sql.raw_sql_trips ................. [RUN]
[0m01:24:28.243753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_stations, now model.dbt_bq_sa.raw_sql_trips)
[0m01:24:28.244413 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_trips
[0m01:24:28.251487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_trips"
[0m01:24:28.252614 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (compile): 01:24:28.244774 => 01:24:28.252322
[0m01:24:28.253106 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_trips
[0m01:24:28.259599 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_trips"
[0m01:24:28.260598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:28.262638 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_trips`;


[0m01:24:29.108737 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:7c443793-2afe-4d71-83f1-8eb632d28637&page=queryresults
[0m01:24:29.583543 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (execute): 01:24:28.253386 => 01:24:29.583132
[0m01:24:29.586854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150719210>]}
[0m01:24:29.593183 [info ] [Thread-1 (]: 3 of 22 OK created sql view model citibike_source_sql.raw_sql_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.34s]
[0m01:24:29.594115 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_trips
[0m01:24:29.595163 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_users
[0m01:24:29.595864 [info ] [Thread-1 (]: 4 of 22 START sql view model citibike_source_sql.raw_sql_users ................. [RUN]
[0m01:24:29.597238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_trips, now model.dbt_bq_sa.raw_sql_users)
[0m01:24:29.597761 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_users
[0m01:24:29.608124 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_users"
[0m01:24:29.609018 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (compile): 01:24:29.597934 => 01:24:29.608796
[0m01:24:29.609338 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_users
[0m01:24:29.613594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_users"
[0m01:24:29.614231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:29.615808 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_users`;


[0m01:24:30.298670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8fad2e8b-1ae5-4417-9c3f-6423e4d421ff&page=queryresults
[0m01:24:30.914633 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (execute): 01:24:29.609505 => 01:24:30.910141
[0m01:24:30.918763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15052bdc0>]}
[0m01:24:30.920242 [info ] [Thread-1 (]: 4 of 22 OK created sql view model citibike_source_sql.raw_sql_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m01:24:30.921201 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_users
[0m01:24:30.923846 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m01:24:30.929388 [info ] [Thread-1 (]: 5 of 22 START sql view model citibike_source_sql.dbt_stg_bikes ................. [RUN]
[0m01:24:30.935952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_users, now model.dbt_bq_sa.dbt_stg_bikes)
[0m01:24:30.936799 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m01:24:31.033682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:31.758838 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m01:24:31.774558 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 01:24:30.937359 => 01:24:31.774294
[0m01:24:31.792423 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m01:24:31.797155 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m01:24:31.811666 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    bike_type

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
),

derived_columns AS (

    SELECT

    bike_id,
    bike_type,
    'SRC_SQL_BIKES' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    BIKE_PK,
    BIKE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:24:32.469661 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:84b97bf0-770a-479e-a33a-089490fe3a3c&page=queryresults
[0m01:24:33.145997 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 01:24:31.793462 => 01:24:33.145632
[0m01:24:33.147531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1505287c0>]}
[0m01:24:33.148236 [info ] [Thread-1 (]: 5 of 22 OK created sql view model citibike_source_sql.dbt_stg_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 2.22s]
[0m01:24:33.148765 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m01:24:33.149166 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m01:24:33.149516 [info ] [Thread-1 (]: 6 of 22 START sql view model citibike_source_sql.dbt_stg_stations .............. [RUN]
[0m01:24:33.150371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m01:24:33.150915 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m01:24:33.160392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:33.810655 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m01:24:33.811940 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 01:24:33.151117 => 01:24:33.811634
[0m01:24:33.812468 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m01:24:33.817463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_stations"
[0m01:24:33.818590 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
),

derived_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    'SRC_SQL_STATIONS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')
    )))) AS STRING) AS STATION_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    STATION_PK,
    STATION_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:24:34.452572 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:32fd097f-fccd-47df-b223-c20831217f6e&page=queryresults
[0m01:24:35.005801 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 01:24:33.812774 => 01:24:35.005287
[0m01:24:35.007542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c34af0>]}
[0m01:24:35.008591 [info ] [Thread-1 (]: 6 of 22 OK created sql view model citibike_source_sql.dbt_stg_stations ......... [[32mCREATE VIEW (0 processed)[0m in 1.86s]
[0m01:24:35.009492 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m01:24:35.010172 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m01:24:35.011116 [info ] [Thread-1 (]: 7 of 22 START sql view model citibike_source_sql.dbt_stg_trips ................. [RUN]
[0m01:24:35.012359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m01:24:35.013029 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m01:24:35.022597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:35.692934 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:24:35.693755 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 01:24:35.013398 => 01:24:35.693553
[0m01:24:35.694094 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m01:24:35.698353 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:24:35.699064 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM,
    'DBT_SAT_SQL_TRIPS' AS DBT_SAT_SQL_TRIPS

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    DBT_SAT_SQL_TRIPS,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_USERS_BIKES_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_BIKES_TRIPS_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_USERS_TRIPS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    DBT_SAT_SQL_TRIPS,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF,
    LINK_USERS_BIKES_PK,
    LINK_BIKES_TRIPS_PK,
    LINK_USERS_TRIPS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:24:36.361697 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5a3aec89-2da8-41d5-bf31-aee8ea98266d&page=queryresults
[0m01:24:36.681583 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 01:24:35.694293 => 01:24:36.681123
[0m01:24:36.683069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150c34af0>]}
[0m01:24:36.684044 [info ] [Thread-1 (]: 7 of 22 OK created sql view model citibike_source_sql.dbt_stg_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m01:24:36.685187 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m01:24:36.685805 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m01:24:36.686981 [info ] [Thread-1 (]: 8 of 22 START sql view model citibike_source_sql.dbt_stg_users ................. [RUN]
[0m01:24:36.687914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m01:24:36.688393 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m01:24:36.697731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:37.346153 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m01:24:37.347929 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 01:24:36.688675 => 01:24:37.347606
[0m01:24:37.348450 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m01:24:37.354270 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_users"
[0m01:24:37.355253 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
),

derived_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    'SRC_SQL_USERS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    USER_PK,
    USER_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:24:38.056136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:37035ea4-02fa-4080-b927-1831351da62c&page=queryresults
[0m01:24:38.393623 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 01:24:37.348746 => 01:24:38.393166
[0m01:24:38.395184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15071ba00>]}
[0m01:24:38.396275 [info ] [Thread-1 (]: 8 of 22 OK created sql view model citibike_source_sql.dbt_stg_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m01:24:38.397188 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m01:24:38.397852 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:24:38.398838 [info ] [Thread-1 (]: 9 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_bikes ...... [RUN]
[0m01:24:38.400295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_users, now model.dbt_bq_sa.dbt_hub_sql_bikes)
[0m01:24:38.400911 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:24:38.427275 [info ] [Thread-1 (]: 01:24:38 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_bikes from 1 source(s)
[0m01:24:38.449903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:24:38.451262 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (compile): 01:24:38.401209 => 01:24:38.451053
[0m01:24:38.451565 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:24:38.485189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:38.486390 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` AS d
    ON a.BIKE_PK = d.BIKE_PK
    WHERE d.BIKE_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:24:39.491213 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:77b79470-e8c8-48d2-b5ed-7e59b34be02d&page=queryresults
[0m01:24:41.556069 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:24:41.584804 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:24:41.587235 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
            )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:24:41.938466 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4b19a078-51f1-4572-a313-532dfe3fb89b&page=queryresults
[0m01:24:43.289784 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (execute): 01:24:38.451726 => 01:24:43.289139
[0m01:24:43.291909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d84250>]}
[0m01:24:43.292917 [info ] [Thread-1 (]: 9 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_bikes . [[32mMERGE (0.0 rows, 325.0 Bytes processed)[0m in 4.89s]
[0m01:24:43.293840 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:24:43.294500 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:24:43.295248 [info ] [Thread-1 (]: 10 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_bikes ..... [RUN]
[0m01:24:43.296260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_bikes, now model.dbt_bq_sa.dbt_sat_sql_bikes)
[0m01:24:43.296807 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:24:43.362901 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m01:24:43.364418 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (compile): 01:24:43.297147 => 01:24:43.364239
[0m01:24:43.364690 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:24:43.368443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:43.369518 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.BIKE_PK, current_records.BIKE_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` AS current_records
    JOIN (
        SELECT DISTINCT source_data.BIKE_PK
        FROM source_data
    ) AS source_records
        ON source_records.BIKE_PK = current_records.BIKE_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.BIKE_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.BIKE_PK = frin.BIKE_PK
        AND lr.BIKE_HASHDIFF = frin.BIKE_HASHDIFF
        WHERE lr.BIKE_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:24:44.510448 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a95e0f6e-2205-4ee3-a1b1-f43dd0ae7620&page=queryresults
[0m01:24:46.534088 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:24:46.540520 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m01:24:46.542340 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
                ) and (
                    DBT_INTERNAL_SOURCE.BIKE_HASHDIFF = DBT_INTERNAL_DEST.BIKE_HASHDIFF
                )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`BIKE_HASHDIFF` = DBT_INTERNAL_SOURCE.`BIKE_HASHDIFF`,`bike_type` = DBT_INTERNAL_SOURCE.`bike_type`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:24:46.855927 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:103aa0b2-60eb-4c3e-8b40-2c1a4db2cee1&page=queryresults
[0m01:24:48.210508 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (execute): 01:24:43.364839 => 01:24:48.209734
[0m01:24:48.212896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150cc8c70>]}
[0m01:24:48.214412 [info ] [Thread-1 (]: 10 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_bikes  [[32mMERGE (0.0 rows, 502.0 Bytes processed)[0m in 4.92s]
[0m01:24:48.215376 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:24:48.216006 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:24:48.217124 [info ] [Thread-1 (]: 11 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_stations .. [RUN]
[0m01:24:48.218317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_bikes, now model.dbt_bq_sa.dbt_hub_sql_stations)
[0m01:24:48.218850 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:24:48.243802 [info ] [Thread-1 (]: 01:24:48 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_stations from 1 source(s)
[0m01:24:48.250814 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:24:48.252133 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (compile): 01:24:48.219157 => 01:24:48.251833
[0m01:24:48.252586 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:24:48.258290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:48.261110 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` AS d
    ON a.STATION_PK = d.STATION_PK
    WHERE d.STATION_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:24:49.416243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8811e1d9-5cd8-4db2-8593-4de4b8cfff1e&page=queryresults
[0m01:24:51.467520 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:24:51.476872 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:24:51.479794 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
            )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`station_id` = DBT_INTERNAL_SOURCE.`station_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:24:51.836051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:6834637d-eb6e-4c6b-af4d-4eca92c9d644&page=queryresults
[0m01:24:53.197234 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (execute): 01:24:48.252817 => 01:24:53.196681
[0m01:24:53.199994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150e94e50>]}
[0m01:24:53.200853 [info ] [Thread-1 (]: 11 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 4.98s]
[0m01:24:53.201502 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:24:53.201982 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:24:53.202555 [info ] [Thread-1 (]: 12 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_stations .. [RUN]
[0m01:24:53.203111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_stations, now model.dbt_bq_sa.dbt_sat_sql_stations)
[0m01:24:53.203336 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:24:53.227635 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m01:24:53.228545 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (compile): 01:24:53.203463 => 01:24:53.228369
[0m01:24:53.228815 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:24:53.268652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:53.270428 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by STATION_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.STATION_PK, current_records.STATION_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` AS current_records
    JOIN (
        SELECT DISTINCT source_data.STATION_PK
        FROM source_data
    ) AS source_records
        ON source_records.STATION_PK = current_records.STATION_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.STATION_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.STATION_PK = frin.STATION_PK
        AND lr.STATION_HASHDIFF = frin.STATION_HASHDIFF
        WHERE lr.STATION_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:24:54.388582 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b9ce019b-e2ec-40cd-bfa0-909d00df2cc2&page=queryresults
[0m01:24:56.812170 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:24:56.817202 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m01:24:56.818819 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
                ) and (
                    DBT_INTERNAL_SOURCE.STATION_HASHDIFF = DBT_INTERNAL_DEST.STATION_HASHDIFF
                )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`STATION_HASHDIFF` = DBT_INTERNAL_SOURCE.`STATION_HASHDIFF`,`name` = DBT_INTERNAL_SOURCE.`name`,`short_name` = DBT_INTERNAL_SOURCE.`short_name`,`latitude` = DBT_INTERNAL_SOURCE.`latitude`,`longitude` = DBT_INTERNAL_SOURCE.`longitude`,`region_id` = DBT_INTERNAL_SOURCE.`region_id`,`rental_method` = DBT_INTERNAL_SOURCE.`rental_method`,`capacity` = DBT_INTERNAL_SOURCE.`capacity`,`last_reported` = DBT_INTERNAL_SOURCE.`last_reported`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:24:57.315480 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5ab10426-4b9f-4493-98fd-28c559f767b7&page=queryresults
[0m01:24:58.772742 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (execute): 01:24:53.228950 => 01:24:58.772083
[0m01:24:58.776453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150e94130>]}
[0m01:24:58.777286 [info ] [Thread-1 (]: 12 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.57s]
[0m01:24:58.777829 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:24:58.778495 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:24:58.779179 [info ] [Thread-1 (]: 13 of 22 START sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips . [RUN]
[0m01:24:58.779871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_stations, now model.dbt_bq_sa.dbt_eff_sat_link_users_trips)
[0m01:24:58.780185 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:24:58.858279 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:24:58.860562 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (compile): 01:24:58.780359 => 01:24:58.860409
[0m01:24:58.860794 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:24:58.863796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:24:59.314363 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:24:59.315033 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_eff_sat_link_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` as DBT_INTERNAL_DEST
        using (

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.USER_PK IS NOT NULL
    AND a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT * FROM (
        SELECT b.TRIP_PK, b.USER_PK, b.BIKE_PK, b.start_time, b.end_time, b.EFFECTIVE_FROM, b.LOAD_DATE, b.RECORD_SOURCE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` AS b
        QUALIFY ROW_NUMBER() OVER (
            PARTITION BY b.TRIP_PK
            ORDER BY b.LOAD_DATE DESC
        ) = 1
        ) AS inner_select
    
),

latest_open AS (
    SELECT c.TRIP_PK, c.USER_PK, c.BIKE_PK, c.start_time, c.end_time, c.EFFECTIVE_FROM, c.LOAD_DATE, c.RECORD_SOURCE
    FROM latest_records AS c
    WHERE DATE(c.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

latest_closed AS (
    SELECT d.TRIP_PK, d.USER_PK, d.BIKE_PK, d.start_time, d.end_time, d.EFFECTIVE_FROM, d.LOAD_DATE, d.RECORD_SOURCE
    FROM latest_records AS d
    WHERE DATE(d.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

new_open_records AS (
    SELECT DISTINCT
        f.TRIP_PK, f.USER_PK, f.BIKE_PK,
        f.start_time AS start_time,
        f.end_time AS end_time,
        f.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        f.LOAD_DATE,
        f.RECORD_SOURCE
    FROM source_data AS f
    LEFT JOIN latest_records AS lr
    ON f.TRIP_PK = lr.TRIP_PK
    WHERE lr.TRIP_PK IS NULL
),

new_reopened_records AS (
    SELECT DISTINCT
        lc.TRIP_PK, lc.USER_PK, lc.BIKE_PK,
        g.start_time AS start_time,
        g.end_time AS end_time,
        g.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        g.LOAD_DATE,
        g.RECORD_SOURCE
    FROM source_data AS g
    INNER JOIN latest_closed AS lc
    ON g.TRIP_PK = lc.TRIP_PK
    WHERE DATE(g.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),



new_closed_records AS (
    SELECT DISTINCT
        lo.TRIP_PK, lo.USER_PK, lo.BIKE_PK,
        h.start_time AS start_time,
        h.end_time AS end_time,
        h.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        h.LOAD_DATE,
        lo.RECORD_SOURCE
    FROM source_data AS h
    LEFT JOIN latest_open AS lo
    ON lo.TRIP_PK = h.TRIP_PK
    LEFT JOIN latest_closed AS lc
    ON lc.TRIP_PK = h.TRIP_PK
    WHERE DATE(h.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
    AND lo.TRIP_PK IS NOT NULL
    AND lc.TRIP_PK IS NULL
),

records_to_insert AS (
    SELECT * FROM new_open_records
    UNION DISTINCT
    SELECT * FROM new_reopened_records
    UNION DISTINCT
    SELECT * FROM new_closed_records
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:25:00.044049 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:6058e801-ce41-4ae2-8549-ece7aba5b4de&page=queryresults
[0m01:25:01.429053 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (execute): 01:24:58.860915 => 01:25:01.428401
[0m01:25:01.431362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150cc8c70>]}
[0m01:25:01.432676 [info ] [Thread-1 (]: 13 of 22 OK created sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips  [[32mMERGE (0.0 rows, 3.5 KiB processed)[0m in 2.65s]
[0m01:25:01.433542 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:25:01.436945 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:25:01.439874 [info ] [Thread-1 (]: 14 of 22 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [RUN]
[0m01:25:01.441117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_eff_sat_link_users_trips, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m01:25:01.441666 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:25:01.455422 [info ] [Thread-1 (]: 01:25:01 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m01:25:01.459880 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:25:01.460822 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 01:25:01.441940 => 01:25:01.460601
[0m01:25:01.461184 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:25:01.465908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:01.468198 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.DBT_SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips` AS d
        ON (
            a.HASHDIFF = d.HASHDIFF
            AND a.LOAD_DATE = d.LOAD_DATE
            AND a.SATELLITE_NAME = d.SATELLITE_NAME
        )
    WHERE d.HASHDIFF IS NULL
    AND d.LOAD_DATE IS NULL
    AND d.SATELLITE_NAME IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:25:02.501473 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5b3adaae-7c84-495a-a9a6-ebd6d89f3d5a&page=queryresults
[0m01:25:04.321438 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:25:04.326716 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:25:04.328754 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.HASHDIFF = DBT_INTERNAL_DEST.HASHDIFF
                ) and (
                    DBT_INTERNAL_SOURCE.SATELLITE_NAME = DBT_INTERNAL_DEST.SATELLITE_NAME
                ) and (
                    DBT_INTERNAL_SOURCE.LOAD_DATE = DBT_INTERNAL_DEST.LOAD_DATE
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`HASHDIFF` = DBT_INTERNAL_SOURCE.`HASHDIFF`,`SATELLITE_NAME` = DBT_INTERNAL_SOURCE.`SATELLITE_NAME`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `HASHDIFF`, `SATELLITE_NAME`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `HASHDIFF`, `SATELLITE_NAME`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:25:04.668378 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:3eeaf994-5b8e-4d7b-a417-ae3331e10b2a&page=queryresults
[0m01:25:06.035682 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 01:25:01.461396 => 01:25:06.035313
[0m01:25:06.037509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d87d90>]}
[0m01:25:06.038460 [info ] [Thread-1 (]: 14 of 22 OK created sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[32mMERGE (20.0 rows, 4.3 KiB processed)[0m in 4.60s]
[0m01:25:06.039385 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:25:06.040041 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:25:06.040858 [info ] [Thread-1 (]: 15 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_trips ..... [RUN]
[0m01:25:06.042078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_ext_track_sat_trips, now model.dbt_bq_sa.dbt_hub_sql_trips)
[0m01:25:06.042702 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:25:06.055989 [info ] [Thread-1 (]: 01:25:06 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_trips from 1 source(s)
[0m01:25:06.062797 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:25:06.063889 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (compile): 01:25:06.043070 => 01:25:06.063516
[0m01:25:06.064408 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:25:06.069737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:06.071452 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` AS d
    ON a.TRIP_PK = d.TRIP_PK
    WHERE d.TRIP_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:25:07.189817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4336066a-7afa-4612-afc3-73f8f189de99&page=queryresults
[0m01:25:10.107437 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:25:10.112093 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:25:10.113446 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
            )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`start_station_id` = DBT_INTERNAL_SOURCE.`start_station_id`,`end_station_id` = DBT_INTERNAL_SOURCE.`end_station_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:25:10.446160 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b671455c-5bca-4bd6-ad1a-db03f19dde8e&page=queryresults
[0m01:25:11.854713 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (execute): 01:25:06.064710 => 01:25:11.854306
[0m01:25:11.856257 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150cdd720>]}
[0m01:25:11.858114 [info ] [Thread-1 (]: 15 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_trips  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 5.81s]
[0m01:25:11.860002 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:25:11.861146 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:25:11.862174 [info ] [Thread-1 (]: 16 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [RUN]
[0m01:25:11.863450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_trips, now model.dbt_bq_sa.dbt_link_sql_bikes_trips)
[0m01:25:11.864093 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:25:11.881839 [info ] [Thread-1 (]: 01:25:11 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_bikes_trips from 1 source(s)
[0m01:25:11.912012 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:25:11.912982 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (compile): 01:25:11.864456 => 01:25:11.912766
[0m01:25:11.913310 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:25:11.917850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:11.982179 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_BIKES_TRIPS_PK, rr.BIKE_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_BIKES_TRIPS_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_BIKES_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_BIKES_TRIPS_PK, a.BIKE_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` AS d
    ON a.LINK_BIKES_TRIPS_PK = d.LINK_BIKES_TRIPS_PK
    WHERE d.LINK_BIKES_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:25:12.685083 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b721d144-34ca-4196-904c-fbd8403fc572&page=queryresults
[0m01:25:14.718323 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:25:14.722327 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:25:14.723915 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_BIKES_TRIPS_PK = DBT_INTERNAL_DEST.LINK_BIKES_TRIPS_PK
            )

    
    when matched then update set
        `LINK_BIKES_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_BIKES_TRIPS_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:25:15.048177 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:3a5792b8-d992-48df-8947-2c019221ef21&page=queryresults
[0m01:25:16.440199 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (execute): 01:25:11.913491 => 01:25:16.439747
[0m01:25:16.445308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150528310>]}
[0m01:25:16.446982 [info ] [Thread-1 (]: 16 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 4.58s]
[0m01:25:16.447977 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:25:16.448701 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:25:16.449796 [info ] [Thread-1 (]: 17 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [RUN]
[0m01:25:16.450930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_bikes_trips, now model.dbt_bq_sa.dbt_link_sql_users_bikes)
[0m01:25:16.451487 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:25:16.461978 [info ] [Thread-1 (]: 01:25:16 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_bikes from 1 source(s)
[0m01:25:16.470459 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:25:16.471766 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (compile): 01:25:16.451813 => 01:25:16.471483
[0m01:25:16.472199 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:25:16.478533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:16.480188 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_BIKES_PK, rr.USER_PK, rr.BIKE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_BIKES_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_BIKES_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_BIKES_PK, a.USER_PK, a.BIKE_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` AS d
    ON a.LINK_USERS_BIKES_PK = d.LINK_USERS_BIKES_PK
    WHERE d.LINK_USERS_BIKES_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:25:17.606569 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:668b553e-7dda-46e9-91cf-e11a5b2e506e&page=queryresults
[0m01:25:19.341258 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:25:19.345903 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:25:19.347349 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_BIKES_PK = DBT_INTERNAL_DEST.LINK_USERS_BIKES_PK
            )

    
    when matched then update set
        `LINK_USERS_BIKES_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_BIKES_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:25:19.725679 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8d68f41d-0f81-4898-832a-5a3954d04348&page=queryresults
[0m01:25:20.855999 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (execute): 01:25:16.472443 => 01:25:20.855579
[0m01:25:20.857324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d87d90>]}
[0m01:25:20.858171 [info ] [Thread-1 (]: 17 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [[32mMERGE (0.0 rows, 1.2 KiB processed)[0m in 4.41s]
[0m01:25:20.858957 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:25:20.859360 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:25:20.859730 [info ] [Thread-1 (]: 18 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [RUN]
[0m01:25:20.860225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_bikes, now model.dbt_bq_sa.dbt_link_sql_users_trips)
[0m01:25:20.860445 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:25:20.864670 [info ] [Thread-1 (]: 01:25:20 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_trips from 1 source(s)
[0m01:25:20.868267 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:25:20.868713 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (compile): 01:25:20.860569 => 01:25:20.868578
[0m01:25:20.869018 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:25:20.873778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:20.874900 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_TRIPS_PK, rr.USER_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_TRIPS_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_TRIPS_PK, a.USER_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` AS d
    ON a.LINK_USERS_TRIPS_PK = d.LINK_USERS_TRIPS_PK
    WHERE d.LINK_USERS_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:25:21.880421 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:dd312a7e-ae66-4e2e-ab6c-0003914f37fd&page=queryresults
[0m01:25:24.017899 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:25:24.024489 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:25:24.026420 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_TRIPS_PK = DBT_INTERNAL_DEST.LINK_USERS_TRIPS_PK
            )

    
    when matched then update set
        `LINK_USERS_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_TRIPS_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:25:24.437594 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8d83554f-0526-4c05-81d1-b1912d319135&page=queryresults
[0m01:25:25.569267 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (execute): 01:25:20.869211 => 01:25:25.568509
[0m01:25:25.571557 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1511b8040>]}
[0m01:25:25.572998 [info ] [Thread-1 (]: 18 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 4.71s]
[0m01:25:25.574022 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:25:25.574795 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:25:25.576016 [info ] [Thread-1 (]: 19 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_trips ..... [RUN]
[0m01:25:25.577362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_trips, now model.dbt_bq_sa.dbt_sat_sql_trips)
[0m01:25:25.578004 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:25:25.611957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:25:25.613047 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (compile): 01:25:25.578386 => 01:25:25.612848
[0m01:25:25.613377 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:25:25.618895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:25.620837 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by TRIP_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.TRIP_PK, current_records.TRIP_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` AS current_records
    JOIN (
        SELECT DISTINCT source_data.TRIP_PK
        FROM source_data
    ) AS source_records
        ON source_records.TRIP_PK = current_records.TRIP_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.TRIP_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.TRIP_PK = frin.TRIP_PK
        AND lr.TRIP_HASHDIFF = frin.TRIP_HASHDIFF
        WHERE lr.TRIP_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:25:26.688060 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c37c43bc-1790-4ad6-af0a-11998cf7d799&page=queryresults
[0m01:25:29.064449 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:25:29.068633 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:25:29.071271 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.TRIP_HASHDIFF = DBT_INTERNAL_DEST.TRIP_HASHDIFF
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`TRIP_HASHDIFF` = DBT_INTERNAL_SOURCE.`TRIP_HASHDIFF`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`trip_duration` = DBT_INTERNAL_SOURCE.`trip_duration`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:25:29.459881 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:1d0b53fe-eb22-446f-a5ac-1bbf35a4eaba&page=queryresults
[0m01:25:30.894057 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (execute): 01:25:25.613564 => 01:25:30.893808
[0m01:25:30.895744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150e01cc0>]}
[0m01:25:30.896343 [info ] [Thread-1 (]: 19 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_trips  [[32mMERGE (0.0 rows, 1.3 KiB processed)[0m in 5.32s]
[0m01:25:30.896807 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:25:30.897160 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:25:30.897744 [info ] [Thread-1 (]: 20 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_users ..... [RUN]
[0m01:25:30.898349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_trips, now model.dbt_bq_sa.dbt_hub_sql_users)
[0m01:25:30.898645 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:25:30.904579 [info ] [Thread-1 (]: 01:25:30 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_users from 1 source(s)
[0m01:25:30.910031 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:25:30.910949 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (compile): 01:25:30.898817 => 01:25:30.910766
[0m01:25:30.911233 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:25:30.914626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:30.915948 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` AS d
    ON a.USER_PK = d.USER_PK
    WHERE d.USER_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:25:32.119326 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:11f0c857-511e-4617-bbe1-278a6efc90e2&page=queryresults
[0m01:25:33.901112 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:25:33.906041 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:25:33.907695 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
            )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:25:34.225346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:29b21a85-a07e-4c0a-9332-add04efad7dc&page=queryresults
[0m01:25:35.608843 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (execute): 01:25:30.911391 => 01:25:35.608512
[0m01:25:35.610056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150f417b0>]}
[0m01:25:35.610851 [info ] [Thread-1 (]: 20 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_users  [[32mMERGE (0.0 rows, 650.0 Bytes processed)[0m in 4.71s]
[0m01:25:35.611623 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:25:35.612205 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:25:35.612938 [info ] [Thread-1 (]: 21 of 22 START sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [RUN]
[0m01:25:35.613960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_users, now model.dbt_bq_sa.dbt_multi_active_sat_users_plans)
[0m01:25:35.614481 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:25:35.657092 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:25:35.658604 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (compile): 01:25:35.614767 => 01:25:35.658428
[0m01:25:35.658875 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:25:35.663281 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:25:35.663746 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:35.664869 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    
WITH source_data AS (
    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS s
    WHERE s.USER_PK IS NOT NULL
        AND s.customer_plan IS NOT NULL
),

records_to_insert AS (
    SELECT source_data.USER_PK, source_data.customer_plan, source_data.user_type, source_data.HASHDIFF, source_data.EFFECTIVE_FROM, source_data.LOAD_DATE, source_data.RECORD_SOURCE
    FROM source_data
)

SELECT * FROM records_to_insert
    );
  
[0m01:25:36.683850 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:9bfea86a-055d-4ff0-8277-9807f841ddda&page=queryresults
[0m01:25:36.797842 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name HASHDIFF not found inside s at [19:64]; reason: invalidQuery, location: query, message: Name HASHDIFF not found inside s at [19:64]')
[0m01:25:38.264447 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0f3d74c1-c1fe-49e3-8c46-6f640dba6383&page=queryresults
[0m01:25:38.378430 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0f3d74c1-c1fe-49e3-8c46-6f640dba6383&page=queryresults
[0m01:25:38.380255 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (execute): 01:25:35.659025 => 01:25:38.379755
[0m01:25:38.411241 [debug] [Thread-1 (]: Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:25:38.414944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x150d0e740>]}
[0m01:25:38.415959 [error] [Thread-1 (]: 21 of 22 ERROR creating sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [[31mERROR[0m in 2.80s]
[0m01:25:38.416368 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:25:38.416711 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:25:38.419606 [info ] [Thread-1 (]: 22 of 22 START sql incremental model citibike_source_sql.dbt sat_sql_users ..... [RUN]
[0m01:25:38.420110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_multi_active_sat_users_plans, now model.dbt_bq_sa.dbt_sat_sql_users)
[0m01:25:38.420335 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:25:38.448184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:25:38.449203 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (compile): 01:25:38.420493 => 01:25:38.449036
[0m01:25:38.449468 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:25:38.454766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:38.456418 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by USER_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.USER_PK, current_records.USER_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` AS current_records
    JOIN (
        SELECT DISTINCT source_data.USER_PK
        FROM source_data
    ) AS source_records
        ON source_records.USER_PK = current_records.USER_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.USER_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.USER_PK = frin.USER_PK
        AND lr.USER_HASHDIFF = frin.USER_HASHDIFF
        WHERE lr.USER_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:25:39.183221 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:89491a34-5563-4c72-8de7-46ba3566f28f&page=queryresults
[0m01:25:41.537267 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:25:41.541884 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:25:41.543859 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
                ) and (
                    DBT_INTERNAL_SOURCE.USER_HASHDIFF = DBT_INTERNAL_DEST.USER_HASHDIFF
                )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`USER_HASHDIFF` = DBT_INTERNAL_SOURCE.`USER_HASHDIFF`,`user_type` = DBT_INTERNAL_SOURCE.`user_type`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`birth_year` = DBT_INTERNAL_SOURCE.`birth_year`,`customer_plan` = DBT_INTERNAL_SOURCE.`customer_plan`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:25:41.862745 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2630b0be-7a2f-4fb8-9e49-2373f5313179&page=queryresults
[0m01:25:43.256309 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (execute): 01:25:38.449620 => 01:25:43.255881
[0m01:25:43.257818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26c8fbc-9007-4ad4-8837-ff774306c701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1510bd5a0>]}
[0m01:25:43.258787 [info ] [Thread-1 (]: 22 of 22 OK created sql incremental model citibike_source_sql.dbt sat_sql_users  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 4.84s]
[0m01:25:43.259705 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:25:43.266446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:43.267159 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_sat_sql_users' was properly closed.
[0m01:25:43.270607 [info ] [MainThread]: 
[0m01:25:43.274090 [info ] [MainThread]: Finished running 8 view models, 14 incremental models in 0 hours 1 minutes and 19.58 seconds (79.58s).
[0m01:25:43.281033 [debug] [MainThread]: Command end result
[0m01:25:43.322979 [info ] [MainThread]: 
[0m01:25:43.323386 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:25:43.323655 [info ] [MainThread]: 
[0m01:25:43.323928 [error] [MainThread]:   Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Name HASHDIFF not found inside s at [19:64]
  compiled Code at target/run/dbt_bq_sa/models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:25:43.324210 [info ] [MainThread]: 
[0m01:25:43.324725 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=1 SKIP=0 TOTAL=22
[0m01:25:43.330391 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 80.85969, "process_user_time": 5.875329, "process_kernel_time": 1.643011, "process_mem_max_rss": "206110720", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:25:43.330834 [debug] [MainThread]: Command `dbt run` failed at 01:25:43.330748 after 80.86 seconds
[0m01:25:43.331163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d85990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151250520>]}
[0m01:25:44.495926 [debug] [MainThread]: Flushing usage events
[0m01:29:55.217714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bdf370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bdef80>]}


============================== 01:29:55.220810 | 3721bbe4-626e-472a-b5ed-e981dc7ba40b ==============================
[0m01:29:55.220810 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:29:55.221117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:29:56.078388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3721bbe4-626e-472a-b5ed-e981dc7ba40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bdee90>]}
[0m01:29:56.108474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3721bbe4-626e-472a-b5ed-e981dc7ba40b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bdd330>]}
[0m01:29:56.108963 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m01:29:56.128090 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:29:56.189256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:29:56.189762 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m01:29:56.189988 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m01:29:56.332788 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the database representation "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`".
  dbt cannot create two resources with identical database representations. To fix this,
  change the configuration of one of these resources:
  - model.dbt_bq_sa.dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  - model.dbt_bq_sa.dbt_stg_users (models/stage/dbt_stg_users.sql)
[0m01:29:56.335404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1551801, "process_user_time": 2.555211, "process_kernel_time": 1.053514, "process_mem_max_rss": "202129408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:29:56.335686 [debug] [MainThread]: Command `dbt run` failed at 01:29:56.335613 after 1.16 seconds
[0m01:29:56.335977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x154ffefb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1551304c0>]}
[0m01:29:56.336241 [debug] [MainThread]: Flushing usage events
[0m01:33:14.023502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055fb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107677370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107676f80>]}


============================== 01:33:14.026776 | d9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf ==============================
[0m01:33:14.026776 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:33:14.027105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'debug': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:33:14.946270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107676e90>]}
[0m01:33:14.977401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107620fa0>]}
[0m01:33:14.978015 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m01:33:14.998039 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:33:15.053744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:33:15.054224 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/stage/dbt_stg_users.sql
[0m01:33:15.209770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.stage
- models.raw_vault
- models.business_vault
[0m01:33:15.213200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136ab40d0>]}
[0m01:33:15.273576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1368ca9e0>]}
[0m01:33:15.273875 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m01:33:15.274068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1369a2500>]}
[0m01:33:15.275258 [info ] [MainThread]: 
[0m01:33:15.275676 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:33:15.276712 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m01:33:15.276898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:33:16.220618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m01:33:16.222126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:33:16.739719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1368ca2f0>]}
[0m01:33:16.741110 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:33:16.741583 [info ] [MainThread]: 
[0m01:33:16.743895 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_bikes
[0m01:33:16.744508 [info ] [Thread-1 (]: 1 of 22 START sql view model citibike_source_sql.raw_sql_bikes ................. [RUN]
[0m01:33:16.745376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.raw_sql_bikes)
[0m01:33:16.745857 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_bikes
[0m01:33:16.757697 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_bikes"
[0m01:33:16.759005 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (compile): 01:33:16.746142 => 01:33:16.758800
[0m01:33:16.759305 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_bikes
[0m01:33:16.785820 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_bikes"
[0m01:33:16.786591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:16.787825 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_bikes`;


[0m01:33:17.501811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d2e39991-20dd-4388-a7bb-5689ceddc7a0&page=queryresults
[0m01:33:18.002727 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (execute): 01:33:16.759471 => 01:33:18.002378
[0m01:33:18.003945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136924310>]}
[0m01:33:18.004738 [info ] [Thread-1 (]: 1 of 22 OK created sql view model citibike_source_sql.raw_sql_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.26s]
[0m01:33:18.005452 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_bikes
[0m01:33:18.005909 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_stations
[0m01:33:18.006369 [info ] [Thread-1 (]: 2 of 22 START sql view model citibike_source_sql.raw_sql_stations .............. [RUN]
[0m01:33:18.007315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_bikes, now model.dbt_bq_sa.raw_sql_stations)
[0m01:33:18.007808 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_stations
[0m01:33:18.012509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_stations"
[0m01:33:18.013439 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (compile): 01:33:18.008082 => 01:33:18.013178
[0m01:33:18.013860 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_stations
[0m01:33:18.018303 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_stations"
[0m01:33:18.018945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:18.020451 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_stations`;


[0m01:33:18.772428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:bd847eed-f612-4042-956d-f5a8d37c1db4&page=queryresults
[0m01:33:19.137953 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (execute): 01:33:18.014217 => 01:33:19.137556
[0m01:33:19.139535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a31de0>]}
[0m01:33:19.140506 [info ] [Thread-1 (]: 2 of 22 OK created sql view model citibike_source_sql.raw_sql_stations ......... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m01:33:19.141437 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_stations
[0m01:33:19.142091 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_trips
[0m01:33:19.143019 [info ] [Thread-1 (]: 3 of 22 START sql view model citibike_source_sql.raw_sql_trips ................. [RUN]
[0m01:33:19.144152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_stations, now model.dbt_bq_sa.raw_sql_trips)
[0m01:33:19.144748 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_trips
[0m01:33:19.150038 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_trips"
[0m01:33:19.151483 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (compile): 01:33:19.145094 => 01:33:19.151100
[0m01:33:19.152006 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_trips
[0m01:33:19.157568 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_trips"
[0m01:33:19.158431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:19.160140 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_trips`;


[0m01:33:19.893686 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:29b52488-4323-44d4-8b07-a268c4471d16&page=queryresults
[0m01:33:20.313053 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (execute): 01:33:19.152293 => 01:33:20.312307
[0m01:33:20.314539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a338e0>]}
[0m01:33:20.315551 [info ] [Thread-1 (]: 3 of 22 OK created sql view model citibike_source_sql.raw_sql_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m01:33:20.316463 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_trips
[0m01:33:20.317139 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_users
[0m01:33:20.318085 [info ] [Thread-1 (]: 4 of 22 START sql view model citibike_source_sql.raw_sql_users ................. [RUN]
[0m01:33:20.319313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_trips, now model.dbt_bq_sa.raw_sql_users)
[0m01:33:20.319916 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_users
[0m01:33:20.325539 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_users"
[0m01:33:20.327749 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (compile): 01:33:20.320283 => 01:33:20.327415
[0m01:33:20.328270 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_users
[0m01:33:20.335492 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_users"
[0m01:33:20.336298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:20.338011 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_users`;


[0m01:33:21.018132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8de10992-f77d-42f2-97ab-34299942c17c&page=queryresults
[0m01:33:21.439328 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (execute): 01:33:20.328551 => 01:33:21.438956
[0m01:33:21.440656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136ae4910>]}
[0m01:33:21.441604 [info ] [Thread-1 (]: 4 of 22 OK created sql view model citibike_source_sql.raw_sql_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m01:33:21.442484 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_users
[0m01:33:21.443111 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m01:33:21.443998 [info ] [Thread-1 (]: 5 of 22 START sql view model citibike_source_sql.dbt_stg_bikes ................. [RUN]
[0m01:33:21.445033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_users, now model.dbt_bq_sa.dbt_stg_bikes)
[0m01:33:21.445652 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m01:33:21.457546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:22.090516 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m01:33:22.092771 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 01:33:21.445998 => 01:33:22.092505
[0m01:33:22.093176 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m01:33:22.098180 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m01:33:22.099159 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    bike_type

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
),

derived_columns AS (

    SELECT

    bike_id,
    bike_type,
    'SRC_SQL_BIKES' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    BIKE_PK,
    BIKE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:33:22.768656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:52327296-079f-4820-accb-d17d0600f103&page=queryresults
[0m01:33:23.104239 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 01:33:22.093388 => 01:33:23.103697
[0m01:33:23.106146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a29fc0>]}
[0m01:33:23.107226 [info ] [Thread-1 (]: 5 of 22 OK created sql view model citibike_source_sql.dbt_stg_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m01:33:23.108125 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m01:33:23.108779 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m01:33:23.109675 [info ] [Thread-1 (]: 6 of 22 START sql view model citibike_source_sql.dbt_stg_stations .............. [RUN]
[0m01:33:23.111037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m01:33:23.111643 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m01:33:23.124703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:23.762246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m01:33:23.763579 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 01:33:23.111999 => 01:33:23.763225
[0m01:33:23.764118 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m01:33:23.769808 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_stations"
[0m01:33:23.771126 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
),

derived_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    'SRC_SQL_STATIONS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')
    )))) AS STRING) AS STATION_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    STATION_PK,
    STATION_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:33:24.477331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:08cb7449-c759-44aa-a396-6e738c2e1d1c&page=queryresults
[0m01:33:24.826260 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 01:33:23.764423 => 01:33:24.825863
[0m01:33:24.827756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136ac8ca0>]}
[0m01:33:24.828765 [info ] [Thread-1 (]: 6 of 22 OK created sql view model citibike_source_sql.dbt_stg_stations ......... [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m01:33:24.829702 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m01:33:24.830348 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m01:33:24.831213 [info ] [Thread-1 (]: 7 of 22 START sql view model citibike_source_sql.dbt_stg_trips ................. [RUN]
[0m01:33:24.832488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m01:33:24.833074 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m01:33:24.842683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:25.503185 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:33:25.504888 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 01:33:24.833445 => 01:33:25.504663
[0m01:33:25.505236 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m01:33:25.509220 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m01:33:25.509897 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM,
    'DBT_SAT_SQL_TRIPS' AS DBT_SAT_SQL_TRIPS

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    DBT_SAT_SQL_TRIPS,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_USERS_BIKES_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_BIKES_TRIPS_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_USERS_TRIPS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    DBT_SAT_SQL_TRIPS,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF,
    LINK_USERS_BIKES_PK,
    LINK_BIKES_TRIPS_PK,
    LINK_USERS_TRIPS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:33:26.344783 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:aacea2ea-a1bc-405c-a71f-20ce0346cf97&page=queryresults
[0m01:33:26.573709 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 01:33:25.505427 => 01:33:26.573254
[0m01:33:26.575577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1368a68c0>]}
[0m01:33:26.576662 [info ] [Thread-1 (]: 7 of 22 OK created sql view model citibike_source_sql.dbt_stg_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.74s]
[0m01:33:26.577571 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m01:33:26.578235 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m01:33:26.579347 [info ] [Thread-1 (]: 8 of 22 START sql view model citibike_source_sql.dbt_stg_users ................. [RUN]
[0m01:33:26.580393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m01:33:26.580936 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m01:33:26.590369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:27.323887 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m01:33:27.325729 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 01:33:26.581269 => 01:33:27.325420
[0m01:33:27.326228 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m01:33:27.332370 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_users"
[0m01:33:27.333209 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
),

derived_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    'SRC_SQL_USERS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_PLANS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    USER_PK,
    USER_HASHDIFF,
    USER_PLANS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m01:33:28.075336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:7320d577-7565-481f-aa72-e89d3d37f945&page=queryresults
[0m01:33:28.406215 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 01:33:27.326521 => 01:33:28.405603
[0m01:33:28.408017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136b6c6d0>]}
[0m01:33:28.409111 [info ] [Thread-1 (]: 8 of 22 OK created sql view model citibike_source_sql.dbt_stg_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.83s]
[0m01:33:28.410074 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m01:33:28.410782 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:33:28.411640 [info ] [Thread-1 (]: 9 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_bikes ...... [RUN]
[0m01:33:28.412968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_users, now model.dbt_bq_sa.dbt_hub_sql_bikes)
[0m01:33:28.413583 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:33:28.443170 [info ] [Thread-1 (]: 01:33:28 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_bikes from 1 source(s)
[0m01:33:28.486737 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:33:28.487815 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (compile): 01:33:28.413928 => 01:33:28.487671
[0m01:33:28.488054 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:33:28.518323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:28.519355 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` AS d
    ON a.BIKE_PK = d.BIKE_PK
    WHERE d.BIKE_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:33:29.598181 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:cd232c1e-7d47-41cd-9c37-d0af58f43164&page=queryresults
[0m01:33:31.777672 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:33:31.806718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m01:33:31.807861 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
            )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:33:32.247853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f46e7ed1-963e-40f8-917d-fba69f9de9c6&page=queryresults
[0m01:33:33.726597 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (execute): 01:33:28.488191 => 01:33:33.725755
[0m01:33:33.729375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136832500>]}
[0m01:33:33.730483 [info ] [Thread-1 (]: 9 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_bikes . [[32mMERGE (0.0 rows, 325.0 Bytes processed)[0m in 5.32s]
[0m01:33:33.731480 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m01:33:33.732214 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:33:33.733033 [info ] [Thread-1 (]: 10 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_bikes ..... [RUN]
[0m01:33:33.734133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_bikes, now model.dbt_bq_sa.dbt_sat_sql_bikes)
[0m01:33:33.734721 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:33:33.798923 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m01:33:33.800207 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (compile): 01:33:33.735073 => 01:33:33.800027
[0m01:33:33.800481 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:33:33.803776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:33.804846 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.BIKE_PK, current_records.BIKE_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` AS current_records
    JOIN (
        SELECT DISTINCT source_data.BIKE_PK
        FROM source_data
    ) AS source_records
        ON source_records.BIKE_PK = current_records.BIKE_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.BIKE_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.BIKE_PK = frin.BIKE_PK
        AND lr.BIKE_HASHDIFF = frin.BIKE_HASHDIFF
        WHERE lr.BIKE_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:33:34.946700 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:390768c5-2450-4983-a64e-80c18e227e2a&page=queryresults
[0m01:33:37.262296 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:33:37.266915 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m01:33:37.268890 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
                ) and (
                    DBT_INTERNAL_SOURCE.BIKE_HASHDIFF = DBT_INTERNAL_DEST.BIKE_HASHDIFF
                )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`BIKE_HASHDIFF` = DBT_INTERNAL_SOURCE.`BIKE_HASHDIFF`,`bike_type` = DBT_INTERNAL_SOURCE.`bike_type`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:33:37.588799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a511935a-65aa-4099-ad88-fe175828b83a&page=queryresults
[0m01:33:38.962239 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (execute): 01:33:33.800629 => 01:33:38.961919
[0m01:33:38.963337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136833040>]}
[0m01:33:38.964001 [info ] [Thread-1 (]: 10 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_bikes  [[32mMERGE (0.0 rows, 502.0 Bytes processed)[0m in 5.23s]
[0m01:33:38.964428 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m01:33:38.964737 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:33:38.965221 [info ] [Thread-1 (]: 11 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_stations .. [RUN]
[0m01:33:38.965654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_bikes, now model.dbt_bq_sa.dbt_hub_sql_stations)
[0m01:33:38.965888 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:33:38.971698 [info ] [Thread-1 (]: 01:33:38 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_stations from 1 source(s)
[0m01:33:38.982577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:33:38.983634 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (compile): 01:33:38.966021 => 01:33:38.983415
[0m01:33:38.983900 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:33:38.988499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:38.989988 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` AS d
    ON a.STATION_PK = d.STATION_PK
    WHERE d.STATION_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:33:39.998742 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4aa1f8ae-7426-4971-9237-dc30474dde72&page=queryresults
[0m01:33:41.738210 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:33:41.741103 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m01:33:41.742273 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
            )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`station_id` = DBT_INTERNAL_SOURCE.`station_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:33:42.113535 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a0e1ce06-5b64-4332-9a83-11d540ebc3e7&page=queryresults
[0m01:33:43.562561 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (execute): 01:33:38.984032 => 01:33:43.562026
[0m01:33:43.564062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a0baf0>]}
[0m01:33:43.565069 [info ] [Thread-1 (]: 11 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 4.60s]
[0m01:33:43.565992 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m01:33:43.566660 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:33:43.567579 [info ] [Thread-1 (]: 12 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_stations .. [RUN]
[0m01:33:43.568802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_stations, now model.dbt_bq_sa.dbt_sat_sql_stations)
[0m01:33:43.569471 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:33:43.603227 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m01:33:43.604312 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (compile): 01:33:43.569851 => 01:33:43.604114
[0m01:33:43.604632 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:33:43.616925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:43.618350 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by STATION_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.STATION_PK, current_records.STATION_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` AS current_records
    JOIN (
        SELECT DISTINCT source_data.STATION_PK
        FROM source_data
    ) AS source_records
        ON source_records.STATION_PK = current_records.STATION_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.STATION_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.STATION_PK = frin.STATION_PK
        AND lr.STATION_HASHDIFF = frin.STATION_HASHDIFF
        WHERE lr.STATION_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:33:44.777215 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:1a2b83e4-83ae-4b67-95fe-a8b0fd1e754a&page=queryresults
[0m01:33:47.069822 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:33:47.074252 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m01:33:47.075801 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
                ) and (
                    DBT_INTERNAL_SOURCE.STATION_HASHDIFF = DBT_INTERNAL_DEST.STATION_HASHDIFF
                )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`STATION_HASHDIFF` = DBT_INTERNAL_SOURCE.`STATION_HASHDIFF`,`name` = DBT_INTERNAL_SOURCE.`name`,`short_name` = DBT_INTERNAL_SOURCE.`short_name`,`latitude` = DBT_INTERNAL_SOURCE.`latitude`,`longitude` = DBT_INTERNAL_SOURCE.`longitude`,`region_id` = DBT_INTERNAL_SOURCE.`region_id`,`rental_method` = DBT_INTERNAL_SOURCE.`rental_method`,`capacity` = DBT_INTERNAL_SOURCE.`capacity`,`last_reported` = DBT_INTERNAL_SOURCE.`last_reported`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:33:47.376852 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:f92101f3-78c1-4841-81af-0edb9e0c4504&page=queryresults
[0m01:33:48.773407 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (execute): 01:33:43.604816 => 01:33:48.772870
[0m01:33:48.775954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136833040>]}
[0m01:33:48.777276 [info ] [Thread-1 (]: 12 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.21s]
[0m01:33:48.778301 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m01:33:48.779026 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:33:48.780030 [info ] [Thread-1 (]: 13 of 22 START sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips . [RUN]
[0m01:33:48.781290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_stations, now model.dbt_bq_sa.dbt_eff_sat_link_users_trips)
[0m01:33:48.781933 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:33:48.852257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:33:48.853797 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (compile): 01:33:48.782307 => 01:33:48.853629
[0m01:33:48.854051 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:33:48.856639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:49.314225 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m01:33:49.316145 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_eff_sat_link_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` as DBT_INTERNAL_DEST
        using (

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.USER_PK IS NOT NULL
    AND a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT * FROM (
        SELECT b.TRIP_PK, b.USER_PK, b.BIKE_PK, b.start_time, b.end_time, b.EFFECTIVE_FROM, b.LOAD_DATE, b.RECORD_SOURCE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` AS b
        QUALIFY ROW_NUMBER() OVER (
            PARTITION BY b.TRIP_PK
            ORDER BY b.LOAD_DATE DESC
        ) = 1
        ) AS inner_select
    
),

latest_open AS (
    SELECT c.TRIP_PK, c.USER_PK, c.BIKE_PK, c.start_time, c.end_time, c.EFFECTIVE_FROM, c.LOAD_DATE, c.RECORD_SOURCE
    FROM latest_records AS c
    WHERE DATE(c.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

latest_closed AS (
    SELECT d.TRIP_PK, d.USER_PK, d.BIKE_PK, d.start_time, d.end_time, d.EFFECTIVE_FROM, d.LOAD_DATE, d.RECORD_SOURCE
    FROM latest_records AS d
    WHERE DATE(d.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

new_open_records AS (
    SELECT DISTINCT
        f.TRIP_PK, f.USER_PK, f.BIKE_PK,
        f.start_time AS start_time,
        f.end_time AS end_time,
        f.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        f.LOAD_DATE,
        f.RECORD_SOURCE
    FROM source_data AS f
    LEFT JOIN latest_records AS lr
    ON f.TRIP_PK = lr.TRIP_PK
    WHERE lr.TRIP_PK IS NULL
),

new_reopened_records AS (
    SELECT DISTINCT
        lc.TRIP_PK, lc.USER_PK, lc.BIKE_PK,
        g.start_time AS start_time,
        g.end_time AS end_time,
        g.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        g.LOAD_DATE,
        g.RECORD_SOURCE
    FROM source_data AS g
    INNER JOIN latest_closed AS lc
    ON g.TRIP_PK = lc.TRIP_PK
    WHERE DATE(g.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),



new_closed_records AS (
    SELECT DISTINCT
        lo.TRIP_PK, lo.USER_PK, lo.BIKE_PK,
        h.start_time AS start_time,
        h.end_time AS end_time,
        h.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        h.LOAD_DATE,
        lo.RECORD_SOURCE
    FROM source_data AS h
    LEFT JOIN latest_open AS lo
    ON lo.TRIP_PK = h.TRIP_PK
    LEFT JOIN latest_closed AS lc
    ON lc.TRIP_PK = h.TRIP_PK
    WHERE DATE(h.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
    AND lo.TRIP_PK IS NOT NULL
    AND lc.TRIP_PK IS NULL
),

records_to_insert AS (
    SELECT * FROM new_open_records
    UNION DISTINCT
    SELECT * FROM new_reopened_records
    UNION DISTINCT
    SELECT * FROM new_closed_records
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:33:50.067292 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b6bc9488-2984-4112-b2d5-544543a793c1&page=queryresults
[0m01:33:51.457074 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (execute): 01:33:48.854194 => 01:33:51.455989
[0m01:33:51.724742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136c622f0>]}
[0m01:33:51.727957 [info ] [Thread-1 (]: 13 of 22 OK created sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips  [[32mMERGE (0.0 rows, 3.5 KiB processed)[0m in 2.94s]
[0m01:33:51.895536 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m01:33:51.897236 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:33:52.057691 [info ] [Thread-1 (]: 14 of 22 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [RUN]
[0m01:33:52.059838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_eff_sat_link_users_trips, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m01:33:52.061030 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:33:52.081628 [info ] [Thread-1 (]: 01:33:52 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m01:33:52.084068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:33:52.086202 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 01:33:52.061608 => 01:33:52.086043
[0m01:33:52.086422 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:33:52.091393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:52.093263 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.DBT_SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips` AS d
        ON (
            a.HASHDIFF = d.HASHDIFF
            AND a.LOAD_DATE = d.LOAD_DATE
            AND a.SATELLITE_NAME = d.SATELLITE_NAME
        )
    WHERE d.HASHDIFF IS NULL
    AND d.LOAD_DATE IS NULL
    AND d.SATELLITE_NAME IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:33:53.184105 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2c28886f-e436-49bd-bf42-eefbf84b723c&page=queryresults
[0m01:33:54.983095 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:33:54.990536 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m01:33:54.993388 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.HASHDIFF = DBT_INTERNAL_DEST.HASHDIFF
                ) and (
                    DBT_INTERNAL_SOURCE.SATELLITE_NAME = DBT_INTERNAL_DEST.SATELLITE_NAME
                ) and (
                    DBT_INTERNAL_SOURCE.LOAD_DATE = DBT_INTERNAL_DEST.LOAD_DATE
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`HASHDIFF` = DBT_INTERNAL_SOURCE.`HASHDIFF`,`SATELLITE_NAME` = DBT_INTERNAL_SOURCE.`SATELLITE_NAME`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `HASHDIFF`, `SATELLITE_NAME`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `HASHDIFF`, `SATELLITE_NAME`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:33:55.382554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:ea0776ce-a583-4c2a-ae7e-167ad6fb5ce7&page=queryresults
[0m01:33:56.856395 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 01:33:52.086539 => 01:33:56.855610
[0m01:33:56.858300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136b6c6d0>]}
[0m01:33:56.859444 [info ] [Thread-1 (]: 14 of 22 OK created sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[32mMERGE (20.0 rows, 6.4 KiB processed)[0m in 4.80s]
[0m01:33:56.860453 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m01:33:56.861168 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:33:56.862178 [info ] [Thread-1 (]: 15 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_trips ..... [RUN]
[0m01:33:56.863340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_ext_track_sat_trips, now model.dbt_bq_sa.dbt_hub_sql_trips)
[0m01:33:56.863883 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:33:56.873555 [info ] [Thread-1 (]: 01:33:56 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_trips from 1 source(s)
[0m01:33:56.881011 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:33:56.882595 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (compile): 01:33:56.864181 => 01:33:56.882313
[0m01:33:56.883038 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:33:56.888304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:56.890088 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` AS d
    ON a.TRIP_PK = d.TRIP_PK
    WHERE d.TRIP_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:33:57.899207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b2354023-cd2b-4d3b-a936-4942729a9c96&page=queryresults
[0m01:34:02.132551 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:34:02.138790 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m01:34:02.141293 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
            )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`start_station_id` = DBT_INTERNAL_SOURCE.`start_station_id`,`end_station_id` = DBT_INTERNAL_SOURCE.`end_station_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:34:02.469989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8d48f9b7-9fea-44ae-a707-eba0a93dcb48&page=queryresults
[0m01:34:03.829961 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (execute): 01:33:56.883286 => 01:34:03.829293
[0m01:34:03.832501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136833040>]}
[0m01:34:03.834130 [info ] [Thread-1 (]: 15 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_trips  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 6.97s]
[0m01:34:03.835141 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m01:34:03.835935 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:34:03.840501 [info ] [Thread-1 (]: 16 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [RUN]
[0m01:34:03.841754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_trips, now model.dbt_bq_sa.dbt_link_sql_bikes_trips)
[0m01:34:03.842345 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:34:03.876114 [info ] [Thread-1 (]: 01:34:03 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_bikes_trips from 1 source(s)
[0m01:34:03.900493 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:34:03.907036 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (compile): 01:34:03.842698 => 01:34:03.906822
[0m01:34:03.907383 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:34:03.914409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:03.919723 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_BIKES_TRIPS_PK, rr.BIKE_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_BIKES_TRIPS_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_BIKES_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_BIKES_TRIPS_PK, a.BIKE_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` AS d
    ON a.LINK_BIKES_TRIPS_PK = d.LINK_BIKES_TRIPS_PK
    WHERE d.LINK_BIKES_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:34:04.642314 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c1401029-e638-4d59-abca-6ff6beab7916&page=queryresults
[0m01:34:06.652077 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:34:06.656208 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m01:34:06.657250 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_BIKES_TRIPS_PK = DBT_INTERNAL_DEST.LINK_BIKES_TRIPS_PK
            )

    
    when matched then update set
        `LINK_BIKES_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_BIKES_TRIPS_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:34:06.998729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:85e6cc5f-7bcc-4fd0-af65-b1059388f4eb&page=queryresults
[0m01:34:08.369321 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (execute): 01:34:03.907570 => 01:34:08.368804
[0m01:34:08.371179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1368a68c0>]}
[0m01:34:08.372170 [info ] [Thread-1 (]: 16 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 4.53s]
[0m01:34:08.373075 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m01:34:08.373732 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:34:08.374488 [info ] [Thread-1 (]: 17 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [RUN]
[0m01:34:08.375500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_bikes_trips, now model.dbt_bq_sa.dbt_link_sql_users_bikes)
[0m01:34:08.376050 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:34:08.385563 [info ] [Thread-1 (]: 01:34:08 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_bikes from 1 source(s)
[0m01:34:08.394039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:34:08.395212 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (compile): 01:34:08.376371 => 01:34:08.394944
[0m01:34:08.395641 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:34:08.402912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:08.404580 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_BIKES_PK, rr.USER_PK, rr.BIKE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_BIKES_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_BIKES_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_BIKES_PK, a.USER_PK, a.BIKE_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` AS d
    ON a.LINK_USERS_BIKES_PK = d.LINK_USERS_BIKES_PK
    WHERE d.LINK_USERS_BIKES_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:34:09.511103 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d21b3129-6ffb-438e-bc52-077e43dd927b&page=queryresults
[0m01:34:11.587869 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:34:11.593436 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m01:34:11.595503 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_BIKES_PK = DBT_INTERNAL_DEST.LINK_USERS_BIKES_PK
            )

    
    when matched then update set
        `LINK_USERS_BIKES_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_BIKES_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:34:11.913803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:25b6333d-fe2c-477d-95bb-1ae0610dda17&page=queryresults
[0m01:34:13.265435 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (execute): 01:34:08.395887 => 01:34:13.264757
[0m01:34:13.274622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136cd89a0>]}
[0m01:34:13.276142 [info ] [Thread-1 (]: 17 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [[32mMERGE (0.0 rows, 1.2 KiB processed)[0m in 4.89s]
[0m01:34:13.277392 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m01:34:13.278250 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:34:13.279580 [info ] [Thread-1 (]: 18 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [RUN]
[0m01:34:13.280912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_bikes, now model.dbt_bq_sa.dbt_link_sql_users_trips)
[0m01:34:13.281544 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:34:13.299643 [info ] [Thread-1 (]: 01:34:13 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_trips from 1 source(s)
[0m01:34:13.309508 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:34:13.310584 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (compile): 01:34:13.281906 => 01:34:13.310314
[0m01:34:13.311025 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:34:13.316883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:13.319443 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_TRIPS_PK, rr.USER_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_TRIPS_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_TRIPS_PK, a.USER_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` AS d
    ON a.LINK_USERS_TRIPS_PK = d.LINK_USERS_TRIPS_PK
    WHERE d.LINK_USERS_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:34:14.472714 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4b461f88-d4bf-4b64-a7e8-21fccda90db8&page=queryresults
[0m01:34:16.238882 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:34:16.242533 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m01:34:16.244154 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_TRIPS_PK = DBT_INTERNAL_DEST.LINK_USERS_TRIPS_PK
            )

    
    when matched then update set
        `LINK_USERS_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_TRIPS_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:34:16.575227 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c8fcf6dd-7b7d-4aef-a17a-d56d731235e3&page=queryresults
[0m01:34:17.943719 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (execute): 01:34:13.311274 => 01:34:17.943279
[0m01:34:17.945504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d7bd00>]}
[0m01:34:17.946823 [info ] [Thread-1 (]: 18 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 4.66s]
[0m01:34:17.947778 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m01:34:17.948422 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:34:17.949224 [info ] [Thread-1 (]: 19 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_trips ..... [RUN]
[0m01:34:17.950469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_trips, now model.dbt_bq_sa.dbt_sat_sql_trips)
[0m01:34:17.951098 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:34:17.984183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:34:17.985418 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (compile): 01:34:17.951464 => 01:34:17.985184
[0m01:34:17.985797 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:34:17.991232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:17.992718 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by TRIP_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.TRIP_PK, current_records.TRIP_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` AS current_records
    JOIN (
        SELECT DISTINCT source_data.TRIP_PK
        FROM source_data
    ) AS source_records
        ON source_records.TRIP_PK = current_records.TRIP_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.TRIP_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.TRIP_PK = frin.TRIP_PK
        AND lr.TRIP_HASHDIFF = frin.TRIP_HASHDIFF
        WHERE lr.TRIP_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:34:19.183616 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2dc098b0-0305-4cdb-bd87-4cae5f289780&page=queryresults
[0m01:34:21.486995 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:34:21.491542 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m01:34:21.493234 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.TRIP_HASHDIFF = DBT_INTERNAL_DEST.TRIP_HASHDIFF
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`TRIP_HASHDIFF` = DBT_INTERNAL_SOURCE.`TRIP_HASHDIFF`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`trip_duration` = DBT_INTERNAL_SOURCE.`trip_duration`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:34:21.802342 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:3b728e24-9401-446f-86e4-71f6e6f50380&page=queryresults
[0m01:34:23.184798 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (execute): 01:34:17.986012 => 01:34:23.184121
[0m01:34:23.186860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d7bd00>]}
[0m01:34:23.188202 [info ] [Thread-1 (]: 19 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_trips  [[32mMERGE (0.0 rows, 1.3 KiB processed)[0m in 5.24s]
[0m01:34:23.189229 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m01:34:23.190020 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:34:23.191470 [info ] [Thread-1 (]: 20 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_users ..... [RUN]
[0m01:34:23.192839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_trips, now model.dbt_bq_sa.dbt_hub_sql_users)
[0m01:34:23.193396 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:34:23.208278 [info ] [Thread-1 (]: 01:34:23 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_users from 1 source(s)
[0m01:34:23.215429 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:34:23.216617 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (compile): 01:34:23.193698 => 01:34:23.216378
[0m01:34:23.216993 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:34:23.222111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:23.224235 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` AS d
    ON a.USER_PK = d.USER_PK
    WHERE d.USER_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m01:34:24.414590 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8ec9cec9-4491-4cb9-9a38-5c9ea2dd4aeb&page=queryresults
[0m01:34:26.168730 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:34:26.173666 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m01:34:26.175322 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
            )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:34:26.471934 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:18156632-8fb2-42e7-9680-f2db8d682b53&page=queryresults
[0m01:34:27.887565 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (execute): 01:34:23.217205 => 01:34:27.887120
[0m01:34:27.889618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d41750>]}
[0m01:34:27.890926 [info ] [Thread-1 (]: 20 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_users  [[32mMERGE (0.0 rows, 650.0 Bytes processed)[0m in 4.70s]
[0m01:34:27.891856 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_users
[0m01:34:27.892546 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:34:27.893331 [info ] [Thread-1 (]: 21 of 22 START sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [RUN]
[0m01:34:27.894408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_users, now model.dbt_bq_sa.dbt_multi_active_sat_users_plans)
[0m01:34:27.894968 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:34:27.946889 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:34:27.948017 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (compile): 01:34:27.895320 => 01:34:27.947824
[0m01:34:27.948323 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:34:27.952160 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m01:34:27.952660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:27.953804 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`
      
    
    

    OPTIONS()
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    
WITH source_data AS (
    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.USER_PLANS_HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS s
    WHERE s.USER_PK IS NOT NULL
        AND s.customer_plan IS NOT NULL
),

records_to_insert AS (
    SELECT source_data.USER_PK, source_data.customer_plan, source_data.user_type, source_data.USER_PLANS_HASHDIFF AS HASHDIFF, source_data.EFFECTIVE_FROM, source_data.LOAD_DATE, source_data.RECORD_SOURCE
    FROM source_data
)

SELECT * FROM records_to_insert
    );
  
[0m01:34:29.124203 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:fa2857a4-139b-4220-9dac-b9b164ad1541&page=queryresults
[0m01:34:30.619021 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (execute): 01:34:27.948492 => 01:34:30.618322
[0m01:34:30.621574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d41750>]}
[0m01:34:30.623318 [info ] [Thread-1 (]: 21 of 22 OK created sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [[32mCREATE TABLE (10.0 rows, 280.0 Bytes processed)[0m in 2.73s]
[0m01:34:30.624397 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m01:34:30.625163 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:34:30.632353 [info ] [Thread-1 (]: 22 of 22 START sql incremental model citibike_source_sql.dbt sat_sql_users ..... [RUN]
[0m01:34:30.634332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_multi_active_sat_users_plans, now model.dbt_bq_sa.dbt_sat_sql_users)
[0m01:34:30.634955 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:34:30.676625 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:34:30.677937 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (compile): 01:34:30.635295 => 01:34:30.677679
[0m01:34:30.678341 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:34:30.683706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:34:30.685654 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by USER_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.USER_PK, current_records.USER_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` AS current_records
    JOIN (
        SELECT DISTINCT source_data.USER_PK
        FROM source_data
    ) AS source_records
        ON source_records.USER_PK = current_records.USER_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.USER_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.USER_PK = frin.USER_PK
        AND lr.USER_HASHDIFF = frin.USER_HASHDIFF
        WHERE lr.USER_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m01:34:31.791785 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:48dc61f5-4721-4b3d-a398-ab3a6df41b8d&page=queryresults
[0m01:34:34.135993 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:34:34.139329 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m01:34:34.140864 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
                ) and (
                    DBT_INTERNAL_SOURCE.USER_HASHDIFF = DBT_INTERNAL_DEST.USER_HASHDIFF
                )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`USER_HASHDIFF` = DBT_INTERNAL_SOURCE.`USER_HASHDIFF`,`user_type` = DBT_INTERNAL_SOURCE.`user_type`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`birth_year` = DBT_INTERNAL_SOURCE.`birth_year`,`customer_plan` = DBT_INTERNAL_SOURCE.`customer_plan`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m01:34:34.543101 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:737f5b51-e833-46d8-86f1-d710e2adc56c&page=queryresults
[0m01:34:35.890789 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (execute): 01:34:30.678560 => 01:34:35.890298
[0m01:34:35.893127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9babcc6-0cc7-4e5c-92e3-e8a3aeed4fdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136d74670>]}
[0m01:34:35.894431 [info ] [Thread-1 (]: 22 of 22 OK created sql incremental model citibike_source_sql.dbt sat_sql_users  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.26s]
[0m01:34:35.895431 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_users
[0m01:34:35.900142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:34:35.900778 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_sat_sql_users' was properly closed.
[0m01:34:35.901453 [info ] [MainThread]: 
[0m01:34:35.902026 [info ] [MainThread]: Finished running 8 view models, 14 incremental models in 0 hours 1 minutes and 20.63 seconds (80.63s).
[0m01:34:35.907015 [debug] [MainThread]: Command end result
[0m01:34:35.932751 [info ] [MainThread]: 
[0m01:34:35.933233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:34:35.933566 [info ] [MainThread]: 
[0m01:34:35.934269 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m01:34:35.938986 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 81.95482, "process_user_time": 6.166426, "process_kernel_time": 1.520722, "process_mem_max_rss": "205275136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:34:35.940053 [debug] [MainThread]: Command `dbt run` succeeded at 01:34:35.939927 after 81.96 seconds
[0m01:34:35.940516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055fb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136da9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107676e90>]}
[0m01:34:37.263676 [debug] [MainThread]: Flushing usage events
[0m05:49:33.506286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10371f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587af80>]}


============================== 05:49:33.509360 | f6c9c18f-dfc0-4235-8e9d-5b96435d5d5e ==============================
[0m05:49:33.509360 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:49:33.509715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models path:models/business_vault', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:49:34.413310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6c9c18f-dfc0-4235-8e9d-5b96435d5d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587ae90>]}
[0m05:49:34.443002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6c9c18f-dfc0-4235-8e9d-5b96435d5d5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105820d90>]}
[0m05:49:34.443544 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m05:49:34.468692 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:49:34.524892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m05:49:34.525304 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/business_vault/dbt_bridge_trips.sql
[0m05:49:34.525495 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/business_vault/dbt_as_of_date_trips.sql
[0m05:49:34.525665 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/business_vault/dbt_pit_users.sql
[0m05:49:34.525860 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m05:49:34.728850 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.dbt_bridge_trips' (models/business_vault/dbt_bridge_trips.sql) depends on a node named 'DBT_STG_TRIPS' which was not found
[0m05:49:34.731491 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2632548, "process_user_time": 2.233731, "process_kernel_time": 1.305155, "process_mem_max_rss": "203718656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:49:34.731818 [debug] [MainThread]: Command `dbt run` failed at 05:49:34.731741 after 1.26 seconds
[0m05:49:34.732060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10371f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b570370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12b057760>]}
[0m05:49:34.732296 [debug] [MainThread]: Flushing usage events
[0m05:52:45.361724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129df340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129def50>]}


============================== 05:52:45.365964 | 75219fa4-296a-49d0-9234-2f8e1491da9b ==============================
[0m05:52:45.365964 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:52:45.366302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models path:models/business_vault', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:52:46.316661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75219fa4-296a-49d0-9234-2f8e1491da9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129dee60>]}
[0m05:52:46.348050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75219fa4-296a-49d0-9234-2f8e1491da9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127441510>]}
[0m05:52:46.348771 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m05:52:46.372663 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:52:46.436504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m05:52:46.436904 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/business_vault/dbt_as_of_date_trips.sql
[0m05:52:46.437097 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/business_vault/dbt_pit_users.sql
[0m05:52:46.437269 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/business_vault/dbt_bridge_trips.sql
[0m05:52:46.437468 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m05:52:46.648864 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_bq_sa.dbt_pit_users' (models/business_vault/dbt_pit_users.sql) depends on a node named 'DBT_STG_USERS' which was not found
[0m05:52:46.650560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.341048, "process_user_time": 2.575965, "process_kernel_time": 1.188357, "process_mem_max_rss": "194428928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:52:46.650862 [debug] [MainThread]: Command `dbt run` failed at 05:52:46.650778 after 1.34 seconds
[0m05:52:46.651097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9e9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15923b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159a009a0>]}
[0m05:52:46.651341 [debug] [MainThread]: Flushing usage events
[0m05:53:58.970181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106df340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106def50>]}


============================== 05:53:58.973818 | a14ce95e-a05c-4041-ace5-577a1d78308b ==============================
[0m05:53:58.973818 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:53:58.974189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rishin/.dbt', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:53:59.870200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106dee60>]}
[0m05:53:59.900558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1346d1510>]}
[0m05:53:59.901217 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m05:53:59.919037 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:53:59.971841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 1 files changed.
[0m05:53:59.993612 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/business_vault/dbt_as_of_date_trips.sql
[0m05:53:59.994726 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/business_vault/dbt_bridge_trips.sql
[0m05:53:59.994951 [debug] [MainThread]: Partial parsing: added file: dbt_bq_sa://models/business_vault/dbt_pit_users.sql
[0m05:54:00.011547 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m05:54:00.266822 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.business_vault
- models.raw_vault
- models.stage
[0m05:54:00.270398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158123e50>]}
[0m05:54:00.283635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158192920>]}
[0m05:54:00.283941 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m05:54:00.284131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158191b70>]}
[0m05:54:00.285307 [info ] [MainThread]: 
[0m05:54:00.285721 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m05:54:00.286722 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m05:54:00.286926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:54:01.261513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m05:54:01.263067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:54:01.815107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158192020>]}
[0m05:54:01.816289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:54:01.816772 [info ] [MainThread]: 
[0m05:54:01.819820 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_bikes
[0m05:54:01.820466 [info ] [Thread-1 (]: 1 of 22 START sql view model citibike_source_sql.raw_sql_bikes ................. [RUN]
[0m05:54:01.821517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.raw_sql_bikes)
[0m05:54:01.822100 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_bikes
[0m05:54:01.833940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_bikes"
[0m05:54:01.835216 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (compile): 05:54:01.822411 => 05:54:01.834942
[0m05:54:01.835604 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_bikes
[0m05:54:01.858586 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_bikes"
[0m05:54:01.859419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:01.860662 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_bikes`;


[0m05:54:02.892954 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d30a44bc-0520-4bde-85c4-0c4faba12bc7&page=queryresults
[0m05:54:03.250754 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (execute): 05:54:01.835821 => 05:54:03.250405
[0m05:54:03.252179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1584f8970>]}
[0m05:54:03.253096 [info ] [Thread-1 (]: 1 of 22 OK created sql view model citibike_source_sql.raw_sql_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.43s]
[0m05:54:03.253898 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_bikes
[0m05:54:03.254437 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_stations
[0m05:54:03.255235 [info ] [Thread-1 (]: 2 of 22 START sql view model citibike_source_sql.raw_sql_stations .............. [RUN]
[0m05:54:03.256220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_bikes, now model.dbt_bq_sa.raw_sql_stations)
[0m05:54:03.256714 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_stations
[0m05:54:03.261597 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_stations"
[0m05:54:03.262584 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (compile): 05:54:03.257018 => 05:54:03.262346
[0m05:54:03.263001 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_stations
[0m05:54:03.269436 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_stations"
[0m05:54:03.270224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:03.271963 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_stations`;


[0m05:54:04.233853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:417b45cf-f527-4fd2-a82d-1acce12c33d8&page=queryresults
[0m05:54:04.772627 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (execute): 05:54:03.263258 => 05:54:04.772262
[0m05:54:04.774190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1584f83d0>]}
[0m05:54:04.775073 [info ] [Thread-1 (]: 2 of 22 OK created sql view model citibike_source_sql.raw_sql_stations ......... [[32mCREATE VIEW (0 processed)[0m in 1.52s]
[0m05:54:04.775680 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_stations
[0m05:54:04.776144 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_trips
[0m05:54:04.777115 [info ] [Thread-1 (]: 3 of 22 START sql view model citibike_source_sql.raw_sql_trips ................. [RUN]
[0m05:54:04.777827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_stations, now model.dbt_bq_sa.raw_sql_trips)
[0m05:54:04.778156 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_trips
[0m05:54:04.832908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_trips"
[0m05:54:04.834470 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (compile): 05:54:04.778350 => 05:54:04.834211
[0m05:54:04.834968 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_trips
[0m05:54:04.838929 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_trips"
[0m05:54:04.839798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:04.845739 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_trips`;


[0m05:54:05.665711 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:508465f4-1d5d-4b1a-a09d-a4ad29fe582e&page=queryresults
[0m05:54:06.141222 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (execute): 05:54:04.835133 => 05:54:06.140794
[0m05:54:06.143584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158565a20>]}
[0m05:54:06.144861 [info ] [Thread-1 (]: 3 of 22 OK created sql view model citibike_source_sql.raw_sql_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m05:54:06.145847 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_trips
[0m05:54:06.146509 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_users
[0m05:54:06.147414 [info ] [Thread-1 (]: 4 of 22 START sql view model citibike_source_sql.raw_sql_users ................. [RUN]
[0m05:54:06.148669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_trips, now model.dbt_bq_sa.raw_sql_users)
[0m05:54:06.149243 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_users
[0m05:54:06.155707 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_users"
[0m05:54:06.156799 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (compile): 05:54:06.149610 => 05:54:06.156516
[0m05:54:06.157268 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_users
[0m05:54:06.165088 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_users"
[0m05:54:06.166163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:06.167965 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_users`;


[0m05:54:06.866300 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4b4982fc-8245-4a5a-aca1-9bb9a4e92bc1&page=queryresults
[0m05:54:07.380865 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (execute): 05:54:06.157538 => 05:54:07.380079
[0m05:54:07.382655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13463ee00>]}
[0m05:54:07.383590 [info ] [Thread-1 (]: 4 of 22 OK created sql view model citibike_source_sql.raw_sql_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.23s]
[0m05:54:07.384539 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_users
[0m05:54:07.385217 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m05:54:07.386079 [info ] [Thread-1 (]: 5 of 22 START sql view model citibike_source_sql.dbt_stg_bikes ................. [RUN]
[0m05:54:07.387373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_users, now model.dbt_bq_sa.dbt_stg_bikes)
[0m05:54:07.388013 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m05:54:07.422585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:08.234747 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m05:54:08.235764 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 05:54:07.388347 => 05:54:08.235575
[0m05:54:08.236067 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m05:54:08.239259 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m05:54:08.239748 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    bike_type

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
),

derived_columns AS (

    SELECT

    bike_id,
    bike_type,
    'SRC_SQL_BIKES' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    BIKE_PK,
    BIKE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m05:54:08.906331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:823b69ff-d53e-4788-8d24-bb7749fc671d&page=queryresults
[0m05:54:09.558012 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 05:54:08.236239 => 05:54:09.557441
[0m05:54:09.559851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1585f2ce0>]}
[0m05:54:09.560983 [info ] [Thread-1 (]: 5 of 22 OK created sql view model citibike_source_sql.dbt_stg_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 2.17s]
[0m05:54:09.561970 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m05:54:09.562666 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m05:54:09.563587 [info ] [Thread-1 (]: 6 of 22 START sql view model citibike_source_sql.dbt_stg_stations .............. [RUN]
[0m05:54:09.565159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m05:54:09.565855 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m05:54:09.575750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:10.304068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m05:54:10.305333 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 05:54:09.566231 => 05:54:10.305077
[0m05:54:10.305731 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m05:54:10.310328 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_stations"
[0m05:54:10.311341 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
),

derived_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    'SRC_SQL_STATIONS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')
    )))) AS STRING) AS STATION_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    STATION_PK,
    STATION_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m05:54:11.027301 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b133ede6-a498-41b1-bc28-1d400b716bfe&page=queryresults
[0m05:54:11.584946 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 05:54:10.305974 => 05:54:11.584593
[0m05:54:11.586707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158566f20>]}
[0m05:54:11.587769 [info ] [Thread-1 (]: 6 of 22 OK created sql view model citibike_source_sql.dbt_stg_stations ......... [[32mCREATE VIEW (0 processed)[0m in 2.02s]
[0m05:54:11.588806 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m05:54:11.589878 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m05:54:11.591141 [info ] [Thread-1 (]: 7 of 22 START sql view model citibike_source_sql.dbt_stg_trips ................. [RUN]
[0m05:54:11.592329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m05:54:11.592937 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m05:54:11.603145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:12.340937 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m05:54:12.341778 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 05:54:11.593282 => 05:54:12.341574
[0m05:54:12.342103 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m05:54:12.345774 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m05:54:12.346529 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM,
    'DBT_SAT_SQL_TRIPS' AS DBT_SAT_SQL_TRIPS

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    DBT_SAT_SQL_TRIPS,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_USERS_BIKES_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_BIKES_TRIPS_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_USERS_TRIPS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    DBT_SAT_SQL_TRIPS,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF,
    LINK_USERS_BIKES_PK,
    LINK_BIKES_TRIPS_PK,
    LINK_USERS_TRIPS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m05:54:13.031389 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:1ded3139-ede0-48cf-ae7b-bec03282d2f8&page=queryresults
[0m05:54:13.395767 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 05:54:12.342291 => 05:54:13.395313
[0m05:54:13.397552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1584f8220>]}
[0m05:54:13.398925 [info ] [Thread-1 (]: 7 of 22 OK created sql view model citibike_source_sql.dbt_stg_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.81s]
[0m05:54:13.400061 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m05:54:13.400743 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m05:54:13.401839 [info ] [Thread-1 (]: 8 of 22 START sql view model citibike_source_sql.dbt_stg_users ................. [RUN]
[0m05:54:13.403047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m05:54:13.403638 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m05:54:13.419341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:14.118953 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m05:54:14.120391 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 05:54:13.403975 => 05:54:14.120120
[0m05:54:14.120878 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m05:54:14.126005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_users"
[0m05:54:14.126852 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
),

derived_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    'SRC_SQL_USERS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_PLANS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    USER_PK,
    USER_HASHDIFF,
    USER_PLANS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m05:54:14.832310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:06e616d7-f428-44ac-bc5a-b1dba25a7631&page=queryresults
[0m05:54:15.297779 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 05:54:14.121080 => 05:54:15.297309
[0m05:54:15.299779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1584f8370>]}
[0m05:54:15.300978 [info ] [Thread-1 (]: 8 of 22 OK created sql view model citibike_source_sql.dbt_stg_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m05:54:15.301918 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m05:54:15.302671 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m05:54:15.303989 [info ] [Thread-1 (]: 9 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_bikes ...... [RUN]
[0m05:54:15.305120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_users, now model.dbt_bq_sa.dbt_hub_sql_bikes)
[0m05:54:15.305688 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m05:54:15.340318 [info ] [Thread-1 (]: 05:54:15 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_bikes from 1 source(s)
[0m05:54:15.359071 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m05:54:15.360140 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (compile): 05:54:15.306020 => 05:54:15.359910
[0m05:54:15.360460 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m05:54:15.395400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:15.396771 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` AS d
    ON a.BIKE_PK = d.BIKE_PK
    WHERE d.BIKE_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m05:54:16.626010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:44a83b2d-ea27-48a7-aa87-c0537005e9a8&page=queryresults
[0m05:54:18.683623 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:54:18.712259 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m05:54:18.713568 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
            )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:54:19.418111 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:da93b410-dda9-49e7-bae9-46ef5a1073f7&page=queryresults
[0m05:54:21.115442 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (execute): 05:54:15.360633 => 05:54:21.114375
[0m05:54:21.117913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1589ebf40>]}
[0m05:54:21.119143 [info ] [Thread-1 (]: 9 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_bikes . [[32mMERGE (0.0 rows, 325.0 Bytes processed)[0m in 5.81s]
[0m05:54:21.120196 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m05:54:21.120922 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m05:54:21.121995 [info ] [Thread-1 (]: 10 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_bikes ..... [RUN]
[0m05:54:21.123317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_bikes, now model.dbt_bq_sa.dbt_sat_sql_bikes)
[0m05:54:21.123961 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m05:54:21.176687 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m05:54:21.178931 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (compile): 05:54:21.124335 => 05:54:21.178738
[0m05:54:21.179227 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m05:54:21.182833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:21.184188 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.BIKE_PK, current_records.BIKE_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` AS current_records
    JOIN (
        SELECT DISTINCT source_data.BIKE_PK
        FROM source_data
    ) AS source_records
        ON source_records.BIKE_PK = current_records.BIKE_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.BIKE_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.BIKE_PK = frin.BIKE_PK
        AND lr.BIKE_HASHDIFF = frin.BIKE_HASHDIFF
        WHERE lr.BIKE_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m05:54:22.237272 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0f59c0a2-80d7-40b4-8ee7-bc5f9ae8067f&page=queryresults
[0m05:54:24.336955 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:54:24.342492 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m05:54:24.343851 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
                ) and (
                    DBT_INTERNAL_SOURCE.BIKE_HASHDIFF = DBT_INTERNAL_DEST.BIKE_HASHDIFF
                )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`BIKE_HASHDIFF` = DBT_INTERNAL_SOURCE.`BIKE_HASHDIFF`,`bike_type` = DBT_INTERNAL_SOURCE.`bike_type`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:54:24.715561 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b5767788-07a3-4f1a-999d-02caa6a95ef9&page=queryresults
[0m05:54:26.340285 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (execute): 05:54:21.179386 => 05:54:26.339676
[0m05:54:26.342714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1585e4400>]}
[0m05:54:26.344301 [info ] [Thread-1 (]: 10 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_bikes  [[32mMERGE (0.0 rows, 502.0 Bytes processed)[0m in 5.22s]
[0m05:54:26.345334 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m05:54:26.346123 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m05:54:26.347161 [info ] [Thread-1 (]: 11 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_stations .. [RUN]
[0m05:54:26.348498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_bikes, now model.dbt_bq_sa.dbt_hub_sql_stations)
[0m05:54:26.349112 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_stations
[0m05:54:26.363268 [info ] [Thread-1 (]: 05:54:26 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_stations from 1 source(s)
[0m05:54:26.370602 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m05:54:26.371606 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (compile): 05:54:26.349403 => 05:54:26.371375
[0m05:54:26.371984 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_stations
[0m05:54:26.377450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:26.379429 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` AS d
    ON a.STATION_PK = d.STATION_PK
    WHERE d.STATION_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m05:54:27.427306 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:df299132-3b97-4198-bfa8-cea8c026cf2b&page=queryresults
[0m05:54:29.203739 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:54:29.208294 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m05:54:29.209738 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
            )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`station_id` = DBT_INTERNAL_SOURCE.`station_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:54:29.518457 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:bfe43733-fe63-42a0-a1c6-9a3cddf547e2&page=queryresults
[0m05:54:30.960995 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (execute): 05:54:26.372193 => 05:54:30.960445
[0m05:54:30.963606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1588e3be0>]}
[0m05:54:30.964999 [info ] [Thread-1 (]: 11 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 4.62s]
[0m05:54:30.966022 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m05:54:30.966760 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m05:54:30.967730 [info ] [Thread-1 (]: 12 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_stations .. [RUN]
[0m05:54:30.968977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_stations, now model.dbt_bq_sa.dbt_sat_sql_stations)
[0m05:54:30.969842 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_stations
[0m05:54:31.006758 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m05:54:31.009097 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (compile): 05:54:30.970192 => 05:54:31.008871
[0m05:54:31.009447 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_stations
[0m05:54:31.020695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:31.022391 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by STATION_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.STATION_PK, current_records.STATION_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` AS current_records
    JOIN (
        SELECT DISTINCT source_data.STATION_PK
        FROM source_data
    ) AS source_records
        ON source_records.STATION_PK = current_records.STATION_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.STATION_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.STATION_PK = frin.STATION_PK
        AND lr.STATION_HASHDIFF = frin.STATION_HASHDIFF
        WHERE lr.STATION_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m05:54:32.132330 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:ac403cd5-0951-4f36-8d95-bb3db54166f1&page=queryresults
[0m05:54:34.502519 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:54:34.508126 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m05:54:34.509898 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
                ) and (
                    DBT_INTERNAL_SOURCE.STATION_HASHDIFF = DBT_INTERNAL_DEST.STATION_HASHDIFF
                )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`STATION_HASHDIFF` = DBT_INTERNAL_SOURCE.`STATION_HASHDIFF`,`name` = DBT_INTERNAL_SOURCE.`name`,`short_name` = DBT_INTERNAL_SOURCE.`short_name`,`latitude` = DBT_INTERNAL_SOURCE.`latitude`,`longitude` = DBT_INTERNAL_SOURCE.`longitude`,`region_id` = DBT_INTERNAL_SOURCE.`region_id`,`rental_method` = DBT_INTERNAL_SOURCE.`rental_method`,`capacity` = DBT_INTERNAL_SOURCE.`capacity`,`last_reported` = DBT_INTERNAL_SOURCE.`last_reported`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:54:34.845425 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:62e22188-b5e7-4ed5-9b77-735309f87e89&page=queryresults
[0m05:54:36.602024 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (execute): 05:54:31.009637 => 05:54:36.601301
[0m05:54:36.604527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1585f0e20>]}
[0m05:54:36.605975 [info ] [Thread-1 (]: 12 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.64s]
[0m05:54:36.607087 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m05:54:36.608054 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m05:54:36.611535 [info ] [Thread-1 (]: 13 of 22 START sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips . [RUN]
[0m05:54:36.615604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_stations, now model.dbt_bq_sa.dbt_eff_sat_link_users_trips)
[0m05:54:36.616330 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m05:54:36.690868 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m05:54:36.691579 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (compile): 05:54:36.616680 => 05:54:36.691432
[0m05:54:36.691823 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m05:54:36.694534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:37.106504 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m05:54:37.108418 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_eff_sat_link_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` as DBT_INTERNAL_DEST
        using (

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.USER_PK IS NOT NULL
    AND a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT * FROM (
        SELECT b.TRIP_PK, b.USER_PK, b.BIKE_PK, b.start_time, b.end_time, b.EFFECTIVE_FROM, b.LOAD_DATE, b.RECORD_SOURCE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` AS b
        QUALIFY ROW_NUMBER() OVER (
            PARTITION BY b.TRIP_PK
            ORDER BY b.LOAD_DATE DESC
        ) = 1
        ) AS inner_select
    
),

latest_open AS (
    SELECT c.TRIP_PK, c.USER_PK, c.BIKE_PK, c.start_time, c.end_time, c.EFFECTIVE_FROM, c.LOAD_DATE, c.RECORD_SOURCE
    FROM latest_records AS c
    WHERE DATE(c.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

latest_closed AS (
    SELECT d.TRIP_PK, d.USER_PK, d.BIKE_PK, d.start_time, d.end_time, d.EFFECTIVE_FROM, d.LOAD_DATE, d.RECORD_SOURCE
    FROM latest_records AS d
    WHERE DATE(d.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

new_open_records AS (
    SELECT DISTINCT
        f.TRIP_PK, f.USER_PK, f.BIKE_PK,
        f.start_time AS start_time,
        f.end_time AS end_time,
        f.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        f.LOAD_DATE,
        f.RECORD_SOURCE
    FROM source_data AS f
    LEFT JOIN latest_records AS lr
    ON f.TRIP_PK = lr.TRIP_PK
    WHERE lr.TRIP_PK IS NULL
),

new_reopened_records AS (
    SELECT DISTINCT
        lc.TRIP_PK, lc.USER_PK, lc.BIKE_PK,
        g.start_time AS start_time,
        g.end_time AS end_time,
        g.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        g.LOAD_DATE,
        g.RECORD_SOURCE
    FROM source_data AS g
    INNER JOIN latest_closed AS lc
    ON g.TRIP_PK = lc.TRIP_PK
    WHERE DATE(g.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),



new_closed_records AS (
    SELECT DISTINCT
        lo.TRIP_PK, lo.USER_PK, lo.BIKE_PK,
        h.start_time AS start_time,
        h.end_time AS end_time,
        h.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        h.LOAD_DATE,
        lo.RECORD_SOURCE
    FROM source_data AS h
    LEFT JOIN latest_open AS lo
    ON lo.TRIP_PK = h.TRIP_PK
    LEFT JOIN latest_closed AS lc
    ON lc.TRIP_PK = h.TRIP_PK
    WHERE DATE(h.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
    AND lo.TRIP_PK IS NOT NULL
    AND lc.TRIP_PK IS NULL
),

records_to_insert AS (
    SELECT * FROM new_open_records
    UNION DISTINCT
    SELECT * FROM new_reopened_records
    UNION DISTINCT
    SELECT * FROM new_closed_records
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:54:37.854556 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d8957c46-6686-4838-92b4-0e87979dae00&page=queryresults
[0m05:54:39.318689 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (execute): 05:54:36.691959 => 05:54:39.318327
[0m05:54:39.319911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1589c50c0>]}
[0m05:54:39.320741 [info ] [Thread-1 (]: 13 of 22 OK created sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips  [[32mMERGE (0.0 rows, 3.5 KiB processed)[0m in 2.71s]
[0m05:54:39.321507 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m05:54:39.322075 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m05:54:39.322804 [info ] [Thread-1 (]: 14 of 22 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [RUN]
[0m05:54:39.323813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_eff_sat_link_users_trips, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m05:54:39.324346 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m05:54:39.352619 [info ] [Thread-1 (]: 05:54:39 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m05:54:39.355901 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m05:54:39.357714 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 05:54:39.324653 => 05:54:39.357479
[0m05:54:39.358067 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m05:54:39.363204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:39.364651 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.DBT_SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips` AS d
        ON (
            a.HASHDIFF = d.HASHDIFF
            AND a.LOAD_DATE = d.LOAD_DATE
            AND a.SATELLITE_NAME = d.SATELLITE_NAME
        )
    WHERE d.HASHDIFF IS NULL
    AND d.LOAD_DATE IS NULL
    AND d.SATELLITE_NAME IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m05:54:40.493487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:6eaf3ac3-e5b9-486b-bc77-9e0da8122212&page=queryresults
[0m05:54:42.351321 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:54:42.355280 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m05:54:42.357145 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.HASHDIFF = DBT_INTERNAL_DEST.HASHDIFF
                ) and (
                    DBT_INTERNAL_SOURCE.SATELLITE_NAME = DBT_INTERNAL_DEST.SATELLITE_NAME
                ) and (
                    DBT_INTERNAL_SOURCE.LOAD_DATE = DBT_INTERNAL_DEST.LOAD_DATE
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`HASHDIFF` = DBT_INTERNAL_SOURCE.`HASHDIFF`,`SATELLITE_NAME` = DBT_INTERNAL_SOURCE.`SATELLITE_NAME`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `HASHDIFF`, `SATELLITE_NAME`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `HASHDIFF`, `SATELLITE_NAME`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:54:42.683173 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:35750d13-d207-4873-8345-dfbbae37b064&page=queryresults
[0m05:54:44.113169 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 05:54:39.358263 => 05:54:44.112653
[0m05:54:44.114897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1585fe590>]}
[0m05:54:44.116276 [info ] [Thread-1 (]: 14 of 22 OK created sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[32mMERGE (20.0 rows, 8.6 KiB processed)[0m in 4.79s]
[0m05:54:44.117315 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m05:54:44.118227 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m05:54:44.119626 [info ] [Thread-1 (]: 15 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_trips ..... [RUN]
[0m05:54:44.120438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_ext_track_sat_trips, now model.dbt_bq_sa.dbt_hub_sql_trips)
[0m05:54:44.120787 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_trips
[0m05:54:44.134262 [info ] [Thread-1 (]: 05:54:44 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_trips from 1 source(s)
[0m05:54:44.147298 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m05:54:44.148676 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (compile): 05:54:44.120984 => 05:54:44.148417
[0m05:54:44.149073 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_trips
[0m05:54:44.154096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:44.156561 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` AS d
    ON a.TRIP_PK = d.TRIP_PK
    WHERE d.TRIP_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m05:54:45.236143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:cb7b200a-11a2-48f0-8992-b373ed8bb432&page=queryresults
[0m05:54:47.169474 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:54:47.175331 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m05:54:47.177432 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
            )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`start_station_id` = DBT_INTERNAL_SOURCE.`start_station_id`,`end_station_id` = DBT_INTERNAL_SOURCE.`end_station_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:54:47.489191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:bdf9203c-7728-46c1-abbd-38c0198e8f16&page=queryresults
[0m05:54:48.883635 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (execute): 05:54:44.149280 => 05:54:48.882916
[0m05:54:48.889372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1588a2740>]}
[0m05:54:48.892530 [info ] [Thread-1 (]: 15 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_trips  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 4.77s]
[0m05:54:48.893755 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m05:54:48.894161 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m05:54:48.894827 [info ] [Thread-1 (]: 16 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [RUN]
[0m05:54:48.895386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_trips, now model.dbt_bq_sa.dbt_link_sql_bikes_trips)
[0m05:54:48.895627 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m05:54:48.909540 [info ] [Thread-1 (]: 05:54:48 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_bikes_trips from 1 source(s)
[0m05:54:48.931950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m05:54:48.935259 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (compile): 05:54:48.895762 => 05:54:48.934997
[0m05:54:48.935569 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m05:54:48.943470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:48.950555 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_BIKES_TRIPS_PK, rr.BIKE_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_BIKES_TRIPS_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_BIKES_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_BIKES_TRIPS_PK, a.BIKE_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` AS d
    ON a.LINK_BIKES_TRIPS_PK = d.LINK_BIKES_TRIPS_PK
    WHERE d.LINK_BIKES_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m05:54:50.134084 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e9667a85-63d7-4342-ab10-e59244606f61&page=queryresults
[0m05:54:52.032322 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:54:52.036458 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m05:54:52.038354 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_BIKES_TRIPS_PK = DBT_INTERNAL_DEST.LINK_BIKES_TRIPS_PK
            )

    
    when matched then update set
        `LINK_BIKES_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_BIKES_TRIPS_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:54:52.482260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:30abfcec-7100-4abb-833d-8022ed82a10c&page=queryresults
[0m05:54:53.907556 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (execute): 05:54:48.935710 => 05:54:53.907048
[0m05:54:53.909633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1585ff160>]}
[0m05:54:53.911209 [info ] [Thread-1 (]: 16 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 5.01s]
[0m05:54:53.912633 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m05:54:53.913377 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m05:54:53.914313 [info ] [Thread-1 (]: 17 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [RUN]
[0m05:54:53.915670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_bikes_trips, now model.dbt_bq_sa.dbt_link_sql_users_bikes)
[0m05:54:53.916263 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m05:54:53.927329 [info ] [Thread-1 (]: 05:54:53 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_bikes from 1 source(s)
[0m05:54:53.936442 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m05:54:53.937670 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (compile): 05:54:53.916608 => 05:54:53.937394
[0m05:54:53.938112 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m05:54:53.948573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:53.950738 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_BIKES_PK, rr.USER_PK, rr.BIKE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_BIKES_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_BIKES_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_BIKES_PK, a.USER_PK, a.BIKE_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` AS d
    ON a.LINK_USERS_BIKES_PK = d.LINK_USERS_BIKES_PK
    WHERE d.LINK_USERS_BIKES_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m05:54:54.713812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8a944181-2111-4837-a676-5b3e0a35fe9d&page=queryresults
[0m05:54:56.822155 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:54:56.824888 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m05:54:56.827881 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_BIKES_PK = DBT_INTERNAL_DEST.LINK_USERS_BIKES_PK
            )

    
    when matched then update set
        `LINK_USERS_BIKES_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_BIKES_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:54:57.241268 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b392e975-0dda-4219-9f15-7a5dcead0bee&page=queryresults
[0m05:54:58.718356 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (execute): 05:54:53.938359 => 05:54:58.717144
[0m05:54:58.720994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158aede10>]}
[0m05:54:58.722390 [info ] [Thread-1 (]: 17 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [[32mMERGE (0.0 rows, 1.2 KiB processed)[0m in 4.81s]
[0m05:54:58.723416 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m05:54:58.724261 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m05:54:58.725951 [info ] [Thread-1 (]: 18 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [RUN]
[0m05:54:58.731383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_bikes, now model.dbt_bq_sa.dbt_link_sql_users_trips)
[0m05:54:58.732173 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m05:54:58.753152 [info ] [Thread-1 (]: 05:54:58 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_trips from 1 source(s)
[0m05:54:58.762149 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m05:54:58.763479 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (compile): 05:54:58.732554 => 05:54:58.762969
[0m05:54:58.764058 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m05:54:58.769331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:54:58.771767 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_TRIPS_PK, rr.USER_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_TRIPS_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_TRIPS_PK, a.USER_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` AS d
    ON a.LINK_USERS_TRIPS_PK = d.LINK_USERS_TRIPS_PK
    WHERE d.LINK_USERS_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m05:54:59.836962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:7760e8cb-2ea8-4070-9354-2dbbe9d1b095&page=queryresults
[0m05:55:01.651932 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:55:01.656919 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m05:55:01.660496 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_TRIPS_PK = DBT_INTERNAL_DEST.LINK_USERS_TRIPS_PK
            )

    
    when matched then update set
        `LINK_USERS_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_TRIPS_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:55:01.993859 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0c3c8494-8132-4033-96bd-4cac703872db&page=queryresults
[0m05:55:03.534004 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (execute): 05:54:58.764329 => 05:55:03.533466
[0m05:55:03.536558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158a7c790>]}
[0m05:55:03.538209 [info ] [Thread-1 (]: 18 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 4.81s]
[0m05:55:03.539249 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m05:55:03.539964 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m05:55:03.540937 [info ] [Thread-1 (]: 19 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_trips ..... [RUN]
[0m05:55:03.542222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_trips, now model.dbt_bq_sa.dbt_sat_sql_trips)
[0m05:55:03.542856 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_trips
[0m05:55:03.577633 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m05:55:03.578903 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (compile): 05:55:03.543219 => 05:55:03.578673
[0m05:55:03.579249 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_trips
[0m05:55:03.584668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:03.586397 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by TRIP_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.TRIP_PK, current_records.TRIP_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` AS current_records
    JOIN (
        SELECT DISTINCT source_data.TRIP_PK
        FROM source_data
    ) AS source_records
        ON source_records.TRIP_PK = current_records.TRIP_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.TRIP_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.TRIP_PK = frin.TRIP_PK
        AND lr.TRIP_HASHDIFF = frin.TRIP_HASHDIFF
        WHERE lr.TRIP_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m05:55:04.615740 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b4ffd811-1fcb-4266-bbca-53a0dffa2fcf&page=queryresults
[0m05:55:07.024917 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:55:07.030531 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m05:55:07.033013 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.TRIP_HASHDIFF = DBT_INTERNAL_DEST.TRIP_HASHDIFF
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`TRIP_HASHDIFF` = DBT_INTERNAL_SOURCE.`TRIP_HASHDIFF`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`trip_duration` = DBT_INTERNAL_SOURCE.`trip_duration`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:55:07.413860 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:ab7c70f5-3f28-4635-9e57-783ddb11f15b&page=queryresults
[0m05:55:08.828635 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (execute): 05:55:03.579442 => 05:55:08.828108
[0m05:55:08.830313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13463ee00>]}
[0m05:55:08.831324 [info ] [Thread-1 (]: 19 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_trips  [[32mMERGE (0.0 rows, 1.3 KiB processed)[0m in 5.29s]
[0m05:55:08.832281 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m05:55:08.832956 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_users
[0m05:55:08.833871 [info ] [Thread-1 (]: 20 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_users ..... [RUN]
[0m05:55:08.835123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_trips, now model.dbt_bq_sa.dbt_hub_sql_users)
[0m05:55:08.835744 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_users
[0m05:55:08.845860 [info ] [Thread-1 (]: 05:55:08 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_users from 1 source(s)
[0m05:55:08.853563 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m05:55:08.854623 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (compile): 05:55:08.836101 => 05:55:08.854360
[0m05:55:08.855051 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_users
[0m05:55:08.862290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:08.864027 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` AS d
    ON a.USER_PK = d.USER_PK
    WHERE d.USER_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m05:55:09.921781 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:daa65bdb-e898-4d93-96c9-417e5eebba77&page=queryresults
[0m05:55:11.741872 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:55:11.748313 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m05:55:11.750705 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
            )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:55:12.126251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:c7dc038b-4ff0-4c45-8969-2f92dad6c3a6&page=queryresults
[0m05:55:13.359186 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (execute): 05:55:08.855299 => 05:55:13.358598
[0m05:55:13.361587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158566f20>]}
[0m05:55:13.362912 [info ] [Thread-1 (]: 20 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_users  [[32mMERGE (0.0 rows, 650.0 Bytes processed)[0m in 4.53s]
[0m05:55:13.363772 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_users
[0m05:55:13.364416 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m05:55:13.365367 [info ] [Thread-1 (]: 21 of 22 START sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [RUN]
[0m05:55:13.370518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_users, now model.dbt_bq_sa.dbt_multi_active_sat_users_plans)
[0m05:55:13.371052 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m05:55:13.404269 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m05:55:13.405119 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (compile): 05:55:13.371289 => 05:55:13.404940
[0m05:55:13.405393 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m05:55:13.411663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:13.414045 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      dbt_sat_sql_trips

-- Generated by AutomateDV (formerly known as dbtvault)

    
WITH source_data AS (
    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.USER_PLANS_HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS s
    WHERE s.USER_PK IS NOT NULL
        AND s.customer_plan IS NOT NULL
),

source_data_with_count AS (
    SELECT a.*,
           b.source_count
    FROM source_data AS a
    INNER JOIN (
        SELECT t.USER_PK, COUNT(*) AS source_count
        FROM (
            SELECT DISTINCT s.USER_PK,
                            s.USER_PLANS_HASHDIFF,
                            s.customer_plan
            FROM source_data AS s
        ) AS t
        GROUP BY t.USER_PK
    ) AS b
    ON a.USER_PK = b.USER_PK
),

latest_records AS (
    SELECT mas.USER_PK, mas.HASHDIFF, mas.customer_plan, mas.LOAD_DATE,DENSE_RANK() OVER (
               PARTITION BY mas.USER_PK
               ORDER BY mas.HASHDIFF, mas.customer_plan ASC
           ) AS check_rank
    FROM (
        SELECT inner_mas.USER_PK, inner_mas.HASHDIFF, inner_mas.customer_plan, inner_mas.LOAD_DATE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans` AS inner_mas
        INNER JOIN (SELECT DISTINCT s.USER_PK FROM source_data as s ) AS spk
            ON inner_mas.USER_PK = spk.USER_PK
            QUALIFY RANK() OVER (
                PARTITION BY inner_mas.USER_PK
                ORDER BY inner_mas.LOAD_DATE DESC
            ) = 1
    ) AS mas
    
),

latest_group_details AS (
    SELECT lr.USER_PK,
           lr.LOAD_DATE,
           MAX(lr.check_rank) AS latest_count
    FROM latest_records AS lr
    GROUP BY lr.USER_PK, lr.LOAD_DATE
),

records_to_insert AS (
    SELECT source_data_with_count.USER_PK, source_data_with_count.customer_plan, source_data_with_count.user_type, source_data_with_count.USER_PLANS_HASHDIFF AS HASHDIFF, source_data_with_count.EFFECTIVE_FROM, source_data_with_count.LOAD_DATE, source_data_with_count.RECORD_SOURCE
    FROM source_data_with_count
    WHERE EXISTS (
        SELECT 1
        FROM source_data_with_count AS stage
        WHERE NOT EXISTS (
            SELECT 1
            FROM (
                SELECT lr.USER_PK, lr.HASHDIFF, lr.customer_plan, lr.LOAD_DATE,
                       lg.latest_count
                FROM latest_records AS lr
                INNER JOIN latest_group_details AS lg
                    ON lr.USER_PK = lg.USER_PK
                    AND lr.LOAD_DATE = lg.LOAD_DATE
            ) AS active_records
            WHERE stage.USER_PK = active_records.USER_PK
                AND stage.USER_PLANS_HASHDIFF = active_records.HASHDIFF
                AND stage.customer_plan = active_records.customer_plan
                AND stage.source_count = active_records.latest_count
        )
        AND source_data_with_count.USER_PK = stage.USER_PK
    )
)

SELECT * FROM records_to_insert
    );
  
[0m05:55:13.973821 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:4416115e-5010-443c-a0a6-6d5bf0f65fbb&page=queryresults
[0m05:55:13.975624 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "dbt_sat_sql_trips" at [15:7]; reason: invalidQuery, location: query, message: Syntax error: Unexpected identifier "dbt_sat_sql_trips" at [15:7]')
[0m05:55:14.835403 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:206ed50a-72f0-449f-bc97-2cbbbce167ea&page=queryresults
[0m05:55:14.837538 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:206ed50a-72f0-449f-bc97-2cbbbce167ea&page=queryresults
[0m05:55:14.839013 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (execute): 05:55:13.405545 => 05:55:14.838450
[0m05:55:14.851598 [debug] [Thread-1 (]: Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Syntax error: Unexpected identifier "dbt_sat_sql_trips" at [15:7]
[0m05:55:14.852633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1584a2680>]}
[0m05:55:14.853802 [error] [Thread-1 (]: 21 of 22 ERROR creating sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [[31mERROR[0m in 1.49s]
[0m05:55:14.854899 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m05:55:14.855594 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_users
[0m05:55:14.865499 [info ] [Thread-1 (]: 22 of 22 START sql incremental model citibike_source_sql.dbt sat_sql_users ..... [RUN]
[0m05:55:14.866645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_multi_active_sat_users_plans, now model.dbt_bq_sa.dbt_sat_sql_users)
[0m05:55:14.867152 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_users
[0m05:55:14.893168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m05:55:14.894235 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (compile): 05:55:14.867431 => 05:55:14.894015
[0m05:55:14.894574 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_users
[0m05:55:14.900481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:14.901851 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by USER_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.USER_PK, current_records.USER_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` AS current_records
    JOIN (
        SELECT DISTINCT source_data.USER_PK
        FROM source_data
    ) AS source_records
        ON source_records.USER_PK = current_records.USER_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.USER_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.USER_PK = frin.USER_PK
        AND lr.USER_HASHDIFF = frin.USER_HASHDIFF
        WHERE lr.USER_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m05:55:15.913728 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a8654dce-3b2c-4a99-a755-d7b9c5c3d141&page=queryresults
[0m05:55:18.406336 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m05:55:18.411544 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m05:55:18.414182 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
                ) and (
                    DBT_INTERNAL_SOURCE.USER_HASHDIFF = DBT_INTERNAL_DEST.USER_HASHDIFF
                )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`USER_HASHDIFF` = DBT_INTERNAL_SOURCE.`USER_HASHDIFF`,`user_type` = DBT_INTERNAL_SOURCE.`user_type`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`birth_year` = DBT_INTERNAL_SOURCE.`birth_year`,`customer_plan` = DBT_INTERNAL_SOURCE.`customer_plan`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m05:55:18.742476 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:78949c9f-2da9-4187-8f3e-7ce49a02b071&page=queryresults
[0m05:55:20.167396 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (execute): 05:55:14.894773 => 05:55:20.166955
[0m05:55:20.172190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14ce95e-a05c-4041-ace5-577a1d78308b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158809e40>]}
[0m05:55:20.173932 [info ] [Thread-1 (]: 22 of 22 OK created sql incremental model citibike_source_sql.dbt sat_sql_users  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.31s]
[0m05:55:20.175497 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_users
[0m05:55:20.184337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:55:20.185311 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_sat_sql_users' was properly closed.
[0m05:55:20.186002 [info ] [MainThread]: 
[0m05:55:20.187063 [info ] [MainThread]: Finished running 8 view models, 14 incremental models in 0 hours 1 minutes and 19.90 seconds (79.90s).
[0m05:55:20.192273 [debug] [MainThread]: Command end result
[0m05:55:20.253807 [info ] [MainThread]: 
[0m05:55:20.254171 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:55:20.254400 [info ] [MainThread]: 
[0m05:55:20.255155 [error] [MainThread]:   Database Error in model dbt_multi_active_sat_users_plans (models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql)
  Syntax error: Unexpected identifier "dbt_sat_sql_trips" at [15:7]
[0m05:55:20.255448 [info ] [MainThread]: 
[0m05:55:20.255999 [info ] [MainThread]: Done. PASS=21 WARN=0 ERROR=1 SKIP=0 TOTAL=22
[0m05:55:20.285202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 81.355415, "process_user_time": 6.102264, "process_kernel_time": 1.765959, "process_mem_max_rss": "207732736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:55:20.287438 [debug] [MainThread]: Command `dbt run` failed at 05:55:20.287326 after 81.36 seconds
[0m05:55:20.288701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1346d1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1581935b0>]}
[0m05:55:21.539082 [debug] [MainThread]: Flushing usage events
[0m06:00:04.962550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075673d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11481b370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11481af80>]}


============================== 06:00:04.965669 | 06db714f-1f5e-4645-8327-1ada5669dc10 ==============================
[0m06:00:04.965669 [info ] [MainThread]: Running with dbt=1.7.19
[0m06:00:04.966007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs', 'profiles_dir': '/Users/rishin/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:00:05.894071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11481ae90>]}
[0m06:00:05.923382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147c1060>]}
[0m06:00:05.923913 [info ] [MainThread]: Registered adapter: bigquery=1.7.9
[0m06:00:05.950755 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m06:00:06.007589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:00:06.008020 [debug] [MainThread]: Partial parsing: updated file: dbt_bq_sa://models/raw_vault/sats/dbt_multi_active_sat_users_plans.sql
[0m06:00:06.139160 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.raw_vault
- models.business_vault
- models.stage
[0m06:00:06.142654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147cd8c10>]}
[0m06:00:06.219228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147c6c100>]}
[0m06:00:06.219673 [info ] [MainThread]: Found 22 models, 4 sources, 0 exposures, 0 metrics, 855 macros, 0 groups, 0 semantic models
[0m06:00:06.219931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147c6f700>]}
[0m06:00:06.221265 [info ] [MainThread]: 
[0m06:00:06.221719 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:00:06.222776 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_leafy-mountain-469410-k3'
[0m06:00:06.222966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:07.148049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3, now list_leafy-mountain-469410-k3_citibike_source_sql)
[0m06:00:07.148716 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:07.711618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147c0be0>]}
[0m06:00:07.713711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:00:07.714239 [info ] [MainThread]: 
[0m06:00:07.718892 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_bikes
[0m06:00:07.719686 [info ] [Thread-1 (]: 1 of 22 START sql view model citibike_source_sql.raw_sql_bikes ................. [RUN]
[0m06:00:07.720689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_leafy-mountain-469410-k3_citibike_source_sql, now model.dbt_bq_sa.raw_sql_bikes)
[0m06:00:07.721190 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_bikes
[0m06:00:07.743393 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_bikes"
[0m06:00:07.744768 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (compile): 06:00:07.721795 => 06:00:07.744503
[0m06:00:07.745144 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_bikes
[0m06:00:07.771668 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_bikes"
[0m06:00:07.772474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:07.773654 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_bikes`;


[0m06:00:08.972716 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8af276ba-154c-4581-9b48-a73495db3937&page=queryresults
[0m06:00:09.421561 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_bikes (execute): 06:00:07.745373 => 06:00:09.421251
[0m06:00:09.422754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b02ad0>]}
[0m06:00:09.423557 [info ] [Thread-1 (]: 1 of 22 OK created sql view model citibike_source_sql.raw_sql_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m06:00:09.424312 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_bikes
[0m06:00:09.424846 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_stations
[0m06:00:09.425568 [info ] [Thread-1 (]: 2 of 22 START sql view model citibike_source_sql.raw_sql_stations .............. [RUN]
[0m06:00:09.426377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_bikes, now model.dbt_bq_sa.raw_sql_stations)
[0m06:00:09.426764 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_stations
[0m06:00:09.431206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_stations"
[0m06:00:09.432108 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (compile): 06:00:09.426996 => 06:00:09.431867
[0m06:00:09.432511 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_stations
[0m06:00:09.437360 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_stations"
[0m06:00:09.438210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:09.439770 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_stations`;


[0m06:00:10.106069 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:25d9b1b6-f9c1-484e-81d7-3b02d5c52df7&page=queryresults
[0m06:00:10.723522 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_stations (execute): 06:00:09.432747 => 06:00:10.722756
[0m06:00:10.725503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b5c670>]}
[0m06:00:10.726181 [info ] [Thread-1 (]: 2 of 22 OK created sql view model citibike_source_sql.raw_sql_stations ......... [[32mCREATE VIEW (0 processed)[0m in 1.30s]
[0m06:00:10.726768 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_stations
[0m06:00:10.727329 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_trips
[0m06:00:10.728174 [info ] [Thread-1 (]: 3 of 22 START sql view model citibike_source_sql.raw_sql_trips ................. [RUN]
[0m06:00:10.729523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_stations, now model.dbt_bq_sa.raw_sql_trips)
[0m06:00:10.730144 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_trips
[0m06:00:10.737444 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_trips"
[0m06:00:10.738549 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (compile): 06:00:10.730497 => 06:00:10.738292
[0m06:00:10.738998 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_trips
[0m06:00:10.747027 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_trips"
[0m06:00:10.747939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:10.749755 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_trips`;


[0m06:00:11.401643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a6f9425e-1969-41d7-ba99-2281997707f1&page=queryresults
[0m06:00:11.862754 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_trips (execute): 06:00:10.739273 => 06:00:11.862381
[0m06:00:11.871601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d6b430>]}
[0m06:00:11.872963 [info ] [Thread-1 (]: 3 of 22 OK created sql view model citibike_source_sql.raw_sql_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.14s]
[0m06:00:11.874080 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_trips
[0m06:00:11.874732 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.raw_sql_users
[0m06:00:11.875648 [info ] [Thread-1 (]: 4 of 22 START sql view model citibike_source_sql.raw_sql_users ................. [RUN]
[0m06:00:11.876832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_trips, now model.dbt_bq_sa.raw_sql_users)
[0m06:00:11.877404 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.raw_sql_users
[0m06:00:11.884616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.raw_sql_users"
[0m06:00:11.886032 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (compile): 06:00:11.877748 => 06:00:11.885683
[0m06:00:11.886583 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.raw_sql_users
[0m06:00:11.892084 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.raw_sql_users"
[0m06:00:11.892969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:11.895023 [debug] [Thread-1 (]: On model.dbt_bq_sa.raw_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.raw_sql_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
  OPTIONS()
  as 
select *
from `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_users`;


[0m06:00:12.537554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:07ba9e82-869e-4b03-aed3-7d9bb76674cd&page=queryresults
[0m06:00:12.905923 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.raw_sql_users (execute): 06:00:11.886866 => 06:00:12.905246
[0m06:00:12.908299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147be26b0>]}
[0m06:00:12.909317 [info ] [Thread-1 (]: 4 of 22 OK created sql view model citibike_source_sql.raw_sql_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.03s]
[0m06:00:12.910236 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.raw_sql_users
[0m06:00:12.910915 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_bikes
[0m06:00:12.912013 [info ] [Thread-1 (]: 5 of 22 START sql view model citibike_source_sql.dbt_stg_bikes ................. [RUN]
[0m06:00:12.913088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.raw_sql_users, now model.dbt_bq_sa.dbt_stg_bikes)
[0m06:00:12.913628 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_bikes
[0m06:00:12.950104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:13.752334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m06:00:13.753334 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (compile): 06:00:12.913968 => 06:00:13.753067
[0m06:00:13.753715 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_bikes
[0m06:00:13.758381 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_bikes"
[0m06:00:13.758919 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_bikes"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    bike_type

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`
),

derived_columns AS (

    SELECT

    bike_id,
    bike_type,
    'SRC_SQL_BIKES' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    bike_type,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    BIKE_PK,
    BIKE_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m06:00:14.468592 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:404f292b-e913-434e-87b6-82bb1ca43af4&page=queryresults
[0m06:00:14.892933 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_bikes (execute): 06:00:13.753899 => 06:00:14.892538
[0m06:00:14.894209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147dc1c60>]}
[0m06:00:14.894908 [info ] [Thread-1 (]: 5 of 22 OK created sql view model citibike_source_sql.dbt_stg_bikes ............ [[32mCREATE VIEW (0 processed)[0m in 1.98s]
[0m06:00:14.895370 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_bikes
[0m06:00:14.895796 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_stations
[0m06:00:14.896513 [info ] [Thread-1 (]: 6 of 22 START sql view model citibike_source_sql.dbt_stg_stations .............. [RUN]
[0m06:00:14.897092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_bikes, now model.dbt_bq_sa.dbt_stg_stations)
[0m06:00:14.897332 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_stations
[0m06:00:14.901724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:15.604087 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_stations"
[0m06:00:15.605208 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (compile): 06:00:14.897465 => 06:00:15.604943
[0m06:00:15.605648 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_stations
[0m06:00:15.610361 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_stations"
[0m06:00:15.611277 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_stations"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`
),

derived_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    'SRC_SQL_STATIONS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')
    )))) AS STRING) AS STATION_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    station_id,
    name,
    short_name,
    latitude,
    longitude,
    region_id,
    rental_method,
    capacity,
    last_reported,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    STATION_PK,
    STATION_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m06:00:16.347122 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5d8c1c8a-fd01-4efb-ae96-5e0f8ee80448&page=queryresults
[0m06:00:16.709551 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_stations (execute): 06:00:15.605908 => 06:00:16.709024
[0m06:00:16.711849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e61900>]}
[0m06:00:16.713116 [info ] [Thread-1 (]: 6 of 22 OK created sql view model citibike_source_sql.dbt_stg_stations ......... [[32mCREATE VIEW (0 processed)[0m in 1.81s]
[0m06:00:16.714081 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_stations
[0m06:00:16.714833 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_trips
[0m06:00:16.715799 [info ] [Thread-1 (]: 7 of 22 START sql view model citibike_source_sql.dbt_stg_trips ................. [RUN]
[0m06:00:16.717235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_stations, now model.dbt_bq_sa.dbt_stg_trips)
[0m06:00:16.717797 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_trips
[0m06:00:16.731020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:17.483766 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_trips"
[0m06:00:17.484669 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (compile): 06:00:16.718132 => 06:00:17.484475
[0m06:00:17.485010 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_trips
[0m06:00:17.488839 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_trips"
[0m06:00:17.489524 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_trips"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`
),

derived_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    'SRC_SQL_TRIPS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    start_time AS EFFECTIVE_FROM,
    'DBT_SAT_SQL_TRIPS' AS DBT_SAT_SQL_TRIPS

    FROM source_data
),

hashed_columns AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    DBT_SAT_SQL_TRIPS,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')
    )))) AS STRING) AS TRIP_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^')
    ), '^^||^^')))) AS STRING) AS LINK_USERS_BIKES_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_BIKES_TRIPS_PK,

    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')
    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_USERS_TRIPS_PK

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    bike_id,
    user_id,
    start_station_id,
    end_station_id,
    start_time,
    end_time,
    trip_duration,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    DBT_SAT_SQL_TRIPS,
    TRIP_PK,
    USER_PK,
    BIKE_PK,
    START_STATION_PK,
    END_STATION_PK,
    TRIP_HASHDIFF,
    LINK_USERS_BIKES_PK,
    LINK_BIKES_TRIPS_PK,
    LINK_USERS_TRIPS_PK

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m06:00:18.292731 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a6f64346-2d4e-4bcb-b82b-49b2e64a1f72&page=queryresults
[0m06:00:18.636800 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_trips (execute): 06:00:17.485200 => 06:00:18.636280
[0m06:00:18.639085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e61900>]}
[0m06:00:18.640578 [info ] [Thread-1 (]: 7 of 22 OK created sql view model citibike_source_sql.dbt_stg_trips ............ [[32mCREATE VIEW (0 processed)[0m in 1.92s]
[0m06:00:18.641533 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_trips
[0m06:00:18.642236 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_stg_users
[0m06:00:18.643127 [info ] [Thread-1 (]: 8 of 22 START sql view model citibike_source_sql.dbt_stg_users ................. [RUN]
[0m06:00:18.644567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_trips, now model.dbt_bq_sa.dbt_stg_users)
[0m06:00:18.645189 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_stg_users
[0m06:00:18.655138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:19.337799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_stg_users"
[0m06:00:19.340257 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (compile): 06:00:18.645563 => 06:00:19.339967
[0m06:00:19.340683 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_stg_users
[0m06:00:19.345622 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_stg_users"
[0m06:00:19.346662 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_stg_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_stg_users"} */


  create or replace view `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users`
  OPTIONS()
  as 




-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan

    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`
),

derived_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    'SRC_SQL_USERS' AS RECORD_SOURCE,
    CURRENT_TIMESTAMP() AS LOAD_DATE,
    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM

    FROM source_data
),

hashed_columns AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,

    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_HASHDIFF,

    CAST(UPPER(TO_HEX(MD5(CONCAT(
        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',
        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')
    )))) AS STRING) AS USER_PLANS_HASHDIFF

    FROM derived_columns
),

columns_to_select AS (

    SELECT

    user_id,
    user_type,
    gender,
    birth_year,
    customer_plan,
    RECORD_SOURCE,
    LOAD_DATE,
    EFFECTIVE_FROM,
    USER_PK,
    USER_HASHDIFF,
    USER_PLANS_HASHDIFF

    FROM hashed_columns
)

SELECT * FROM columns_to_select;


[0m06:00:20.041246 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a14aae42-d55a-4c3f-b0d3-0d791e1c0cce&page=queryresults
[0m06:00:20.412739 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_stg_users (execute): 06:00:19.340926 => 06:00:20.412318
[0m06:00:20.414086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b2202b0>]}
[0m06:00:20.415044 [info ] [Thread-1 (]: 8 of 22 OK created sql view model citibike_source_sql.dbt_stg_users ............ [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m06:00:20.415931 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_stg_users
[0m06:00:20.416578 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m06:00:20.417543 [info ] [Thread-1 (]: 9 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_bikes ...... [RUN]
[0m06:00:20.418577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_stg_users, now model.dbt_bq_sa.dbt_hub_sql_bikes)
[0m06:00:20.419153 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m06:00:20.445326 [info ] [Thread-1 (]: 06:00:20 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_bikes from 1 source(s)
[0m06:00:20.465138 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m06:00:20.466156 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (compile): 06:00:20.419478 => 06:00:20.465976
[0m06:00:20.466444 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m06:00:20.503226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:20.504336 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS rr
    WHERE rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.BIKE_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` AS d
    ON a.BIKE_PK = d.BIKE_PK
    WHERE d.BIKE_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m06:00:21.645683 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b85ab847-ce3e-43bf-b471-efd734ae1457&page=queryresults
[0m06:00:23.511469 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:00:23.542250 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_bikes"
[0m06:00:23.543379 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
            )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `bike_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:00:23.970078 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:65cf2436-b3fc-494f-aa6f-01e2abaa2246&page=queryresults
[0m06:00:25.648881 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_bikes (execute): 06:00:20.466607 => 06:00:25.648301
[0m06:00:25.650737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d6b430>]}
[0m06:00:25.652277 [info ] [Thread-1 (]: 9 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_bikes . [[32mMERGE (0.0 rows, 325.0 Bytes processed)[0m in 5.23s]
[0m06:00:25.653623 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_bikes
[0m06:00:25.654510 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m06:00:25.655321 [info ] [Thread-1 (]: 10 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_bikes ..... [RUN]
[0m06:00:25.656161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_bikes, now model.dbt_bq_sa.dbt_sat_sql_bikes)
[0m06:00:25.656695 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m06:00:25.694540 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m06:00:25.695518 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (compile): 06:00:25.657004 => 06:00:25.695364
[0m06:00:25.695769 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m06:00:25.699301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:25.701162 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS a
    WHERE a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.BIKE_PK, current_records.BIKE_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` AS current_records
    JOIN (
        SELECT DISTINCT source_data.BIKE_PK
        FROM source_data
    ) AS source_records
        ON source_records.BIKE_PK = current_records.BIKE_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.BIKE_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (
        PARTITION BY sd.BIKE_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.BIKE_PK = frin.BIKE_PK
        AND lr.BIKE_HASHDIFF = frin.BIKE_HASHDIFF
        WHERE lr.BIKE_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m06:00:26.790710 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0ef08546-b094-4e0f-8311-fe98d5c10ca1&page=queryresults
[0m06:00:28.900921 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:00:28.906020 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_bikes"
[0m06:00:28.907824 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_bikes"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.BIKE_PK = DBT_INTERNAL_DEST.BIKE_PK
                ) and (
                    DBT_INTERNAL_SOURCE.BIKE_HASHDIFF = DBT_INTERNAL_DEST.BIKE_HASHDIFF
                )

    
    when matched then update set
        `BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`BIKE_HASHDIFF` = DBT_INTERNAL_SOURCE.`BIKE_HASHDIFF`,`bike_type` = DBT_INTERNAL_SOURCE.`bike_type`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`BIKE_PK`, `BIKE_HASHDIFF`, `bike_type`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:00:29.452347 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:b825057d-0bd5-43b9-86fd-260c1002c60f&page=queryresults
[0m06:00:30.675702 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_bikes (execute): 06:00:25.695911 => 06:00:30.675336
[0m06:00:30.676869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d6b430>]}
[0m06:00:30.677591 [info ] [Thread-1 (]: 10 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_bikes  [[32mMERGE (0.0 rows, 502.0 Bytes processed)[0m in 5.02s]
[0m06:00:30.678332 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_bikes
[0m06:00:30.678812 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m06:00:30.679549 [info ] [Thread-1 (]: 11 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_stations .. [RUN]
[0m06:00:30.680122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_bikes, now model.dbt_bq_sa.dbt_hub_sql_stations)
[0m06:00:30.680391 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_stations
[0m06:00:30.688633 [info ] [Thread-1 (]: 06:00:30 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_stations from 1 source(s)
[0m06:00:30.698351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m06:00:30.699315 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (compile): 06:00:30.680547 => 06:00:30.699079
[0m06:00:30.699696 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_stations
[0m06:00:30.707558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:30.710510 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS rr
    WHERE rr.STATION_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.STATION_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` AS d
    ON a.STATION_PK = d.STATION_PK
    WHERE d.STATION_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m06:00:31.837124 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5b89fff9-d629-4991-a977-d3156f3720da&page=queryresults
[0m06:00:33.936263 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:00:33.941675 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_stations"
[0m06:00:33.943410 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
            )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`station_id` = DBT_INTERNAL_SOURCE.`station_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `station_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:00:34.265576 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e17592d9-7948-44f4-9e67-f4539f6963e6&page=queryresults
[0m06:00:35.691812 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_stations (execute): 06:00:30.699910 => 06:00:35.691419
[0m06:00:35.693420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147be1270>]}
[0m06:00:35.694404 [info ] [Thread-1 (]: 11 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.01s]
[0m06:00:35.695313 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_stations
[0m06:00:35.696039 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m06:00:35.696838 [info ] [Thread-1 (]: 12 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_stations .. [RUN]
[0m06:00:35.697838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_stations, now model.dbt_bq_sa.dbt_sat_sql_stations)
[0m06:00:35.698300 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_stations
[0m06:00:35.730738 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m06:00:35.732230 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (compile): 06:00:35.698599 => 06:00:35.732011
[0m06:00:35.732567 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_stations
[0m06:00:35.744328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:35.745700 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by STATION_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS a
    WHERE a.STATION_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.STATION_PK, current_records.STATION_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` AS current_records
    JOIN (
        SELECT DISTINCT source_data.STATION_PK
        FROM source_data
    ) AS source_records
        ON source_records.STATION_PK = current_records.STATION_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.STATION_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (
        PARTITION BY sd.STATION_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.STATION_PK = frin.STATION_PK
        AND lr.STATION_HASHDIFF = frin.STATION_HASHDIFF
        WHERE lr.STATION_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m06:00:36.828726 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d9473226-82bb-4ebb-92b2-43278cce8242&page=queryresults
[0m06:00:39.194896 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:00:39.198740 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_stations"
[0m06:00:39.200370 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_stations: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_stations"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.STATION_PK = DBT_INTERNAL_DEST.STATION_PK
                ) and (
                    DBT_INTERNAL_SOURCE.STATION_HASHDIFF = DBT_INTERNAL_DEST.STATION_HASHDIFF
                )

    
    when matched then update set
        `STATION_PK` = DBT_INTERNAL_SOURCE.`STATION_PK`,`STATION_HASHDIFF` = DBT_INTERNAL_SOURCE.`STATION_HASHDIFF`,`name` = DBT_INTERNAL_SOURCE.`name`,`short_name` = DBT_INTERNAL_SOURCE.`short_name`,`latitude` = DBT_INTERNAL_SOURCE.`latitude`,`longitude` = DBT_INTERNAL_SOURCE.`longitude`,`region_id` = DBT_INTERNAL_SOURCE.`region_id`,`rental_method` = DBT_INTERNAL_SOURCE.`rental_method`,`capacity` = DBT_INTERNAL_SOURCE.`capacity`,`last_reported` = DBT_INTERNAL_SOURCE.`last_reported`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`STATION_PK`, `STATION_HASHDIFF`, `name`, `short_name`, `latitude`, `longitude`, `region_id`, `rental_method`, `capacity`, `last_reported`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:00:39.534222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:9d09919d-c1c9-46db-ba2d-e6eb43cf445f&page=queryresults
[0m06:00:40.909095 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_stations (execute): 06:00:35.732756 => 06:00:40.908162
[0m06:00:40.918897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d1a830>]}
[0m06:00:40.920884 [info ] [Thread-1 (]: 12 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_stations  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.21s]
[0m06:00:40.922084 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_stations
[0m06:00:40.922957 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m06:00:40.924193 [info ] [Thread-1 (]: 13 of 22 START sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips . [RUN]
[0m06:00:40.925469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_stations, now model.dbt_bq_sa.dbt_eff_sat_link_users_trips)
[0m06:00:40.926084 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m06:00:41.007066 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m06:00:41.007701 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (compile): 06:00:40.926434 => 06:00:41.007559
[0m06:00:41.007936 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m06:00:41.010610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:41.515666 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"
[0m06:00:41.517588 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_eff_sat_link_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` as DBT_INTERNAL_DEST
        using (

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.USER_PK IS NOT NULL
    AND a.BIKE_PK IS NOT NULL
),

latest_records AS (
    SELECT * FROM (
        SELECT b.TRIP_PK, b.USER_PK, b.BIKE_PK, b.start_time, b.end_time, b.EFFECTIVE_FROM, b.LOAD_DATE, b.RECORD_SOURCE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` AS b
        QUALIFY ROW_NUMBER() OVER (
            PARTITION BY b.TRIP_PK
            ORDER BY b.LOAD_DATE DESC
        ) = 1
        ) AS inner_select
    
),

latest_open AS (
    SELECT c.TRIP_PK, c.USER_PK, c.BIKE_PK, c.start_time, c.end_time, c.EFFECTIVE_FROM, c.LOAD_DATE, c.RECORD_SOURCE
    FROM latest_records AS c
    WHERE DATE(c.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

latest_closed AS (
    SELECT d.TRIP_PK, d.USER_PK, d.BIKE_PK, d.start_time, d.end_time, d.EFFECTIVE_FROM, d.LOAD_DATE, d.RECORD_SOURCE
    FROM latest_records AS d
    WHERE DATE(d.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),

new_open_records AS (
    SELECT DISTINCT
        f.TRIP_PK, f.USER_PK, f.BIKE_PK,
        f.start_time AS start_time,
        f.end_time AS end_time,
        f.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        f.LOAD_DATE,
        f.RECORD_SOURCE
    FROM source_data AS f
    LEFT JOIN latest_records AS lr
    ON f.TRIP_PK = lr.TRIP_PK
    WHERE lr.TRIP_PK IS NULL
),

new_reopened_records AS (
    SELECT DISTINCT
        lc.TRIP_PK, lc.USER_PK, lc.BIKE_PK,
        g.start_time AS start_time,
        g.end_time AS end_time,
        g.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        g.LOAD_DATE,
        g.RECORD_SOURCE
    FROM source_data AS g
    INNER JOIN latest_closed AS lc
    ON g.TRIP_PK = lc.TRIP_PK
    WHERE DATE(g.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
),



new_closed_records AS (
    SELECT DISTINCT
        lo.TRIP_PK, lo.USER_PK, lo.BIKE_PK,
        h.start_time AS start_time,
        h.end_time AS end_time,
        h.EFFECTIVE_FROM AS EFFECTIVE_FROM,
        h.LOAD_DATE,
        lo.RECORD_SOURCE
    FROM source_data AS h
    LEFT JOIN latest_open AS lo
    ON lo.TRIP_PK = h.TRIP_PK
    LEFT JOIN latest_closed AS lc
    ON lc.TRIP_PK = h.TRIP_PK
    WHERE DATE(h.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))
    AND lo.TRIP_PK IS NOT NULL
    AND lc.TRIP_PK IS NULL
),

records_to_insert AS (
    SELECT * FROM new_open_records
    UNION DISTINCT
    SELECT * FROM new_reopened_records
    UNION DISTINCT
    SELECT * FROM new_closed_records
)

SELECT * FROM records_to_insert
        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `USER_PK`, `BIKE_PK`, `start_time`, `end_time`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:00:42.237655 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:7a3d7ab0-899d-4db0-9e20-77917d048ba2&page=queryresults
[0m06:00:43.706023 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_eff_sat_link_users_trips (execute): 06:00:41.008067 => 06:00:43.705371
[0m06:00:43.937230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d1a830>]}
[0m06:00:43.964130 [info ] [Thread-1 (]: 13 of 22 OK created sql incremental model citibike_source_sql.dbt_eff_sat_sql_trips  [[32mMERGE (0.0 rows, 3.5 KiB processed)[0m in 3.01s]
[0m06:00:43.966668 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_eff_sat_link_users_trips
[0m06:00:43.975651 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m06:00:43.977336 [info ] [Thread-1 (]: 14 of 22 START sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [RUN]
[0m06:00:43.978774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_eff_sat_link_users_trips, now model.dbt_bq_sa.dbt_ext_track_sat_trips)
[0m06:00:43.979328 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m06:00:44.024268 [info ] [Thread-1 (]: 06:00:44 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_ext_track_sat_trips from 1 source(s) and 1 satellite(s)
[0m06:00:44.027258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m06:00:44.027965 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (compile): 06:00:43.979635 => 06:00:44.027821
[0m06:00:44.028261 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m06:00:44.036670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:44.038261 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    

WITH 

satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS (
    SELECT s.TRIP_PK,
           s.TRIP_HASHDIFF AS HASHDIFF,
           s.DBT_SAT_SQL_TRIPS AS SATELLITE_NAME,
           s.LOAD_DATE,
           s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS s
    WHERE s.TRIP_PK IS NOT NULL
),

records_to_insert AS (
    SELECT DISTINCT
        a.TRIP_PK,
        a.HASHDIFF,
        a.SATELLITE_NAME,
        a.LOAD_DATE,
        a.RECORD_SOURCE
    FROM satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips` AS d
        ON (
            a.HASHDIFF = d.HASHDIFF
            AND a.LOAD_DATE = d.LOAD_DATE
            AND a.SATELLITE_NAME = d.SATELLITE_NAME
        )
    WHERE d.HASHDIFF IS NULL
    AND d.LOAD_DATE IS NULL
    AND d.SATELLITE_NAME IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m06:00:45.232903 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:289dc76c-bb25-4288-b9f4-e8ee1763a390&page=queryresults
[0m06:00:47.043896 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:00:47.054240 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_ext_track_sat_trips"
[0m06:00:47.056041 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_ext_track_sat_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.HASHDIFF = DBT_INTERNAL_DEST.HASHDIFF
                ) and (
                    DBT_INTERNAL_SOURCE.SATELLITE_NAME = DBT_INTERNAL_DEST.SATELLITE_NAME
                ) and (
                    DBT_INTERNAL_SOURCE.LOAD_DATE = DBT_INTERNAL_DEST.LOAD_DATE
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`HASHDIFF` = DBT_INTERNAL_SOURCE.`HASHDIFF`,`SATELLITE_NAME` = DBT_INTERNAL_SOURCE.`SATELLITE_NAME`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `HASHDIFF`, `SATELLITE_NAME`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `HASHDIFF`, `SATELLITE_NAME`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:00:47.409502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:243c26c1-2d57-40e2-b633-5d08cf8a32cd&page=queryresults
[0m06:00:48.871538 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_ext_track_sat_trips (execute): 06:00:44.028400 => 06:00:48.870802
[0m06:00:48.874292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147dc1c60>]}
[0m06:00:48.876325 [info ] [Thread-1 (]: 14 of 22 OK created sql incremental model citibike_source_sql.dbt_ext_track_sat_trips  [[32mMERGE (20.0 rows, 10.7 KiB processed)[0m in 4.90s]
[0m06:00:48.877421 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_ext_track_sat_trips
[0m06:00:48.878332 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m06:00:48.879585 [info ] [Thread-1 (]: 15 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_trips ..... [RUN]
[0m06:00:48.881128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_ext_track_sat_trips, now model.dbt_bq_sa.dbt_hub_sql_trips)
[0m06:00:48.881781 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_trips
[0m06:00:48.897784 [info ] [Thread-1 (]: 06:00:48 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_trips from 1 source(s)
[0m06:00:48.902539 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m06:00:48.903540 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (compile): 06:00:48.882170 => 06:00:48.903358
[0m06:00:48.903795 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_trips
[0m06:00:48.907198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:48.908989 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.TRIP_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` AS d
    ON a.TRIP_PK = d.TRIP_PK
    WHERE d.TRIP_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m06:00:50.018816 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:1b7a0132-343a-46a8-a613-396f8ad14316&page=queryresults
[0m06:00:51.896541 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:00:51.901731 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_trips"
[0m06:00:51.903653 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
            )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`bike_id` = DBT_INTERNAL_SOURCE.`bike_id`,`start_station_id` = DBT_INTERNAL_SOURCE.`start_station_id`,`end_station_id` = DBT_INTERNAL_SOURCE.`end_station_id`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `user_id`, `bike_id`, `start_station_id`, `end_station_id`, `start_time`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:00:52.221972 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:56ba3aff-17b0-483b-aba2-2be7829fc4db&page=queryresults
[0m06:00:53.647188 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_trips (execute): 06:00:48.903926 => 06:00:53.646803
[0m06:00:53.649309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147b16530>]}
[0m06:00:53.650478 [info ] [Thread-1 (]: 15 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_trips  [[32mMERGE (0.0 rows, 1.9 KiB processed)[0m in 4.77s]
[0m06:00:53.651435 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_trips
[0m06:00:53.652178 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m06:00:53.653058 [info ] [Thread-1 (]: 16 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [RUN]
[0m06:00:53.654267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_trips, now model.dbt_bq_sa.dbt_link_sql_bikes_trips)
[0m06:00:53.654899 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m06:00:53.672078 [info ] [Thread-1 (]: 06:00:53 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_bikes_trips from 1 source(s)
[0m06:00:53.694690 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m06:00:53.695574 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (compile): 06:00:53.655289 => 06:00:53.695372
[0m06:00:53.695905 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m06:00:53.700167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:53.701494 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_BIKES_TRIPS_PK, rr.BIKE_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_BIKES_TRIPS_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_BIKES_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_BIKES_TRIPS_PK, a.BIKE_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` AS d
    ON a.LINK_BIKES_TRIPS_PK = d.LINK_BIKES_TRIPS_PK
    WHERE d.LINK_BIKES_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m06:00:54.410040 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:29d3965b-3e7b-43d4-9baf-9713adefd91c&page=queryresults
[0m06:00:56.239650 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:00:56.243807 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_bikes_trips"
[0m06:00:56.246075 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_bikes_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_BIKES_TRIPS_PK = DBT_INTERNAL_DEST.LINK_BIKES_TRIPS_PK
            )

    
    when matched then update set
        `LINK_BIKES_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_BIKES_TRIPS_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_BIKES_TRIPS_PK`, `BIKE_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:00:56.569745 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:a07b7bb8-ebb7-463b-88eb-c87bd193ca75&page=queryresults
[0m06:00:57.986276 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_bikes_trips (execute): 06:00:53.696098 => 06:00:57.981382
[0m06:00:57.988718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147d1a830>]}
[0m06:00:57.990147 [info ] [Thread-1 (]: 16 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_bikes_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 4.33s]
[0m06:00:57.991140 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_bikes_trips
[0m06:00:57.991919 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m06:00:57.993164 [info ] [Thread-1 (]: 17 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [RUN]
[0m06:00:57.994515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_bikes_trips, now model.dbt_bq_sa.dbt_link_sql_users_bikes)
[0m06:00:57.995157 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m06:00:58.010132 [info ] [Thread-1 (]: 06:00:58 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_bikes from 1 source(s)
[0m06:00:58.024140 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m06:00:58.025233 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (compile): 06:00:57.995538 => 06:00:58.024972
[0m06:00:58.025809 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m06:00:58.031632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:00:58.033890 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_BIKES_PK, rr.USER_PK, rr.BIKE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_BIKES_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.BIKE_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_BIKES_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_BIKES_PK, a.USER_PK, a.BIKE_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` AS d
    ON a.LINK_USERS_BIKES_PK = d.LINK_USERS_BIKES_PK
    WHERE d.LINK_USERS_BIKES_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m06:00:58.808727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:2ae355a9-2a56-4cb4-b061-ee5d5f0b0fc9&page=queryresults
[0m06:01:00.933184 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:01:00.940603 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_bikes"
[0m06:01:00.947495 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_bikes: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_BIKES_PK = DBT_INTERNAL_DEST.LINK_USERS_BIKES_PK
            )

    
    when matched then update set
        `LINK_USERS_BIKES_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_BIKES_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`BIKE_PK` = DBT_INTERNAL_SOURCE.`BIKE_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_BIKES_PK`, `USER_PK`, `BIKE_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:01:01.281716 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:da366279-f7b8-407a-a009-5115e69f549e&page=queryresults
[0m06:01:02.669322 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_bikes (execute): 06:00:58.026107 => 06:01:02.668788
[0m06:01:02.671005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b34f910>]}
[0m06:01:02.672085 [info ] [Thread-1 (]: 17 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_bikes  [[32mMERGE (0.0 rows, 1.2 KiB processed)[0m in 4.68s]
[0m06:01:02.673079 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_bikes
[0m06:01:02.673860 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m06:01:02.674830 [info ] [Thread-1 (]: 18 of 22 START sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [RUN]
[0m06:01:02.676133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_bikes, now model.dbt_bq_sa.dbt_link_sql_users_trips)
[0m06:01:02.676657 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m06:01:02.687265 [info ] [Thread-1 (]: 06:01:02 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_link_sql_users_trips from 1 source(s)
[0m06:01:02.695006 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m06:01:02.695950 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (compile): 06:01:02.676964 => 06:01:02.695727
[0m06:01:02.696406 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m06:01:02.703458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:02.705398 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.LINK_USERS_TRIPS_PK, rr.USER_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr
    WHERE rr.LINK_USERS_TRIPS_PK IS NOT NULL
    AND rr.USER_PK IS NOT NULL
    AND rr.TRIP_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.LINK_USERS_TRIPS_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),

records_to_insert AS (
    SELECT a.LINK_USERS_TRIPS_PK, a.USER_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` AS d
    ON a.LINK_USERS_TRIPS_PK = d.LINK_USERS_TRIPS_PK
    WHERE d.LINK_USERS_TRIPS_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m06:01:03.817052 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0c926b28-82c1-4050-b362-7ba93bdd3009&page=queryresults
[0m06:01:05.603062 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:01:05.606999 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_link_sql_users_trips"
[0m06:01:05.608572 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_link_sql_users_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_link_sql_users_trips"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.LINK_USERS_TRIPS_PK = DBT_INTERNAL_DEST.LINK_USERS_TRIPS_PK
            )

    
    when matched then update set
        `LINK_USERS_TRIPS_PK` = DBT_INTERNAL_SOURCE.`LINK_USERS_TRIPS_PK`,`USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`LINK_USERS_TRIPS_PK`, `USER_PK`, `TRIP_PK`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:01:05.928152 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:e05fa8d6-51db-48d6-8905-58b644521188&page=queryresults
[0m06:01:07.357834 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_link_sql_users_trips (execute): 06:01:02.696687 => 06:01:07.356906
[0m06:01:07.361048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b34f910>]}
[0m06:01:07.362132 [info ] [Thread-1 (]: 18 of 22 OK created sql incremental model citibike_source_sql.dbt_link_sql_users_trips  [[32mMERGE (0.0 rows, 2.4 KiB processed)[0m in 4.69s]
[0m06:01:07.363148 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_link_sql_users_trips
[0m06:01:07.363891 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m06:01:07.364844 [info ] [Thread-1 (]: 19 of 22 START sql incremental model citibike_source_sql.dbt_sat_sql_trips ..... [RUN]
[0m06:01:07.366115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_link_sql_users_trips, now model.dbt_bq_sa.dbt_sat_sql_trips)
[0m06:01:07.366745 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_trips
[0m06:01:07.399127 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m06:01:07.400482 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (compile): 06:01:07.367112 => 06:01:07.400252
[0m06:01:07.400850 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_trips
[0m06:01:07.406930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:07.408540 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by TRIP_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a
    WHERE a.TRIP_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.TRIP_PK, current_records.TRIP_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` AS current_records
    JOIN (
        SELECT DISTINCT source_data.TRIP_PK
        FROM source_data
    ) AS source_records
        ON source_records.TRIP_PK = current_records.TRIP_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.TRIP_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (
        PARTITION BY sd.TRIP_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.TRIP_PK = frin.TRIP_PK
        AND lr.TRIP_HASHDIFF = frin.TRIP_HASHDIFF
        WHERE lr.TRIP_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m06:01:08.516827 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:8d229df2-cd29-4fb1-a8a5-760bad4ddddb&page=queryresults
[0m06:01:11.024962 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:01:11.028762 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_trips"
[0m06:01:11.030738 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_trips: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_trips"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.TRIP_PK = DBT_INTERNAL_DEST.TRIP_PK
                ) and (
                    DBT_INTERNAL_SOURCE.TRIP_HASHDIFF = DBT_INTERNAL_DEST.TRIP_HASHDIFF
                )

    
    when matched then update set
        `TRIP_PK` = DBT_INTERNAL_SOURCE.`TRIP_PK`,`TRIP_HASHDIFF` = DBT_INTERNAL_SOURCE.`TRIP_HASHDIFF`,`start_time` = DBT_INTERNAL_SOURCE.`start_time`,`end_time` = DBT_INTERNAL_SOURCE.`end_time`,`trip_duration` = DBT_INTERNAL_SOURCE.`trip_duration`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`TRIP_PK`, `TRIP_HASHDIFF`, `start_time`, `end_time`, `trip_duration`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:01:11.445310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:5fbe6252-2835-4db9-96c3-294f4a4292a6&page=queryresults
[0m06:01:12.836943 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_trips (execute): 06:01:07.401057 => 06:01:12.836554
[0m06:01:12.838359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b177040>]}
[0m06:01:12.839262 [info ] [Thread-1 (]: 19 of 22 OK created sql incremental model citibike_source_sql.dbt_sat_sql_trips  [[32mMERGE (0.0 rows, 1.3 KiB processed)[0m in 5.47s]
[0m06:01:12.840162 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_trips
[0m06:01:12.840876 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_hub_sql_users
[0m06:01:12.841719 [info ] [Thread-1 (]: 20 of 22 START sql incremental model citibike_source_sql.dbt_hub_sql_users ..... [RUN]
[0m06:01:12.842896 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_sat_sql_trips, now model.dbt_bq_sa.dbt_hub_sql_users)
[0m06:01:12.843524 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_hub_sql_users
[0m06:01:12.852805 [info ] [Thread-1 (]: 06:01:12 + Loading leafy-mountain-469410-k3.citibike_source_sql.dbt_hub_sql_users from 1 source(s)
[0m06:01:12.860420 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m06:01:12.861687 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (compile): 06:01:12.843875 => 06:01:12.861358
[0m06:01:12.862195 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_hub_sql_users
[0m06:01:12.868510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:12.870400 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH row_rank_1 AS (
    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS rr
    WHERE rr.USER_PK IS NOT NULL
    QUALIFY ROW_NUMBER() OVER(
        PARTITION BY rr.USER_PK
        ORDER BY rr.LOAD_DATE
    ) = 1
),


records_to_insert AS (
    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE
    FROM row_rank_1 AS a
    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` AS d
    ON a.USER_PK = d.USER_PK
    WHERE d.USER_PK IS NULL
)

SELECT * FROM records_to_insert
    );
  
[0m06:01:14.021269 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:9e14647b-1bc9-4dd3-b92d-4190ea2baf53&page=queryresults
[0m06:01:16.127706 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:01:16.132899 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_hub_sql_users"
[0m06:01:16.134656 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_hub_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_hub_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
            )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`user_id` = DBT_INTERNAL_SOURCE.`user_id`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `user_id`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:01:16.560869 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:16af830f-914e-435f-9f71-027f889b57c5&page=queryresults
[0m06:01:17.704165 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_hub_sql_users (execute): 06:01:12.862457 => 06:01:17.703546
[0m06:01:17.705832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b407e80>]}
[0m06:01:17.706791 [info ] [Thread-1 (]: 20 of 22 OK created sql incremental model citibike_source_sql.dbt_hub_sql_users  [[32mMERGE (0.0 rows, 650.0 Bytes processed)[0m in 4.86s]
[0m06:01:17.707769 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_hub_sql_users
[0m06:01:17.708994 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m06:01:17.709882 [info ] [Thread-1 (]: 21 of 22 START sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [RUN]
[0m06:01:17.711421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_hub_sql_users, now model.dbt_bq_sa.dbt_multi_active_sat_users_plans)
[0m06:01:17.712130 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m06:01:17.752205 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m06:01:17.752989 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (compile): 06:01:17.712517 => 06:01:17.752789
[0m06:01:17.753319 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m06:01:17.757541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:17.759072 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans__dbt_tmp`
      
    
    

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      

-- Generated by AutomateDV (formerly known as dbtvault)

    
WITH source_data AS (
    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.USER_PLANS_HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS s
    WHERE s.USER_PK IS NOT NULL
        AND s.customer_plan IS NOT NULL
),

source_data_with_count AS (
    SELECT a.*,
           b.source_count
    FROM source_data AS a
    INNER JOIN (
        SELECT t.USER_PK, COUNT(*) AS source_count
        FROM (
            SELECT DISTINCT s.USER_PK,
                            s.USER_PLANS_HASHDIFF,
                            s.customer_plan
            FROM source_data AS s
        ) AS t
        GROUP BY t.USER_PK
    ) AS b
    ON a.USER_PK = b.USER_PK
),

latest_records AS (
    SELECT mas.USER_PK, mas.HASHDIFF, mas.customer_plan, mas.LOAD_DATE,DENSE_RANK() OVER (
               PARTITION BY mas.USER_PK
               ORDER BY mas.HASHDIFF, mas.customer_plan ASC
           ) AS check_rank
    FROM (
        SELECT inner_mas.USER_PK, inner_mas.HASHDIFF, inner_mas.customer_plan, inner_mas.LOAD_DATE
        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans` AS inner_mas
        INNER JOIN (SELECT DISTINCT s.USER_PK FROM source_data as s ) AS spk
            ON inner_mas.USER_PK = spk.USER_PK
            QUALIFY RANK() OVER (
                PARTITION BY inner_mas.USER_PK
                ORDER BY inner_mas.LOAD_DATE DESC
            ) = 1
    ) AS mas
    
),

latest_group_details AS (
    SELECT lr.USER_PK,
           lr.LOAD_DATE,
           MAX(lr.check_rank) AS latest_count
    FROM latest_records AS lr
    GROUP BY lr.USER_PK, lr.LOAD_DATE
),

records_to_insert AS (
    SELECT source_data_with_count.USER_PK, source_data_with_count.customer_plan, source_data_with_count.user_type, source_data_with_count.USER_PLANS_HASHDIFF AS HASHDIFF, source_data_with_count.EFFECTIVE_FROM, source_data_with_count.LOAD_DATE, source_data_with_count.RECORD_SOURCE
    FROM source_data_with_count
    WHERE EXISTS (
        SELECT 1
        FROM source_data_with_count AS stage
        WHERE NOT EXISTS (
            SELECT 1
            FROM (
                SELECT lr.USER_PK, lr.HASHDIFF, lr.customer_plan, lr.LOAD_DATE,
                       lg.latest_count
                FROM latest_records AS lr
                INNER JOIN latest_group_details AS lg
                    ON lr.USER_PK = lg.USER_PK
                    AND lr.LOAD_DATE = lg.LOAD_DATE
            ) AS active_records
            WHERE stage.USER_PK = active_records.USER_PK
                AND stage.USER_PLANS_HASHDIFF = active_records.HASHDIFF
                AND stage.customer_plan = active_records.customer_plan
                AND stage.source_count = active_records.latest_count
        )
        AND source_data_with_count.USER_PK = stage.USER_PK
    )
)

SELECT * FROM records_to_insert
    );
  
[0m06:01:18.845418 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:815839b4-5c1f-4407-a1d6-c0105990097b&page=queryresults
[0m06:01:21.472442 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:01:21.477093 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"
[0m06:01:21.478354 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_multi_active_sat_users_plans: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
                ) and (
                    DBT_INTERNAL_SOURCE.customer_plan = DBT_INTERNAL_DEST.customer_plan
                ) and (
                    DBT_INTERNAL_SOURCE.HASHDIFF = DBT_INTERNAL_DEST.HASHDIFF
                ) and (
                    DBT_INTERNAL_SOURCE.LOAD_DATE = DBT_INTERNAL_DEST.LOAD_DATE
                )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`customer_plan` = DBT_INTERNAL_SOURCE.`customer_plan`,`user_type` = DBT_INTERNAL_SOURCE.`user_type`,`HASHDIFF` = DBT_INTERNAL_SOURCE.`HASHDIFF`,`EFFECTIVE_FROM` = DBT_INTERNAL_SOURCE.`EFFECTIVE_FROM`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `customer_plan`, `user_type`, `HASHDIFF`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `customer_plan`, `user_type`, `HASHDIFF`, `EFFECTIVE_FROM`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:01:21.812892 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:d817f713-681a-40b4-959e-27a9920d6756&page=queryresults
[0m06:01:23.092816 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_multi_active_sat_users_plans (execute): 06:01:17.753510 => 06:01:23.091959
[0m06:01:23.094994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b2b2f20>]}
[0m06:01:23.096255 [info ] [Thread-1 (]: 21 of 22 OK created sql incremental model citibike_source_sql.dbt_multi_active_sat_users_plans  [[32mMERGE (0.0 rows, 1.2 KiB processed)[0m in 5.38s]
[0m06:01:23.097263 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_multi_active_sat_users_plans
[0m06:01:23.098067 [debug] [Thread-1 (]: Began running node model.dbt_bq_sa.dbt_sat_sql_users
[0m06:01:23.099187 [info ] [Thread-1 (]: 22 of 22 START sql incremental model citibike_source_sql.dbt sat_sql_users ..... [RUN]
[0m06:01:23.100551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq_sa.dbt_multi_active_sat_users_plans, now model.dbt_bq_sa.dbt_sat_sql_users)
[0m06:01:23.101184 [debug] [Thread-1 (]: Began compiling node model.dbt_bq_sa.dbt_sat_sql_users
[0m06:01:23.156116 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m06:01:23.157125 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (compile): 06:01:23.101542 => 06:01:23.156900
[0m06:01:23.157471 [debug] [Thread-1 (]: Began executing node model.dbt_bq_sa.dbt_sat_sql_users
[0m06:01:23.162546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:01:23.164505 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */

  
    

    create or replace table `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
      
    partition by timestamp_trunc(load_date, day)
    cluster by USER_PK

    OPTIONS(
      expiration_timestamp=TIMESTAMP_ADD(CURRENT_TIMESTAMP(), INTERVAL 12 hour)
    )
    as (
      -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS a
    WHERE a.USER_PK IS NOT NULL
),

latest_records AS (
    SELECT current_records.USER_PK, current_records.USER_HASHDIFF, current_records.LOAD_DATE
    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` AS current_records
    JOIN (
        SELECT DISTINCT source_data.USER_PK
        FROM source_data
    ) AS source_records
        ON source_records.USER_PK = current_records.USER_PK
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY current_records.USER_PK
        ORDER BY current_records.LOAD_DATE DESC
    ) = 1
),

first_record_in_set AS (
    SELECT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    ) = 1
),

unique_source_records AS (
    SELECT DISTINCT
        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE
    FROM source_data AS sd
    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (
        PARTITION BY sd.USER_PK
        ORDER BY sd.LOAD_DATE ASC
    )
),

records_to_insert AS (
    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE
    FROM first_record_in_set AS frin
    LEFT JOIN latest_records AS lr
        ON lr.USER_PK = frin.USER_PK
        AND lr.USER_HASHDIFF = frin.USER_HASHDIFF
        WHERE lr.USER_HASHDIFF IS NULL
    UNION DISTINCT
    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    );
  
[0m06:01:24.329500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:66faded3-cf1b-4c79-b639-b01ea56b0890&page=queryresults
[0m06:01:26.441401 [debug] [Thread-1 (]: 
    In `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`:
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m06:01:26.449014 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq_sa.dbt_sat_sql_users"
[0m06:01:26.455718 [debug] [Thread-1 (]: On model.dbt_bq_sa.dbt_sat_sql_users: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "dbt_bq_sa", "target_name": "dev", "node_id": "model.dbt_bq_sa.dbt_sat_sql_users"} */
-- back compat for old kwarg name
  
  
        
            
                
                
            
                
                
            
        
    

    

    merge into `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` as DBT_INTERNAL_DEST
        using (
        select
        * from `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users__dbt_tmp`
        ) as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.USER_PK = DBT_INTERNAL_DEST.USER_PK
                ) and (
                    DBT_INTERNAL_SOURCE.USER_HASHDIFF = DBT_INTERNAL_DEST.USER_HASHDIFF
                )

    
    when matched then update set
        `USER_PK` = DBT_INTERNAL_SOURCE.`USER_PK`,`USER_HASHDIFF` = DBT_INTERNAL_SOURCE.`USER_HASHDIFF`,`user_type` = DBT_INTERNAL_SOURCE.`user_type`,`gender` = DBT_INTERNAL_SOURCE.`gender`,`birth_year` = DBT_INTERNAL_SOURCE.`birth_year`,`customer_plan` = DBT_INTERNAL_SOURCE.`customer_plan`,`LOAD_DATE` = DBT_INTERNAL_SOURCE.`LOAD_DATE`,`RECORD_SOURCE` = DBT_INTERNAL_SOURCE.`RECORD_SOURCE`
    

    when not matched then insert
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)
    values
        (`USER_PK`, `USER_HASHDIFF`, `user_type`, `gender`, `birth_year`, `customer_plan`, `LOAD_DATE`, `RECORD_SOURCE`)


    
[0m06:01:26.781266 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=leafy-mountain-469410-k3&j=bq:asia-south2:0de86e62-4fde-448b-be2a-22e9f0e8738c&page=queryresults
[0m06:01:28.259173 [debug] [Thread-1 (]: Timing info for model.dbt_bq_sa.dbt_sat_sql_users (execute): 06:01:23.157664 => 06:01:28.258648
[0m06:01:28.260927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db714f-1f5e-4645-8327-1ada5669dc10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b334d60>]}
[0m06:01:28.262051 [info ] [Thread-1 (]: 22 of 22 OK created sql incremental model citibike_source_sql.dbt sat_sql_users  [[32mMERGE (0.0 rows, 680.0 Bytes processed)[0m in 5.16s]
[0m06:01:28.262889 [debug] [Thread-1 (]: Finished running node model.dbt_bq_sa.dbt_sat_sql_users
[0m06:01:28.266433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:01:28.266794 [debug] [MainThread]: Connection 'model.dbt_bq_sa.dbt_sat_sql_users' was properly closed.
[0m06:01:28.267244 [info ] [MainThread]: 
[0m06:01:28.267619 [info ] [MainThread]: Finished running 8 view models, 14 incremental models in 0 hours 1 minutes and 22.05 seconds (82.05s).
[0m06:01:28.272257 [debug] [MainThread]: Command end result
[0m06:01:28.320674 [info ] [MainThread]: 
[0m06:01:28.321202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:01:28.321565 [info ] [MainThread]: 
[0m06:01:28.321955 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m06:01:28.325527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 83.402115, "process_user_time": 6.298918, "process_kernel_time": 1.566499, "process_mem_max_rss": "207273984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:01:28.326346 [debug] [MainThread]: Command `dbt run` succeeded at 06:01:28.326184 after 83.40 seconds
[0m06:01:28.326953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075673d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x137c2a950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147c1060>]}
[0m06:01:29.488335 [debug] [MainThread]: Flushing usage events
