{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.19", "generated_at": "2025-08-21T00:31:28.267895Z", "invocation_id": "06db714f-1f5e-4645-8327-1ada5669dc10", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:07.721795Z", "completed_at": "2025-08-21T00:30:07.744503Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:07.745373Z", "completed_at": "2025-08-21T00:30:09.421251Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7024791240692139, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "8af276ba-154c-4581-9b48-a73495db3937", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_bq_sa.raw_sql_bikes", "compiled": true, "compiled_code": "\nselect *\nfrom `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_bikes`", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:09.426996Z", "completed_at": "2025-08-21T00:30:09.431867Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:09.432747Z", "completed_at": "2025-08-21T00:30:10.722756Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.299377202987671, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "25d9b1b6-f9c1-484e-81d7-3b02d5c52df7", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_bq_sa.raw_sql_stations", "compiled": true, "compiled_code": "\nselect *\nfrom `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_stations`", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:10.730497Z", "completed_at": "2025-08-21T00:30:10.738292Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:10.739273Z", "completed_at": "2025-08-21T00:30:11.862381Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.142430067062378, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "a6f9425e-1969-41d7-ba99-2281997707f1", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_bq_sa.raw_sql_trips", "compiled": true, "compiled_code": "\nselect *\nfrom `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_trips`", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:11.877748Z", "completed_at": "2025-08-21T00:30:11.885683Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:11.886866Z", "completed_at": "2025-08-21T00:30:12.905246Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.031867265701294, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "07ba9e82-869e-4b03-aed3-7d9bb76674cd", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_bq_sa.raw_sql_users", "compiled": true, "compiled_code": "\nselect *\nfrom `leafy-mountain-469410-k3`.`citibike_source_sql`.`src_sql_users`", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:12.913968Z", "completed_at": "2025-08-21T00:30:13.753067Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:13.753899Z", "completed_at": "2025-08-21T00:30:14.892538Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.981450080871582, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "404f292b-e913-434e-87b6-82bb1ca43af4", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_stg_bikes", "compiled": true, "compiled_code": "\n\n\n\n\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n\n    SELECT\n\n    bike_id,\n    bike_type\n\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_bikes`\n),\n\nderived_columns AS (\n\n    SELECT\n\n    bike_id,\n    bike_type,\n    'SRC_SQL_BIKES' AS RECORD_SOURCE,\n    CURRENT_TIMESTAMP() AS LOAD_DATE,\n    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM\n\n    FROM source_data\n),\n\nhashed_columns AS (\n\n    SELECT\n\n    bike_id,\n    bike_type,\n    RECORD_SOURCE,\n    LOAD_DATE,\n    EFFECTIVE_FROM,\n\n    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,\n\n    CAST(UPPER(TO_HEX(MD5(IFNULL(NULLIF(UPPER(TRIM(CAST(bike_type AS STRING))), ''), '^^')))) AS STRING) AS BIKE_HASHDIFF\n\n    FROM derived_columns\n),\n\ncolumns_to_select AS (\n\n    SELECT\n\n    bike_id,\n    bike_type,\n    RECORD_SOURCE,\n    LOAD_DATE,\n    EFFECTIVE_FROM,\n    BIKE_PK,\n    BIKE_HASHDIFF\n\n    FROM hashed_columns\n)\n\nSELECT * FROM columns_to_select", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:14.897465Z", "completed_at": "2025-08-21T00:30:15.604943Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:15.605908Z", "completed_at": "2025-08-21T00:30:16.709024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.814673900604248, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "5d8c1c8a-fd01-4efb-ae96-5e0f8ee80448", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_stg_stations", "compiled": true, "compiled_code": "\n\n\n\n\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n\n    SELECT\n\n    station_id,\n    name,\n    short_name,\n    latitude,\n    longitude,\n    region_id,\n    rental_method,\n    capacity,\n    last_reported\n\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_stations`\n),\n\nderived_columns AS (\n\n    SELECT\n\n    station_id,\n    name,\n    short_name,\n    latitude,\n    longitude,\n    region_id,\n    rental_method,\n    capacity,\n    last_reported,\n    'SRC_SQL_STATIONS' AS RECORD_SOURCE,\n    CURRENT_TIMESTAMP() AS LOAD_DATE,\n    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM\n\n    FROM source_data\n),\n\nhashed_columns AS (\n\n    SELECT\n\n    station_id,\n    name,\n    short_name,\n    latitude,\n    longitude,\n    region_id,\n    rental_method,\n    capacity,\n    last_reported,\n    RECORD_SOURCE,\n    LOAD_DATE,\n    EFFECTIVE_FROM,\n\n    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(station_id AS STRING))), '')))) AS STRING) AS STATION_PK,\n\n    CAST(UPPER(TO_HEX(MD5(CONCAT(\n        IFNULL(NULLIF(UPPER(TRIM(CAST(capacity AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(last_reported AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(latitude AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(longitude AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(name AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(region_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(rental_method AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(short_name AS STRING))), ''), '^^')\n    )))) AS STRING) AS STATION_HASHDIFF\n\n    FROM derived_columns\n),\n\ncolumns_to_select AS (\n\n    SELECT\n\n    station_id,\n    name,\n    short_name,\n    latitude,\n    longitude,\n    region_id,\n    rental_method,\n    capacity,\n    last_reported,\n    RECORD_SOURCE,\n    LOAD_DATE,\n    EFFECTIVE_FROM,\n    STATION_PK,\n    STATION_HASHDIFF\n\n    FROM hashed_columns\n)\n\nSELECT * FROM columns_to_select", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:16.718132Z", "completed_at": "2025-08-21T00:30:17.484475Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:17.485200Z", "completed_at": "2025-08-21T00:30:18.636280Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.9220447540283203, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "a6f64346-2d4e-4bcb-b82b-49b2e64a1f72", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_stg_trips", "compiled": true, "compiled_code": "\n\n\n\n\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n\n    SELECT\n\n    bike_id,\n    user_id,\n    start_station_id,\n    end_station_id,\n    start_time,\n    end_time,\n    trip_duration\n\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_trips`\n),\n\nderived_columns AS (\n\n    SELECT\n\n    bike_id,\n    user_id,\n    start_station_id,\n    end_station_id,\n    start_time,\n    end_time,\n    trip_duration,\n    'SRC_SQL_TRIPS' AS RECORD_SOURCE,\n    CURRENT_TIMESTAMP() AS LOAD_DATE,\n    start_time AS EFFECTIVE_FROM,\n    'DBT_SAT_SQL_TRIPS' AS DBT_SAT_SQL_TRIPS\n\n    FROM source_data\n),\n\nhashed_columns AS (\n\n    SELECT\n\n    bike_id,\n    user_id,\n    start_station_id,\n    end_station_id,\n    start_time,\n    end_time,\n    trip_duration,\n    RECORD_SOURCE,\n    LOAD_DATE,\n    EFFECTIVE_FROM,\n    DBT_SAT_SQL_TRIPS,\n\n    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(\n        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')\n    ), '^^||^^||^^||^^||^^')))) AS STRING) AS TRIP_PK,\n\n    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,\n\n    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), '')))) AS STRING) AS BIKE_PK,\n\n    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), '')))) AS STRING) AS START_STATION_PK,\n\n    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), '')))) AS STRING) AS END_STATION_PK,\n\n    CAST(UPPER(TO_HEX(MD5(CONCAT(\n        IFNULL(NULLIF(UPPER(TRIM(CAST(end_time AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(trip_duration AS STRING))), ''), '^^')\n    )))) AS STRING) AS TRIP_HASHDIFF,\n\n    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(\n        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^')\n    ), '^^||^^')))) AS STRING) AS LINK_USERS_BIKES_PK,\n\n    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(\n        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')\n    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_BIKES_TRIPS_PK,\n\n    CAST(UPPER(TO_HEX(MD5(NULLIF(CONCAT(\n        IFNULL(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(bike_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(start_station_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(end_station_id AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(start_time AS STRING))), ''), '^^')\n    ), '^^||^^||^^||^^||^^')))) AS STRING) AS LINK_USERS_TRIPS_PK\n\n    FROM derived_columns\n),\n\ncolumns_to_select AS (\n\n    SELECT\n\n    bike_id,\n    user_id,\n    start_station_id,\n    end_station_id,\n    start_time,\n    end_time,\n    trip_duration,\n    RECORD_SOURCE,\n    LOAD_DATE,\n    EFFECTIVE_FROM,\n    DBT_SAT_SQL_TRIPS,\n    TRIP_PK,\n    USER_PK,\n    BIKE_PK,\n    START_STATION_PK,\n    END_STATION_PK,\n    TRIP_HASHDIFF,\n    LINK_USERS_BIKES_PK,\n    LINK_BIKES_TRIPS_PK,\n    LINK_USERS_TRIPS_PK\n\n    FROM hashed_columns\n)\n\nSELECT * FROM columns_to_select", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:18.645563Z", "completed_at": "2025-08-21T00:30:19.339967Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:19.340926Z", "completed_at": "2025-08-21T00:30:20.412318Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7699708938598633, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "a14aae42-d55a-4c3f-b0d3-0d791e1c0cce", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_stg_users", "compiled": true, "compiled_code": "\n\n\n\n\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n\n    SELECT\n\n    user_id,\n    user_type,\n    gender,\n    birth_year,\n    customer_plan\n\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`raw_sql_users`\n),\n\nderived_columns AS (\n\n    SELECT\n\n    user_id,\n    user_type,\n    gender,\n    birth_year,\n    customer_plan,\n    'SRC_SQL_USERS' AS RECORD_SOURCE,\n    CURRENT_TIMESTAMP() AS LOAD_DATE,\n    CURRENT_TIMESTAMP() AS EFFECTIVE_FROM\n\n    FROM source_data\n),\n\nhashed_columns AS (\n\n    SELECT\n\n    user_id,\n    user_type,\n    gender,\n    birth_year,\n    customer_plan,\n    RECORD_SOURCE,\n    LOAD_DATE,\n    EFFECTIVE_FROM,\n\n    CAST(UPPER(TO_HEX(MD5(NULLIF(UPPER(TRIM(CAST(user_id AS STRING))), '')))) AS STRING) AS USER_PK,\n\n    CAST(UPPER(TO_HEX(MD5(CONCAT(\n        IFNULL(NULLIF(UPPER(TRIM(CAST(birth_year AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(gender AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')\n    )))) AS STRING) AS USER_HASHDIFF,\n\n    CAST(UPPER(TO_HEX(MD5(CONCAT(\n        IFNULL(NULLIF(UPPER(TRIM(CAST(customer_plan AS STRING))), ''), '^^'), '||',\n        IFNULL(NULLIF(UPPER(TRIM(CAST(user_type AS STRING))), ''), '^^')\n    )))) AS STRING) AS USER_PLANS_HASHDIFF\n\n    FROM derived_columns\n),\n\ncolumns_to_select AS (\n\n    SELECT\n\n    user_id,\n    user_type,\n    gender,\n    birth_year,\n    customer_plan,\n    RECORD_SOURCE,\n    LOAD_DATE,\n    EFFECTIVE_FROM,\n    USER_PK,\n    USER_HASHDIFF,\n    USER_PLANS_HASHDIFF\n\n    FROM hashed_columns\n)\n\nSELECT * FROM columns_to_select", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:20.419478Z", "completed_at": "2025-08-21T00:30:20.465976Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:20.466607Z", "completed_at": "2025-08-21T00:30:25.648301Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.2322351932525635, "adapter_response": {"_message": "MERGE (0.0 rows, 325.0 Bytes processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 325, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "65cf2436-b3fc-494f-aa6f-01e2abaa2246", "slot_ms": 1591}, "message": "MERGE (0.0 rows, 325.0 Bytes processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_hub_sql_bikes", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT rr.BIKE_PK, rr.bike_id, rr.LOAD_DATE, rr.RECORD_SOURCE,\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS rr\n    WHERE rr.BIKE_PK IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER(\n        PARTITION BY rr.BIKE_PK\n        ORDER BY rr.LOAD_DATE\n    ) = 1\n),\n\n\nrecords_to_insert AS (\n    SELECT a.BIKE_PK, a.bike_id, a.LOAD_DATE, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes` AS d\n    ON a.BIKE_PK = d.BIKE_PK\n    WHERE d.BIKE_PK IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_bikes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:25.657004Z", "completed_at": "2025-08-21T00:30:25.695364Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:25.695911Z", "completed_at": "2025-08-21T00:30:30.675336Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.0209221839904785, "adapter_response": {"_message": "MERGE (0.0 rows, 502.0 Bytes processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 502, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "b825057d-0bd5-43b9-86fd-260c1002c60f", "slot_ms": 1227}, "message": "MERGE (0.0 rows, 502.0 Bytes processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_sat_sql_bikes", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n    SELECT a.BIKE_PK, a.BIKE_HASHDIFF, a.bike_type, a.LOAD_DATE, a.RECORD_SOURCE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_bikes` AS a\n    WHERE a.BIKE_PK IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT current_records.BIKE_PK, current_records.BIKE_HASHDIFF, current_records.LOAD_DATE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes` AS current_records\n    JOIN (\n        SELECT DISTINCT source_data.BIKE_PK\n        FROM source_data\n    ) AS source_records\n        ON source_records.BIKE_PK = current_records.BIKE_PK\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY current_records.BIKE_PK\n        ORDER BY current_records.LOAD_DATE DESC\n    ) = 1\n),\n\nfirst_record_in_set AS (\n    SELECT\n        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE\n    FROM source_data AS sd\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY sd.BIKE_PK\n        ORDER BY sd.LOAD_DATE ASC\n    ) = 1\n),\n\nunique_source_records AS (\n    SELECT DISTINCT\n        sd.BIKE_PK, sd.BIKE_HASHDIFF, sd.bike_type, sd.LOAD_DATE, sd.RECORD_SOURCE\n    FROM source_data AS sd\n    QUALIFY sd.BIKE_HASHDIFF != LAG(sd.BIKE_HASHDIFF) OVER (\n        PARTITION BY sd.BIKE_PK\n        ORDER BY sd.LOAD_DATE ASC\n    )\n),\n\nrecords_to_insert AS (\n    SELECT frin.BIKE_PK, frin.BIKE_HASHDIFF, frin.bike_type, frin.LOAD_DATE, frin.RECORD_SOURCE\n    FROM first_record_in_set AS frin\n    LEFT JOIN latest_records AS lr\n        ON lr.BIKE_PK = frin.BIKE_PK\n        AND lr.BIKE_HASHDIFF = frin.BIKE_HASHDIFF\n        WHERE lr.BIKE_HASHDIFF IS NULL\n    UNION DISTINCT\n    SELECT usr.BIKE_PK, usr.BIKE_HASHDIFF, usr.bike_type, usr.LOAD_DATE, usr.RECORD_SOURCE\n    FROM unique_source_records AS usr\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_bikes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:30.680547Z", "completed_at": "2025-08-21T00:30:30.699079Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:30.699910Z", "completed_at": "2025-08-21T00:30:35.691419Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.01339316368103, "adapter_response": {"_message": "MERGE (0.0 rows, 680.0 Bytes processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 680, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "e17592d9-7948-44f4-9e67-f4539f6963e6", "slot_ms": 1249}, "message": "MERGE (0.0 rows, 680.0 Bytes processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_hub_sql_stations", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT rr.STATION_PK, rr.station_id, rr.LOAD_DATE, rr.RECORD_SOURCE,\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS rr\n    WHERE rr.STATION_PK IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER(\n        PARTITION BY rr.STATION_PK\n        ORDER BY rr.LOAD_DATE\n    ) = 1\n),\n\n\nrecords_to_insert AS (\n    SELECT a.STATION_PK, a.station_id, a.LOAD_DATE, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations` AS d\n    ON a.STATION_PK = d.STATION_PK\n    WHERE d.STATION_PK IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_stations`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:35.698599Z", "completed_at": "2025-08-21T00:30:35.732011Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:35.732756Z", "completed_at": "2025-08-21T00:30:40.908162Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.2137627601623535, "adapter_response": {"_message": "MERGE (0.0 rows, 680.0 Bytes processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 680, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "9d09919d-c1c9-46db-ba2d-e6eb43cf445f", "slot_ms": 2978}, "message": "MERGE (0.0 rows, 680.0 Bytes processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_sat_sql_stations", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n    SELECT a.STATION_PK, a.STATION_HASHDIFF, a.name, a.short_name, a.latitude, a.longitude, a.region_id, a.rental_method, a.capacity, a.last_reported, a.LOAD_DATE, a.RECORD_SOURCE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_stations` AS a\n    WHERE a.STATION_PK IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT current_records.STATION_PK, current_records.STATION_HASHDIFF, current_records.LOAD_DATE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations` AS current_records\n    JOIN (\n        SELECT DISTINCT source_data.STATION_PK\n        FROM source_data\n    ) AS source_records\n        ON source_records.STATION_PK = current_records.STATION_PK\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY current_records.STATION_PK\n        ORDER BY current_records.LOAD_DATE DESC\n    ) = 1\n),\n\nfirst_record_in_set AS (\n    SELECT\n        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE\n    FROM source_data AS sd\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY sd.STATION_PK\n        ORDER BY sd.LOAD_DATE ASC\n    ) = 1\n),\n\nunique_source_records AS (\n    SELECT DISTINCT\n        sd.STATION_PK, sd.STATION_HASHDIFF, sd.name, sd.short_name, sd.latitude, sd.longitude, sd.region_id, sd.rental_method, sd.capacity, sd.last_reported, sd.LOAD_DATE, sd.RECORD_SOURCE\n    FROM source_data AS sd\n    QUALIFY sd.STATION_HASHDIFF != LAG(sd.STATION_HASHDIFF) OVER (\n        PARTITION BY sd.STATION_PK\n        ORDER BY sd.LOAD_DATE ASC\n    )\n),\n\nrecords_to_insert AS (\n    SELECT frin.STATION_PK, frin.STATION_HASHDIFF, frin.name, frin.short_name, frin.latitude, frin.longitude, frin.region_id, frin.rental_method, frin.capacity, frin.last_reported, frin.LOAD_DATE, frin.RECORD_SOURCE\n    FROM first_record_in_set AS frin\n    LEFT JOIN latest_records AS lr\n        ON lr.STATION_PK = frin.STATION_PK\n        AND lr.STATION_HASHDIFF = frin.STATION_HASHDIFF\n        WHERE lr.STATION_HASHDIFF IS NULL\n    UNION DISTINCT\n    SELECT usr.STATION_PK, usr.STATION_HASHDIFF, usr.name, usr.short_name, usr.latitude, usr.longitude, usr.region_id, usr.rental_method, usr.capacity, usr.last_reported, usr.LOAD_DATE, usr.RECORD_SOURCE\n    FROM unique_source_records AS usr\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_stations`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:40.926434Z", "completed_at": "2025-08-21T00:30:41.007559Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:41.008067Z", "completed_at": "2025-08-21T00:30:43.705371Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.011380910873413, "adapter_response": {"_message": "MERGE (0.0 rows, 3.5 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 3620, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "7a3d7ab0-899d-4db0-9e20-77917d048ba2", "slot_ms": 12697}, "message": "MERGE (0.0 rows, 3.5 KiB processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_eff_sat_link_users_trips", "compiled": true, "compiled_code": "\n\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n    SELECT a.TRIP_PK, a.USER_PK, a.BIKE_PK, a.start_time, a.end_time, a.EFFECTIVE_FROM, a.LOAD_DATE, a.RECORD_SOURCE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a\n    WHERE a.USER_PK IS NOT NULL\n    AND a.BIKE_PK IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT * FROM (\n        SELECT b.TRIP_PK, b.USER_PK, b.BIKE_PK, b.start_time, b.end_time, b.EFFECTIVE_FROM, b.LOAD_DATE, b.RECORD_SOURCE\n        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips` AS b\n        QUALIFY ROW_NUMBER() OVER (\n            PARTITION BY b.TRIP_PK\n            ORDER BY b.LOAD_DATE DESC\n        ) = 1\n        ) AS inner_select\n    \n),\n\nlatest_open AS (\n    SELECT c.TRIP_PK, c.USER_PK, c.BIKE_PK, c.start_time, c.end_time, c.EFFECTIVE_FROM, c.LOAD_DATE, c.RECORD_SOURCE\n    FROM latest_records AS c\n    WHERE DATE(c.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))\n),\n\nlatest_closed AS (\n    SELECT d.TRIP_PK, d.USER_PK, d.BIKE_PK, d.start_time, d.end_time, d.EFFECTIVE_FROM, d.LOAD_DATE, d.RECORD_SOURCE\n    FROM latest_records AS d\n    WHERE DATE(d.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))\n),\n\nnew_open_records AS (\n    SELECT DISTINCT\n        f.TRIP_PK, f.USER_PK, f.BIKE_PK,\n        f.start_time AS start_time,\n        f.end_time AS end_time,\n        f.EFFECTIVE_FROM AS EFFECTIVE_FROM,\n        f.LOAD_DATE,\n        f.RECORD_SOURCE\n    FROM source_data AS f\n    LEFT JOIN latest_records AS lr\n    ON f.TRIP_PK = lr.TRIP_PK\n    WHERE lr.TRIP_PK IS NULL\n),\n\nnew_reopened_records AS (\n    SELECT DISTINCT\n        lc.TRIP_PK, lc.USER_PK, lc.BIKE_PK,\n        g.start_time AS start_time,\n        g.end_time AS end_time,\n        g.EFFECTIVE_FROM AS EFFECTIVE_FROM,\n        g.LOAD_DATE,\n        g.RECORD_SOURCE\n    FROM source_data AS g\n    INNER JOIN latest_closed AS lc\n    ON g.TRIP_PK = lc.TRIP_PK\n    WHERE DATE(g.end_time) = DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))\n),\n\n\n\nnew_closed_records AS (\n    SELECT DISTINCT\n        lo.TRIP_PK, lo.USER_PK, lo.BIKE_PK,\n        h.start_time AS start_time,\n        h.end_time AS end_time,\n        h.EFFECTIVE_FROM AS EFFECTIVE_FROM,\n        h.LOAD_DATE,\n        lo.RECORD_SOURCE\n    FROM source_data AS h\n    LEFT JOIN latest_open AS lo\n    ON lo.TRIP_PK = h.TRIP_PK\n    LEFT JOIN latest_closed AS lc\n    ON lc.TRIP_PK = h.TRIP_PK\n    WHERE DATE(h.end_time) != DATE(PARSE_DATETIME('%F %H:%M:%E6S', '9999-12-31 23:59:59.999999'))\n    AND lo.TRIP_PK IS NOT NULL\n    AND lc.TRIP_PK IS NULL\n),\n\nrecords_to_insert AS (\n    SELECT * FROM new_open_records\n    UNION DISTINCT\n    SELECT * FROM new_reopened_records\n    UNION DISTINCT\n    SELECT * FROM new_closed_records\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_eff_sat_sql_trips`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:43.979635Z", "completed_at": "2025-08-21T00:30:44.027821Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:44.028400Z", "completed_at": "2025-08-21T00:30:48.870802Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.895201921463013, "adapter_response": {"_message": "MERGE (20.0 rows, 10.7 KiB processed)", "code": "MERGE", "rows_affected": 20, "bytes_processed": 11000, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "243c26c1-2d57-40e2-b633-5d08cf8a32cd", "slot_ms": 2368}, "message": "MERGE (20.0 rows, 10.7 KiB processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_ext_track_sat_trips", "compiled": true, "compiled_code": "\n\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH \n\nsatellite_dbt_sat_sql_trips_from_dbt_stg_trips AS (\n    SELECT s.TRIP_PK,\n           s.TRIP_HASHDIFF AS HASHDIFF,\n           s.DBT_SAT_SQL_TRIPS AS SATELLITE_NAME,\n           s.LOAD_DATE,\n           s.RECORD_SOURCE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS s\n    WHERE s.TRIP_PK IS NOT NULL\n),\n\nrecords_to_insert AS (\n    SELECT DISTINCT\n        a.TRIP_PK,\n        a.HASHDIFF,\n        a.SATELLITE_NAME,\n        a.LOAD_DATE,\n        a.RECORD_SOURCE\n    FROM satellite_dbt_sat_sql_trips_from_dbt_stg_trips AS a\n    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips` AS d\n        ON (\n            a.HASHDIFF = d.HASHDIFF\n            AND a.LOAD_DATE = d.LOAD_DATE\n            AND a.SATELLITE_NAME = d.SATELLITE_NAME\n        )\n    WHERE d.HASHDIFF IS NULL\n    AND d.LOAD_DATE IS NULL\n    AND d.SATELLITE_NAME IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_ext_track_sat_trips`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:48.882170Z", "completed_at": "2025-08-21T00:30:48.903358Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:48.903926Z", "completed_at": "2025-08-21T00:30:53.646803Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.768667936325073, "adapter_response": {"_message": "MERGE (0.0 rows, 1.9 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 1940, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "56ba3aff-17b0-483b-aba2-2be7829fc4db", "slot_ms": 1043}, "message": "MERGE (0.0 rows, 1.9 KiB processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_hub_sql_trips", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT rr.TRIP_PK, rr.user_id, rr.bike_id, rr.start_station_id, rr.end_station_id, rr.start_time, rr.LOAD_DATE, rr.RECORD_SOURCE,\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr\n    WHERE rr.TRIP_PK IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER(\n        PARTITION BY rr.TRIP_PK\n        ORDER BY rr.LOAD_DATE\n    ) = 1\n),\n\n\nrecords_to_insert AS (\n    SELECT a.TRIP_PK, a.user_id, a.bike_id, a.start_station_id, a.end_station_id, a.start_time, a.LOAD_DATE, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips` AS d\n    ON a.TRIP_PK = d.TRIP_PK\n    WHERE d.TRIP_PK IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_trips`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:53.655289Z", "completed_at": "2025-08-21T00:30:53.695372Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:53.696098Z", "completed_at": "2025-08-21T00:30:57.981382Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.334438800811768, "adapter_response": {"_message": "MERGE (0.0 rows, 2.4 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 2500, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "a07b7bb8-ebb7-463b-88eb-c87bd193ca75", "slot_ms": 1009}, "message": "MERGE (0.0 rows, 2.4 KiB processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_link_sql_bikes_trips", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT rr.LINK_BIKES_TRIPS_PK, rr.BIKE_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr\n    WHERE rr.LINK_BIKES_TRIPS_PK IS NOT NULL\n    AND rr.BIKE_PK IS NOT NULL\n    AND rr.TRIP_PK IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER(\n        PARTITION BY rr.LINK_BIKES_TRIPS_PK\n        ORDER BY rr.LOAD_DATE\n    ) = 1\n),\n\nrecords_to_insert AS (\n    SELECT a.LINK_BIKES_TRIPS_PK, a.BIKE_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips` AS d\n    ON a.LINK_BIKES_TRIPS_PK = d.LINK_BIKES_TRIPS_PK\n    WHERE d.LINK_BIKES_TRIPS_PK IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_bikes_trips`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:30:57.995538Z", "completed_at": "2025-08-21T00:30:58.024972Z"}, {"name": "execute", "started_at": "2025-08-21T00:30:58.026107Z", "completed_at": "2025-08-21T00:31:02.668788Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.67691707611084, "adapter_response": {"_message": "MERGE (0.0 rows, 1.2 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 1250, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "da366279-f7b8-407a-a009-5115e69f549e", "slot_ms": 993}, "message": "MERGE (0.0 rows, 1.2 KiB processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_link_sql_users_bikes", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT rr.LINK_USERS_BIKES_PK, rr.USER_PK, rr.BIKE_PK, rr.LOAD_DATE, rr.RECORD_SOURCE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr\n    WHERE rr.LINK_USERS_BIKES_PK IS NOT NULL\n    AND rr.USER_PK IS NOT NULL\n    AND rr.BIKE_PK IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER(\n        PARTITION BY rr.LINK_USERS_BIKES_PK\n        ORDER BY rr.LOAD_DATE\n    ) = 1\n),\n\nrecords_to_insert AS (\n    SELECT a.LINK_USERS_BIKES_PK, a.USER_PK, a.BIKE_PK, a.LOAD_DATE, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes` AS d\n    ON a.LINK_USERS_BIKES_PK = d.LINK_USERS_BIKES_PK\n    WHERE d.LINK_USERS_BIKES_PK IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_bikes`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:31:02.676964Z", "completed_at": "2025-08-21T00:31:02.695727Z"}, {"name": "execute", "started_at": "2025-08-21T00:31:02.696687Z", "completed_at": "2025-08-21T00:31:07.356906Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.685174942016602, "adapter_response": {"_message": "MERGE (0.0 rows, 2.4 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 2500, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "e05fa8d6-51db-48d6-8905-58b644521188", "slot_ms": 967}, "message": "MERGE (0.0 rows, 2.4 KiB processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_link_sql_users_trips", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT rr.LINK_USERS_TRIPS_PK, rr.USER_PK, rr.TRIP_PK, rr.LOAD_DATE, rr.RECORD_SOURCE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS rr\n    WHERE rr.LINK_USERS_TRIPS_PK IS NOT NULL\n    AND rr.USER_PK IS NOT NULL\n    AND rr.TRIP_PK IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER(\n        PARTITION BY rr.LINK_USERS_TRIPS_PK\n        ORDER BY rr.LOAD_DATE\n    ) = 1\n),\n\nrecords_to_insert AS (\n    SELECT a.LINK_USERS_TRIPS_PK, a.USER_PK, a.TRIP_PK, a.LOAD_DATE, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips` AS d\n    ON a.LINK_USERS_TRIPS_PK = d.LINK_USERS_TRIPS_PK\n    WHERE d.LINK_USERS_TRIPS_PK IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_link_sql_users_trips`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:31:07.367112Z", "completed_at": "2025-08-21T00:31:07.400252Z"}, {"name": "execute", "started_at": "2025-08-21T00:31:07.401057Z", "completed_at": "2025-08-21T00:31:12.836554Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.472745895385742, "adapter_response": {"_message": "MERGE (0.0 rows, 1.3 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 1360, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "5fbe6252-2835-4db9-96c3-294f4a4292a6", "slot_ms": 2968}, "message": "MERGE (0.0 rows, 1.3 KiB processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_sat_sql_trips", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n    SELECT a.TRIP_PK, a.TRIP_HASHDIFF, a.start_time, a.end_time, a.trip_duration, a.LOAD_DATE, a.RECORD_SOURCE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_trips` AS a\n    WHERE a.TRIP_PK IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT current_records.TRIP_PK, current_records.TRIP_HASHDIFF, current_records.LOAD_DATE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips` AS current_records\n    JOIN (\n        SELECT DISTINCT source_data.TRIP_PK\n        FROM source_data\n    ) AS source_records\n        ON source_records.TRIP_PK = current_records.TRIP_PK\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY current_records.TRIP_PK\n        ORDER BY current_records.LOAD_DATE DESC\n    ) = 1\n),\n\nfirst_record_in_set AS (\n    SELECT\n        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE\n    FROM source_data AS sd\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY sd.TRIP_PK\n        ORDER BY sd.LOAD_DATE ASC\n    ) = 1\n),\n\nunique_source_records AS (\n    SELECT DISTINCT\n        sd.TRIP_PK, sd.TRIP_HASHDIFF, sd.start_time, sd.end_time, sd.trip_duration, sd.LOAD_DATE, sd.RECORD_SOURCE\n    FROM source_data AS sd\n    QUALIFY sd.TRIP_HASHDIFF != LAG(sd.TRIP_HASHDIFF) OVER (\n        PARTITION BY sd.TRIP_PK\n        ORDER BY sd.LOAD_DATE ASC\n    )\n),\n\nrecords_to_insert AS (\n    SELECT frin.TRIP_PK, frin.TRIP_HASHDIFF, frin.start_time, frin.end_time, frin.trip_duration, frin.LOAD_DATE, frin.RECORD_SOURCE\n    FROM first_record_in_set AS frin\n    LEFT JOIN latest_records AS lr\n        ON lr.TRIP_PK = frin.TRIP_PK\n        AND lr.TRIP_HASHDIFF = frin.TRIP_HASHDIFF\n        WHERE lr.TRIP_HASHDIFF IS NULL\n    UNION DISTINCT\n    SELECT usr.TRIP_PK, usr.TRIP_HASHDIFF, usr.start_time, usr.end_time, usr.trip_duration, usr.LOAD_DATE, usr.RECORD_SOURCE\n    FROM unique_source_records AS usr\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_sat_sql_trips`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:31:12.843875Z", "completed_at": "2025-08-21T00:31:12.861358Z"}, {"name": "execute", "started_at": "2025-08-21T00:31:12.862457Z", "completed_at": "2025-08-21T00:31:17.703546Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.86335301399231, "adapter_response": {"_message": "MERGE (0.0 rows, 650.0 Bytes processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 650, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "16af830f-914e-435f-9f71-027f889b57c5", "slot_ms": 2162}, "message": "MERGE (0.0 rows, 650.0 Bytes processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_hub_sql_users", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH row_rank_1 AS (\n    SELECT rr.USER_PK, rr.user_id, rr.LOAD_DATE, rr.RECORD_SOURCE,\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS rr\n    WHERE rr.USER_PK IS NOT NULL\n    QUALIFY ROW_NUMBER() OVER(\n        PARTITION BY rr.USER_PK\n        ORDER BY rr.LOAD_DATE\n    ) = 1\n),\n\n\nrecords_to_insert AS (\n    SELECT a.USER_PK, a.user_id, a.LOAD_DATE, a.RECORD_SOURCE\n    FROM row_rank_1 AS a\n    LEFT JOIN `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users` AS d\n    ON a.USER_PK = d.USER_PK\n    WHERE d.USER_PK IS NULL\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_hub_sql_users`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:31:17.712517Z", "completed_at": "2025-08-21T00:31:17.752789Z"}, {"name": "execute", "started_at": "2025-08-21T00:31:17.753510Z", "completed_at": "2025-08-21T00:31:23.091959Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.384047269821167, "adapter_response": {"_message": "MERGE (0.0 rows, 1.2 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 1190, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "d817f713-681a-40b4-959e-27a9920d6756", "slot_ms": 2205}, "message": "MERGE (0.0 rows, 1.2 KiB processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_multi_active_sat_users_plans", "compiled": true, "compiled_code": "\n\n-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \nWITH source_data AS (\n    SELECT DISTINCT s.USER_PK, s.customer_plan, s.user_type, s.USER_PLANS_HASHDIFF, s.EFFECTIVE_FROM, s.LOAD_DATE, s.RECORD_SOURCE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS s\n    WHERE s.USER_PK IS NOT NULL\n        AND s.customer_plan IS NOT NULL\n),\n\nsource_data_with_count AS (\n    SELECT a.*,\n           b.source_count\n    FROM source_data AS a\n    INNER JOIN (\n        SELECT t.USER_PK, COUNT(*) AS source_count\n        FROM (\n            SELECT DISTINCT s.USER_PK,\n                            s.USER_PLANS_HASHDIFF,\n                            s.customer_plan\n            FROM source_data AS s\n        ) AS t\n        GROUP BY t.USER_PK\n    ) AS b\n    ON a.USER_PK = b.USER_PK\n),\n\nlatest_records AS (\n    SELECT mas.USER_PK, mas.HASHDIFF, mas.customer_plan, mas.LOAD_DATE,DENSE_RANK() OVER (\n               PARTITION BY mas.USER_PK\n               ORDER BY mas.HASHDIFF, mas.customer_plan ASC\n           ) AS check_rank\n    FROM (\n        SELECT inner_mas.USER_PK, inner_mas.HASHDIFF, inner_mas.customer_plan, inner_mas.LOAD_DATE\n        FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans` AS inner_mas\n        INNER JOIN (SELECT DISTINCT s.USER_PK FROM source_data as s ) AS spk\n            ON inner_mas.USER_PK = spk.USER_PK\n            QUALIFY RANK() OVER (\n                PARTITION BY inner_mas.USER_PK\n                ORDER BY inner_mas.LOAD_DATE DESC\n            ) = 1\n    ) AS mas\n    \n),\n\nlatest_group_details AS (\n    SELECT lr.USER_PK,\n           lr.LOAD_DATE,\n           MAX(lr.check_rank) AS latest_count\n    FROM latest_records AS lr\n    GROUP BY lr.USER_PK, lr.LOAD_DATE\n),\n\nrecords_to_insert AS (\n    SELECT source_data_with_count.USER_PK, source_data_with_count.customer_plan, source_data_with_count.user_type, source_data_with_count.USER_PLANS_HASHDIFF AS HASHDIFF, source_data_with_count.EFFECTIVE_FROM, source_data_with_count.LOAD_DATE, source_data_with_count.RECORD_SOURCE\n    FROM source_data_with_count\n    WHERE EXISTS (\n        SELECT 1\n        FROM source_data_with_count AS stage\n        WHERE NOT EXISTS (\n            SELECT 1\n            FROM (\n                SELECT lr.USER_PK, lr.HASHDIFF, lr.customer_plan, lr.LOAD_DATE,\n                       lg.latest_count\n                FROM latest_records AS lr\n                INNER JOIN latest_group_details AS lg\n                    ON lr.USER_PK = lg.USER_PK\n                    AND lr.LOAD_DATE = lg.LOAD_DATE\n            ) AS active_records\n            WHERE stage.USER_PK = active_records.USER_PK\n                AND stage.USER_PLANS_HASHDIFF = active_records.HASHDIFF\n                AND stage.customer_plan = active_records.customer_plan\n                AND stage.source_count = active_records.latest_count\n        )\n        AND source_data_with_count.USER_PK = stage.USER_PK\n    )\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_multi_active_sat_users_plans`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T00:31:23.101542Z", "completed_at": "2025-08-21T00:31:23.156900Z"}, {"name": "execute", "started_at": "2025-08-21T00:31:23.157664Z", "completed_at": "2025-08-21T00:31:28.258648Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.160684108734131, "adapter_response": {"_message": "MERGE (0.0 rows, 680.0 Bytes processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 680, "bytes_billed": 20971520, "location": "asia-south2", "project_id": "leafy-mountain-469410-k3", "job_id": "0de86e62-4fde-448b-be2a-22e9f0e8738c", "slot_ms": 4316}, "message": "MERGE (0.0 rows, 680.0 Bytes processed)", "failures": null, "unique_id": "model.dbt_bq_sa.dbt_sat_sql_users", "compiled": true, "compiled_code": "-- Generated by AutomateDV (formerly known as dbtvault)\n\n    \n\nWITH source_data AS (\n    SELECT a.USER_PK, a.USER_HASHDIFF, a.user_type, a.gender, a.birth_year, a.customer_plan, a.LOAD_DATE, a.RECORD_SOURCE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt_stg_users` AS a\n    WHERE a.USER_PK IS NOT NULL\n),\n\nlatest_records AS (\n    SELECT current_records.USER_PK, current_records.USER_HASHDIFF, current_records.LOAD_DATE\n    FROM `leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users` AS current_records\n    JOIN (\n        SELECT DISTINCT source_data.USER_PK\n        FROM source_data\n    ) AS source_records\n        ON source_records.USER_PK = current_records.USER_PK\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY current_records.USER_PK\n        ORDER BY current_records.LOAD_DATE DESC\n    ) = 1\n),\n\nfirst_record_in_set AS (\n    SELECT\n        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE\n    FROM source_data AS sd\n    QUALIFY ROW_NUMBER() OVER (\n        PARTITION BY sd.USER_PK\n        ORDER BY sd.LOAD_DATE ASC\n    ) = 1\n),\n\nunique_source_records AS (\n    SELECT DISTINCT\n        sd.USER_PK, sd.USER_HASHDIFF, sd.user_type, sd.gender, sd.birth_year, sd.customer_plan, sd.LOAD_DATE, sd.RECORD_SOURCE\n    FROM source_data AS sd\n    QUALIFY sd.USER_HASHDIFF != LAG(sd.USER_HASHDIFF) OVER (\n        PARTITION BY sd.USER_PK\n        ORDER BY sd.LOAD_DATE ASC\n    )\n),\n\nrecords_to_insert AS (\n    SELECT frin.USER_PK, frin.USER_HASHDIFF, frin.user_type, frin.gender, frin.birth_year, frin.customer_plan, frin.LOAD_DATE, frin.RECORD_SOURCE\n    FROM first_record_in_set AS frin\n    LEFT JOIN latest_records AS lr\n        ON lr.USER_PK = frin.USER_PK\n        AND lr.USER_HASHDIFF = frin.USER_HASHDIFF\n        WHERE lr.USER_HASHDIFF IS NULL\n    UNION DISTINCT\n    SELECT usr.USER_PK, usr.USER_HASHDIFF, usr.user_type, usr.gender, usr.birth_year, usr.customer_plan, usr.LOAD_DATE, usr.RECORD_SOURCE\n    FROM unique_source_records AS usr\n)\n\nSELECT * FROM records_to_insert", "relation_name": "`leafy-mountain-469410-k3`.`citibike_source_sql`.`dbt sat_sql_users`"}], "elapsed_time": 82.04560613632202, "args": {"log_level": "info", "populate_cache": true, "static_parser": true, "profiles_dir": "/Users/rishin/.dbt", "warn_error_options": {"include": [], "exclude": []}, "use_colors": true, "invocation_command": "dbt run", "project_dir": "/Users/rishin/PycharmProjects/automate-dv-demo-5.4", "use_colors_file": true, "exclude": [], "macro_debugging": false, "quiet": false, "cache_selected_only": false, "log_format_file": "debug", "introspect": true, "indirect_selection": "eager", "defer": false, "require_explicit_package_overrides_for_builtin_materializations": false, "vars": {}, "printer_width": 80, "write_json": true, "log_path": "/Users/rishin/PycharmProjects/automate-dv-demo-5.4/logs", "send_anonymous_usage_stats": true, "select": [], "partial_parse_file_diff": true, "strict_mode": false, "version_check": true, "log_format": "default", "partial_parse": true, "enable_legacy_logger": false, "print": true, "favor_state": false, "log_file_max_bytes": 10485760, "show_resource_report": false, "log_level_file": "debug", "which": "run"}}